!function(e){"use strict";const t={actions:Object.create(null),filters:Object.create(null)},n=new Set;function r(e){return"string"==typeof e&&e.length>0&&!/[._]/.test(e)&&!/(proto|constructor)/.test(e)}function o(e,n,o,i=10){return!(!r(n)||"function"!=typeof o)&&(n in t[e]||(t[e][n]=[]),t[e][n].push({callback:o,priority:i}),t[e][n].sort((e,t)=>e.priority-t.priority),!0)}function i(e,n,o){if(!r(n)||!(n in t[e]))return!1;const i=t[e][n].findIndex(e=>e.callback===o);return i>-1&&(t[e][n].splice(i,1),!0)}e.StarmusHooks={addAction:function(e,t,n=10){o("actions",e,t,n)},removeAction:function(e,t){return i("actions",e,t)},doAction:function(e,...o){r(e)&&(n.add(e),e in t.actions&&t.actions[e].forEach(e=>{try{e.callback(...o)}catch(e){}}))},hasFired:function(e){return r(e)&&n.has(e)},addFilter:function(e,t,n=10){o("filters",e,t,n)},removeFilter:function(e,t){return i("filters",e,t)},applyFilters:function(e,n,...o){let i=n;return r(e)&&e in t.filters&&t.filters[e].forEach(e=>{try{i=e.callback(i,...o)}catch(e){}}),i}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>e.StarmusHooks.doAction("starmus_hooks_ready")):e.StarmusHooks.doAction("starmus_hooks_ready"),e.StarmusHooks.isPWA=()=>e.matchMedia("(display-mode: standalone)").matches||!0===e.navigator.standalone}(window),function(e){"use strict";const t=!(!e.MediaRecorder||!e.navigator.mediaDevices),n=Object.create(null);function r(e){return"string"==typeof e&&/^[a-zA-Z0-9_-]{1,100}$/.test(e)}function o(e,t,n){console&&console[e]}function i(t,...n){e.StarmusHooks&&e.StarmusHooks.doAction(t,...n)}function a(t,n,...r){return e.StarmusHooks?e.StarmusHooks.applyFilters(t,n,...r):n}e.StarmusAudioRecorder={init:function(a){return new Promise((s,c)=>{if(!t)return c(new Error("MediaRecorder API not supported."));const u=a.formInstanceId;return r(u)?u in n?s(!0):(i("starmus_before_recorder_init",u,a),void navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:16e3,channelCount:1}}).then(t=>{const r=new(e.AudioContext||e.webkitAudioContext)({sampleRate:16e3}),o=r.createMediaStreamSource(t),a=r.createAnalyser(),c=r.createGain(),l=r.createDynamicsCompressor(),d=r.createBiquadFilter();a.fftSize=1024,d.type="highpass",d.frequency.value=80,l.threshold.value=-24,l.knee.value=30,l.ratio.value=12,l.attack.value=.003,l.release.value=.25,o.connect(d),d.connect(l),l.connect(a),l.connect(c),n[u]={stream:t,recorder:null,chunks:[],audioBlob:null,isRecording:!1,isPaused:!1,startTime:0,ctx:r,analyser:a,gain:c,compressor:l,filter:d,isCalibrated:!1,volumeMonitorId:null,speechRecognition:null,transcript:[],currentLanguage:null,silenceStart:null,totalSilence:0,peakVolume:0,avgVolume:0,volumeSamples:[],sessionUUID:crypto.randomUUID?crypto.randomUUID():"uuid-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)},i("starmus_after_recorder_init",u),s(!0)}).catch(e=>{o("error",0,e.message),i("starmus_recorder_init_failed",u,e),c(new Error("Microphone permission is required."))})):c(new Error("Invalid instance ID."))})},calibrate:function(e,t){if(!r(e)||!(e in n))return;const o=n[e],s=o.analyser,c=new Float32Array(s.fftSize),u=[],l=performance.now();i("starmus_calibration_started",e),function n(){const r=performance.now()-l,d=Math.ceil((15e3-r)/1e3);t(r<5e3?"Be quiet for background noise ("+d+"s)":r<1e4?"Now speak clearly and loudly ("+d+"s)":"Be quiet again ("+d+"s)"),s.getFloatTimeDomainData(c);let m=0;for(let e=0;e<c.length;e++)m+=c[e]*c[e];const f=Math.sqrt(m/c.length);u.push(f),t(null,Math.min(100,2e3*f)),r<15e3?requestAnimationFrame(n):function(){const n=u.slice(0,Math.floor(.33*u.length)),r=u.slice(Math.floor(.33*u.length),Math.floor(.67*u.length)),s=n.reduce((e,t)=>e+t,0)/n.length,c=r.reduce((e,t)=>e+t,0)/r.length,l=c/Math.max(s,1e-6);let d=l<3?6:Math.max(1,Math.min(4,.1/Math.max(c,1e-6)));d=a("starmus_calibration_gain",d,e,{speechLevel:c,noiseFloor:s,snr:l}),o.gain.gain.setTargetAtTime(d,o.ctx.currentTime,.01),o.isCalibrated=!0,t("Mic calibrated (gain ×"+d.toFixed(1)+", SNR: "+l.toFixed(1)+"). Ready to record.",null,!0),i("starmus_calibration_complete",e,{gain:d,snr:l,noiseFloor:s})}()}()},startVolumeMonitoring:function(e,t){if(!r(e)||!(e in n))return;const o=n[e],i=o.analyser,s=new Float32Array(i.fftSize);o.volumeMonitorId=requestAnimationFrame(function n(){if(!o.isRecording||o.isPaused)return void(o.volumeMonitorId=null);i.getFloatTimeDomainData(s);const r=s.reduce((e,t)=>e+t*t,0),c=Math.sqrt(r/s.length),u=Math.min(100,2e3*c);o.volumeSamples.push(u),o.peakVolume=Math.max(o.peakVolume,u),o.avgVolume=o.volumeSamples.reduce((e,t)=>e+t,0)/o.volumeSamples.length;const l=Date.now();u<5?o.silenceStart||(o.silenceStart=l):o.silenceStart&&(o.totalSilence+=l-o.silenceStart,o.silenceStart=null),t(a("starmus_volume_level",u,e)),o.volumeMonitorId=requestAnimationFrame(n)})},startRecording:function(t,a="en-US"){if(!r(t)||!(t in n)||n[t].isRecording)return;const s=n[t];if(e.SpeechRecognition||e.webkitSpeechRecognition){const n=e.SpeechRecognition||e.webkitSpeechRecognition;s.speechRecognition=new n,s.speechRecognition.continuous=!0,s.speechRecognition.interimResults=!0,s.speechRecognition.lang=a,s.currentLanguage=a,s.speechRecognition.onresult=e=>{const n=Date.now()-s.startTime;for(let r=e.resultIndex;r<e.results.length;r++){const o=e.results[r],a={text:o[0].transcript,confidence:o[0].confidence,timestamp:n,isFinal:o.isFinal,language:s.currentLanguage};o.isFinal&&(s.transcript.push(a),i("starmus_speech_recognized",t,a))}},s.speechRecognition.onerror=e=>{"no-speech"!==e.error&&"language-not-supported"!==e.error||s.transcript.push({text:"[Non-transcribable language detected]",confidence:0,timestamp:Date.now()-s.startTime,isFinal:!0,language:"unknown"})}}try{const e=s.ctx.createMediaStreamDestination();s.gain.connect(e);const n={audioBitsPerSecond:32e3};MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?n.mimeType="audio/webm;codecs=opus":MediaRecorder.isTypeSupported("audio/mp4")&&(n.mimeType="audio/mp4"),s.recorder=new MediaRecorder(e.stream,n),s.chunks=[],s.audioBlob=null,s.isRecording=!0,s.isPaused=!1,s.startTime=Date.now(),s.recorder.ondataavailable=e=>{e.data.size>0&&s.chunks.push(e.data)},s.recorder.onstop=()=>{s.audioBlob=new Blob(s.chunks,{type:s.recorder.mimeType||"audio/webm"}),i("starmus_recording_stopped",t,s.audioBlob)},s.recorder.start(),s.speechRecognition&&s.speechRecognition.start(),i("starmus_recording_started",t)}catch(e){o("error",0,e.message),i("starmus_recording_failed",t,e)}},stopRecording:function(e){if(!r(e)||!(e in n))return;const t=n[e];t.recorder&&"inactive"!==t.recorder.state&&t.recorder.stop(),t.speechRecognition&&t.speechRecognition.stop(),t.silenceStart&&(t.totalSilence+=Date.now()-t.silenceStart),t.isRecording=!1,t.isPaused=!1},getRecordingQuality:function(e){if(!r(e)||!(e in n))return null;const t=n[e],o=Date.now()-t.startTime,i=t.totalSilence/o;return{peakVolume:t.peakVolume,avgVolume:t.avgVolume,silenceRatio:i,quality:t.peakVolume>20&&t.avgVolume>10&&i<.7?"good":"poor",warnings:[...t.peakVolume<20?["Low volume detected"]:[],...i>.7?["Too much silence"]:[],...t.isCalibrated?[]:["Microphone not calibrated"]]}},togglePause:function(e){if(!r(e)||!(e in n))return;const t=n[e];t.recorder&&(t.isPaused&&"paused"===t.recorder.state?(t.recorder.resume(),t.isPaused=!1,i("starmus_recording_resumed",e)):"recording"===t.recorder.state&&(t.recorder.pause(),t.isPaused=!0,i("starmus_recording_paused",e)))},getSubmissionData:function(t){if(!r(t)||!(t in n))return null;const o=n[t];if(o.audioBlob){const n=a("starmus_recorder_filename","starmus-recording.webm",t),r=Date.now()-o.startTime;return a("starmus_submission_data",{blob:o.audioBlob,fileName:n,mimeType:o.audioBlob.type||"audio/webm",size:o.audioBlob.size,metadata:{sessionUUID:o.sessionUUID,submissionUUID:crypto.randomUUID?crypto.randomUUID():"sub-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),recordedAt:new Date(o.startTime).toISOString(),recordedAtLocal:new Date(o.startTime).toString(),duration:r,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,sampleRate:o.ctx.sampleRate,channelCount:1,bitDepth:16,codec:o.audioBlob.type,fileSize:o.audioBlob.size,userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,languages:navigator.languages,screenResolution:`${screen.width}x${screen.height}`,deviceMemory:navigator.deviceMemory||"unknown",hardwareConcurrency:navigator.hardwareConcurrency||"unknown",connection:navigator.connection?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt}:"unknown",audioProcessing:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,gainApplied:o.gain.gain.value,isCalibrated:o.isCalibrated,compressionUsed:!0,highpassFilter:"80Hz"},quality:{peakVolume:o.peakVolume,avgVolume:o.avgVolume,silenceRatio:o.totalSilence/r,volumeConsistency:o.volumeSamples.length>0?o.volumeSamples.reduce((e,t)=>e+Math.abs(t-o.avgVolume),0)/o.volumeSamples.length:0},transcript:o.transcript.map(e=>({...e,timestampUTC:new Date(o.startTime+e.timestamp).toISOString(),timestampOffset:e.timestamp})),detectedLanguage:o.currentLanguage,hasTranscription:o.transcript.length>0,speechRecognitionAvailable:!(!e.SpeechRecognition&&!e.webkitSpeechRecognition)}},t)}return null},cleanup:function(e){if(!r(e)||!(e in n))return;const t=n[e];t.volumeMonitorId&&cancelAnimationFrame(t.volumeMonitorId),t.stream&&t.stream.getTracks().forEach(e=>e.stop()),i("starmus_recorder_cleanup",e),delete n[e]},validateWestAfricanLanguage:function(e,t="unknown"){if(!r(e)||!(e in n))return{isValid:!1,reason:"Invalid instance"};const o=n[e],i=Date.now()-o.startTime,a=o.transcript.map(e=>e.text).join(" ").toLowerCase().trim(),s=a?a.split(/\s+/).length:0,c=o.transcript.length>0?o.transcript.reduce((e,t)=>e+t.confidence,0)/o.transcript.length:0,u=t.toLowerCase();if(u.includes("word")||i<3e3&&s<=2){const e=/^(hello|yes|no|the|and|is|are|you|me|my|your|good|bad|big|small|one|two|three)$/i.test(a),t=/^(bonjour|oui|non|le|la|les|et|est|vous|moi|mon|votre|bon|mauvais|grand|petit|un|deux|trois)$/i.test(a);return c>.95&&(e||t)?{isValid:!1,reason:`Obvious ${e?"English":"French"} word detected`,recordingType:"word"}:{isValid:!0,reason:"Single word - likely West African",recordingType:"word",avgConfidence:c}}if(u.includes("phrase")||u.includes("proverb")||u.includes("saying")||i<15e3&&s<=15){const e=/\b(the|and|is|in|to|of|a|that|it|with|for|as|was|on|are|you|this|have|they|we|said|do|will|about|then|would|make|what|know|also|your|can|now|when|where|good|come|get|see|way|who|say)\b/g,t=/\b(le|la|les|de|des|du|et|est|dans|pour|avec|sur|sont|vous|que|qui|une|un|ce|ne|pas|tout|être|avoir|faire|dire|aller|voir|savoir|venir|vouloir|donner|parler)\b/g,n=(a.match(e)||[]).length,r=(a.match(t)||[]).length,o=Math.max(n,r)/Math.max(s,1);return o>.6&&c>.8?{isValid:!1,reason:`${Math.round(100*o)}% ${n>r?"English":"French"} phrase patterns`,recordingType:"phrase"}:{isValid:!0,reason:"Phrase/proverb - likely West African",recordingType:"phrase",avgConfidence:c}}const l=(a.match(/\b(the|and|is|in|to|of|a|that|it|with|for|as|was|on|are|you|this|have|from|they|we|been|their|said|which|do|how|will|about|many|then|some|would|make|like|has|more|what|know|first|also|your|work|only|can|should|now|here|when|where|good|come|could|get|new|see|way|who|did|say|too|any)\b/g)||[]).length,d=(a.match(/\b(le|la|les|de|des|du|et|est|dans|pour|avec|sur|sont|vous|que|qui|une|un|ce|se|ne|pas|tout|être|avoir|faire|dire|aller|voir|savoir|prendre|venir|vouloir|pouvoir|croire|donner|parler|porter|finir|partir|sentir|sortir|conduire)\b/g)||[]).length,m=Math.max(l,d)/Math.max(s,1);return m>.4&&c>.7?{isValid:!1,reason:`${Math.round(100*m)}% ${l>d?"English":"French"} patterns detected`,recordingType:"story"}:{isValid:!0,reason:"Recording validated - likely West African language",recordingType:"unknown",avgConfidence:c}},getTranscript:function(e){return r(e)&&e in n&&n[e].transcript||[]},_instances:n}}(window),function(e,t){"use strict";function n(e,t,n){console&&console[e]}function r(e){return t.getElementById(e)}function o(e){return"string"==typeof e&&/^[A-Za-z0-9_-]{1,100}$/.test(e)}function i(e){return"string"==typeof e?e.replace(/[<>"'&]/g,""):""}function a(t,...n){e.StarmusHooks&&e.StarmusHooks.doAction(t,...n)}function s(e,t,n){if(!o(e))return;const i=r("starmus_recorder_status_"+e)||r("starmus_calibration_status_"+e)||r("starmus_step1_usermsg_"+e);i&&(i.textContent=String(t||""),i.setAttribute("data-status",n||"info"))}const c={db:null,name:"StarmusSubmissions",store:"pendingSubmissions",init:function(){if("indexedDB"in e)try{const e=indexedDB.open(this.name,1),t=this;e.onupgradeneeded=function(e){const n=e.target.result;n.objectStoreNames.contains(t.store)||n.createObjectStore(t.store,{keyPath:"id",autoIncrement:!0})},e.onsuccess=function(e){t.db=e.target.result,n("log"),t.processQueue()},e.onerror=function(e){n("error",0,e&&e.target&&e.target.errorCode)}}catch(e){n("error",0,e.message)}else n("warn")},add:function(e,t,r,i,a){if(this.db&&o(e))try{const n=this.db.transaction([this.store],"readwrite"),o=n.objectStore(this.store).add({formInstanceId:e,fileName:r,when:Date.now(),audioBlob:t,formFields:i||{},meta:a||{}});o.onsuccess=function(){s(e,"You are offline. Saved and will auto-send later.","success")},o.onerror=function(){s(e,"Failed to save offline.","error")}}catch(e){n("error",0,e.message)}else s(e,"Cannot save offline here.","error")},processQueue:function(){if(this.db&&navigator.onLine)try{const e=this.db.transaction([this.store],"readwrite").objectStore(this.store);let t=0;e.openCursor().onsuccess=function(r){const o=r.target.result;if(o){const r=o.value;setTimeout(function(){u(r.audioBlob,r.fileName,r.formFields,r.meta,r.formInstanceId).then(function(){s(r.formInstanceId,"Queued submission sent.","success"),e.delete(o.key)}).catch(function(e){n("error",0,e&&e.message)})},1e3*t),t++,o.continue()}}}catch(e){n("error",0,e.message)}}};function u(t,r,a,c,u){if(!o(u))return Promise.reject(new Error("Invalid instanceId for upload"));const l=e.starmusTus||{};if(!e.tus||!l.endpoint){const n=e.starmusFormData||{};if(n.rest_url&&n.rest_nonce){const e=new FormData;return Object.keys(a||{}).forEach(function(t){e.append(i(t),a[t])}),e.append("audio_file",t,i(r)||"recording"),c&&e.append("metadata",JSON.stringify(c)),fetch(n.rest_url,{method:"POST",headers:{"X-WP-Nonce":n.rest_nonce},body:e}).then(function(e){if(!e.ok)throw new Error("Direct upload failed: "+e.status);return e})}return Promise.reject(new Error("tus missing and no fallback endpoint configured"))}return new Promise(function(e,o){const d=Object.assign({},a||{});d.filename=i(r)||"recording",c&&(d.starmus_meta=JSON.stringify(c));const m=new tus.Upload(t,{endpoint:l.endpoint,chunkSize:l.chunkSize||5242880,retryDelays:l.retryDelays||[0,3e3,5e3,1e4,2e4],headers:l.headers||{},metadata:d,onError:function(e){o(e)},onProgress:function(e,t){const n=Math.round(e/t*100);s(u,"Uploading… "+n+"%","info")},onSuccess:function(){s(u,"Upload complete.","success"),e(m.url)}});m.findPreviousUploads().then(function(e){e.length&&m.resumeFromPreviousUpload(e[0]),m.start()}).catch(function(e){n("warn",0,e.message),m.start()})})}function l(t){if(!o(t))return;const r=e.StarmusAudioRecorder;r&&"function"==typeof r.init?(s(t,"Initializing microphone...","info"),r.init({formInstanceId:t}).then(function(e){e&&"A"===e.tier?s(t,"Recorder ready. Use “Setup Mic” for best results.","info"):s(t,"Recorder ready.","info")}).catch(function(e){n("error",0,e&&e.message),d(t)})):d(t)}function d(e){if(!o(e))return;const t=r("starmus_recorder_container_"+e),n=r("starmus_fallback_container_"+e);t&&(t.style.display="none"),n&&(n.style.display="block"),a("starmus_tier_c_revealed",e)}function m(t,i){if(!o(t))return;const l=e.StarmusAudioRecorder?.getSubmissionData?.(t),d=r("starmus_fallback_input_"+t);let m=null,f="recording.webm";if(l?.blob?(m=l.blob,f=l.fileName):d?.files?.length&&(m=d.files[0],f=d.files[0].name),!m)return void a("starmus_submission_failed",t,"No audio");if((_.duration||0)<1e3)return s(t,"Recording too short. Please record at least 1 second.","error"),void a("starmus_submission_failed",t,"Recording too short");const g=e.StarmusAudioRecorder?.getRecordingQuality?.(t);if("poor"===g?.quality){const e=g.warnings.join(", ");s(t,`Recording quality may be poor: ${e}. Continue anyway?`,"warning"),a("starmus_quality_warning",t,g)}const p=i.querySelector('select[name="recording_type"]'),h=p?.selectedOptions[0]?.text||"unknown",y=e.StarmusAudioRecorder?.validateWestAfricanLanguage?.(t,h);if(y&&!y.isValid)return s(t,`Warning: ${y.reason}. This corpus is for West African languages only.`,"error"),void a("starmus_language_validation_failed",t,y);y?.isValid&&a("starmus_west_african_language_confirmed",t,y);const b=function(e){const t={};return new FormData(e).forEach((e,n)=>t[n]=e),t}(i),_=l?.metadata||{};_.transcript&&_.transcript.length>0&&(b["first-pass-transcription"]=JSON.stringify({transcript:_.transcript,detectedLanguage:_.detectedLanguage,hasTranscription:_.hasTranscription,recordedAt:_.recordedAt,timezone:_.timezone})),b.recording_metadata=JSON.stringify({identifiers:{sessionUUID:_.sessionUUID,submissionUUID:_.submissionUUID,formInstanceId:t},technical:{duration:_.duration,sampleRate:_.sampleRate,codec:_.codec,fileSize:_.fileSize,audioProcessing:_.audioProcessing},device:{userAgent:_.userAgent,platform:_.platform,screenResolution:_.screenResolution,deviceMemory:_.deviceMemory,hardwareConcurrency:_.hardwareConcurrency,connection:_.connection},linguistic:{browserLanguage:_.language,browserLanguages:_.languages,detectedLanguage:_.detectedLanguage,speechRecognitionAvailable:_.speechRecognitionAvailable,westAfricanValidation:y},temporal:{recordedAt:_.recordedAt,recordedAtLocal:_.recordedAtLocal,timezone:_.timezone,submittedAt:(new Date).toISOString()}});const w={instanceId:t,blob:m,fileName:f,formFields:b,metadata:_};if(!function(t,n,...r){return e.StarmusHooks?e.StarmusHooks.applyFilters(t,n,...r):n}("starmus_before_submit",!0,w))return n("log"),void a("starmus_submission_queued",t,w);a("starmus_submission_started",t,w),u(m,f,b,_,t).then(n=>(a("starmus_upload_success",t,n),function(t,n,r){const o=e.starmusFormData||{};if(!o.rest_url||!o.rest_nonce)return Promise.resolve();const i=new FormData;Object.keys(n||{}).forEach(e=>i.append(e,n[e])),i.append("tus_url",t||""),i.append("metadata",JSON.stringify(r)),n["first-pass-transcription"]&&i.append("first-pass-transcription",n["first-pass-transcription"]);return fetch(o.rest_url,{method:"POST",headers:{"X-WP-Nonce":o.rest_nonce},body:i})}(n,b,_))).then(()=>{a("starmus_submission_complete",t,w)}).catch(e=>{n("error"),a("starmus_submission_failed",t,e),c.add(t,m,f,b,_)})}function f(){c.init(),e.addEventListener("online",()=>{a("starmus_network_online"),c.processQueue()}),e.addEventListener("offline",()=>a("starmus_network_offline")),a("starmus_submissions_handler_ready")}"loading"===t.readyState?t.addEventListener("DOMContentLoaded",f):f(),e.StarmusSubmissionsHandler={init:f,handleSubmit:m,initRecorder:l}}(window,document),function(e,t){"use strict";function n(e,t,n){console&&console[e]}function r(e){return t.getElementById(e)}function o(e){return"string"==typeof e&&/^[a-zA-Z0-9_-]{1,100}$/.test(e)}const i=e.StarmusHooks;function a(e,t,n="info"){if(!o(e))return;const i=r(`starmus_recorder_status_${e}`)||r(`starmus_step1_usermsg_${e}`);var a;i&&(i.textContent="string"!=typeof(a=t)?"":a.replace(/[\x00-\x1F\x7F<>"'&]/g," ").substring(0,500),i.setAttribute("data-status",n),i.style.display=t?"block":"none")}function s(e){}function c(t){const i=t.id;if(!o(i)||t.getAttribute("data-starmus-bound"))return;t.setAttribute("data-starmus-bound","1");const s=t.querySelector(`#starmus_continue_btn_${i}`);s?s.addEventListener("click",()=>function(t){if(!o(t))return;r(t);const i=r(`starmus_step1_${t}`),s=r(`starmus_step2_${t}`);let c=!0;for(const e of i.querySelectorAll("[required]"))if(!e.checkValidity()){a(t,"Please complete all required fields.","error"),"function"==typeof e.reportValidity&&e.reportValidity(),c=!1;break}c&&(i.style.display="none",s.style.display="block",a(t,"","info"),e.StarmusSubmissionsHandler.initRecorder(t).then(()=>{}).catch(e=>{n("error"),a(t,"Unable to initialize recorder. Please try again.","error"),i.style.display="block",s.style.display="none"}))}(i)):n("error"),t.addEventListener("submit",n=>{n.preventDefault(),e.StarmusSubmissionsHandler.handleSubmit(i,t)})}let u=!1;function l(){if(u)return;u=!0,n("info"),e.StarmusSubmissionsHandler&&"function"==typeof e.StarmusSubmissionsHandler.init&&e.StarmusSubmissionsHandler.init();t.querySelectorAll("form.starmus-audio-form").forEach(c),i?.doAction("starmus_ui_ready")}i?(i.addAction("starmus_hooks_ready",l),i.hasFired&&i.hasFired("starmus_hooks_ready")&&l()):"loading"===t.readyState?t.addEventListener("DOMContentLoaded",l):l(),e.StarmusUIController={updateRecorderUI:function(e,t){},showUserMessage:a,buildRecorderUI:s}}(window,document);