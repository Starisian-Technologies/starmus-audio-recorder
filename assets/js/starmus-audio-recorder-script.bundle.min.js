var StarmusBundle=function(t,e){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o,i,a={};function u(){if(i)return o;i=1;var t=function(t){return t&&t.Math===Math&&t};return o=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof r&&r)||t("object"==typeof o&&o)||function(){return this}()||Function("return this")()}var s,c,l,f,d,p,h,v,m={};function y(){return c?s:(c=1,s=function(t){try{return!!t()}catch(t){return!0}})}function g(){if(f)return l;f=1;var t=y();return l=!t(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}function b(){if(p)return d;p=1;var t=y();return d=!t(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})}function w(){if(v)return h;v=1;var t=b(),e=Function.prototype.call;return h=t?e.bind(e):function(){return e.apply(e,arguments)},h}var S,k,E,_,O,T,A,x,P,R,U,I,C,j,L,B,M,N,D,F,q,z,H,G,W,V,$,J,Y,K,Q,X,Z,tt,et,rt,nt,ot,it,at,ut,st={};function ct(){if(S)return st;S=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return st.f=r?function(t){var r=e(this,t);return!!r&&r.enumerable}:t,st}function lt(){return E?k:(E=1,k=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}})}function ft(){if(O)return _;O=1;var t=b(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return _=t?n:function(t){return function(){return r.apply(t,arguments)}},_}function dt(){if(A)return T;A=1;var t=ft(),e=t({}.toString),r=t("".slice);return T=function(t){return r(e(t),8,-1)}}function pt(){if(P)return x;P=1;var t=ft(),e=y(),r=dt(),n=Object,o=t("".split);return x=e(function(){return!n("z").propertyIsEnumerable(0)})?function(t){return"String"===r(t)?o(t,""):n(t)}:n}function ht(){return U?R:(U=1,R=function(t){return null==t})}function vt(){if(C)return I;C=1;var t=ht(),e=TypeError;return I=function(r){if(t(r))throw new e("Can't call method on "+r);return r}}function mt(){if(L)return j;L=1;var t=pt(),e=vt();return j=function(r){return t(e(r))}}function yt(){if(M)return B;M=1;var t="object"==typeof document&&document.all;return B=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(t){return"function"==typeof t}}function gt(){if(D)return N;D=1;var t=yt();return N=function(e){return"object"==typeof e?null!==e:t(e)}}function bt(){if(q)return F;q=1;var t=u(),e=yt();return F=function(r,n){return arguments.length<2?(o=t[r],e(o)?o:void 0):t[r]&&t[r][n];var o},F}function wt(){if(H)return z;H=1;var t=ft();return z=t({}.isPrototypeOf)}function St(){if(W)return G;W=1;var t=u().navigator,e=t&&t.userAgent;return G=e?String(e):""}function kt(){if($)return V;$=1;var t,e,r=u(),n=St(),o=r.process,i=r.Deno,a=o&&o.versions||i&&i.version,s=a&&a.v8;return s&&(e=(t=s.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!e&&n&&(!(t=n.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=n.match(/Chrome\/(\d+)/))&&(e=+t[1]),V=e}function Et(){if(Y)return J;Y=1;var t=kt(),e=y(),r=u().String;return J=!!Object.getOwnPropertySymbols&&!e(function(){var e=Symbol("symbol detection");return!r(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&t&&t<41})}function _t(){if(Q)return K;Q=1;var t=Et();return K=t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function Ot(){if(Z)return X;Z=1;var t=bt(),e=yt(),r=wt(),n=_t(),o=Object;return X=n?function(t){return"symbol"==typeof t}:function(n){var i=t("Symbol");return e(i)&&r(i.prototype,o(n))}}function Tt(){if(et)return tt;et=1;var t=String;return tt=function(e){try{return t(e)}catch(t){return"Object"}}}function At(){if(nt)return rt;nt=1;var t=yt(),e=Tt(),r=TypeError;return rt=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")}}function xt(){if(it)return ot;it=1;var t=At(),e=ht();return ot=function(r,n){var o=r[n];return e(o)?void 0:t(o)}}function Pt(){if(ut)return at;ut=1;var t=w(),e=yt(),r=gt(),n=TypeError;return at=function(o,i){var a,u;if("string"===i&&e(a=o.toString)&&!r(u=t(a,o)))return u;if(e(a=o.valueOf)&&!r(u=t(a,o)))return u;if("string"!==i&&e(a=o.toString)&&!r(u=t(a,o)))return u;throw new n("Can't convert object to primitive value")}}var Rt,Ut,It,Ct,jt,Lt,Bt,Mt,Nt,Dt,Ft,qt,zt,Ht,Gt,Wt,Vt,$t,Jt,Yt,Kt,Qt,Xt,Zt,te={exports:{}};function ee(){return Ut?Rt:(Ut=1,Rt=!1)}function re(){if(Ct)return It;Ct=1;var t=u(),e=Object.defineProperty;return It=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch(e){t[r]=n}return n},It}function ne(){if(jt)return te.exports;jt=1;var t=ee(),e=u(),r=re(),n="__core-js_shared__",o=te.exports=e[n]||r(n,{});return(o.versions||(o.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),te.exports}function oe(){if(Bt)return Lt;Bt=1;var t=ne();return Lt=function(e,r){return t[e]||(t[e]=r||{})},Lt}function ie(){if(Nt)return Mt;Nt=1;var t=vt(),e=Object;return Mt=function(r){return e(t(r))}}function ae(){if(Ft)return Dt;Ft=1;var t=ft(),e=ie(),r=t({}.hasOwnProperty);return Dt=Object.hasOwn||function(t,n){return r(e(t),n)},Dt}function ue(){if(zt)return qt;zt=1;var t=ft(),e=0,r=Math.random(),n=t(1.1.toString);return qt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+n(++e+r,36)},qt}function se(){if(Gt)return Ht;Gt=1;var t=u(),e=oe(),r=ae(),n=ue(),o=Et(),i=_t(),a=t.Symbol,s=e("wks"),c=i?a.for||a:a&&a.withoutSetter||n;return Ht=function(t){return r(s,t)||(s[t]=o&&r(a,t)?a[t]:c("Symbol."+t)),s[t]}}function ce(){if(Vt)return Wt;Vt=1;var t=w(),e=gt(),r=Ot(),n=xt(),o=Pt(),i=se(),a=TypeError,u=i("toPrimitive");return Wt=function(i,s){if(!e(i)||r(i))return i;var c,l=n(i,u);if(l){if(void 0===s&&(s="default"),c=t(l,i,s),!e(c)||r(c))return c;throw new a("Can't convert object to primitive value")}return void 0===s&&(s="number"),o(i,s)}}function le(){if(Jt)return $t;Jt=1;var t=ce(),e=Ot();return $t=function(r){var n=t(r,"string");return e(n)?n:n+""},$t}function fe(){if(Kt)return Yt;Kt=1;var t=u(),e=gt(),r=t.document,n=e(r)&&e(r.createElement);return Yt=function(t){return n?r.createElement(t):{}}}function de(){if(Xt)return Qt;Xt=1;var t=g(),e=y(),r=fe();return Qt=!t&&!e(function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})}function pe(){if(Zt)return m;Zt=1;var t=g(),e=w(),r=ct(),n=lt(),o=mt(),i=le(),a=ae(),u=de(),s=Object.getOwnPropertyDescriptor;return m.f=t?s:function(t,c){if(t=o(t),c=i(c),u)try{return s(t,c)}catch(t){}if(a(t,c))return n(!e(r.f,t,c),t[c])},m}var he,ve,me,ye,ge,be,we,Se={};function ke(){if(ve)return he;ve=1;var t=g(),e=y();return he=t&&e(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}function Ee(){if(ye)return me;ye=1;var t=gt(),e=String,r=TypeError;return me=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")}}function _e(){if(ge)return Se;ge=1;var t=g(),e=de(),r=ke(),n=Ee(),o=le(),i=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,s="enumerable",c="configurable",l="writable";return Se.f=t?r?function(t,e,r){if(n(t),e=o(e),n(r),"function"==typeof t&&"prototype"===e&&"value"in r&&l in r&&!r[l]){var i=u(t,e);i&&i[l]&&(t[e]=r.value,r={configurable:c in r?r[c]:i[c],enumerable:s in r?r[s]:i[s],writable:!1})}return a(t,e,r)}:a:function(t,r,u){if(n(t),r=o(r),n(u),e)try{return a(t,r,u)}catch(t){}if("get"in u||"set"in u)throw new i("Accessors not supported");return"value"in u&&(t[r]=u.value),t},Se}function Oe(){if(we)return be;we=1;var t=g(),e=_e(),r=lt();return be=t?function(t,n,o){return e.f(t,n,r(1,o))}:function(t,e,r){return t[e]=r,t},be}var Te,Ae,xe,Pe,Re,Ue,Ie,Ce,je,Le,Be,Me,Ne,De,Fe,qe={exports:{}};function ze(){if(Ae)return Te;Ae=1;var t=g(),e=ae(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,o=e(r,"name"),i=o&&"something"===function(){}.name,a=o&&(!t||t&&n(r,"name").configurable);return Te={EXISTS:o,PROPER:i,CONFIGURABLE:a}}function He(){if(Pe)return xe;Pe=1;var t=ft(),e=yt(),r=ne(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(t){return n(t)}),xe=r.inspectSource}function Ge(){if(Ce)return Ie;Ce=1;var t=oe(),e=ue(),r=t("keys");return Ie=function(t){return r[t]||(r[t]=e(t))},Ie}function We(){return Le?je:(Le=1,je={})}function Ve(){if(Me)return Be;Me=1;var t,e,r,n=function(){if(Ue)return Re;Ue=1;var t=u(),e=yt(),r=t.WeakMap;return Re=e(r)&&/native code/.test(String(r))}(),o=u(),i=gt(),a=Oe(),s=ae(),c=ne(),l=Ge(),f=We(),d="Object already initialized",p=o.TypeError,h=o.WeakMap;if(n||c.state){var v=c.state||(c.state=new h);v.get=v.get,v.has=v.has,v.set=v.set,t=function(t,e){if(v.has(t))throw new p(d);return e.facade=t,v.set(t,e),e},e=function(t){return v.get(t)||{}},r=function(t){return v.has(t)}}else{var m=l("state");f[m]=!0,t=function(t,e){if(s(t,m))throw new p(d);return e.facade=t,a(t,m,e),e},e=function(t){return s(t,m)?t[m]:{}},r=function(t){return s(t,m)}}return Be={set:t,get:e,has:r,enforce:function(n){return r(n)?e(n):t(n,{})},getterFor:function(t){return function(r){var n;if(!i(r)||(n=e(r)).type!==t)throw new p("Incompatible receiver, "+t+" required");return n}}}}function $e(){if(Ne)return qe.exports;Ne=1;var t=ft(),e=y(),r=yt(),n=ae(),o=g(),i=ze().CONFIGURABLE,a=He(),u=Ve(),s=u.enforce,c=u.get,l=String,f=Object.defineProperty,d=t("".slice),p=t("".replace),h=t([].join),v=o&&!e(function(){return 8!==f(function(){},"length",{value:8}).length}),m=String(String).split("String"),b=qe.exports=function(t,e,r){"Symbol("===d(l(e),0,7)&&(e="["+p(l(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!n(t,"name")||i&&t.name!==e)&&(o?f(t,"name",{value:e,configurable:!0}):t.name=e),v&&r&&n(r,"arity")&&t.length!==r.arity&&f(t,"length",{value:r.arity});try{r&&n(r,"constructor")&&r.constructor?o&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var a=s(t);return n(a,"source")||(a.source=h(m,"string"==typeof e?e:"")),t};return Function.prototype.toString=b(function(){return r(this)&&c(this).source||a(this)},"toString"),qe.exports}function Je(){if(Fe)return De;Fe=1;var t=yt(),e=_e(),r=$e(),n=re();return De=function(o,i,a,u){u||(u={});var s=u.enumerable,c=void 0!==u.name?u.name:i;if(t(a)&&r(a,c,u),u.global)s?o[i]=a:n(i,a);else{try{u.unsafe?o[i]&&(s=!0):delete o[i]}catch(t){}s?o[i]=a:e.f(o,i,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return o},De}var Ye,Ke,Qe,Xe,Ze,tr,er,rr,nr,or,ir,ar,ur,sr,cr,lr,fr,dr={};function pr(){if(Xe)return Qe;Xe=1;var t=function(){if(Ke)return Ye;Ke=1;var t=Math.ceil,e=Math.floor;return Ye=Math.trunc||function(r){var n=+r;return(n>0?e:t)(n)}}();return Qe=function(e){var r=+e;return r!=r||0===r?0:t(r)}}function hr(){if(tr)return Ze;tr=1;var t=pr(),e=Math.max,r=Math.min;return Ze=function(n,o){var i=t(n);return i<0?e(i+o,0):r(i,o)}}function vr(){if(rr)return er;rr=1;var t=pr(),e=Math.min;return er=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},er}function mr(){if(or)return nr;or=1;var t=vr();return nr=function(e){return t(e.length)}}function yr(){if(ar)return ir;ar=1;var t=mt(),e=hr(),r=mr(),n=function(n){return function(o,i,a){var u=t(o),s=r(u);if(0===s)return!n&&-1;var c,l=e(a,s);if(n&&i!=i){for(;s>l;)if((c=u[l++])!=c)return!0}else for(;s>l;l++)if((n||l in u)&&u[l]===i)return n||l||0;return!n&&-1}};return ir={includes:n(!0),indexOf:n(!1)}}function gr(){if(sr)return ur;sr=1;var t=ft(),e=ae(),r=mt(),n=yr().indexOf,o=We(),i=t([].push);return ur=function(t,a){var u,s=r(t),c=0,l=[];for(u in s)!e(o,u)&&e(s,u)&&i(l,u);for(;a.length>c;)e(s,u=a[c++])&&(~n(l,u)||i(l,u));return l},ur}function br(){return lr?cr:(lr=1,cr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}function wr(){if(fr)return dr;fr=1;var t=gr(),e=br().concat("length","prototype");return dr.f=Object.getOwnPropertyNames||function(r){return t(r,e)},dr}var Sr,kr,Er,_r,Or,Tr,Ar,xr,Pr,Rr,Ur,Ir,Cr,jr,Lr={};function Br(){return Sr||(Sr=1,Lr.f=Object.getOwnPropertySymbols),Lr}function Mr(){if(Or)return _r;Or=1;var t=ae(),e=function(){if(Er)return kr;Er=1;var t=bt(),e=ft(),r=wr(),n=Br(),o=Ee(),i=e([].concat);return kr=t("Reflect","ownKeys")||function(t){var e=r.f(o(t)),a=n.f;return a?i(e,a(t)):e}}(),r=pe(),n=_e();return _r=function(o,i,a){for(var u=e(i),s=n.f,c=r.f,l=0;l<u.length;l++){var f=u[l];t(o,f)||a&&t(a,f)||s(o,f,c(i,f))}},_r}function Nr(){if(Ar)return Tr;Ar=1;var t=y(),e=yt(),r=/#|\.prototype\./,n=function(r,n){var s=i[o(r)];return s===u||s!==a&&(e(n)?t(n):!!n)},o=n.normalize=function(t){return String(t).replace(r,".").toLowerCase()},i=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return Tr=n}function Dr(){if(Pr)return xr;Pr=1;var t=u(),e=pe().f,r=Oe(),n=Je(),o=re(),i=Mr(),a=Nr();return xr=function(u,s){var c,l,f,d,p,h=u.target,v=u.global,m=u.stat;if(c=v?t:m?t[h]||o(h,{}):t[h]&&t[h].prototype)for(l in s){if(d=s[l],f=u.dontCallGetSet?(p=e(c,l))&&p.value:c[l],!a(v?l:h+(m?".":"#")+l,u.forced)&&void 0!==f){if(typeof d==typeof f)continue;i(d,f)}(u.sham||f&&f.sham)&&r(d,"sham",!0),n(c,l,d,u)}},xr}function Fr(){if(Ur)return Rr;Ur=1;var t=dt(),e=ft();return Rr=function(r){if("Function"===t(r))return e(r)}}function qr(){if(Cr)return Ir;Cr=1;var t=y();return Ir=function(e,r){var n=[][e];return!!n&&t(function(){n.call(null,r||function(){return 1},1)})}}!function(){if(jr)return a;jr=1;var t=Dr(),e=Fr(),r=yr().indexOf,n=qr(),o=e([].indexOf),i=!!o&&1/o([1],1,-0)<0;t({target:"Array",proto:!0,forced:i||!n("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return i?o(this,t,e)||0:r(this,t,e)}})}();var zr,Hr,Gr,Wr,Vr,$r,Jr,Yr,Kr,Qr,Xr,Zr,tn,en,rn,nn,on,an,un,sn,cn,ln,fn,dn,pn,hn,vn,mn,yn,gn,bn,wn,Sn,kn,En,_n={};function On(){if(Hr)return zr;Hr=1;var t=gr(),e=br();return zr=Object.keys||function(r){return t(r,e)}}function Tn(){if(Vr)return Wr;Vr=1;var t=bt();return Wr=t("document","documentElement")}function An(){if(Jr)return $r;Jr=1;var t,e=Ee(),r=function(){if(Gr)return _n;Gr=1;var t=g(),e=ke(),r=_e(),n=Ee(),o=mt(),i=On();return _n.f=t&&!e?Object.defineProperties:function(t,e){n(t);for(var a,u=o(e),s=i(e),c=s.length,l=0;c>l;)r.f(t,a=s[l++],u[a]);return t},_n}(),n=br(),o=We(),i=Tn(),a=fe(),u=Ge(),s="prototype",c="script",l=u("IE_PROTO"),f=function(){},d=function(t){return"<"+c+">"+t+"</"+c+">"},p=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},h=function(){try{t=new ActiveXObject("htmlfile")}catch(t){}var e,r,o;h="undefined"!=typeof document?document.domain&&t?p(t):(r=a("iframe"),o="java"+c+":",r.style.display="none",i.appendChild(r),r.src=String(o),(e=r.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):p(t);for(var u=n.length;u--;)delete h[s][n[u]];return h()};return o[l]=!0,$r=Object.create||function(t,n){var o;return null!==t?(f[s]=e(t),o=new f,f[s]=null,o[l]=t):o=h(),void 0===n?o:r.f(o,n)}}function xn(){if(Kr)return Yr;Kr=1;var t=se(),e=An(),r=_e().f,n=t("unscopables"),o=Array.prototype;return void 0===o[n]&&r(o,n,{configurable:!0,value:e(null)}),Yr=function(t){o[n][t]=!0},Yr}function Pn(){return Xr?Qr:(Xr=1,Qr={})}function Rn(){if(rn)return en;rn=1;var t=ae(),e=yt(),r=ie(),n=Ge(),o=function(){if(tn)return Zr;tn=1;var t=y();return Zr=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})}(),i=n("IE_PROTO"),a=Object,u=a.prototype;return en=o?a.getPrototypeOf:function(n){var o=r(n);if(t(o,i))return o[i];var s=o.constructor;return e(s)&&o instanceof s?s.prototype:o instanceof a?u:null}}function Un(){if(on)return nn;on=1;var t,e,r,n=y(),o=yt(),i=gt(),a=An(),u=Rn(),s=Je(),c=se(),l=ee(),f=c("iterator"),d=!1;return[].keys&&("next"in(r=[].keys())?(e=u(u(r)))!==Object.prototype&&(t=e):d=!0),!i(t)||n(function(){var e={};return t[f].call(e)!==e})?t={}:l&&(t=a(t)),o(t[f])||s(t,f,function(){return this}),nn={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:d}}function In(){if(un)return an;un=1;var t=_e().f,e=ae(),r=se()("toStringTag");return an=function(n,o,i){n&&!i&&(n=n.prototype),n&&!e(n,r)&&t(n,r,{configurable:!0,value:o})}}function Cn(){if(cn)return sn;cn=1;var t=Un().IteratorPrototype,e=An(),r=lt(),n=In(),o=Pn(),i=function(){return this};return sn=function(a,u,s,c){var l=u+" Iterator";return a.prototype=e(t,{next:r(+!c,s)}),n(a,l,!1,!0),o[l]=i,a}}function jn(){if(pn)return dn;pn=1;var t=gt();return dn=function(e){return t(e)||null===e}}function Ln(){if(vn)return hn;vn=1;var t=jn(),e=String,r=TypeError;return hn=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")}}function Bn(){if(yn)return mn;yn=1;var t=function(){if(fn)return ln;fn=1;var t=ft(),e=At();return ln=function(r,n,o){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[o]))}catch(t){}},ln}(),e=gt(),r=vt(),n=Ln();return mn=Object.setPrototypeOf||("__proto__"in{}?function(){var o,i=!1,a={};try{(o=t(Object.prototype,"__proto__","set"))(a,[]),i=a instanceof Array}catch(t){}return function(t,a){return r(t),n(a),e(t)?(i?o(t,a):t.__proto__=a,t):t}}():void 0)}function Mn(){if(bn)return gn;bn=1;var t=Dr(),e=w(),r=ee(),n=ze(),o=yt(),i=Cn(),a=Rn(),u=Bn(),s=In(),c=Oe(),l=Je(),f=se(),d=Pn(),p=Un(),h=n.PROPER,v=n.CONFIGURABLE,m=p.IteratorPrototype,y=p.BUGGY_SAFARI_ITERATORS,g=f("iterator"),b="keys",S="values",k="entries",E=function(){return this};return gn=function(n,f,p,w,_,O,T){i(p,f,w);var A,x,P,R=function(t){if(t===_&&L)return L;if(!y&&t&&t in C)return C[t];switch(t){case b:case S:case k:return function(){return new p(this,t)}}return function(){return new p(this)}},U=f+" Iterator",I=!1,C=n.prototype,j=C[g]||C["@@iterator"]||_&&C[_],L=!y&&j||R(_),B="Array"===f&&C.entries||j;if(B&&(A=a(B.call(new n)))!==Object.prototype&&A.next&&(r||a(A)===m||(u?u(A,m):o(A[g])||l(A,g,E)),s(A,U,!0,!0),r&&(d[U]=E)),h&&_===S&&j&&j.name!==S&&(!r&&v?c(C,"name",S):(I=!0,L=function(){return e(j,this)})),_)if(x={values:R(S),keys:O?L:R(b),entries:R(k)},T)for(P in x)(y||I||!(P in C))&&l(C,P,x[P]);else t({target:f,proto:!0,forced:y||I},x);return r&&!T||C[g]===L||l(C,g,L,{name:_}),d[f]=L,x}}function Nn(){return Sn?wn:(Sn=1,wn=function(t,e){return{value:t,done:e}})}function Dn(){if(En)return kn;En=1;var t=mt(),e=xn(),r=Pn(),n=Ve(),o=_e().f,i=Mn(),a=Nn(),u=ee(),s=g(),c="Array Iterator",l=n.set,f=n.getterFor(c);kn=i(Array,"Array",function(e,r){l(this,{type:c,target:t(e),index:0,kind:r})},function(){var t=f(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,a(void 0,!0);switch(t.kind){case"keys":return a(r,!1);case"values":return a(e[r],!1)}return a([r,e[r]],!1)},"values");var d=r.Arguments=r.Array;if(e("keys"),e("values"),e("entries"),!u&&s&&"values"!==d.name)try{o(d,"name",{value:"values"})}catch(t){}return kn}Dn();var Fn,qn,zn,Hn,Gn,Wn,Vn,$n,Jn,Yn,Kn,Qn,Xn,Zn,to,eo={};function ro(){if(qn)return Fn;qn=1;var t=dt();return Fn=Array.isArray||function(e){return"Array"===t(e)}}function no(){if(Hn)return zn;Hn=1;var t={};return t[se()("toStringTag")]="z",zn="[object z]"===String(t)}function oo(){if(Wn)return Gn;Wn=1;var t=no(),e=yt(),r=dt(),n=se()("toStringTag"),o=Object,i="Arguments"===r(function(){return arguments}());return Gn=t?r:function(t){var a,u,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(u=function(t,e){try{return t[e]}catch(t){}}(a=o(t),n))?u:i?r(a):"Object"===(s=r(a))&&e(a.callee)?"Arguments":s},Gn}function io(){if($n)return Vn;$n=1;var t=ft(),e=y(),r=yt(),n=oo(),o=bt(),i=He(),a=function(){},u=o("Reflect","construct"),s=/^\s*(?:class|function)\b/,c=t(s.exec),l=!s.test(a),f=function(t){if(!r(t))return!1;try{return u(a,[],t),!0}catch(t){return!1}},d=function(t){if(!r(t))return!1;switch(n(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return l||!!c(s,i(t))}catch(t){return!0}};return d.sham=!0,Vn=!u||e(function(){var t;return f(f.call)||!f(Object)||!f(function(){t=!0})||t})?d:f}function ao(){if(Yn)return Jn;Yn=1;var t=g(),e=_e(),r=lt();return Jn=function(n,o,i){t?e.f(n,o,r(0,i)):n[o]=i},Jn}function uo(){if(Qn)return Kn;Qn=1;var t=y(),e=se(),r=kt(),n=e("species");return Kn=function(e){return r>=51||!t(function(){var t=[];return(t.constructor={})[n]=function(){return{foo:1}},1!==t[e](Boolean).foo})}}function so(){if(Zn)return Xn;Zn=1;var t=ft();return Xn=t([].slice)}!function(){if(to)return eo;to=1;var t=Dr(),e=ro(),r=io(),n=gt(),o=hr(),i=mr(),a=mt(),u=ao(),s=se(),c=uo(),l=so(),f=c("slice"),d=s("species"),p=Array,h=Math.max;t({target:"Array",proto:!0,forced:!f},{slice:function(t,s){var c,f,v,m=a(this),y=i(m),g=o(t,y),b=o(void 0===s?y:s,y);if(e(m)&&(c=m.constructor,(r(c)&&(c===p||e(c.prototype))||n(c)&&null===(c=c[d]))&&(c=void 0),c===p||void 0===c))return l(m,g,b);for(f=new(void 0===c?p:c)(h(b-g,0)),v=0;g<b;g++,v++)g in m&&u(f,v,m[g]);return f.length=v,f}})}();var co,lo,fo,po,ho,vo,mo,yo,go,bo,wo,So={};function ko(){if(po)return fo;po=1;var t=TypeError;return fo=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}}function Eo(){if(vo)return ho;vo=1;var t=ro(),e=io(),r=gt(),n=se()("species"),o=Array;return ho=function(i){var a;return t(i)&&(a=i.constructor,(e(a)&&(a===o||t(a.prototype))||r(a)&&null===(a=a[n]))&&(a=void 0)),void 0===a?o:a}}function _o(){if(yo)return mo;yo=1;var t=Eo();return mo=function(e,r){return new(t(e))(0===r?0:r)}}function Oo(){if(bo)return go;bo=1;var t=Tt(),e=TypeError;return go=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))}}!function(){if(wo)return So;wo=1;var t=Dr(),e=ie(),r=hr(),n=pr(),o=mr(),i=function(){if(lo)return co;lo=1;var t=g(),e=ro(),r=TypeError,n=Object.getOwnPropertyDescriptor,o=t&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();return co=o?function(t,o){if(e(t)&&!n(t,"length").writable)throw new r("Cannot set read only .length");return t.length=o}:function(t,e){return t.length=e}}(),a=ko(),u=_o(),s=ao(),c=Oo(),l=uo()("splice"),f=Math.max,d=Math.min;t({target:"Array",proto:!0,forced:!l},{splice:function(t,l){var p,h,v,m,y,g,b=e(this),w=o(b),S=r(t,w),k=arguments.length;for(0===k?p=h=0:1===k?(p=0,h=w-S):(p=k-2,h=d(f(n(l),0),w-S)),a(w+p-h),v=u(b,h),m=0;m<h;m++)(y=S+m)in b&&s(v,m,b[y]);if(v.length=h,p<h){for(m=S;m<w-h;m++)g=m+p,(y=m+h)in b?b[g]=b[y]:c(b,g);for(m=w;m>w-h+p;m--)c(b,m-1)}else if(p>h)for(m=w-h;m>S;m--)g=m+p-1,(y=m+h-1)in b?b[g]=b[y]:c(b,g);for(m=0;m<p;m++)b[m+S]=arguments[m+2];return i(b,w-h+p),v}})}();var To,Ao,xo,Po={};!function(){if(xo)return Po;xo=1;var t=no(),e=Je(),r=function(){if(Ao)return To;Ao=1;var t=no(),e=oo();return To=t?{}.toString:function(){return"[object "+e(this)+"]"}}();t||e(Object.prototype,"toString",r,{unsafe:!0})}();var Ro,Uo,Io,Co,jo,Lo,Bo,Mo,No,Do,Fo,qo,zo,Ho,Go,Wo,Vo,$o,Jo,Yo,Ko,Qo,Xo,Zo,ti,ei,ri,ni,oi,ii,ai,ui,si,ci,li,fi,di,pi,hi={exports:{}},vi={};function mi(){if(Ro)return vi;Ro=1;var t=dt(),e=mt(),r=wr().f,n=so(),o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];return vi.f=function(i){return o&&"Window"===t(i)?function(t){try{return r(t)}catch(t){return n(o)}}(i):r(e(i))},vi}function yi(){if(jo)return Co;jo=1;var t=y(),e=gt(),r=dt(),n=function(){if(Io)return Uo;Io=1;var t=y();return Uo=t(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})}(),o=Object.isExtensible,i=t(function(){});return Co=i||n?function(t){return!!e(t)&&((!n||"ArrayBuffer"!==r(t))&&(!o||o(t)))}:o}function gi(){if(Mo)return hi.exports;Mo=1;var t=Dr(),e=ft(),r=We(),n=gt(),o=ae(),i=_e().f,a=wr(),u=mi(),s=yi(),c=ue(),l=function(){if(Bo)return Lo;Bo=1;var t=y();return Lo=!t(function(){return Object.isExtensible(Object.preventExtensions({}))})}(),f=!1,d=c("meta"),p=0,h=function(t){i(t,d,{value:{objectID:"O"+p++,weakData:{}}})},v=hi.exports={enable:function(){v.enable=function(){},f=!0;var r=a.f,n=e([].splice),o={};o[d]=1,r(o).length&&(a.f=function(t){for(var e=r(t),o=0,i=e.length;o<i;o++)if(e[o]===d){n(e,o,1);break}return e},t({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,d)){if(!s(t))return"F";if(!e)return"E";h(t)}return t[d].objectID},getWeakData:function(t,e){if(!o(t,d)){if(!s(t))return!0;if(!e)return!1;h(t)}return t[d].weakData},onFreeze:function(t){return l&&f&&s(t)&&!o(t,d)&&h(t),t}};return r[d]=!0,hi.exports}function bi(){if(Do)return No;Do=1;var t=Fr(),e=At(),r=b(),n=t(t.bind);return No=function(t,o){return e(t),void 0===o?t:r?n(t,o):function(){return t.apply(o,arguments)}},No}function wi(){if(qo)return Fo;qo=1;var t=se(),e=Pn(),r=t("iterator"),n=Array.prototype;return Fo=function(t){return void 0!==t&&(e.Array===t||n[r]===t)}}function Si(){if(Ho)return zo;Ho=1;var t=oo(),e=xt(),r=ht(),n=Pn(),o=se()("iterator");return zo=function(i){if(!r(i))return e(i,o)||e(i,"@@iterator")||n[t(i)]}}function ki(){if(Wo)return Go;Wo=1;var t=w(),e=At(),r=Ee(),n=Tt(),o=Si(),i=TypeError;return Go=function(a,u){var s=arguments.length<2?o(a):u;if(e(s))return r(t(s,a));throw new i(n(a)+" is not iterable")},Go}function Ei(){if($o)return Vo;$o=1;var t=w(),e=Ee(),r=xt();return Vo=function(n,o,i){var a,u;e(n);try{if(!(a=r(n,"return"))){if("throw"===o)throw i;return i}a=t(a,n)}catch(t){u=!0,a=t}if("throw"===o)throw i;if(u)throw a;return e(a),i}}function _i(){if(Yo)return Jo;Yo=1;var t=bi(),e=w(),r=Ee(),n=Tt(),o=wi(),i=mr(),a=wt(),u=ki(),s=Si(),c=Ei(),l=TypeError,f=function(t,e){this.stopped=t,this.result=e},d=f.prototype;return Jo=function(p,h,v){var m,y,g,b,w,S,k,E=v&&v.that,_=!(!v||!v.AS_ENTRIES),O=!(!v||!v.IS_RECORD),T=!(!v||!v.IS_ITERATOR),A=!(!v||!v.INTERRUPTED),x=t(h,E),P=function(t){return m&&c(m,"normal"),new f(!0,t)},R=function(t){return _?(r(t),A?x(t[0],t[1],P):x(t[0],t[1])):A?x(t,P):x(t)};if(O)m=p.iterator;else if(T)m=p;else{if(!(y=s(p)))throw new l(n(p)+" is not iterable");if(o(y)){for(g=0,b=i(p);b>g;g++)if((w=R(p[g]))&&a(d,w))return w;return new f(!1)}m=u(p,y)}for(S=O?p.next:m.next;!(k=e(S,m)).done;){try{w=R(k.value)}catch(t){c(m,"throw",t)}if("object"==typeof w&&w&&a(d,w))return w}return new f(!1)}}function Oi(){if(Qo)return Ko;Qo=1;var t=wt(),e=TypeError;return Ko=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")}}function Ti(){if(Zo)return Xo;Zo=1;var t=se()("iterator"),e=!1;try{var r=0,n={next:function(){return{done:!!r++}},return:function(){e=!0}};n[t]=function(){return this},Array.from(n,function(){throw 2})}catch(t){}return Xo=function(r,n){try{if(!n&&!e)return!1}catch(t){return!1}var o=!1;try{var i={};i[t]=function(){return{next:function(){return{done:o=!0}}}},r(i)}catch(t){}return o}}function Ai(){if(ei)return ti;ei=1;var t=yt(),e=gt(),r=Bn();return ti=function(n,o,i){var a,u;return r&&t(a=o.constructor)&&a!==i&&e(u=a.prototype)&&u!==i.prototype&&r(n,u),n}}function xi(){if(ni)return ri;ni=1;var t=Dr(),e=u(),r=ft(),n=Nr(),o=Je(),i=gi(),a=_i(),s=Oi(),c=yt(),l=ht(),f=gt(),d=y(),p=Ti(),h=In(),v=Ai();return ri=function(u,m,y){var g=-1!==u.indexOf("Map"),b=-1!==u.indexOf("Weak"),w=g?"set":"add",S=e[u],k=S&&S.prototype,E=S,_={},O=function(t){var e=r(k[t]);o(k,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(b&&!f(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return b&&!f(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(b&&!f(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(n(u,!c(S)||!(b||k.forEach&&!d(function(){(new S).entries().next()}))))E=y.getConstructor(m,u,g,w),i.enable();else if(n(u,!0)){var T=new E,A=T[w](b?{}:-0,1)!==T,x=d(function(){T.has(1)}),P=p(function(t){new S(t)}),R=!b&&d(function(){for(var t=new S,e=5;e--;)t[w](e,e);return!t.has(-0)});P||((E=m(function(t,e){s(t,k);var r=v(new S,t,E);return l(e)||a(e,r[w],{that:r,AS_ENTRIES:g}),r})).prototype=k,k.constructor=E),(x||R)&&(O("delete"),O("has"),g&&O("get")),(R||A)&&O(w),b&&k.clear&&delete k.clear}return _[u]=E,t({global:!0,constructor:!0,forced:E!==S},_),h(E,u),b||y.setStrong(E,u,g),E},ri}function Pi(){if(ii)return oi;ii=1;var t=$e(),e=_e();return oi=function(r,n,o){return o.get&&t(o.get,n,{getter:!0}),o.set&&t(o.set,n,{setter:!0}),e.f(r,n,o)}}function Ri(){if(ui)return ai;ui=1;var t=Je();return ai=function(e,r,n){for(var o in r)t(e,o,r[o],n);return e},ai}function Ui(){if(ci)return si;ci=1;var t=bt(),e=Pi(),r=se(),n=g(),o=r("species");return si=function(r){var i=t(r);n&&i&&!i[o]&&e(i,o,{configurable:!0,get:function(){return this}})}}function Ii(){if(fi)return li;fi=1;var t=An(),e=Pi(),r=Ri(),n=bi(),o=Oi(),i=ht(),a=_i(),u=Mn(),s=Nn(),c=Ui(),l=g(),f=gi().fastKey,d=Ve(),p=d.set,h=d.getterFor;return li={getConstructor:function(u,s,c,d){var v=u(function(e,r){o(e,m),p(e,{type:s,index:t(null),first:null,last:null,size:0}),l||(e.size=0),i(r)||a(r,e[d],{that:e,AS_ENTRIES:c})}),m=v.prototype,y=h(s),g=function(t,e,r){var n,o,i=y(t),a=b(t,e);return a?a.value=r:(i.last=a={index:o=f(e,!0),key:e,value:r,previous:n=i.last,next:null,removed:!1},i.first||(i.first=a),n&&(n.next=a),l?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},b=function(t,e){var r,n=y(t),o=f(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key===e)return r};return r(m,{clear:function(){for(var e=y(this),r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=null),r=r.next;e.first=e.last=null,e.index=t(null),l?e.size=0:this.size=0},delete:function(t){var e=this,r=y(e),n=b(e,t);if(n){var o=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=o),o&&(o.previous=i),r.first===n&&(r.first=o),r.last===n&&(r.last=i),l?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=y(this),o=n(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(o(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!b(this,t)}}),r(m,c?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),l&&e(m,"size",{configurable:!0,get:function(){return y(this).size}}),v},setStrong:function(t,e,r){var n=e+" Iterator",o=h(e),i=h(n);u(t,e,function(t,e){p(this,{type:n,target:t,state:o(t),kind:e,last:null})},function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?s("keys"===e?r.key:"values"===e?r.value:[r.key,r.value],!1):(t.target=null,s(void 0,!0))},r?"entries":"values",!r,!0),c(e)}},li}pi||(pi=1,di||(di=1,xi()("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ii())));var Ci,ji,Li,Bi,Mi,Ni={};function Di(){if(ji)return Ci;ji=1;var t=oo(),e=String;return Ci=function(r){if("Symbol"===t(r))throw new TypeError("Cannot convert a Symbol value to a string");return e(r)}}function Fi(){if(Bi)return Li;Bi=1;var t=ft(),e=pr(),r=Di(),n=vt(),o=t("".charAt),i=t("".charCodeAt),a=t("".slice),u=function(t){return function(u,s){var c,l,f=r(n(u)),d=e(s),p=f.length;return d<0||d>=p?t?"":void 0:(c=i(f,d))<55296||c>56319||d+1===p||(l=i(f,d+1))<56320||l>57343?t?o(f,d):c:t?a(f,d,d+2):l-56320+(c-55296<<10)+65536}};return Li={codeAt:u(!1),charAt:u(!0)}}function qi(){if(Mi)return Ni;Mi=1;var t=Fi().charAt,e=Di(),r=Ve(),n=Mn(),o=Nn(),i="String Iterator",a=r.set,u=r.getterFor(i);return n(String,"String",function(t){a(this,{type:i,string:e(t),index:0})},function(){var e,r=u(this),n=r.string,i=r.index;return i>=n.length?o(void 0,!0):(e=t(n,i),r.index+=e.length,o(e,!1))}),Ni}qi();var zi,Hi,Gi={};Hi||(Hi=1,function(){if(zi)return Gi;zi=1;var t=Dr(),e=u();t({global:!0,forced:e.globalThis!==e},{globalThis:e})}());var Wi,Vi,$i,Ji,Yi,Ki,Qi,Xi,Zi,ta={};function ea(){return Vi?Wi:(Vi=1,Wi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})}function ra(){if(Ji)return $i;Ji=1;var t=fe()("span").classList,e=t&&t.constructor&&t.constructor.prototype;return $i=e===Object.prototype?void 0:e}function na(){if(Ki)return Yi;Ki=1;var t=bi(),e=ft(),r=pt(),n=ie(),o=mr(),i=_o(),a=e([].push),u=function(e){var u=1===e,s=2===e,c=3===e,l=4===e,f=6===e,d=7===e,p=5===e||f;return function(h,v,m,y){for(var g,b,w=n(h),S=r(w),k=o(S),E=t(v,m),_=0,O=y||i,T=u?O(h,k):s||d?O(h,0):void 0;k>_;_++)if((p||_ in S)&&(b=E(g=S[_],_,w),e))if(u)T[_]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return _;case 2:a(T,g)}else switch(e){case 4:return!1;case 7:a(T,g)}return f?-1:c||l?l:T}};return Yi={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}}!function(){if(Zi)return ta;Zi=1;var t=u(),e=ea(),r=ra(),n=function(){if(Xi)return Qi;Xi=1;var t=na().forEach,e=qr()("forEach");return Qi=e?[].forEach:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)},Qi}(),o=Oe(),i=function(t){if(t&&t.forEach!==n)try{o(t,"forEach",n)}catch(e){t.forEach=n}};for(var a in e)e[a]&&i(t[a]&&t[a].prototype);i(r)}();var oa,ia={};!function(){if(oa)return ia;oa=1;var t=u(),e=ea(),r=ra(),n=Dn(),o=Oe(),i=In(),a=se()("iterator"),s=n.values,c=function(t,r){if(t){if(t[a]!==s)try{o(t,a,s)}catch(e){t[a]=s}if(i(t,r,!0),e[r])for(var u in n)if(t[u]!==n[u])try{o(t,u,n[u])}catch(e){t[u]=n[u]}}};for(var l in e)c(t[l]&&t[l].prototype,l);c(r,"DOMTokenList")}(),function(t){var e=!(!t.starmusConfig||!t.starmusConfig.debug);function r(){if(e)try{(console.log||function(){}).apply(console,arguments)}catch(t){}}var n="function"==typeof Set,o={},i={};void 0===t.StarmusHooks&&(t.StarmusHooks={}),t.StarmusHooks.subscribe=function(t,e){var r,i;return o[t]||(o[t]=n?new Set:[]),r=o[t],i=e,n?r.add(i):-1===r.indexOf(i)&&r.push(i),function(){o[t]&&function(t,e){if(n)t.delete(e);else{var r=t.indexOf(e);-1!==r&&t.splice(r,1)}}(o[t],e)}},t.StarmusHooks.dispatch=function(t,e,a){e=e||{};var u=t+"::"+((a=a||{}).instanceId||"");if(i[u])r("Prevented recursive dispatch:",t);else{i[u]=!0;try{var s=o[t];if(!s)return;!function(t,e){if(n)t.forEach(e);else for(var r=t.slice(),o=0;o<r.length;o++)e(r[o])}(s,function(r){try{r(e,a)}catch(e){console.error("Error executing handler for command "+t+":",e)}})}finally{delete i[u]}}},t.StarmusHooks.debugLog=r}("undefined"!=typeof window?window:globalThis);var aa="undefined"!=typeof window?window:globalThis,ua=aa.StarmusHooks&&aa.StarmusHooks.debugLog||function(){},sa=aa.StarmusHooks&&aa.StarmusHooks.dispatch||function(){},ca=aa.StarmusHooks&&aa.StarmusHooks.subscribe||function(){};"undefined"!=typeof module&&module.exports&&(module.exports={debugLog:ua,subscribe:aa.StarmusHooks.subscribe,dispatch:aa.StarmusHooks.dispatch});var la,fa={subscribe:ca,dispatch:sa,unsubscribeInstance:function(t){}},da={};function pa(t){return window.StarmusStore.createStore(t)}function ha(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function va(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ma(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){va(i,n,o,a,u,"next",t)}function u(t){va(i,n,o,a,u,"throw",t)}a(void 0)})}}function ya(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ga(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Aa(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ba(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Pa(t))||e){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function wa(t,e,r){return(e=Aa(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sa(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ka(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Sa(Object(r),!0).forEach(function(e){wa(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sa(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Ea(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var s=n&&n.prototype instanceof u?n:u,c=Object.create(s.prototype);return _a(c,"_invoke",function(r,n,o){var i,u,s,c=0,l=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,r){return i=e,u=0,s=t,d.n=r,a}};function p(r,n){for(u=r,s=n,e=0;!f&&c&&!o&&e<l.length;e++){var o,i=l[e],p=d.p,h=i[2];r>3?(o=h===n)&&(s=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<h&&(o=r<3||i[0]>n||n>h)&&(i[4]=r,i[5]=n,d.n=h,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,l,h){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),u=l,s=h;(e=u<2?t:s)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,s)):d.n=s:d.v=s);try{if(c=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=d.n<0)?s:r.call(n,d))!==a)break}catch(e){i=t,u=1,s=e}finally{c=1}}return{value:e,done:f}}}(r,o,i),!0),c}var a={};function u(){}function s(){}function c(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(_a(e={},n,function(){return this}),e),f=c.prototype=u.prototype=Object.create(l);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_a(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return s.prototype=c,_a(f,"constructor",c),_a(c,"constructor",s),s.displayName="GeneratorFunction",_a(c,o,"GeneratorFunction"),_a(f),_a(f,o,"Generator"),_a(f,n,function(){return this}),_a(f,"toString",function(){return"[object Generator]"}),(Ea=function(){return{w:i,m:d}})()}function _a(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}_a=function(t,e,r,n){function i(e,r){_a(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(i("next",0),i("throw",1),i("return",2))},_a(t,e,r,n)}function Oa(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(typeof t+" is not iterable")}function Ta(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e);else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||Pa(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Aa(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof e?e:e+""}function xa(t){return xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xa(t)}function Pa(t,e){if(t){if("string"==typeof t)return ha(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ha(t,e):void 0}}!function(){if(la)return da;la=1;var t=g(),e=ze().EXISTS,r=ft(),n=Pi(),o=Function.prototype,i=r(o.toString),a=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=r(a.exec);t&&!e&&n(o,"name",{configurable:!0,get:function(){try{return u(a,i(this))[1]}catch(t){return""}}})}(),function(e){var r={instanceId:null,env:{},tier:null,status:"uninitialized",error:null,source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""},calibration:{phase:null,message:"",volumePercent:0,complete:!1,gain:1},recorder:{duration:0,amplitude:0,isPlaying:!1,isPaused:!1},submission:{progress:0,isQueued:!1}};function n(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function o(t,e){var r=n(t);for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r}function i(t){var e=o(r,t||{}),i=[];return{getState:function(){return e},dispatch:function(t){e=function(t,e){if(!e||!e.type)return t;switch(!t.instanceId&&e.payload&&e.payload.instanceId&&(t=o(t,{instanceId:e.payload.instanceId})),e.type){case"starmus/tier-ready":return t.tier?t:o(t,{tier:e.payload&&e.payload.tier?e.payload.tier:t.tier});case"starmus/init":return o(t,o(e.payload||{},{status:"idle",error:null}));case"starmus/ui/step-continue":return o(t,{status:"ready_to_record",error:null});case"starmus/calibration-start":return o(t,{status:"calibrating"});case"starmus/calibration-update":return o(t,{calibration:o(t.calibration,{message:e.message,volumePercent:e.volumePercent})});case"starmus/calibration-complete":return o(t,{status:"ready",calibration:o(t.calibration,o(e.calibration||{},{complete:!0}))});case"starmus/mic-start":return o(t,{status:"recording",error:null,recorder:o(t.recorder,{duration:0,amplitude:0,isPaused:!1})});case"starmus/mic-pause":return o(t,{status:"paused",recorder:o(t.recorder,{isPaused:!0})});case"starmus/mic-resume":return o(t,{status:"recording",recorder:o(t.recorder,{isPaused:!1})});case"starmus/mic-stop":return o(t,{status:"processing"});case"starmus/recorder-tick":return o(t,{recorder:o(t.recorder,{duration:e.duration,amplitude:e.amplitude})});case"starmus/recording-available":return o(t,{status:"ready_to_submit",source:o(t.source,{kind:"blob",blob:e.payload.blob,fileName:e.payload.fileName})});case"starmus/recorder-playback-state":return o(t,{recorder:o(t.recorder,{isPlaying:e.isPlaying})});case"starmus/transcript-update":return o(t,{source:o(t.source,{transcript:e.transcript})});case"starmus/transcript-interim":return o(t,{source:o(t.source,{interimTranscript:e.interim})});case"starmus/env-update":return o(t,{env:o(t.env,e.payload||{}),tier:e.tier||t.tier});case"starmus/file-attached":return o(t,{status:"ready_to_submit",source:{kind:"file",file:e.file,fileName:e.file.name}});case"starmus/submit-start":return o(t,{status:"submitting",error:null});case"starmus/submit-progress":return o(t,{submission:o(t.submission,{progress:e.progress})});case"starmus/submit-complete":return o(t,{status:"complete",submission:{progress:1,isQueued:!1}});case"starmus/submit-queued":return o(t,{status:"complete",submission:{progress:0,isQueued:!0}});case"starmus/error":return o(t,{error:e.error||e.payload});case"starmus/reset":return o(n(r),{instanceId:t.instanceId,env:t.env,tier:t.tier,status:"idle",source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""}});default:return t}}(e,t);for(var a=0;a<i.length;a++)try{i[a](e)}catch(t){console.error(t)}},subscribe:function(t){return-1===i.indexOf(t)&&i.push(t),function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}}e.StarmusStore=e.StarmusStore||{},e.StarmusStore.createStore=i,"undefined"!=typeof module&&module.exports&&(module.exports={createStore:i}),void 0!==t&&(t.createStore=i)}("undefined"!=typeof window?window:globalThis);var Ra,Ua={};!function(){if(Ra)return Ua;Ra=1;var t=Dr(),e=y(),r=ro(),n=gt(),o=ie(),i=mr(),a=ko(),u=ao(),s=_o(),c=uo(),l=se(),f=kt(),d=l("isConcatSpreadable"),p=f>=51||!e(function(){var t=[];return t[d]=!1,t.concat()[0]!==t}),h=function(t){if(!n(t))return!1;var e=t[d];return void 0!==e?!!e:r(t)};t({target:"Array",proto:!0,arity:1,forced:!p||!c("concat")},{concat:function(t){var e,r,n,c,l,f=o(this),d=s(f,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(h(l=-1===e?f:arguments[e]))for(c=i(l),a(p+c),r=0;r<c;r++,p++)r in l&&u(d,p,l[r]);else a(p+1),u(d,p++,l);return d.length=p,d}})}();var Ia,Ca={};!function(){if(Ia)return Ca;Ia=1;var t=Dr(),e=ft(),r=pt(),n=mt(),o=qr(),i=e([].join);t({target:"Array",proto:!0,forced:r!==Object||!o("join",",")},{join:function(t){return i(n(this),void 0===t?",":t)}})}();var ja,La,Ba,Ma,Na,Da,Fa,qa={};function za(){if(La)return ja;La=1;var t=At(),e=ie(),r=pt(),n=mr(),o=TypeError,i="Reduce of empty array with no initial value",a=function(a){return function(u,s,c,l){var f=e(u),d=r(f),p=n(f);if(t(s),0===p&&c<2)throw new o(i);var h=a?p-1:0,v=a?-1:1;if(c<2)for(;;){if(h in d){l=d[h],h+=v;break}if(h+=v,a?h<0:p<=h)throw new o(i)}for(;a?h>=0:p>h;h+=v)h in d&&(l=s(l,d[h],h,f));return l}};return ja={left:a(!1),right:a(!0)}}function Ha(){if(Ma)return Ba;Ma=1;var t=u(),e=St(),r=dt(),n=function(t){return e.slice(0,t.length)===t};return Ba=n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&"string"==typeof Bun.version?"BUN":t.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(t.process)?"NODE":t.window&&t.document?"BROWSER":"REST"}function Ga(){if(Da)return Na;Da=1;var t=Ha();return Na="NODE"===t}!function(){if(Fa)return qa;Fa=1;var t=Dr(),e=za().left,r=qr(),n=kt();t({target:"Array",proto:!0,forced:!Ga()&&n>79&&n<83||!r("reduce")},{reduce:function(t){var r=arguments.length;return e(this,t,r,r>1?arguments[1]:void 0)}})}();var Wa,Va,$a,Ja={};!function(){if($a)return Ja;$a=1;var t=Dr(),e=function(){if(Va)return Wa;Va=1;var t=g(),e=y(),r=ft(),n=Rn(),o=On(),i=mt(),a=r(ct().f),u=r([].push),s=t&&e(function(){var t=Object.create(null);return t[2]=2,!a(t,2)}),c=function(e){return function(r){for(var c,l=i(r),f=o(l),d=s&&null===n(l),p=f.length,h=0,v=[];p>h;)c=f[h++],t&&!(d?c in l:a(l,c))||u(v,e?[c,l[c]]:l[c]);return v}};return Wa={entries:c(!0),values:c(!1)}}().entries;t({target:"Object",stat:!0},{entries:function(t){return e(t)}})}();var Ya,Ka={};!function(){if(Ya)return Ka;Ya=1;var t=Dr(),e=ie(),r=On();t({target:"Object",stat:!0,forced:y()(function(){r(1)})},{keys:function(t){return r(e(t))}})}();var Qa,Xa,Za,tu,eu,ru,nu,ou,iu,au,uu,su,cu,lu,fu,du,pu,hu,vu,mu,yu,gu,bu,wu,Su,ku,Eu,_u,Ou,Tu,Au,xu,Pu={};function Ru(){if(Xa)return Qa;Xa=1;var t=u();return Qa=t}function Uu(){if(tu)return Za;tu=1;var t=io(),e=Tt(),r=TypeError;return Za=function(n){if(t(n))return n;throw new r(e(n)+" is not a constructor")}}function Iu(){if(ru)return eu;ru=1;var t=Ee(),e=Uu(),r=ht(),n=se()("species");return eu=function(o,i){var a,u=t(o).constructor;return void 0===u||r(a=t(u)[n])?i:e(a)}}function Cu(){if(ou)return nu;ou=1;var t=b(),e=Function.prototype,r=e.apply,n=e.call;return nu="object"==typeof Reflect&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),nu}function ju(){if(au)return iu;au=1;var t=TypeError;return iu=function(e,r){if(e<r)throw new t("Not enough arguments");return e}}function Lu(){if(su)return uu;su=1;var t=St();return uu=/(?:ipad|iphone|ipod).*applewebkit/i.test(t)}function Bu(){if(lu)return cu;lu=1;var t,e,r,n,o=u(),i=Cu(),a=bi(),s=yt(),c=ae(),l=y(),f=Tn(),d=so(),p=fe(),h=ju(),v=Lu(),m=Ga(),g=o.setImmediate,b=o.clearImmediate,w=o.process,S=o.Dispatch,k=o.Function,E=o.MessageChannel,_=o.String,O=0,T={},A="onreadystatechange";l(function(){t=o.location});var x=function(t){if(c(T,t)){var e=T[t];delete T[t],e()}},P=function(t){return function(){x(t)}},R=function(t){x(t.data)},U=function(e){o.postMessage(_(e),t.protocol+"//"+t.host)};return g&&b||(g=function(t){h(arguments.length,1);var r=s(t)?t:k(t),n=d(arguments,1);return T[++O]=function(){i(r,void 0,n)},e(O),O},b=function(t){delete T[t]},m?e=function(t){w.nextTick(P(t))}:S&&S.now?e=function(t){S.now(P(t))}:E&&!v?(n=(r=new E).port2,r.port1.onmessage=R,e=a(n.postMessage,n)):o.addEventListener&&s(o.postMessage)&&!o.importScripts&&t&&"file:"!==t.protocol&&!l(U)?(e=U,o.addEventListener("message",R,!1)):e=A in p("script")?function(t){f.appendChild(p("script"))[A]=function(){f.removeChild(this),x(t)}}:function(t){setTimeout(P(t),0)}),cu={set:g,clear:b}}function Mu(){if(du)return fu;du=1;var t=u(),e=g(),r=Object.getOwnPropertyDescriptor;return fu=function(n){if(!e)return t[n];var o=r(t,n);return o&&o.value}}function Nu(){if(hu)return pu;hu=1;var t=function(){this.head=null,this.tail=null};return t.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},pu=t}function Du(){if(wu)return bu;wu=1;var t,e,r,n,o,i=u(),a=Mu(),s=bi(),c=Bu().set,l=Nu(),f=Lu(),d=function(){if(mu)return vu;mu=1;var t=St();return vu=/ipad|iphone|ipod/i.test(t)&&"undefined"!=typeof Pebble}(),p=function(){if(gu)return yu;gu=1;var t=St();return yu=/web0s(?!.*chrome)/i.test(t)}(),h=Ga(),v=i.MutationObserver||i.WebKitMutationObserver,m=i.document,y=i.process,g=i.Promise,b=a("queueMicrotask");if(!b){var w=new l,S=function(){var e,r;for(h&&(e=y.domain)&&e.exit();r=w.get();)try{r()}catch(e){throw w.head&&t(),e}e&&e.enter()};f||h||p||!v||!m?!d&&g&&g.resolve?((n=g.resolve(void 0)).constructor=g,o=s(n.then,n),t=function(){o(S)}):h?t=function(){y.nextTick(S)}:(c=s(c,i),t=function(){c(S)}):(e=!0,r=m.createTextNode(""),new v(S).observe(r,{characterData:!0}),t=function(){r.data=e=!e}),b=function(e){w.head||t(),w.add(e)}}return bu=b}function Fu(){return ku||(ku=1,Su=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}),Su}function qu(){return _u?Eu:(_u=1,Eu=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}})}function zu(){if(Tu)return Ou;Tu=1;var t=u();return Ou=t.Promise}function Hu(){if(xu)return Au;xu=1;var t=u(),e=zu(),r=yt(),n=Nr(),o=He(),i=se(),a=Ha(),s=ee(),c=kt(),l=e&&e.prototype,f=i("species"),d=!1,p=r(t.PromiseRejectionEvent),h=n("Promise",function(){var t=o(e),r=t!==String(e);if(!r&&66===c)return!0;if(s&&(!l.catch||!l.finally))return!0;if(!c||c<51||!/native code/.test(t)){var n=new e(function(t){t(1)}),i=function(t){t(function(){},function(){})};if((n.constructor={})[f]=i,!(d=n.then(function(){})instanceof i))return!0}return!(r||"BROWSER"!==a&&"DENO"!==a||p)});return Au={CONSTRUCTOR:h,REJECTION_EVENT:p,SUBCLASSING:d}}var Gu,Wu,Vu={};function $u(){if(Gu)return Vu;Gu=1;var t=At(),e=TypeError,r=function(r){var n,o;this.promise=new r(function(t,r){if(void 0!==n||void 0!==o)throw new e("Bad Promise constructor");n=t,o=r}),this.resolve=t(n),this.reject=t(o)};return Vu.f=function(t){return new r(t)},Vu}var Ju,Yu,Ku,Qu={};function Xu(){if(Yu)return Ju;Yu=1;var t=zu(),e=Ti(),r=Hu().CONSTRUCTOR;return Ju=r||!e(function(e){t.all(e).then(void 0,function(){})})}var Zu,ts={};var es,rs={};var ns,os={};var is,as,us,ss,cs={};function ls(){if(as)return is;as=1;var t=Ee(),e=gt(),r=$u();return is=function(n,o){if(t(n),e(o)&&o.constructor===n)return o;var i=r.f(n);return(0,i.resolve)(o),i.promise}}ss||(ss=1,function(){if(Wu)return Pu;Wu=1;var t,e,r,n,o=Dr(),i=ee(),a=Ga(),s=u(),c=Ru(),l=w(),f=Je(),d=Bn(),p=In(),h=Ui(),v=At(),m=yt(),y=gt(),g=Oi(),b=Iu(),S=Bu().set,k=Du(),E=Fu(),_=qu(),O=Nu(),T=Ve(),A=zu(),x=Hu(),P=$u(),R="Promise",U=x.CONSTRUCTOR,I=x.REJECTION_EVENT,C=x.SUBCLASSING,j=T.getterFor(R),L=T.set,B=A&&A.prototype,M=A,N=B,D=s.TypeError,F=s.document,q=s.process,z=P.f,H=z,G=!!(F&&F.createEvent&&s.dispatchEvent),W="unhandledrejection",V=function(t){var e;return!(!y(t)||!m(e=t.then))&&e},$=function(t,e){var r,n,o,i=e.value,a=1===e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&X(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(new D("Promise-chain cycle")):(n=V(r))?l(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},J=function(t,e){t.notified||(t.notified=!0,k(function(){for(var r,n=t.reactions;r=n.get();)$(r,t);t.notified=!1,e&&!t.rejection&&K(t)}))},Y=function(t,e,r){var n,o;G?((n=F.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),s.dispatchEvent(n)):n={promise:e,reason:r},!I&&(o=s["on"+t])?o(n):t===W&&E("Unhandled promise rejection",r)},K=function(t){l(S,s,function(){var e,r=t.facade,n=t.value;if(Q(t)&&(e=_(function(){a?q.emit("unhandledRejection",n,r):Y(W,r,n)}),t.rejection=a||Q(t)?2:1,e.error))throw e.value})},Q=function(t){return 1!==t.rejection&&!t.parent},X=function(t){l(S,s,function(){var e=t.facade;a?q.emit("rejectionHandled",e):Y("rejectionhandled",e,t.value)})},Z=function(t,e,r){return function(n){t(e,n,r)}},tt=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,J(t,!0))},et=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw new D("Promise can't be resolved itself");var n=V(e);n?k(function(){var r={done:!1};try{l(n,e,Z(et,r,t),Z(tt,r,t))}catch(e){tt(r,e,t)}}):(t.value=e,t.state=1,J(t,!1))}catch(e){tt({done:!1},e,t)}}};if(U&&(N=(M=function(e){g(this,N),v(e),l(t,this);var r=j(this);try{e(Z(et,r),Z(tt,r))}catch(t){tt(r,t)}}).prototype,(t=function(t){L(this,{type:R,done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:null})}).prototype=f(N,"then",function(t,e){var r=j(this),n=z(b(this,M));return r.parent=!0,n.ok=!m(t)||t,n.fail=m(e)&&e,n.domain=a?q.domain:void 0,0===r.state?r.reactions.add(n):k(function(){$(n,r)}),n.promise}),e=function(){var e=new t,r=j(e);this.promise=e,this.resolve=Z(et,r),this.reject=Z(tt,r)},P.f=z=function(t){return t===M||t===r?new e(t):H(t)},!i&&m(A)&&B!==Object.prototype)){n=B.then,C||f(B,"then",function(t,e){var r=this;return new M(function(t,e){l(n,r,t,e)}).then(t,e)},{unsafe:!0});try{delete B.constructor}catch(t){}d&&d(B,N)}o({global:!0,constructor:!0,wrap:!0,forced:U},{Promise:M}),r=c.Promise,p(M,R,!1,!0),h(R)}(),function(){if(Ku)return Qu;Ku=1;var t=Dr(),e=w(),r=At(),n=$u(),o=qu(),i=_i();t({target:"Promise",stat:!0,forced:Xu()},{all:function(t){var a=this,u=n.f(a),s=u.resolve,c=u.reject,l=o(function(){var n=r(a.resolve),o=[],u=0,l=1;i(t,function(t){var r=u++,i=!1;l++,e(n,a,t).then(function(t){i||(i=!0,o[r]=t,--l||s(o))},c)}),--l||s(o)});return l.error&&c(l.value),u.promise}})}(),function(){if(Zu)return ts;Zu=1;var t=Dr(),e=ee(),r=Hu().CONSTRUCTOR,n=zu(),o=bt(),i=yt(),a=Je(),u=n&&n.prototype;if(t({target:"Promise",proto:!0,forced:r,real:!0},{catch:function(t){return this.then(void 0,t)}}),!e&&i(n)){var s=o("Promise").prototype.catch;u.catch!==s&&a(u,"catch",s,{unsafe:!0})}}(),function(){if(es)return rs;es=1;var t=Dr(),e=w(),r=At(),n=$u(),o=qu(),i=_i();t({target:"Promise",stat:!0,forced:Xu()},{race:function(t){var a=this,u=n.f(a),s=u.reject,c=o(function(){var n=r(a.resolve);i(t,function(t){e(n,a,t).then(u.resolve,s)})});return c.error&&s(c.value),u.promise}})}(),function(){if(ns)return os;ns=1;var t=Dr(),e=$u();t({target:"Promise",stat:!0,forced:Hu().CONSTRUCTOR},{reject:function(t){var r=e.f(this);return(0,r.reject)(t),r.promise}})}(),function(){if(us)return cs;us=1;var t=Dr(),e=bt(),r=ee(),n=zu(),o=Hu().CONSTRUCTOR,i=ls(),a=e("Promise"),u=r&&!o;t({target:"Promise",stat:!0,forced:r||o},{resolve:function(t){return i(u&&this===a?n:this,t)}})}());var fs,ds={};!function(){if(fs)return ds;fs=1;var t=Dr(),e=ee(),r=zu(),n=y(),o=bt(),i=yt(),a=Iu(),u=ls(),s=Je(),c=r&&r.prototype;if(t({target:"Promise",proto:!0,real:!0,forced:!!r&&n(function(){c.finally.call({then:function(){}},function(){})})},{finally:function(t){var e=a(this,o("Promise")),r=i(t);return this.then(r?function(r){return u(e,t()).then(function(){return r})}:t,r?function(r){return u(e,t()).then(function(){throw r})}:t)}}),!e&&i(r)){var l=o("Promise").prototype.finally;c.finally!==l&&s(c,"finally",l,{unsafe:!0})}}();var ps,hs,vs,ms,ys,gs,bs,ws,Ss,ks,Es,_s={};function Os(){if(hs)return ps;hs=1;var t=Ee();return ps=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r}}function Ts(){if(ks)return Ss;ks=1;var t,e,r=w(),n=ft(),o=Di(),i=Os(),a=function(){if(ms)return vs;ms=1;var t=y(),e=u().RegExp,r=t(function(){var t=e("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),n=r||t(function(){return!e("a","y").sticky}),o=r||t(function(){var t=e("^r","gy");return t.lastIndex=2,null!==t.exec("str")});return vs={BROKEN_CARET:o,MISSED_STICKY:n,UNSUPPORTED_Y:r}}(),s=oe(),c=An(),l=Ve().get,f=function(){if(gs)return ys;gs=1;var t=y(),e=u().RegExp;return ys=t(function(){var t=e(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})}(),d=function(){if(ws)return bs;ws=1;var t=y(),e=u().RegExp;return bs=t(function(){var t=e("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})}(),p=s("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,v=h,m=n("".charAt),g=n("".indexOf),b=n("".replace),S=n("".slice),k=(e=/b*/g,r(h,t=/a/,"a"),r(h,e,"a"),0!==t.lastIndex||0!==e.lastIndex),E=a.BROKEN_CARET,_=void 0!==/()??/.exec("")[1];return(k||_||E||f||d)&&(v=function(t){var e,n,a,u,s,f,d,y=this,w=l(y),O=o(t),T=w.raw;if(T)return T.lastIndex=y.lastIndex,e=r(v,T,O),y.lastIndex=T.lastIndex,e;var A=w.groups,x=E&&y.sticky,P=r(i,y),R=y.source,U=0,I=O;if(x&&(P=b(P,"y",""),-1===g(P,"g")&&(P+="g"),I=S(O,y.lastIndex),y.lastIndex>0&&(!y.multiline||y.multiline&&"\n"!==m(O,y.lastIndex-1))&&(R="(?: "+R+")",I=" "+I,U++),n=new RegExp("^(?:"+R+")",P)),_&&(n=new RegExp("^"+R+"$(?!\\s)",P)),k&&(a=y.lastIndex),u=r(h,x?n:y,I),x?u?(u.input=S(u.input,U),u[0]=S(u[0],U),u.index=y.lastIndex,y.lastIndex+=u[0].length):y.lastIndex=0:k&&u&&(y.lastIndex=y.global?u.index+u[0].length:a),_&&u&&u.length>1&&r(p,u[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(u[s]=void 0)}),u&&A)for(u.groups=f=c(null),s=0;s<A.length;s++)f[(d=A[s])[0]]=u[d[1]];return u}),Ss=v}function As(){if(Es)return _s;Es=1;var t=Dr(),e=Ts();return t({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e}),_s}As();var xs,Ps,Rs,Us,Is,Cs,js,Ls,Bs,Ms,Ns,Ds,Fs,qs={};function zs(){if(Us)return Rs;Us=1;var t=Fi().charAt;return Rs=function(e,r,n){return r+(n?t(e,r).length:1)}}function Hs(){if(Cs)return Is;Cs=1;var t=ft(),e=ie(),r=Math.floor,n=t("".charAt),o=t("".replace),i=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return Is=function(t,s,c,l,f,d){var p=c+t.length,h=l.length,v=u;return void 0!==f&&(f=e(f),v=a),o(d,v,function(e,o){var a;switch(n(o,0)){case"$":return"$";case"&":return t;case"`":return i(s,0,c);case"'":return i(s,p);case"<":a=f[i(o,1,-1)];break;default:var u=+o;if(0===u)return e;if(u>h){var d=r(u/10);return 0===d?e:d<=h?void 0===l[d-1]?n(o,1):l[d-1]+n(o,1):e}a=l[u-1]}return void 0===a?"":a})}}function Gs(){if(Ms)return Bs;Ms=1;var t=w(),e=ae(),r=wt(),n=function(){if(Ls)return js;Ls=1;var t=u(),e=y(),r=t.RegExp,n=!e(function(){var t=!0;try{r(".","d")}catch(e){t=!1}var e={},n="",o=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var u in t&&(a.hasIndices="d"),a)i(u,a[u]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(e)!==o||n!==o});return js={correct:n}}(),o=Os(),i=RegExp.prototype;return Bs=n.correct?function(t){return t.flags}:function(a){return n.correct||!r(i,a)||e(a,"flags")?a.flags:t(o,a)}}!function(){if(Fs)return qs;Fs=1;var t=Cu(),e=w(),r=ft(),n=function(){if(Ps)return xs;Ps=1,As();var t=w(),e=Je(),r=Ts(),n=y(),o=se(),i=Oe(),a=o("species"),u=RegExp.prototype;return xs=function(s,c,l,f){var d=o(s),p=!n(function(){var t={};return t[d]=function(){return 7},7!==""[s](t)}),h=p&&!n(function(){var t=!1,e=/a/;if("split"===s){var r={};r[a]=function(){return e},(e={constructor:r,flags:""})[d]=/./[d]}return e.exec=function(){return t=!0,null},e[d](""),!t});if(!p||!h||l){var v=/./[d],m=c(d,""[s],function(e,n,o,i,a){var s=n.exec;return s===r||s===u.exec?p&&!a?{done:!0,value:t(v,n,o,i)}:{done:!0,value:t(e,o,n,i)}:{done:!1}});e(String.prototype,s,m[0]),e(u,d,m[1])}f&&i(u[d],"sham",!0)}}(),o=y(),i=Ee(),a=yt(),u=gt(),s=pr(),c=vr(),l=Di(),f=vt(),d=zs(),p=xt(),h=Hs(),v=Gs(),m=function(){if(Ds)return Ns;Ds=1;var t=w(),e=Ee(),r=yt(),n=dt(),o=Ts(),i=TypeError;return Ns=function(a,u){var s=a.exec;if(r(s)){var c=t(s,a,u);return null!==c&&e(c),c}if("RegExp"===n(a))return t(o,a,u);throw new i("RegExp#exec called on incompatible receiver")}}(),g=se()("replace"),b=Math.max,S=Math.min,k=r([].concat),E=r([].push),_=r("".indexOf),O=r("".slice),T=function(t){return void 0===t?t:String(t)},A="$0"==="a".replace(/./,"$0"),x=!!/./[g]&&""===/./[g]("a","$0");n("replace",function(r,n,o){var y=x?"$":"$0";return[function(t,r){var o=f(this),i=u(t)?p(t,g):void 0;return i?e(i,t,o,r):e(n,l(o),t,r)},function(e,r){var u=i(this),f=l(e);if("string"==typeof r&&-1===_(r,y)&&-1===_(r,"$<")){var p=o(n,u,f,r);if(p.done)return p.value}var g=a(r);g||(r=l(r));var w,A=l(v(u)),x=-1!==_(A,"g");x&&(w=-1!==_(A,"u"),u.lastIndex=0);for(var P,R=[];null!==(P=m(u,f))&&(E(R,P),x);){""===l(P[0])&&(u.lastIndex=d(f,c(u.lastIndex),w))}for(var U="",I=0,C=0;C<R.length;C++){for(var j,L=l((P=R[C])[0]),B=b(S(s(P.index),f.length),0),M=[],N=1;N<P.length;N++)E(M,T(P[N]));var D=P.groups;if(g){var F=k([L],M,B,f);void 0!==D&&E(F,D),j=l(t(r,void 0,F))}else j=h(L,f,B,M,D,r);B>=I&&(U+=O(f,I,B)+j,I=B+L.length)}return U+O(f,I)}]},!!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!A||x)}();var Ws={chunkSize:1048576,retryDelays:[0,3e3,5e3,1e4,2e4,6e4],maxChunkRetries:3};function Vs(){return window.starmusTus||window.starmusConfig||{}}function $s(t){var e=("string"==typeof t?t:String(t)).replace(/[\r\n\t]/g," ");return e.length>500?e.slice(0,497)+"...":e}function Js(t){return t&&"object"===xa(t)?t:{}}function Ys(t,e){return Ks.apply(this,arguments)}function Ks(){return Ks=ma(Ea().m(function t(e,r){var n,o,i,a,u,s,c,l=arguments;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(n=l.length>2&&void 0!==l[2]?l[2]:{},o=l.length>3&&void 0!==l[3]?l[3]:{},i=l.length>4&&void 0!==l[4]?l[4]:"",a=l.length>5?l[5]:void 0,window.tus&&window.tus.Upload){t.n=1;break}throw ua("[TUS] No tus library â failing over"),new Error("TUS_NOT_AVAILABLE");case 1:if(u=Vs(),s=u.endpoint||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.tusUpload){t.n=2;break}throw new Error("TUS_ENDPOINT_NOT_CONFIGURED");case 2:if(c=ka({filename:$s(r),filetype:e.type||"audio/webm"},Object.entries(Js(n)).reduce(function(t,e){var r=Ta(e,2),n=r[0],o=r[1];return t[n]=$s(o),t},{})),o)try{c.starmus_meta=$s(JSON.stringify(o))}catch(t){ua("[TUS] Metadata sanitization failed",t)}return t.a(2,new Promise(function(t,r){var n,o={endpoint:s,chunkSize:u.chunkSize||Ws.chunkSize,retryDelays:u.retryDelays||Ws.retryDelays,metadata:c,fingerprint:function(t){return["starmus",i,t.size,t.lastModified||""].join("-")},onError:function(t){ua("[TUS] Upload error",t),r(t)},onProgress:function(t,e){"function"==typeof a&&a(t,e)},onSuccess:function(){return ma(Ea().m(function r(){var i,a,s;return Ea().w(function(r){for(;;)switch(r.p=r.n){case 0:if(ua("[TUS] Upload success",n.url),!u.removeFingerprintOnSuccess||null===(i=window.tus)||void 0===i||null===(i=i.defaultOptions)||void 0===i||!i.removeFingerprint){r.n=5;break}return r.p=1,r.n=2,window.tus.defaultOptions.fingerprint(e,o);case 2:return a=r.v,r.n=3,window.tus.defaultOptions.removeFingerprint(a);case 3:r.n=5;break;case 4:r.p=4,s=r.v,ua("[TUS] Failed to remove fingerprint",s);case 5:t(n.url);case 6:return r.a(2)}},r,null,[[1,4]])}))()}};(n=new window.tus.Upload(e,o)).findPreviousUploads().then(function(t){t&&t.length>0&&(ua("[TUS] Resuming from previous upload",t[0].uploadUrl),n.resumeFromPreviousUpload(t[0]))}).finally(function(){n.start()})}))}},t)})),Ks.apply(this,arguments)}function Qs(t,e){return Xs.apply(this,arguments)}function Xs(){return Xs=ma(Ea().m(function t(e,r){var n,o,i,a,u,s,c,l,f,d,p,h,v,m,y,g,b,w,S=arguments;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(w=function(){return w=ma(Ea().m(function t(r,n,o,i,a,u,s,c,l,f){return Ea().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,a){var p=new FormData;p.append("audio_chunk",n,"".concat(o,".part").concat(r)),p.append("chunk_index",r),p.append("total_chunks",d),u?p.append("upload_id",u):p.append("create_upload_id","1"),Object.entries(s).forEach(function(t){var e=Ta(t,2),r=e[0],n=e[1];return p.append(r,n)}),i&&p.append("_starmus_meta",JSON.stringify(i));var h=new XMLHttpRequest;h.open("POST",c,!0),h.setRequestHeader("X-WP-Nonce",l),h.upload&&"function"==typeof f&&(h.upload.onprogress=function(t){t.lengthComputable&&f(start+t.loaded,e.size)}),h.onload=function(){if(h.status>=200&&h.status<300)try{var e=JSON.parse(h.responseText);!u&&e.upload_id&&(window.lastUploadId=e.upload_id),t(e)}catch(t){a(new Error("Invalid JSON chunk response"))}else a(new Error("Chunk ".concat(r," failed: ").concat(h.status)))},h.onerror=function(){return a(new Error("Network error during chunk upload"))},h.send(p)}))},t)})),w.apply(this,arguments)},b=function(t,e,r,n,o,i,a,u,s,c){return w.apply(this,arguments)},n=S.length>2&&void 0!==S[2]?S[2]:{},o=S.length>3&&void 0!==S[3]?S[3]:{},i=S.length>4&&void 0!==S[4]?S[4]:"",a=S.length>5?S[5]:void 0,u=Vs(),s=u.chunkedUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.chunkedUpload,c=u.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",s){t.n=1;break}throw new Error("CHUNKED_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:if(c){t.n=2;break}throw new Error("CHUNKED_UPLOAD_NONCE_MISSING");case 2:l=Js(n),f=u.chunkSize||Ws.chunkSize,d=Math.ceil(e.size/f),p="starmus_chunked_".concat(i,"_").concat(r,"_").concat(e.size),h=localStorage.getItem(p)||null,v=Ea().m(function t(){var n,d,v,y,g,w;return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:n=0,d=!1,v=m*f,y=Math.min(v+f,e.size),g=e.slice(v,y);case 1:if(d||!(n<(u.maxChunkRetries||Ws.maxChunkRetries))){t.n=7;break}return t.p=2,t.n=3,b(m,g,r,o,i,h,l,s,c,a);case 3:d=!0,t.n=6;break;case 4:if(t.p=4,w=t.v,!(++n>=(u.maxChunkRetries||Ws.maxChunkRetries))){t.n=5;break}throw w;case 5:return t.n=6,new Promise(function(t){return setTimeout(t,300*n*n)});case 6:t.n=1;break;case 7:!h&&0===m&&window.lastUploadId&&(h=window.lastUploadId,localStorage.setItem(p,h));case 8:return t.a(2)}},t,null,[[2,4]])}),m=0;case 3:if(!(m<d)){t.n=5;break}return t.d(Oa(v()),4);case 4:m++,t.n=3;break;case 5:return(y=new FormData).append("upload_id",h),y.append("finalize","1"),(g=new XMLHttpRequest).open("POST",s,!0),g.setRequestHeader("X-WP-Nonce",c),t.a(2,new Promise(function(t,e){g.onload=function(){if(g.status>=200&&g.status<300)try{var r=JSON.parse(g.responseText);localStorage.removeItem(p),t(r)}catch(t){e(new Error("Invalid JSON on finalize"))}else e(new Error("Finalize failed: ".concat(g.status)))},g.onerror=function(){return e(new Error("Network error on finalize"))},g.send(y)}))}},t)})),Xs.apply(this,arguments)}function Zs(t,e){return tc.apply(this,arguments)}function tc(){return tc=ma(Ea().m(function t(e,r){var n,o,i,a,u,s,c,l=arguments;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(n=l.length>2&&void 0!==l[2]?l[2]:{},o=l.length>3&&void 0!==l[3]?l[3]:{},i=l.length>5?l[5]:void 0,a=Vs(),u=a.directUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.directUpload,s=a.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",u){t.n=1;break}throw new Error("DIRECT_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:return c=Js(n),t.a(2,new Promise(function(t,n){var a=new FormData;Object.entries(c).forEach(function(t){var e=Ta(t,2),r=e[0],n=e[1];return a.append(r,n)}),a.append("audio_file",e,r),null!=o&&o.transcript&&a.append("_starmus_transcript",o.transcript),null!=o&&o.calibration&&a.append("_starmus_calibration",JSON.stringify(o.calibration)),null!=o&&o.env&&a.append("_starmus_env",JSON.stringify(o.env));var l=new XMLHttpRequest;l.open("POST",u,!0),s&&l.setRequestHeader("X-WP-Nonce",s),l.upload&&"function"==typeof i&&(l.upload.onprogress=function(t){t.lengthComputable&&i(t.loaded,t.total)}),l.onload=function(){if(l.status>=200&&l.status<300)try{t(JSON.parse(l.responseText))}catch(t){n(new Error("Invalid JSON response"))}else n(new Error("Upload failed: ".concat(l.status)))},l.onerror=function(){return n(new Error("Network error on direct upload"))},l.send(a)}))}},t)})),tc.apply(this,arguments)}function ec(t,e,r,n,o,i){return rc.apply(this,arguments)}function rc(){return(rc=ma(Ea().m(function t(e,r,n,o,i,a){var u,s;return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Ys(e,r,n,o,i,a);case 1:case 4:case 6:return t.a(2,t.v);case 2:return t.p=2,u=t.v,ua("[Uploader] TUS failed, trying fallback",u),t.p=3,t.n=4,Qs(e,r,n,o,i,a);case 5:return t.p=5,s=t.v,ua("[Uploader] Chunked REST failed, trying direct",s),t.n=6,Zs(e,r,n,o,i,a)}},t,null,[[3,5],[0,2]])}))).apply(this,arguments)}function nc(t,e){var r=null==e?void 0:e.downlink;r&&0!==r||(r={"slow-2g":.05,"2g":.15,"3g":.75,"4g":8}[null==e?void 0:e.effectiveType]||.5);var n=1e6*(r=Math.min(r,10))/8;return Math.ceil(t/n*1.5)}function oc(t){return isFinite(t)?t<60?"~".concat(t,"s"):"~".concat(Math.ceil(t/60)," min"):"Calculating..."}var ic={uploadWithTus:Ys,uploadWithChunkedRest:Qs,uploadDirect:Zs,uploadWithPriority:ec,isTusAvailable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var e=Vs();return!!(window.tus&&window.tus.Upload&&e.endpoint&&t>1048576)}catch(t){return!1}},estimateUploadTime:nc,formatUploadEstimate:oc};"undefined"!=typeof window&&(window.StarmusTus=ic);var ac,uc={};!function(){if(ac)return uc;ac=1;var t=Dr(),e=na().map;t({target:"Array",proto:!0,forced:!uo()("map")},{map:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var sc,cc,lc,fc,dc,pc={};function hc(){if(cc)return sc;cc=1;var t=ft();return sc=t(1.1.valueOf)}function vc(){if(fc)return lc;fc=1;var t=pr(),e=Di(),r=vt(),n=RangeError;return lc=function(o){var i=e(r(this)),a="",u=t(o);if(u<0||u===1/0)throw new n("Wrong number of repetitions");for(;u>0;(u>>>=1)&&(i+=i))1&u&&(a+=i);return a}}!function(){if(dc)return pc;dc=1;var t=Dr(),e=ft(),r=pr(),n=hc(),o=vc(),i=y(),a=RangeError,u=String,s=Math.floor,c=e(o),l=e("".slice),f=e(1.1.toFixed),d=function(t,e,r){return 0===e?r:e%2==1?d(t,e-1,r*t):d(t*t,e/2,r)},p=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=s(o/1e7)},h=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=s(n/e),n=n%e*1e7},v=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=u(t[e]);r=""===r?n:r+c("0",7-n.length)+n}return r};t({target:"Number",proto:!0,forced:i(function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)})||!i(function(){f({})})},{toFixed:function(t){var e,o,i,s,f=n(this),m=r(t),y=[0,0,0,0,0,0],g="",b="0";if(m<0||m>20)throw new a("Incorrect fraction digits");if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return u(f);if(f<0&&(g="-",f=-f),f>1e-21)if(o=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(f*d(2,69,1))-69)<0?f*d(2,-e,1):f/d(2,e,1),o*=4503599627370496,(e=52-e)>0){for(p(y,0,o),i=m;i>=7;)p(y,1e7,0),i-=7;for(p(y,d(10,i,1),0),i=e-1;i>=23;)h(y,1<<23),i-=23;h(y,1<<i),p(y,1,1),h(y,2),b=v(y)}else p(y,0,o),p(y,1<<-e,0),b=v(y)+c("0",m);return b=m>0?g+((s=b.length)<=m?"0."+c("0",m-s)+b:l(b,0,s-m)+"."+l(b,s-m)):g+b}})}();var mc,yc={};!function(){if(mc)return yc;mc=1;var t=ze().PROPER,e=Je(),r=Ee(),n=Di(),o=y(),i=Gs(),a="toString",u=RegExp.prototype,s=u[a],c=o(function(){return"/a/b"!==s.call({source:"a",flags:"b"})}),l=t&&s.name!==a;(c||l)&&e(u,a,function(){var t=r(this);return"/"+n(t.source)+"/"+n(i(t))},{unsafe:!0})}();var gc={dbName:"StarmusSubmissions",storeName:"pendingSubmissions",dbVersion:1,maxRetries:10,retryDelays:[0,5e3,1e4,3e4,6e4,12e4,3e5,6e5,12e5,18e5],maxBlobSize:41943040},bc=function(){return ga(function t(){ya(this,t),this.db=null,this.isProcessing=!1},[{key:"init",value:(i=ma(Ea().m(function t(){var e=this;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(window.indexedDB){t.n=1;break}return console.error("[Offline] IndexedDB not supported. Offline uploads disabled."),t.a(2);case 1:return t.a(2,new Promise(function(t){var r=indexedDB.open(gc.dbName,gc.dbVersion);r.onerror=function(e){ua("[Offline] DB open failed:",e),t()},r.onblocked=function(){ua("[Offline] DB open blocked â other tab open")},r.onsuccess=function(r){e.db=r.target.result,e.db.onversionchange=function(){e.db.close(),ua("[Offline] DB version changed â closed connection")},ua("[Offline] DB ready"),t()},r.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(gc.storeName)){var r=e.createObjectStore(gc.storeName,{keyPath:"id"});r.createIndex("timestamp","timestamp",{unique:!1}),r.createIndex("retryCount","retryCount",{unique:!1}),ua("[Offline] Created object store:",gc.storeName)}}}))}},t)})),function(){return i.apply(this,arguments)})},{key:"add",value:(o=ma(Ea().m(function t(e,r,n){var o,i,a,u,s,c=this,l=arguments;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(o=l.length>3&&void 0!==l[3]?l[3]:{},i=l.length>4&&void 0!==l[4]?l[4]:{},this.db){t.n=1;break}throw new Error("OfflineQueue: DB not initialized");case 1:if(!(r.size>gc.maxBlobSize)){t.n=2;break}throw a="Audio too large (".concat((r.size/1024/1024).toFixed(2),"â¯MB) â exceeds limit of ").concat(gc.maxBlobSize/1024/1024,"â¯MB"),ua("[Offline] "+a),new Error(a);case 2:return u=new Blob([r],{type:r.type}),s={id:"starmus-offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),instanceId:e,fileName:n,timestamp:Date.now(),audioBlob:u,formFields:o,metadata:i,retryCount:0,lastAttempt:null,error:null},t.a(2,new Promise(function(t,e){var r=c.db.transaction([gc.storeName],"readwrite");r.objectStore(gc.storeName).add(s),r.oncomplete=function(){ua("[Offline] Queued submission:",s.id),c._notifyQueueUpdate(),t(s.id)},r.onerror=function(t){var r=t.target.error;r&&"QuotaExceededError"===r.name?(ua("[Offline] IndexedDB quota exceeded â cannot save offline"),e(new Error("IndexedDB quota exceeded â cannot store offline"))):(ua("[Offline] Transaction error:",r),e(r))}}))}},t,this)})),function(t,e,r){return o.apply(this,arguments)})},{key:"getAll",value:(n=ma(Ea().m(function t(){var e=this;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2,[]);case 1:return t.a(2,new Promise(function(t,r){var n=e.db.transaction([gc.storeName],"readonly").objectStore(gc.storeName).getAll();n.onsuccess=function(){return t(n.result||[])},n.onerror=function(){return r(n.error)}}))}},t,this)})),function(){return n.apply(this,arguments)})},{key:"remove",value:(r=ma(Ea().m(function t(e){var r=this;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2);case 1:return t.a(2,new Promise(function(t,n){var o=r.db.transaction([gc.storeName],"readwrite");o.objectStore(gc.storeName).delete(e),o.oncomplete=function(){ua("[Offline] Removed from queue:",e),r._notifyQueueUpdate(),t()},o.onerror=function(t){return n(t.target.error)}}))}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"_updateRetry",value:(e=ma(Ea().m(function t(e,r,n){var o=this;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2);case 1:return t.a(2,new Promise(function(t,i){var a=o.db.transaction([gc.storeName],"readwrite"),u=a.objectStore(gc.storeName),s=u.get(e);s.onsuccess=function(){var t=s.result;t&&(t.retryCount=r,t.lastAttempt=Date.now(),t.error=n||null,u.put(t))},s.onerror=function(t){return i(t.target.error)},a.oncomplete=function(){return t()}}))}},t,this)})),function(t,r,n){return e.apply(this,arguments)})},{key:"processQueue",value:(t=ma(Ea().m(function t(){var e,r,n,o,i,a,u,s,c,l,f,d,p,h,v,m,y;return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.isProcessing&&navigator.onLine){t.n=1;break}return t.a(2);case 1:return this.isProcessing=!0,ua("[Offline] Processing queue..."),t.p=2,t.n=3,this.getAll();case 3:e=t.v,ua("[Offline] ".concat(e.length," submissions pending")),r=ba(e),t.p=4,r.s();case 5:if((n=r.n()).done){t.n=14;break}if(o=n.value,i=o.id,a=o.audioBlob,u=o.fileName,s=o.formFields,c=o.metadata,l=o.retryCount,f=o.instanceId,!(l>=gc.maxRetries)){t.n=6;break}return ua("[Offline] Max retries exceeded for",i),t.a(3,13);case 6:if(null===o.lastAttempt){t.n=7;break}if(d=gc.retryDelays[Math.min(l,gc.retryDelays.length-1)],!(Date.now()-o.lastAttempt<d)){t.n=7;break}return t.a(3,13);case 7:return t.p=7,ua("[Offline] Uploading queued item",i),t.n=8,ec(a,u,s,c,f,null);case 8:return p=t.v,ua("[Offline] Upload succeeded for",i,p),t.n=9,this.remove(i);case 9:t.n=13;break;case 10:if(t.p=10,v=t.v,ua("[Offline] Upload failed for",i,v),h=v&&v.message?v.message:String(v),/400|Invalid JSON|QuotaExceeded/i.test(h)){t.n=12;break}return t.n=11,this._updateRetry(i,l+1,h);case 11:t.n=13;break;case 12:ua("[Offline] Nonâretryable error, leaving in queue for manual review:",i);case 13:t.n=5;break;case 14:t.n=16;break;case 15:t.p=15,m=t.v,r.e(m);case 16:return t.p=16,r.f(),t.f(16);case 17:t.n=19;break;case 18:t.p=18,y=t.v,console.error("[Offline] Queue processing error:",y);case 19:return t.p=19,this.isProcessing=!1,t.f(19);case 20:return t.a(2)}},t,this,[[7,10],[4,15,16,17],[2,18,19,20]])})),function(){return t.apply(this,arguments)})},{key:"setupNetworkListeners",value:function(){var t=this;window.addEventListener("online",function(){ua("[Offline] Network online â processing queue"),t.processQueue()}),window.addEventListener("offline",function(){ua("[Offline] Network offline â queue paused")}),setInterval(function(){navigator.onLine&&t.processQueue().catch(function(t){return ua("[Offline] Retry error",t)})},6e4)}},{key:"_notifyQueueUpdate",value:function(){window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&this.getAll().then(function(t){var e=t.map(function(t){return{id:t.id,fileName:t.fileName,retryCount:t.retryCount,error:t.error,timestamp:t.timestamp}});window.StarmusHooks.doAction("starmus_offline_queue_updated",e)}).catch(function(t){return ua("[Offline] Queue notification failed",t)})}}]);var t,e,r,n,o,i}(),wc=new bc;function Sc(){return kc.apply(this,arguments)}function kc(){return(kc=ma(Ea().m(function t(){return Ea().w(function(t){for(;;)switch(t.n){case 0:if(wc.db){t.n=2;break}return t.n=1,wc.init();case 1:wc.setupNetworkListeners();case 2:return t.a(2,wc)}},t)}))).apply(this,arguments)}function Ec(t,e,r,n,o){return _c.apply(this,arguments)}function _c(){return(_c=ma(Ea().m(function t(e,r,n,o,i){var a;return Ea().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Sc();case 1:return a=t.v,t.a(2,a.add(e,r,n,o,i))}},t)}))).apply(this,arguments)}function Oc(){return Tc.apply(this,arguments)}function Tc(){return(Tc=ma(Ea().m(function t(){var e,r;return Ea().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Sc();case 1:return e=t.v,t.n=2,e.getAll();case 2:return r=t.v,t.a(2,r.length)}},t)}))).apply(this,arguments)}function Ac(){return Sc()}"undefined"!=typeof window&&(window.initOffline=Ac);var xc,Pc,Rc;function Uc(){if(Pc)return xc;Pc=1;var t=u().isFinite;return xc=Number.isFinite||function(e){return"number"==typeof e&&t(e)}}Rc||(Rc=1,Dr()({target:"Number",stat:!0},{isFinite:Uc()}));var Ic,Cc,jc,Lc,Bc,Mc={};!function(){if(Bc)return Mc;Bc=1;var t=Dr(),e=function(){if(Cc)return Ic;Cc=1;var t=ft(),e=vr(),r=Di(),n=vc(),o=vt(),i=t(n),a=t("".slice),u=Math.ceil,s=function(t){return function(n,s,c){var l,f,d=r(o(n)),p=e(s),h=d.length,v=void 0===c?" ":r(c);return p<=h||""===v?d:((f=i(v,u((l=p-h)/v.length))).length>l&&(f=a(f,0,l)),t?d+f:f+d)}};return Ic={start:s(!1),end:s(!0)}}().start;t({target:"String",proto:!0,forced:function(){if(Lc)return jc;Lc=1;var t=St();return jc=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(t)}()},{padStart:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}(),window.StarmusInstances=window.StarmusInstances||{};var Nc=!1;function Dc(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}function Fc(t,e){var r;"error"!==t.status&&"complete"!==t.status||console.log("[StarmusUI] Render called with state:",{status:t.status,calibrationComplete:null===(r=t.calibration)||void 0===r?void 0:r.complete,instanceId:t.instanceId});var n=t.status,o=t.error,i=t.source,a=void 0===i?{}:i,u=t.submission,s=void 0===u?{}:u,c=t.calibration,l=void 0===c?{}:c,f=t.recorder,d=void 0===f?{}:f,p=t.instanceId;if("C"===t.tier||!0===t.fallbackActive)return["recordBtn","pauseBtn","resumeBtn","stopBtn","recorderContainer"].forEach(function(t){e[t]&&(e[t].style.display="none")}),void(e.fallbackContainer&&(e.fallbackContainer.style.display="block"));if(e.step1&&e.step2){var h="idle"!==n&&"uninitialized"!==n;e.step1.style.display=h?"none":"block",e.step2.style.display=h?"block":"none"}if(e.timer||e.timerElapsed){var v=function(t){if(!Number.isFinite(t))return"00m 00s";var e=Math.floor(t/60),r=Math.floor(t%60);return"".concat(e.toString().padStart(2,"0"),"m ").concat(r.toString().padStart(2,"0"),"s")}(d.duration||0);e.timerElapsed?e.timerElapsed.textContent=v:e.timer&&(e.timer.textContent=v),e.timer&&("recording"===n?e.timer.classList.add("starmus-timer--recording"):e.timer.classList.remove("starmus-timer--recording"))}if(e.durationProgress){var m=d.duration||0,y="recording"===n||"paused"===n||"calibrating"===n;if(e.durationProgress.parentElement&&(e.durationProgress.parentElement.style.display=y?"block":"none"),y){var g=Math.min(100,m/1200*100);e.durationProgress.style.setProperty("--starmus-recording-progress","".concat(g,"%")),e.durationProgress.setAttribute("aria-valuenow",Math.floor(m)),m>=1020?e.durationProgress.setAttribute("data-level","danger"):m>=900?e.durationProgress.setAttribute("data-level","warning"):e.durationProgress.setAttribute("data-level","safe"),m>=1200&&"recording"===n&&window.CommandBus&&window.CommandBus.dispatch("stop-mic",{},{instanceId:p})}}if(e.volumeMeter){var b="recording"===n||"paused"===n||"calibrating"===n;if(e.volumeMeter.parentElement&&(e.volumeMeter.parentElement.style.display=b?"block":"none"),b){var w=Math.max(0,Math.min(100,"calibrating"===n?l.volumePercent||0:d.amplitude||0));e.volumeMeter.style.setProperty("--starmus-audio-level","".concat(w,"%"));var S=w/100;S<.6?e.volumeMeter.setAttribute("data-level","safe"):S<.85?e.volumeMeter.setAttribute("data-level","hot"):e.volumeMeter.setAttribute("data-level","clip"),"recording"===n&&function(t,e){if(t>=.85&&!Nc){Nc=!0;var r=e.messageBox||document.querySelector("[data-starmus-message-box]");r&&(r.textContent="â ï¸ Your microphone is too loud. Move back 6â12 inches or speak softer for a cleaner recording.",r.style.display="block",r.setAttribute("role","alert"),r.setAttribute("aria-live","assertive"),setTimeout(function(){r.style.display="none",r.removeAttribute("role"),r.removeAttribute("aria-live")},6e3))}}(S,e)}else e.volumeMeter.style.setProperty("--starmus-audio-level","0%"),e.volumeMeter.removeAttribute("data-level")}var k="recording"===n,E="paused"===n,_="ready"===n,O="calibrating"===n,T="ready_to_submit"===n,A=l&&!0===l.complete,x=k||E||O;if(e.recordBtn&&(e.recordBtn.style.display=_&&A&&!x&&!T?"inline-flex":"none"),e.pauseBtn&&(e.pauseBtn.style.display=k?"inline-flex":"none"),e.resumeBtn&&(e.resumeBtn.style.display=E?"inline-flex":"none"),e.stopBtn&&(e.stopBtn.style.display=x?"inline-flex":"none",e.stopBtn.disabled=O,e.stopBtn.innerHTML=O?'<span class="dashicons dashicons-update"></span> Calibrating...':'<span class="dashicons dashicons-media-default"></span> Stop'),e.submitBtn&&(e.submitBtn.disabled="ready_to_submit"!==n,e.submitBtn.textContent="submitting"===n?"Uploadingâ¦":"Submit Recording"),e.transcriptBox){var P,R,U=(null===(P=a.transcript)||void 0===P?void 0:P.length)>0,I=(null===(R=a.interimTranscript)||void 0===R?void 0:R.length)>0;U||I?(e.transcriptBox.style.display="block",e.transcriptBox.innerHTML=(U?'<span class="starmus-transcript--final">'.concat(Dc(a.transcript),"</span>"):"")+(I?' <span class="starmus-transcript--interim">'.concat(Dc(a.interimTranscript),"</span>"):"")):e.transcriptBox.style.display="none"}if(e.statusEl){var C=e.statusEl,j="",L="starmus-status";if(o)j=o.message||"An error occurred.",L+=" starmus-status--error";else switch(n){case"ready":j="Mic calibrated. Click Start Recording.",L+=" starmus-status--success";break;case"recording":j="Recording...",L+=" starmus-status--recording";break;case"paused":j="Paused â Resume or Stop.";break;case"submitting":j="Uploading ".concat(Math.round(100*s.progress),"%");break;case"complete":j="Upload successful!",L+=" starmus-status--success";break;default:j=""}C.className=L,C.textContent=j,C.style.display=j?"block":"none"}}function qc(t,e){var r,n,o,i,a,u,s;console.log("[StarmusUI] initInstance called with elements:",{recordBtn:!!e.recordBtn,setupMicBtn:!!e.setupMicBtn,volumeMeter:!!e.volumeMeter,timer:!!e.timer,elementKeys:Object.keys(e)});var c=t.getState().instanceId,l=window.CommandBus||window.StarmusHooks;function f(t){if(!l)return console.warn("[StarmusUI] No CommandBus detected.");console.log("[StarmusUI] Dispatching:",t),l.dispatch(t,{},{instanceId:c})}console.log("[StarmusUI] CommandBus found:",!!l,"Instance ID:",c),console.log("[StarmusUI] Attaching event listeners..."),e.recordBtn?(console.log("[StarmusUI] Record button element:",e.recordBtn),console.log("[StarmusUI] Button disabled:",e.recordBtn.disabled),console.log("[StarmusUI] Button style display:",getComputedStyle(e.recordBtn).display),console.log("[StarmusUI] Button style visibility:",getComputedStyle(e.recordBtn).visibility),console.log("[StarmusUI] Button style pointer-events:",getComputedStyle(e.recordBtn).pointerEvents),e.recordBtn.addEventListener("click",function(t){console.log("[StarmusUI] Record button clicked! Event:",t),console.log("[StarmusUI] Button disabled at click time:",e.recordBtn.disabled),f("start-recording")}),e.recordBtn.addEventListener("mousedown",function(t){console.log("[StarmusUI] Record button MOUSEDOWN detected!",t)}),setTimeout(function(){console.log("[StarmusUI] Testing manual click..."),e.recordBtn.click();var t=e.recordBtn.getBoundingClientRect(),r=t.left+t.width/2,n=t.top+t.height/2,o=document.elementFromPoint(r,n);console.log("[StarmusUI] Button position:",{x:r,y:n}),console.log("[StarmusUI] Element at button center:",o),console.log("[StarmusUI] Is the button the top element?",o===e.recordBtn),o!==e.recordBtn&&(console.log("[StarmusUI] *** FOUND THE PROBLEM! Another element is covering the button ***"),console.log("[StarmusUI] Covering element classes:",null==o?void 0:o.className),console.log("[StarmusUI] Covering element z-index:",getComputedStyle(o).zIndex))},2e3),console.log("[StarmusUI] Record button listener attached")):console.log("[StarmusUI] No record button found!"),null===(r=e.pauseBtn)||void 0===r||r.addEventListener("click",function(){return f("pause-mic")}),null===(n=e.resumeBtn)||void 0===n||n.addEventListener("click",function(){return f("resume-mic")}),null===(o=e.stopBtn)||void 0===o||o.addEventListener("click",function(){return f("stop-mic")}),null===(i=e.submitBtn)||void 0===i||i.addEventListener("click",function(){var t,r=e.submitBtn.closest("form"),n={},o=ba((r?new FormData(r):new FormData).entries());try{for(o.s();!(t=o.n()).done;){var i=Ta(t.value,2),a=i[0],u=i[1];n[a]=u}}catch(t){o.e(t)}finally{o.f()}f("submit")}),null===(a=e.resetBtn)||void 0===a||a.addEventListener("click",function(){return f("reset")}),null===(u=e.playBtn)||void 0===u||u.addEventListener("click",function(){return f("play")}),null===(s=e.setupMicBtn)||void 0===s||s.addEventListener("click",function(){return f("setup-mic")}),e.continueBtn&&e.continueBtn.addEventListener("click",function(){console.log("[StarmusUI] Continue button clicked!"),t.dispatch({type:"starmus/ui/step-continue",payload:{}})}),e.fileInput&&e.fileInput.addEventListener("change",function(t){var e,r=null===(e=t.target.files)||void 0===e?void 0:e[0];r&&l.dispatch("file-attached",{file:r},{instanceId:c})});var d=t.subscribe(function(t){return Fc(t,e)});return Fc(t.getState(),e),d}"undefined"!=typeof window&&(window.initUI=qc),document.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll('[data-starmus-action="next"]');t.length&&t.forEach(function(t){t.addEventListener("click",function(){try{var e;if(!window.StarmusStore||!window.StarmusStore.createStore)return void console.error("[Starmus] Store not available");var r=t.closest("[data-starmus-instance]");if(!r)return;var n=r.getAttribute("data-starmus-instance"),o=null===(e=window.StarmusInstances)||void 0===e||null===(e=e[n])||void 0===e?void 0:e.store;if(!o)return void console.error("[Starmus] No store for instance",n);o.dispatch({type:"starmus/ui/step-continue"});var i=document.querySelector("#starmus_step1_"+n),a=document.querySelector("#starmus_step2_"+n);i&&(i.style.display="none"),a&&(a.style.display="block"),console.log("[Starmus] Continue â Recording step enabled",n)}catch(t){console.error("[Starmus Continue Error]",t)}})})});var zc,Hc={};!function(){if(zc)return Hc;zc=1;var t=Dr(),e=yr().includes,r=y(),n=xn();t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")}();var Gc,Wc,Vc,$c,Jc,Yc,Kc,Qc={};function Xc(){if($c)return Vc;$c=1;var t=function(){if(Wc)return Gc;Wc=1;var t=gt(),e=dt(),r=se()("match");return Gc=function(n){var o;return t(n)&&(void 0!==(o=n[r])?!!o:"RegExp"===e(n))}}(),e=TypeError;return Vc=function(r){if(t(r))throw new e("The method doesn't accept regular expressions");return r}}!function(){if(Kc)return Qc;Kc=1;var t=Dr(),e=ft(),r=Xc(),n=vt(),o=Di(),i=function(){if(Yc)return Jc;Yc=1;var t=se()("match");return Jc=function(e){var r=/./;try{"/./"[e](r)}catch(n){try{return r[t]=!1,"/./"[e](r)}catch(t){}}return!1}}(),a=e("".indexOf);t({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~a(o(n(this)),o(r(t)),arguments.length>1?arguments[1]:void 0)}})}();var Zc,tl,el,rl,nl,ol,il,al={};function ul(){return tl?Zc:(tl=1,Zc="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff")}function sl(){if(rl)return el;rl=1;var t=ft(),e=vt(),r=Di(),n=ul(),o=t("".replace),i=RegExp("^["+n+"]+"),a=RegExp("(^|[^"+n+"])["+n+"]+$"),u=function(t){return function(n){var u=r(e(n));return 1&t&&(u=o(u,i,"")),2&t&&(u=o(u,a,"$1")),u}};return el={start:u(1),end:u(2),trim:u(3)}}!function(){if(il)return al;il=1;var t=Dr(),e=sl().trim,r=function(){if(ol)return nl;ol=1;var t=ze().PROPER,e=y(),r=ul();return nl=function(n){return e(function(){return!!r[n]()||"âÂá "!=="âÂá "[n]()||t&&r[n].name!==n})}}();t({target:"String",proto:!0,forced:r("trim")},{trim:function(){return e(this)}})}();var cl=window.StarmusHooks||{},ll=cl.subscribe||function(){},fl=cl.debugLog||function(){};function dl(t,e,r){fl("[StarmusCore] initCore",e,r);try{window.dispatchEvent(new CustomEvent("starmus-ready",{detail:{instanceId:e}})),fl("[StarmusCore] dispatched starmus-ready event")}catch(t){fl("[StarmusCore] failed to dispatch starmus-ready",t)}function n(t){return o.apply(this,arguments)}function o(){return(o=ma(Ea().m(function n(o){var i,a,u,s,c,l,f,d,p,h,v,m,y,g,b,w,S;return Ea().w(function(n){for(;;)switch(n.p=n.n){case 0:if(a=t.getState(),u=a.source||{},s=a.calibration||{},c=a.env||r||{},l=u.blob||u.file,f=u.fileName||u.file&&u.file.name||"recording.webm",l){n.n=1;break}return t.dispatch({type:"starmus/error",error:{message:"Please record or attach audio before submitting.",retryable:!1},status:a.status}),n.a(2);case 1:if(d={transcript:(null===(i=u.transcript)||void 0===i?void 0:i.trim())||null,calibration:s.complete?{gain:s.gain,snr:s.snr,noiseFloor:s.noiseFloor,speechLevel:s.speechLevel,timestamp:s.timestamp||(new Date).toISOString()}:null,env:c},p=nc(l.size,c.network),fl("[StarmusCore] Upload size: ".concat((l.size/1024/1024).toFixed(2),"â¯MB, estimated time: ").concat(oc(p))),t.dispatch({type:"starmus/submit-start"}),h=function(e,r){t.dispatch({type:"starmus/submit-progress",progress:e/r})},n.p=2,navigator.onLine){n.n=3;break}throw new Error("OFFLINE_FAST_PATH");case 3:return n.n=4,ec({blob:l,fileName:f,formFields:o,metadata:d,instanceId:e,onProgress:h});case 4:v=n.v,fl("[StarmusCore] Upload succeeded via",v.method,v),t.dispatch({type:"starmus/submit-complete",payload:v});try{window.dispatchEvent(new CustomEvent("starmus-upload-finished",{detail:{instanceId:e,method:v.method}}))}catch(t){}n.n=12;break;case 5:if(n.p=5,w=n.v,fl("[StarmusCore] Upload error",w),m=(null==w?void 0:w.message)||"",y=m.includes("not configured"),"OFFLINE_FAST_PATH"!==w.message&&y){n.n=11;break}return fl("[StarmusCore] Saving submission to offline queue for retry"),n.p=6,n.n=7,Ec(e,l,f,o,d);case 7:return g=n.v,t.dispatch({type:"starmus/submit-queued",submissionId:g}),n.n=8,Oc();case 8:b=n.v,fl("[StarmusCore] Offline queue count: ".concat(b)),window.dispatchEvent(new CustomEvent("starmus-offline-queued",{detail:{instanceId:e,pending:b}})),n.n=10;break;case 9:n.p=9,S=n.v,console.error("[StarmusCore] Failed to save offline submission",S),t.dispatch({type:"starmus/error",error:{message:"Upload failed and could not be saved offline.",retryable:!1},status:"ready_to_submit"});case 10:n.n=12;break;case 11:t.dispatch({type:"starmus/error",error:{message:w.message||"Upload failed.",retryable:!1},status:"ready_to_submit"});case 12:return n.a(2)}},n,null,[[6,9],[2,5]])}))).apply(this,arguments)}return ll("submit",function(t,r){r&&r.instanceId===e&&n(t.formFields||{})}),ll("reset",function(r,n){n&&n.instanceId===e&&t.dispatch({type:"starmus/reset"})}),ll("continue",function(r,n){n&&n.instanceId===e&&t.dispatch({type:"starmus/ui/step-continue"})}),{handleSubmit:n}}"undefined"!=typeof window&&(window.initCore=dl),"undefined"!=typeof module&&module.exports&&(module.exports={initCore:dl});var pl,hl,vl,ml,yl,gl,bl,wl,Sl,kl,El,_l,Ol,Tl,Al,xl,Pl,Rl,Ul,Il={};function Cl(){return hl?pl:(hl=1,pl="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView)}function jl(){if(ml)return vl;ml=1;var t=pr(),e=vr(),r=RangeError;return vl=function(n){if(void 0===n)return 0;var o=t(n),i=e(o);if(o!==i)throw new r("Wrong length or index");return i}}function Ll(){if(kl)return Sl;kl=1;var t=gl?yl:(gl=1,yl=Math.sign||function(t){var e=+t;return 0===e||e!=e?e:e<0?-1:1}),e=function(){if(wl)return bl;wl=1;var t=4503599627370496;return bl=function(e){return e+t-t}}(),r=Math.abs;return Sl=function(n,o,i,a){var u=+n,s=r(u),c=t(u);if(s<a)return c*e(s/a/o)*a*o;var l=(1+o/2220446049250313e-31)*s,f=l-(l-s);return f>i||f!=f?c*(1/0):c*f}}function Bl(){if(Tl)return Ol;Tl=1;var t=Array,e=Math.abs,r=Math.pow,n=Math.floor,o=Math.log,i=Math.LN2;return Ol={pack:function(a,u,s){var c,l,f,d=t(s),p=8*s-u-1,h=(1<<p)-1,v=h>>1,m=23===u?r(2,-24)-r(2,-77):0,y=a<0||0===a&&1/a<0?1:0,g=0;for((a=e(a))!=a||a===1/0?(l=a!=a?1:0,c=h):(c=n(o(a)/i),a*(f=r(2,-c))<1&&(c--,f*=2),(a+=c+v>=1?m/f:m*r(2,1-v))*f>=2&&(c++,f/=2),c+v>=h?(l=0,c=h):c+v>=1?(l=(a*f-1)*r(2,u),c+=v):(l=a*r(2,v-1)*r(2,u),c=0));u>=8;)d[g++]=255&l,l/=256,u-=8;for(c=c<<u|l,p+=u;p>0;)d[g++]=255&c,c/=256,p-=8;return d[g-1]|=128*y,d},unpack:function(t,e){var n,o=t.length,i=8*o-e-1,a=(1<<i)-1,u=a>>1,s=i-7,c=o-1,l=t[c--],f=127&l;for(l>>=7;s>0;)f=256*f+t[c--],s-=8;for(n=f&(1<<-s)-1,f>>=-s,s+=e;s>0;)n=256*n+t[c--],s-=8;if(0===f)f=1-u;else{if(f===a)return n?NaN:l?-1/0:1/0;n+=r(2,e),f-=u}return(l?-1:1)*n*r(2,f-e)}}}function Ml(){if(xl)return Al;xl=1;var t=ie(),e=hr(),r=mr();return Al=function(n){for(var o=t(this),i=r(o),a=arguments.length,u=e(a>1?arguments[1]:void 0,i),s=a>2?arguments[2]:void 0,c=void 0===s?i:e(s,i);c>u;)o[u++]=n;return o},Al}function Nl(){if(Rl)return Pl;Rl=1;var t=u(),e=ft(),r=g(),n=Cl(),o=ze(),i=Oe(),a=Pi(),s=Ri(),c=y(),l=Oi(),f=pr(),d=vr(),p=jl(),h=function(){if(_l)return El;_l=1;var t=Ll();return El=Math.fround||function(e){return t(e,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)}}(),v=Bl(),m=Rn(),b=Bn(),w=Ml(),S=so(),k=Ai(),E=Mr(),_=In(),O=Ve(),T=o.PROPER,A=o.CONFIGURABLE,x="ArrayBuffer",P="DataView",R="prototype",U="Wrong index",I=O.getterFor(x),C=O.getterFor(P),j=O.set,L=t[x],B=L,M=B&&B[R],N=t[P],D=N&&N[R],F=Object.prototype,q=t.Array,z=t.RangeError,H=e(w),G=e([].reverse),W=v.pack,V=v.unpack,$=function(t){return[255&t]},J=function(t){return[255&t,t>>8&255]},Y=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},K=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Q=function(t){return W(h(t),23,4)},X=function(t){return W(t,52,8)},Z=function(t,e,r){a(t[R],e,{configurable:!0,get:function(){return r(this)[e]}})},tt=function(t,e,r,n){var o=C(t),i=p(r),a=!!n;if(i+e>o.byteLength)throw new z(U);var u=o.bytes,s=i+o.byteOffset,c=S(u,s,s+e);return a?c:G(c)},et=function(t,e,r,n,o,i){var a=C(t),u=p(r),s=n(+o),c=!!i;if(u+e>a.byteLength)throw new z(U);for(var l=a.bytes,f=u+a.byteOffset,d=0;d<e;d++)l[f+d]=s[c?d:e-d-1]};if(n){var rt=T&&L.name!==x;c(function(){L(1)})&&c(function(){new L(-1)})&&!c(function(){return new L,new L(1.5),new L(NaN),1!==L.length||rt&&!A})?rt&&A&&i(L,"name",x):((B=function(t){return l(this,M),k(new L(p(t)),this,B)})[R]=M,M.constructor=B,E(B,L)),b&&m(D)!==F&&b(D,F);var nt=new N(new B(2)),ot=e(D.setInt8);nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||s(D,{setInt8:function(t,e){ot(this,t,e<<24>>24)},setUint8:function(t,e){ot(this,t,e<<24>>24)}},{unsafe:!0})}else M=(B=function(t){l(this,M);var e=p(t);j(this,{type:x,bytes:H(q(e),0),byteLength:e}),r||(this.byteLength=e,this.detached=!1)})[R],D=(N=function(t,e,n){l(this,D),l(t,M);var o=I(t),i=o.byteLength,a=f(e);if(a<0||a>i)throw new z("Wrong offset");if(a+(n=void 0===n?i-a:d(n))>i)throw new z("Wrong length");j(this,{type:P,buffer:t,byteLength:n,byteOffset:a,bytes:o.bytes}),r||(this.buffer=t,this.byteLength=n,this.byteOffset=a)})[R],r&&(Z(B,"byteLength",I),Z(N,"buffer",C),Z(N,"byteLength",C),Z(N,"byteOffset",C)),s(D,{getInt8:function(t){return tt(this,1,t)[0]<<24>>24},getUint8:function(t){return tt(this,1,t)[0]},getInt16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return K(tt(this,4,t,arguments.length>1&&arguments[1]))},getUint32:function(t){return K(tt(this,4,t,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(t){return V(tt(this,4,t,arguments.length>1&&arguments[1]),23)},getFloat64:function(t){return V(tt(this,8,t,arguments.length>1&&arguments[1]),52)},setInt8:function(t,e){et(this,1,t,$,e)},setUint8:function(t,e){et(this,1,t,$,e)},setInt16:function(t,e){et(this,2,t,J,e,arguments.length>2&&arguments[2])},setUint16:function(t,e){et(this,2,t,J,e,arguments.length>2&&arguments[2])},setInt32:function(t,e){et(this,4,t,Y,e,arguments.length>2&&arguments[2])},setUint32:function(t,e){et(this,4,t,Y,e,arguments.length>2&&arguments[2])},setFloat32:function(t,e){et(this,4,t,Q,e,arguments.length>2&&arguments[2])},setFloat64:function(t,e){et(this,8,t,X,e,arguments.length>2&&arguments[2])}});return _(B,x),_(N,P),Pl={ArrayBuffer:B,DataView:N}}!function(){if(Ul)return Il;Ul=1;var t=Dr(),e=u(),r=Nl(),n=Ui(),o="ArrayBuffer",i=r[o];t({global:!0,constructor:!0,forced:e[o]!==i},{ArrayBuffer:i}),n(o)}();var Dl,Fl={};!function(){if(Dl)return Fl;Dl=1;var t=Dr(),e=Fr(),r=y(),n=Nl(),o=Ee(),i=hr(),a=vr(),u=n.ArrayBuffer,s=n.DataView,c=s.prototype,l=e(u.prototype.slice),f=e(c.getUint8),d=e(c.setUint8);t({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:r(function(){return!new u(2).slice(1,void 0).byteLength})},{slice:function(t,e){if(l&&void 0===e)return l(o(this),t);for(var r=o(this).byteLength,n=i(t,r),c=i(void 0===e?r:e,r),p=new u(a(c-n)),h=new s(this),v=new s(p),m=0;n<c;)d(v,m++,f(h,n++));return p}})}();var ql,zl;zl||(zl=1,ql||(ql=1,xi()("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ii())));var Hl,Gl,Wl,Vl={};!function(){if(Wl)return Vl;Wl=1;var t=Dr(),e=function(){if(Gl)return Hl;Gl=1;var t=u(),e=y(),r=ft(),n=Di(),o=sl().trim,i=ul(),a=r("".charAt),s=t.parseFloat,c=t.Symbol,l=c&&c.iterator,f=1/s(i+"-0")!=-1/0||l&&!e(function(){s(Object(l))});return Hl=f?function(t){var e=o(n(t)),r=s(e);return 0===r&&"-"===a(e,0)?-0:r}:s}();t({global:!0,forced:parseFloat!==e},{parseFloat:e})}();var $l,Jl,Yl,Kl,Ql,Xl,Zl,tf,ef,rf,nf,of,af,uf,sf,cf,lf,ff,df,pf,hf,vf,mf={exports:{}};function yf(){if(Jl)return $l;Jl=1;var t,e,r,n=Cl(),o=g(),i=u(),a=yt(),s=gt(),c=ae(),l=oo(),f=Tt(),d=Oe(),p=Je(),h=Pi(),v=wt(),m=Rn(),y=Bn(),b=se(),w=ue(),S=Ve(),k=S.enforce,E=S.get,_=i.Int8Array,O=_&&_.prototype,T=i.Uint8ClampedArray,A=T&&T.prototype,x=_&&m(_),P=O&&m(O),R=Object.prototype,U=i.TypeError,I=b("toStringTag"),C=w("TYPED_ARRAY_TAG"),j="TypedArrayConstructor",L=n&&!!y&&"Opera"!==l(i.opera),B=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},D=function(t){var e=m(t);if(s(e)){var r=E(e);return r&&c(r,j)?r[j]:D(e)}},F=function(t){if(!s(t))return!1;var e=l(t);return c(M,e)||c(N,e)};for(t in M)(r=(e=i[t])&&e.prototype)?k(r)[j]=e:L=!1;for(t in N)(r=(e=i[t])&&e.prototype)&&(k(r)[j]=e);if((!L||!a(x)||x===Function.prototype)&&(x=function(){throw new U("Incorrect invocation")},L))for(t in M)i[t]&&y(i[t],x);if((!L||!P||P===R)&&(P=x.prototype,L))for(t in M)i[t]&&y(i[t].prototype,P);if(L&&m(A)!==P&&y(A,P),o&&!c(P,I))for(t in B=!0,h(P,I,{configurable:!0,get:function(){return s(this)?this[C]:void 0}}),M)i[t]&&d(i[t],C,t);return $l={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:B&&C,aTypedArray:function(t){if(F(t))return t;throw new U("Target is not a typed array")},aTypedArrayConstructor:function(t){if(a(t)&&(!y||v(x,t)))return t;throw new U(f(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(o){if(r)for(var a in M){var u=i[a];if(u&&c(u.prototype,t))try{delete u.prototype[t]}catch(r){try{u.prototype[t]=e}catch(t){}}}P[t]&&!r||p(P,t,r?e:L&&O[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,a;if(o){if(y){if(r)for(n in M)if((a=i[n])&&c(a,t))try{delete a[t]}catch(t){}if(x[t]&&!r)return;try{return p(x,t,r?e:L&&x[t]||e)}catch(t){}}for(n in M)!(a=i[n])||a[t]&&!r||p(a,t,e)}},getTypedArrayConstructor:D,isView:function(t){if(!s(t))return!1;var e=l(t);return"DataView"===e||c(M,e)||c(N,e)},isTypedArray:F,TypedArray:x,TypedArrayPrototype:P}}function gf(){if(Xl)return Ql;Xl=1;var t=gt(),e=Math.floor;return Ql=Number.isInteger||function(r){return!t(r)&&isFinite(r)&&e(r)===r}}function bf(){if(tf)return Zl;tf=1;var t=pr(),e=RangeError;return Zl=function(r){var n=t(r);if(n<0)throw new e("The argument can't be less than 0");return n}}function wf(){if(rf)return ef;rf=1;var t=bf(),e=RangeError;return ef=function(r,n){var o=t(r);if(o%n)throw new e("Wrong offset");return o}}function Sf(){if(of)return nf;of=1;var t=Math.round;return nf=function(e){var r=t(e);return r<0?0:r>255?255:255&r}}function kf(){if(uf)return af;uf=1;var t=oo();return af=function(e){var r=t(e);return"BigInt64Array"===r||"BigUint64Array"===r}}function Ef(){if(cf)return sf;cf=1;var t=ce(),e=TypeError;return sf=function(r){var n=t(r,"number");if("number"==typeof n)throw new e("Can't convert number to bigint");return BigInt(n)}}function _f(){if(ff)return lf;ff=1;var t=bi(),e=w(),r=Uu(),n=ie(),o=mr(),i=ki(),a=Si(),u=wi(),s=kf(),c=yf().aTypedArrayConstructor,l=Ef();return lf=function(f){var d,p,h,v,m,y,g,b,w=r(this),S=n(f),k=arguments.length,E=k>1?arguments[1]:void 0,_=void 0!==E,O=a(S);if(O&&!u(O))for(b=(g=i(S,O)).next,S=[];!(y=e(b,g)).done;)S.push(y.value);for(_&&k>2&&(E=t(E,arguments[2])),p=o(S),h=new(c(w))(p),v=s(h),d=0;p>d;d++)m=_?E(S[d],d):S[d],h[d]=v?l(m):+m;return h},lf}function Of(){if(pf)return df;pf=1;var t=mr();return df=function(e,r,n){for(var o=0,i=arguments.length>2?n:t(r),a=new e(i);i>o;)a[o]=r[o++];return a},df}function Tf(){if(hf)return mf.exports;hf=1;var t=Dr(),e=u(),r=w(),n=g(),o=function(){if(Kl)return Yl;Kl=1;var t=u(),e=y(),r=Ti(),n=yf().NATIVE_ARRAY_BUFFER_VIEWS,o=t.ArrayBuffer,i=t.Int8Array;return Yl=!n||!e(function(){i(1)})||!e(function(){new i(-1)})||!r(function(t){new i,new i(null),new i(1.5),new i(t)},!0)||e(function(){return 1!==new i(new o(2),1,void 0).length})}(),i=yf(),a=Nl(),s=Oi(),c=lt(),l=Oe(),f=gf(),d=vr(),p=jl(),h=wf(),v=Sf(),m=le(),b=ae(),S=oo(),k=gt(),E=Ot(),_=An(),O=wt(),T=Bn(),A=wr().f,x=_f(),P=na().forEach,R=Ui(),U=Pi(),I=_e(),C=pe(),j=Of(),L=Ve(),B=Ai(),M=L.get,N=L.set,D=L.enforce,F=I.f,q=C.f,z=e.RangeError,H=a.ArrayBuffer,G=H.prototype,W=a.DataView,V=i.NATIVE_ARRAY_BUFFER_VIEWS,$=i.TYPED_ARRAY_TAG,J=i.TypedArray,Y=i.TypedArrayPrototype,K=i.isTypedArray,Q="BYTES_PER_ELEMENT",X="Wrong length",Z=function(t,e){U(t,e,{configurable:!0,get:function(){return M(this)[e]}})},tt=function(t){var e;return O(G,t)||"ArrayBuffer"===(e=S(t))||"SharedArrayBuffer"===e},et=function(t,e){return K(t)&&!E(e)&&e in t&&f(+e)&&e>=0},rt=function(t,e){return e=m(e),et(t,e)?c(2,t[e]):q(t,e)},nt=function(t,e,r){return e=m(e),!(et(t,e)&&k(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?F(t,e,r):(t[e]=r.value,t)};return n?(V||(C.f=rt,I.f=nt,Z(Y,"buffer"),Z(Y,"byteOffset"),Z(Y,"byteLength"),Z(Y,"length")),t({target:"Object",stat:!0,forced:!V},{getOwnPropertyDescriptor:rt,defineProperty:nt}),mf.exports=function(n,i,a){var u=n.match(/\d+/)[0]/8,c=n+(a?"Clamped":"")+"Array",f="get"+n,m="set"+n,y=e[c],g=y,b=g&&g.prototype,w={},S=function(t,e){F(t,e,{get:function(){return function(t,e){var r=M(t);return r.view[f](e*u+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var n=M(t);n.view[m](e*u+n.byteOffset,a?v(r):r,!0)}(this,e,t)},enumerable:!0})};V?o&&(g=i(function(t,e,n,o){return s(t,b),B(k(e)?tt(e)?void 0!==o?new y(e,h(n,u),o):void 0!==n?new y(e,h(n,u)):new y(e):K(e)?j(g,e):r(x,g,e):new y(p(e)),t,g)}),T&&T(g,J),P(A(y),function(t){t in g||l(g,t,y[t])}),g.prototype=b):(g=i(function(t,e,n,o){s(t,b);var i,a,c,l=0,f=0;if(k(e)){if(!tt(e))return K(e)?j(g,e):r(x,g,e);i=e,f=h(n,u);var v=e.byteLength;if(void 0===o){if(v%u)throw new z(X);if((a=v-f)<0)throw new z(X)}else if((a=d(o)*u)+f>v)throw new z(X);c=a/u}else c=p(e),i=new H(a=c*u);for(N(t,{buffer:i,byteOffset:f,byteLength:a,length:c,view:new W(i)});l<c;)S(t,l++)}),T&&T(g,J),b=g.prototype=_(Y)),b.constructor!==g&&l(b,"constructor",g),D(b).TypedArrayConstructor=g,$&&l(b,$,c);var E=g!==y;w[c]=g,t({global:!0,constructor:!0,forced:E,sham:!V},w),Q in g||l(g,Q,u),Q in b||l(b,Q,u),R(c)}):mf.exports=function(){},mf.exports}vf||(vf=1,Tf()("Float32",function(t){return function(e,r,n){return t(this,e,r,n)}}));var Af,xf,Pf,Rf={};!function(){if(Pf)return Rf;Pf=1;var t=ft(),e=yf(),r=function(){if(xf)return Af;xf=1;var t=ie(),e=hr(),r=mr(),n=Oo(),o=Math.min;return Af=[].copyWithin||function(i,a){var u=t(this),s=r(u),c=e(i,s),l=e(a,s),f=arguments.length>2?arguments[2]:void 0,d=o((void 0===f?s:e(f,s))-l,s-c),p=1;for(l<c&&c<l+d&&(p=-1,l+=d-1,c+=d-1);d-- >0;)l in u?u[c]=u[l]:n(u,c),c+=p,l+=p;return u},Af}(),n=t(r),o=e.aTypedArray;(0,e.exportTypedArrayMethod)("copyWithin",function(t,e){return n(o(this),t,e,arguments.length>2?arguments[2]:void 0)})}();var Uf,If={};!function(){if(Uf)return If;Uf=1;var t=yf(),e=na().every,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("every",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Cf,jf={};!function(){if(Cf)return jf;Cf=1;var t=yf(),e=Ml(),r=Ef(),n=oo(),o=w(),i=ft(),a=y(),u=t.aTypedArray,s=t.exportTypedArrayMethod,c=i("".slice);s("fill",function(t){var i=arguments.length;u(this);var a="Big"===c(n(this),0,3)?r(t):+t;return o(e,this,a,i>1?arguments[1]:void 0,i>2?arguments[2]:void 0)},a(function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t}))}();var Lf,Bf,Mf,Nf={};!function(){if(Mf)return Nf;Mf=1;var t=yf(),e=na().filter,r=function(){if(Bf)return Lf;Bf=1;var t=Of(),e=yf().getTypedArrayConstructor;return Lf=function(r,n){return t(e(r),n)}}(),n=t.aTypedArray;(0,t.exportTypedArrayMethod)("filter",function(t){var o=e(n(this),t,arguments.length>1?arguments[1]:void 0);return r(this,o)})}();var Df,Ff={};!function(){if(Df)return Ff;Df=1;var t=yf(),e=na().find,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("find",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var qf,zf={};!function(){if(qf)return zf;qf=1;var t=yf(),e=na().findIndex,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("findIndex",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Hf,Gf={};!function(){if(Hf)return Gf;Hf=1;var t=yf(),e=na().forEach,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("forEach",function(t){e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Wf,Vf={};!function(){if(Wf)return Vf;Wf=1;var t=yf(),e=yr().includes,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("includes",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var $f,Jf={};!function(){if($f)return Jf;$f=1;var t=yf(),e=yr().indexOf,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("indexOf",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Yf,Kf={};!function(){if(Yf)return Kf;Yf=1;var t=u(),e=y(),r=ft(),n=yf(),o=Dn(),i=se()("iterator"),a=t.Uint8Array,s=r(o.values),c=r(o.keys),l=r(o.entries),f=n.aTypedArray,d=n.exportTypedArrayMethod,p=a&&a.prototype,h=!e(function(){p[i].call([1])}),v=!!p&&p.values&&p[i]===p.values&&"values"===p.values.name,m=function(){return s(f(this))};d("entries",function(){return l(f(this))},h),d("keys",function(){return c(f(this))},h),d("values",m,h||!v,{name:"values"}),d(i,m,h||!v,{name:"values"})}();var Qf,Xf={};!function(){if(Qf)return Xf;Qf=1;var t=yf(),e=ft(),r=t.aTypedArray,n=t.exportTypedArrayMethod,o=e([].join);n("join",function(t){return o(r(this),t)})}();var Zf,td,ed,rd={};!function(){if(ed)return rd;ed=1;var t=yf(),e=Cu(),r=function(){if(td)return Zf;td=1;var t=Cu(),e=mt(),r=pr(),n=mr(),o=qr(),i=Math.min,a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0,s=o("lastIndexOf");return Zf=u||!s?function(o){if(u)return t(a,this,arguments)||0;var s=e(this),c=n(s);if(0===c)return-1;var l=c-1;for(arguments.length>1&&(l=i(l,r(arguments[1]))),l<0&&(l=c+l);l>=0;l--)if(l in s&&s[l]===o)return l||0;return-1}:a,Zf}(),n=t.aTypedArray;(0,t.exportTypedArrayMethod)("lastIndexOf",function(t){var o=arguments.length;return e(r,n(this),o>1?[t,arguments[1]]:[t])})}();var nd,od={};!function(){if(nd)return od;nd=1;var t=yf(),e=na().map,r=t.aTypedArray,n=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("map",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0,function(t,e){return new(n(t))(e)})})}();var id,ad={};!function(){if(id)return ad;id=1;var t=yf(),e=za().left,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("reduce",function(t){var n=arguments.length;return e(r(this),t,n,n>1?arguments[1]:void 0)})}();var ud,sd={};!function(){if(ud)return sd;ud=1;var t=yf(),e=za().right,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("reduceRight",function(t){var n=arguments.length;return e(r(this),t,n,n>1?arguments[1]:void 0)})}();var cd,ld={};!function(){if(cd)return ld;cd=1;var t=yf(),e=t.aTypedArray,r=t.exportTypedArrayMethod,n=Math.floor;r("reverse",function(){for(var t,r=this,o=e(r).length,i=n(o/2),a=0;a<i;)t=r[a],r[a++]=r[--o],r[o]=t;return r})}();var fd,dd={};!function(){if(fd)return dd;fd=1;var t=u(),e=w(),r=yf(),n=mr(),o=wf(),i=ie(),a=y(),s=t.RangeError,c=t.Int8Array,l=c&&c.prototype,f=l&&l.set,d=r.aTypedArray,p=r.exportTypedArrayMethod,h=!a(function(){var t=new Uint8ClampedArray(2);return e(f,t,{length:1,0:3},1),3!==t[1]}),v=h&&r.NATIVE_ARRAY_BUFFER_VIEWS&&a(function(){var t=new c(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]});p("set",function(t){d(this);var r=o(arguments.length>1?arguments[1]:void 0,1),a=i(t);if(h)return e(f,this,a,r);var u=this.length,c=n(a),l=0;if(c+r>u)throw new s("Wrong length");for(;l<c;)this[r+l]=a[l++]},!h||v)}();var pd,hd={};!function(){if(pd)return hd;pd=1;var t=yf(),e=y(),r=so(),n=t.aTypedArray,o=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("slice",function(t,e){for(var i=r(n(this),t,e),a=o(this),u=0,s=i.length,c=new a(s);s>u;)c[u]=i[u++];return c},e(function(){new Int8Array(1).slice()}))}();var vd,md={};!function(){if(vd)return md;vd=1;var t=yf(),e=na().some,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("some",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var yd,gd,bd,wd,Sd,kd,Ed,_d,Od,Td={};function Ad(){if(gd)return yd;gd=1;var t=so(),e=Math.floor,r=function(n,o){var i=n.length;if(i<8)for(var a,u,s=1;s<i;){for(u=s,a=n[s];u&&o(n[u-1],a)>0;)n[u]=n[--u];u!==s++&&(n[u]=a)}else for(var c=e(i/2),l=r(t(n,0,c),o),f=r(t(n,c),o),d=l.length,p=f.length,h=0,v=0;h<d||v<p;)n[h+v]=h<d&&v<p?o(l[h],f[v])<=0?l[h++]:f[v++]:h<d?l[h++]:f[v++];return n};return yd=r}function xd(){if(wd)return bd;wd=1;var t=St().match(/firefox\/(\d+)/i);return bd=!!t&&+t[1]}function Pd(){if(kd)return Sd;kd=1;var t=St();return Sd=/MSIE|Trident/.test(t)}function Rd(){if(_d)return Ed;_d=1;var t=St().match(/AppleWebKit\/(\d+)\./);return Ed=!!t&&+t[1]}!function(){if(Od)return Td;Od=1;var t=u(),e=Fr(),r=y(),n=At(),o=Ad(),i=yf(),a=xd(),s=Pd(),c=kt(),l=Rd(),f=i.aTypedArray,d=i.exportTypedArrayMethod,p=t.Uint16Array,h=p&&e(p.prototype.sort),v=!(!h||r(function(){h(new p(2),null)})&&r(function(){h(new p(2),{})})),m=!!h&&!r(function(){if(c)return c<74;if(a)return a<67;if(s)return!0;if(l)return l<602;var t,e,r=new p(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(h(r,function(t,e){return(t/4|0)-(e/4|0)}),t=0;t<516;t++)if(r[t]!==n[t])return!0});d("sort",function(t){return void 0!==t&&n(t),m?h(this,t):o(f(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))},!m||v)}();var Ud,Id={};!function(){if(Ud)return Id;Ud=1;var t=yf(),e=vr(),r=hr(),n=t.aTypedArray,o=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("subarray",function(t,i){var a=n(this),u=a.length,s=r(t,u);return new(o(a))(a.buffer,a.byteOffset+s*a.BYTES_PER_ELEMENT,e((void 0===i?u:r(i,u))-s))})}();var Cd,jd={};!function(){if(Cd)return jd;Cd=1;var t=u(),e=Cu(),r=yf(),n=y(),o=so(),i=t.Int8Array,a=r.aTypedArray,s=r.exportTypedArrayMethod,c=[].toLocaleString,l=!!i&&n(function(){c.call(new i(1))});s("toLocaleString",function(){return e(c,l?o(a(this)):a(this),o(arguments))},n(function(){return[1,2].toLocaleString()!==new i([1,2]).toLocaleString()})||!n(function(){i.prototype.toLocaleString.call([1,2])}))}();var Ld,Bd={};!function(){if(Ld)return Bd;Ld=1;var t=yf().exportTypedArrayMethod,e=y(),r=u(),n=ft(),o=r.Uint8Array,i=o&&o.prototype||{},a=[].toString,s=n([].join);e(function(){a.call({})})&&(a=function(){return s(this)});var c=i.toString!==a;t("toString",a,c)}();var Md=new Map,Nd=null;function Dd(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:t,event:e,severity:r.severity||"info",message:r.message||"",data:r.data||{}})}catch(t){console.warn("[Starmus] Telemetry emit failed:",t)}}function Fd(t){return qd.apply(this,arguments)}function qd(){return(qd=ma(Ea().m(function t(e){var r,n;return Ea().w(function(t){for(;;)switch(t.n){case 0:if((r=e.getAudioTracks&&e.getAudioTracks()||[]).length){t.n=1;break}return t.a(2);case 1:if("live"!==(n=r[0]).readyState){t.n=2;break}return t.a(2);case 2:return t.a(2,new Promise(function(t){var e=0,r=setInterval(function(){("live"===n.readyState||e>100)&&(clearInterval(r),t()),e+=1},50);setTimeout(function(){clearInterval(r),t()},5e3)}))}},t)}))).apply(this,arguments)}function zd(){var t=window.AudioContext||window.webkitAudioContext;if(!t)throw new Error("AudioContext not supported in this browser");if((!Nd||"closed"===Nd.state)&&(Nd=new t({latencyHint:"interactive"}),ua("[Recorder] Created AudioContext, state:",Nd.state),"function"!=typeof Nd.createMediaStreamSource))throw new Error("AudioContext lacks createMediaStreamSource");return Nd}function Hd(t){var e=zd(),r=e.createMediaStreamSource(t);try{var n=function(t){var e=t.createMediaStreamDestination||t.createMediaStreamAudioDestination;if("function"!=typeof e)throw new Error("MediaStreamDestination not supported");var r=e.call(t);if(!r||!r.stream)throw new Error("Destination stream invalid");return r}(e),o=e.createBiquadFilter();o.type="highpass",o.frequency.value=85;var i=e.createDynamicsCompressor();i.threshold.value=-20,i.knee.value=40,i.ratio.value=12,i.attack.value=0,i.release.value=.25;var a=e.createAnalyser();return a.fftSize=2048,r.connect(o),o.connect(i),i.connect(a),a.connect(n),{audioContext:e,destinationStream:n.stream,analyser:a,nodes:[r,o,i,a,n],fallbackActive:!1}}catch(n){ua("[Recorder] Audio graph failed â fallback to raw stream:",n.message);var u=e.createAnalyser();return u.fftSize=2048,r.connect(u),{audioContext:e,destinationStream:t,analyser:u,nodes:[r,u],fallbackActive:!0}}}function Gd(t,e){return Wd.apply(this,arguments)}function Wd(){return(Wd=ma(Ea().m(function t(e,r){var n,o,i,a,u,s;return Ea().w(function(t){for(;;)if(0===t.n)return n=zd(),(o=n.createAnalyser()).fftSize=2048,(i=n.createMediaStreamSource(e)).connect(o),a=new Float32Array(o.fftSize),u=[],s=performance.now(),t.a(2,new Promise(function(t){!function e(){if("running"===n.state){o.getFloatTimeDomainData(a);for(var c=0,l=0;l<a.length;l++)c+=a[l]*a[l];var f=Math.sqrt(c/a.length);if(isFinite(f)){u.push(f);var d=Math.min(100,2e3*f);r&&r("",d,!1),performance.now()-s<15e3?requestAnimationFrame(e):function(){var e=Math.max(1,Math.floor(u.length/3)),n=u.slice(0,e),a=u.slice(e,2*e),s=function(t){return t.length?t.reduce(function(t,e){return t+e},0)/t.length:0},c=s(n),l=s(a),f=l/Math.max(c,1e-6),d=f<3?6:Math.max(1,Math.min(4,.1/Math.max(l,1e-6))),p={gain:parseFloat(d.toFixed(3)),snr:parseFloat(f.toFixed(3)),noiseFloor:parseFloat(c.toFixed(6)),speechLevel:parseFloat(l.toFixed(6)),timestamp:(new Date).toISOString()};try{i.disconnect()}catch(t){}try{o.disconnect()}catch(t){}r&&r("",null,!0);t(p)}()}else requestAnimationFrame(e)}else requestAnimationFrame(e)}()}))},t)}))).apply(this,arguments)}function Vd(t,e){fa.unsubscribeInstance&&fa.unsubscribeInstance(e),fa.subscribe("setup-mic",function(){var r=ma(Ea().m(function r(n,o){var i,a,u,s,c;return Ea().w(function(r){for(;;)switch(r.p=r.n){case 0:if(o.instanceId===e){r.n=1;break}return r.a(2);case 1:if(navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia){r.n=2;break}return Dd(e,"E_RECORDER_UNSUPPORTED",{severity:"error",message:i="Microphone not supported."}),t.dispatch({type:"starmus/error",payload:{message:i,retryable:!1}}),r.a(2);case 2:return r.p=2,r.n=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:return a=r.v,Dd(e,"E_MIC_ACCESS",{severity:"info",message:"Mic access granted â calibrating"}),t.dispatch({type:"starmus/calibration-start"}),r.n=4,Gd(a,function(e,r,n){t.dispatch({type:"starmus/calibration-update",message:e,volumePercent:r})});case 4:u=r.v,a.getTracks().forEach(function(t){return t.stop()}),t.dispatch({type:"starmus/calibration-complete",payload:{calibration:u},calibration:u}),r.n=6;break;case 5:r.p=5,c=r.v,s="NotAllowedError"===c.name?"Microphone permission denied.":"Failed to access microphone.",Dd(e,"E_MIC_ACCESS",{severity:"error",message:s,data:{error:c.message}}),t.dispatch({type:"starmus/error",payload:{message:s,retryable:!0}});case 6:return r.a(2)}},r,null,[[2,5]])}));return function(t,e){return r.apply(this,arguments)}}()),fa.subscribe("start-recording",function(){var r=ma(Ea().m(function r(n,o){var i,a,u,s,c,l,f,d,p,h,v;return Ea().w(function(r){for(;;)switch(r.p=r.n){case 0:if(o.instanceId===e){r.n=1;break}return r.a(2);case 1:if("calibrating"!==(i=t.getState()).status){r.n=2;break}return t.dispatch({type:"starmus/error",payload:{message:"Please wait for calibration to complete.",retryable:!0}}),r.a(2);case 2:if(i.calibration&&i.calibration.complete){r.n=3;break}return t.dispatch({type:"starmus/error",payload:{message:"Please setup your microphone first.",retryable:!0}}),r.a(2);case 3:return r.p=3,a=function(){var r=Md.get(e);if(r&&"recording"===r.mediaRecorder.state){try{d.getFloatTimeDomainData(p);for(var n=0,o=0;o<p.length;o++)n+=p[o]*p[o];var i=Math.sqrt(n/p.length),u=Math.min(100,4e3*i),s=(performance.now()-h)/1e3;t.dispatch({type:"starmus/recorder-tick",duration:s,amplitude:u})}catch(t){}r.rafId=requestAnimationFrame(a)}},r.n=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:if(u=r.v,"suspended"!==(s=Hd(u)).audioContext.state){r.n=5;break}return r.n=5,s.audioContext.resume();case 5:return r.n=6,Fd(s.destinationStream);case 6:if(c=s.destinationStream,c.getAudioTracks().length){r.n=7;break}throw new Error("No audio tracks available");case 7:l=new MediaRecorder(c),f=[],l.ondataavailable=function(t){t.data&&t.data.size>0&&f.push(t.data)},l.onstop=function(){var r=Md.get(e);if(r){r.rafId&&cancelAnimationFrame(r.rafId);var n=new Blob(f,{type:l.mimeType||"audio/webm"}),o="starmus-recording-".concat(Date.now(),".webm");Dd(e,"REC_COMPLETE",{severity:"info",message:"Recording stopped and blob created",data:{mimeType:l.mimeType||"audio/webm",chunkCount:f.length}}),t.dispatch({type:"starmus/recording-available",payload:{blob:n,fileName:o}}),u.getTracks().forEach(function(t){return t.stop()}),c.getTracks().forEach(function(t){return t.stop()}),s.nodes.forEach(function(t){try{t.disconnect()}catch(t){}}),Md.delete(e)}},Md.set(e,{mediaRecorder:l,rawStream:u,graph:s,rafId:null}),l.start(3e3),t.dispatch({type:"starmus/mic-start"}),d=s.analyser,p=new Float32Array(d.fftSize),h=performance.now(),requestAnimationFrame(a),r.n=9;break;case 8:r.p=8,v=r.v,console.error("[Recorder] ERROR start-recording:",v),Dd(e,"E_RECORDER_START_FAIL",{severity:"error",message:v.message}),t.dispatch({type:"starmus/error",payload:{message:"Recording failed to start.",retryable:!0}});case 9:return r.a(2)}},r,null,[[3,8]])}));return function(t,e){return r.apply(this,arguments)}}()),fa.subscribe("stop-mic",function(r,n){if(n.instanceId===e){var o=Md.get(e);o&&o.mediaRecorder&&"recording"===o.mediaRecorder.state&&(o.mediaRecorder.stop(),t.dispatch({type:"starmus/mic-stop"}))}}),fa.subscribe("pause-mic",function(r,n){if(n.instanceId===e){var o=Md.get(e);o&&o.mediaRecorder&&"recording"===o.mediaRecorder.state&&"function"==typeof o.mediaRecorder.pause&&(t.dispatch({type:"starmus/mic-pause"}),o.mediaRecorder.pause())}}),fa.subscribe("resume-mic",function(r,n){if(n.instanceId===e){var o=Md.get(e);o&&o.mediaRecorder&&"paused"===o.mediaRecorder.state&&"function"==typeof o.mediaRecorder.resume&&(t.dispatch({type:"starmus/mic-resume"}),o.mediaRecorder.resume())}}),fa.subscribe("reset",function(t,r){if(r.instanceId===e){var n=Md.get(e);if(n){try{n.mediaRecorder&&"inactive"!==n.mediaRecorder.state&&n.mediaRecorder.stop()}catch(t){}n.rafId&&cancelAnimationFrame(n.rafId),n.rawStream&&n.rawStream.getTracks().forEach(function(t){return t.stop()}),n.graph&&n.graph.destinationStream&&n.graph.destinationStream.getTracks().forEach(function(t){return t.stop()}),n.graph&&n.graph.nodes&&n.graph.nodes.forEach(function(t){try{t.disconnect()}catch(t){}}),Md.delete(e)}}})}var $d=window.StarmusHooks||window.CommandBus,Jd=$d&&$d.debugLog?$d.debugLog:function(){},Yd=function(){return ga(function t(e,r,n){ya(this,t),this.peaks=e,this.container=document.getElementById(r),this.data=Array.isArray(n)?n:[],this.activeTokenIndex=-1,this.isUserScrolling=!1,this.scrollTimeout=null,this.boundOnTimeUpdate=null,this.boundOnSeeked=null,this.boundOnClick=null,this.boundOnScroll=null,this.init()},[{key:"init",value:function(){this.container?(this.render(),this.bindEvents()):console.warn("[StarmusTranscript] Container not found. Transcript sync disabled.")}},{key:"render",value:function(){var t=this,e=document.createDocumentFragment();this.data.forEach(function(r,n){var o=document.createElement("span");o.textContent=r.text,o.className="starmus-word",o.dataset.index=n,o.dataset.start=r.start,o.dataset.end=r.end,"confidence"in r&&r.confidence<.8&&(o.dataset.confidence="low",o.title="Low confidence: ".concat(Math.round(100*r.confidence),"%")),e.appendChild(o),n<t.data.length-1&&e.appendChild(document.createTextNode(" "))}),this.container.innerHTML="",this.container.appendChild(e),this.activeTokenIndex=-1}},{key:"bindEvents",value:function(){var t=this;this.boundOnClick=function(e){var r=e.target;if(r.classList.contains("starmus-word")){var n=parseFloat(r.dataset.start);t.peaks&&t.peaks.player&&"function"==typeof t.peaks.player.seek&&(t.peaks.player.seek(n),$d&&"function"==typeof $d.dispatch&&$d.dispatch("starmus/transcript/seek",{time:n},{instanceId:t.peaks.instanceId}))}},this.container.addEventListener("click",this.boundOnClick),this.boundOnScroll=function(){t.isUserScrolling=!0,t.scrollTimeout&&clearTimeout(t.scrollTimeout),t.scrollTimeout=setTimeout(function(){t.isUserScrolling=!1},1e3)},this.container.addEventListener("scroll",this.boundOnScroll);var e=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;e&&"function"==typeof e.addEventListener?(this.boundOnTimeUpdate=function(){var r=e.currentTime;"number"!=typeof r||isNaN(r)||t.syncHighlight(r)},e.addEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked=function(){var r=e.currentTime;"number"!=typeof r||isNaN(r)||t.syncHighlight(r)},e.addEventListener("seeked",this.boundOnSeeked)):Jd("[StarmusTranscript] Player media element not found â sync disabled")}},{key:"findTokenIndex",value:function(t){if("number"!=typeof t||0===this.data.length)return-1;for(var e=0,r=this.data.length-1;e<=r;){var n=e+r>>1,o=this.data[n];if(t>=o.start&&t<=o.end)return n;t<o.start?r=n-1:e=n+1}return-1}},{key:"syncHighlight",value:function(t){var e=this.findTokenIndex(t);-1===e?this.clearHighlight():e!==this.activeTokenIndex&&this.updateDOM(e)}},{key:"updateDOM",value:function(t){var e=this.container.querySelectorAll(".starmus-word");this.activeTokenIndex>=0&&e[this.activeTokenIndex]&&e[this.activeTokenIndex].classList.remove("is-active"),this.activeTokenIndex=t;var r=e[t];r&&(r.classList.add("is-active"),this.isUserScrolling||this.scrollToWord(r))}},{key:"clearHighlight",value:function(){var t=this.container.querySelector(".starmus-word.is-active");t&&t.classList.remove("is-active"),this.activeTokenIndex=-1}},{key:"scrollToWord",value:function(t){t.scrollIntoView&&t.scrollIntoView({block:"center",behavior:"smooth"})}},{key:"updateData",value:function(t){this.data=Array.isArray(t)?t:[],this.render(),this.unbindEvents(),this.bindEvents()}},{key:"unbindEvents",value:function(){if(this.container){this.boundOnClick&&this.container.removeEventListener("click",this.boundOnClick),this.boundOnScroll&&this.container.removeEventListener("scroll",this.boundOnScroll);var t=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;t&&"function"==typeof t.removeEventListener&&(this.boundOnTimeUpdate&&t.removeEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked&&t.removeEventListener("seeked",this.boundOnSeeked))}}},{key:"destroy",value:function(){this.unbindEvents(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.container&&(this.container.innerHTML=""),this.data=[],this.activeTokenIndex=-1,this.isUserScrolling=!1}}])}();function Kd(t,e,r){return new Yd(t,e,r)}function Qd(t,e){Object.keys(t).forEach(function(r){var n=t[r],o=e.querySelector('input[name="'.concat(r,'"]'));if(o||((o=document.createElement("input")).type="hidden",o.name=r,e.appendChild(o)),null==n)o.value="";else if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)o.value=String(n);else try{o.value=JSON.stringify(n)}catch(t){console.warn("[StarmusMetadataAuto] Could not serialize field",r,n),o.value=""}})}function Xd(t,e){t&&Array.isArray(e)&&1===t.nodeType?e.forEach(function(e){try{var r=t.querySelector('input[name="'.concat(e,'"]'));r&&r.parentNode&&(t.contains(r)?(r.parentNode.removeChild(r),console.debug("[StarmusMetadataAuto] Removed field:",e)):console.debug("[StarmusMetadataAuto] Field not a child of form:",e))}catch(t){console.warn("[StarmusMetadataAuto] Could not remove field",e,t.message)}}):console.warn("[StarmusMetadataAuto] Invalid form element or field names for clearHiddenFields")}function Zd(t){var e,r,n,o,i,a,u,s,c,l,f,d,p,h,v,m,y,g,b,w,S,k,E,_,O=new Date,T=O.toISOString().split("T")[0],A=O.toISOString();return{starmus_title:(null===(e=t.source)||void 0===e?void 0:e.title)||"",starmus_language:(null===(r=t.source)||void 0===r?void 0:r.language)||"",starmus_recording_type:(null===(n=t.source)||void 0===n?void 0:n.type)||"",audio_file_type:(null===(o=t.submission)||void 0===o||null===(o=o.blob)||void 0===o?void 0:o.type)||"audio/webm",agreement_to_terms:null!==(i=t.user)&&void 0!==i&&i.agreedToTerms?"1":"0",_starmus_calibration:t.calibration||{},_starmus_env:t.env||{},first_pass_transcription:(null===(a=t.source)||void 0===a?void 0:a.transcript)||"",recording_metadata:(null===(u=t.source)||void 0===u?void 0:u.metadata)||{},waveform_json:(null===(s=t.source)||void 0===s?void 0:s.waveform)||{},project_collection_id:(null===(c=t.submission)||void 0===c?void 0:c.collectionId)||"",accession_number:(null===(l=t.submission)||void 0===l?void 0:l.accession)||"",session_date:T,session_start_time:(null===(f=t.recorder)||void 0===f?void 0:f.startTime)||A,session_end_time:(null===(d=t.recorder)||void 0===d?void 0:d.endTime)||A,location:(null===(p=t.source)||void 0===p?void 0:p.location)||"",gps_coordinates:(null===(h=t.source)||void 0===h?void 0:h.gps)||"",contributor_id:(null===(v=t.user)||void 0===v?void 0:v.id)||"",interviewers_recorders:(null===(m=t.source)||void 0===m?void 0:m.interviewers)||"",recording_equipment:(null===(y=t.source)||void 0===y?void 0:y.equipment)||"",audio_files_originals:(null===(g=t.source)||void 0===g?void 0:g.originals)||[],media_condition_notes:(null===(b=t.source)||void 0===b?void 0:b.conditionNotes)||"",related_consent_agreement:(null===(w=t.source)||void 0===w?void 0:w.consent)||"",usage_restrictions_rights:(null===(S=t.source)||void 0===S?void 0:S.usageRights)||"",access_level:(null===(k=t.submission)||void 0===k?void 0:k.accessLevel)||"",audio_quality_score:(null===(E=t.submission)||void 0===E?void 0:E.qualityScore)||"",mic_rest_adjustments:(null===(_=t.calibration)||void 0===_?void 0:_.adjustments)||"",device:navigator.userAgent,user_agent:navigator.userAgent}}function tp(t,e){var r=[];return e.forEach(function(e){var n=t[e];(null==n||"string"==typeof n&&""===n.trim()||Array.isArray(n)&&0===n.length)&&r.push(e)}),{valid:0===r.length,missing:r}}function ep(t,e,r){if(t&&"function"==typeof t.getState&&"function"==typeof t.subscribe){if(e instanceof HTMLFormElement){var n=r||{},o=Array.isArray(n.trigger)?n.trigger:[n.trigger||"ready_to_submit"],i=Array.isArray(n.clearOn)?n.clearOn:[n.clearOn||"reset"],a=Array.isArray(n.requiredFields)?n.requiredFields:[],u=null,s=t.subscribe(c);return c(),s}console.warn("[StarmusMetadataAuto] Invalid form element â must be HTMLFormElement")}else console.warn("[StarmusMetadataAuto] Invalid store â cannot init auto metadata");function c(){var r=t.getState(),n=r.status;if(i.includes(n)&&Xd(e,Object.keys(Zd(r))),n!==u&&o.includes(n)){u=n;var s=Zd(r),c=a.length?tp(s,a):{valid:!0,missing:[]},l=c.valid,f=c.missing;l||console.warn("[StarmusMetadataAuto] Missing required metadata fields:",f),Qd(s,e)}else u=n}}"undefined"!=typeof window&&(window.StarmusTranscript=Yd,window.StarmusTranscriptController={StarmusTranscript:Yd,init:Kd}),"undefined"!=typeof module&&module.exports&&(module.exports={StarmusTranscript:Yd,init:Kd}),"undefined"!=typeof window&&(window.StarmusMetadataAuto={initAutoMetadata:ep,populateHiddenFields:Qd,buildMetadataMap:Zd,validateMetadata:tp,clearHiddenFields:Xd});var rp,np,op,ip,ap,up,sp,cp,lp,fp,dp={};function pp(){if(np)return rp;np=1;var t=y(),e=se(),r=g(),n=ee(),o=e("iterator");return rp=!t(function(){var t=new URL("b?a=1&b=2&c=3","https://a"),e=t.searchParams,i=new URLSearchParams("a=1&a=2&b=3"),a="";return t.pathname="c%20d",e.forEach(function(t,r){e.delete("b"),a+=r+t}),i.delete("a",2),i.delete("b",void 0),n&&(!t.toJSON||!i.has("a",1)||i.has("a",2)||!i.has("a",void 0)||i.has("b"))||!e.size&&(n||!r)||!e.sort||"https://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("https://a#Ð±").hash||"a1c3"!==a||"x"!==new URL("https://x",void 0).host}),rp}function hp(){if(up)return ap;up=1;var t=Ee(),e=Ei();return ap=function(r,n,o,i){try{return i?n(t(o)[0],o[1]):n(o)}catch(t){e(r,"throw",t)}}}function vp(){if(cp)return sp;cp=1;var t=bi(),e=w(),r=ie(),n=hp(),o=wi(),i=io(),a=mr(),u=ao(),s=ki(),c=Si(),l=Array;return sp=function(f){var d=r(f),p=i(this),h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v;m&&(v=t(v,h>2?arguments[2]:void 0));var y,g,b,w,S,k,E=c(d),_=0;if(!E||this===l&&o(E))for(y=a(d),g=p?new this(y):l(y);y>_;_++)k=m?v(d[_],_):d[_],u(g,_,k);else for(g=p?new this:[],S=(w=s(d,E)).next;!(b=e(S,w)).done;_++)k=m?n(w,v,[b.value,_],!0):b.value,u(g,_,k);return g.length=_,g},sp}function mp(){if(fp)return lp;fp=1;var t=ft(),e=2147483647,r=/[^\0-\u007E]/,n=/[.\u3002\uFF0E\uFF61]/g,o="Overflow: input needs wider integers to process",i=RangeError,a=t(n.exec),u=Math.floor,s=String.fromCharCode,c=t("".charCodeAt),l=t([].join),f=t([].push),d=t("".replace),p=t("".split),h=t("".toLowerCase),v=function(t){return t+22+75*(t<26)},m=function(t,e,r){var n=0;for(t=r?u(t/700):t>>1,t+=u(t/e);t>455;)t=u(t/35),n+=36;return u(n+36*t/(t+38))},y=function(t){var r=[];t=function(t){for(var e=[],r=0,n=t.length;r<n;){var o=c(t,r++);if(o>=55296&&o<=56319&&r<n){var i=c(t,r++);56320==(64512&i)?f(e,((1023&o)<<10)+(1023&i)+65536):(f(e,o),r--)}else f(e,o)}return e}(t);var n,a,d=t.length,p=128,h=0,y=72;for(n=0;n<t.length;n++)(a=t[n])<128&&f(r,s(a));var g=r.length,b=g;for(g&&f(r,"-");b<d;){var w=e;for(n=0;n<t.length;n++)(a=t[n])>=p&&a<w&&(w=a);var S=b+1;if(w-p>u((e-h)/S))throw new i(o);for(h+=(w-p)*S,p=w,n=0;n<t.length;n++){if((a=t[n])<p&&++h>e)throw new i(o);if(a===p){for(var k=h,E=36;;){var _=E<=y?1:E>=y+26?26:E-y;if(k<_)break;var O=k-_,T=36-_;f(r,s(v(_+O%T))),k=u(O/T),E+=36}f(r,s(v(k))),y=m(h,S,b===g),h=0,b++}}h++,p++}return l(r,"")};return lp=function(t){var e,o,i=[],u=p(d(h(t),n,"."),".");for(e=0;e<u.length;e++)o=u[e],f(i,a(r,o)?"xn--"+y(o):o);return l(i,".")}}var yp,gp,bp,wp,Sp,kp={};function Ep(){if(bp)return gp;bp=1,Dn(),function(){if(yp)return kp;yp=1;var t=Dr(),e=ft(),r=hr(),n=RangeError,o=String.fromCharCode,i=String.fromCodePoint,a=e([].join);t({target:"String",stat:!0,arity:1,forced:!!i&&1!==i.length},{fromCodePoint:function(t){for(var e,i=[],u=arguments.length,s=0;u>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw new n(e+" is not a valid code point");i[s]=e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320)}return a(i,"")}})}();var t=Dr(),e=u(),r=Mu(),n=bt(),o=w(),i=ft(),a=g(),s=pp(),c=Je(),l=Pi(),f=Ri(),d=In(),p=Cn(),h=Ve(),v=Oi(),m=yt(),y=ae(),b=bi(),S=oo(),k=Ee(),E=gt(),_=Di(),O=An(),T=lt(),A=ki(),x=Si(),P=Nn(),R=ju(),U=se(),I=Ad(),C=U("iterator"),j="URLSearchParams",L=j+"Iterator",B=h.set,M=h.getterFor(j),N=h.getterFor(L),D=r("fetch"),F=r("Request"),q=r("Headers"),z=F&&F.prototype,H=q&&q.prototype,G=e.TypeError,W=e.encodeURIComponent,V=String.fromCharCode,$=n("String","fromCodePoint"),J=parseInt,Y=i("".charAt),K=i([].join),Q=i([].push),X=i("".replace),Z=i([].shift),tt=i([].splice),et=i("".split),rt=i("".slice),nt=i(/./.exec),ot=/\+/g,it=/^[0-9a-f]+$/i,at=function(t,e){var r=rt(t,e,e+2);return nt(it,r)?J(r,16):NaN},ut=function(t){for(var e=0,r=128;r>0&&0!==(t&r);r>>=1)e++;return e},st=function(t){var e=null;switch(t.length){case 1:e=t[0];break;case 2:e=(31&t[0])<<6|63&t[1];break;case 3:e=(15&t[0])<<12|(63&t[1])<<6|63&t[2];break;case 4:e=(7&t[0])<<18|(63&t[1])<<12|(63&t[2])<<6|63&t[3]}return e>1114111?null:e},ct=function(t){for(var e=(t=X(t,ot," ")).length,r="",n=0;n<e;){var o=Y(t,n);if("%"===o){if("%"===Y(t,n+1)||n+3>e){r+="%",n++;continue}var i=at(t,n+1);if(i!=i){r+=o,n++;continue}n+=2;var a=ut(i);if(0===a)o=V(i);else{if(1===a||a>4){r+="ï¿½",n++;continue}for(var u=[i],s=1;s<a&&!(++n+3>e||"%"!==Y(t,n));){var c=at(t,n+1);if(c!=c){n+=3;break}if(c>191||c<128)break;Q(u,c),n+=2,s++}if(u.length!==a){r+="ï¿½";continue}var l=st(u);null===l?r+="ï¿½":o=$(l)}}r+=o,n++}return r},dt=/[!'()~]|%20/g,pt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ht=function(t){return pt[t]},vt=function(t){return X(W(t),dt,ht)},mt=p(function(t,e){B(this,{type:L,target:M(t).entries,index:0,kind:e})},j,function(){var t=N(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,P(void 0,!0);var n=e[r];switch(t.kind){case"keys":return P(n.key,!1);case"values":return P(n.value,!1)}return P([n.key,n.value],!1)},!0),wt=function(t){this.entries=[],this.url=null,void 0!==t&&(E(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===Y(t,0)?rt(t,1):t:_(t)))};wt.prototype={type:j,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,r,n,i,a,u,s,c=this.entries,l=x(t);if(l)for(r=(e=A(t,l)).next;!(n=o(r,e)).done;){if(a=(i=A(k(n.value))).next,(u=o(a,i)).done||(s=o(a,i)).done||!o(a,i).done)throw new G("Expected sequence with length 2");Q(c,{key:_(u.value),value:_(s.value)})}else for(var f in t)y(t,f)&&Q(c,{key:f,value:_(t[f])})},parseQuery:function(t){if(t)for(var e,r,n=this.entries,o=et(t,"&"),i=0;i<o.length;)(e=o[i++]).length&&(r=et(e,"="),Q(n,{key:ct(Z(r)),value:ct(K(r,"="))}))},serialize:function(){for(var t,e=this.entries,r=[],n=0;n<e.length;)t=e[n++],Q(r,vt(t.key)+"="+vt(t.value));return K(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var St=function(){v(this,kt);var t=B(this,new wt(arguments.length>0?arguments[0]:void 0));a||(this.size=t.entries.length)},kt=St.prototype;if(f(kt,{append:function(t,e){var r=M(this);R(arguments.length,2),Q(r.entries,{key:_(t),value:_(e)}),a||this.size++,r.updateURL()},delete:function(t){for(var e=M(this),r=R(arguments.length,1),n=e.entries,o=_(t),i=r<2?void 0:arguments[1],u=void 0===i?i:_(i),s=0;s<n.length;){var c=n[s];if(c.key!==o||void 0!==u&&c.value!==u)s++;else if(tt(n,s,1),void 0!==u)break}a||(this.size=n.length),e.updateURL()},get:function(t){var e=M(this).entries;R(arguments.length,1);for(var r=_(t),n=0;n<e.length;n++)if(e[n].key===r)return e[n].value;return null},getAll:function(t){var e=M(this).entries;R(arguments.length,1);for(var r=_(t),n=[],o=0;o<e.length;o++)e[o].key===r&&Q(n,e[o].value);return n},has:function(t){for(var e=M(this).entries,r=R(arguments.length,1),n=_(t),o=r<2?void 0:arguments[1],i=void 0===o?o:_(o),a=0;a<e.length;){var u=e[a++];if(u.key===n&&(void 0===i||u.value===i))return!0}return!1},set:function(t,e){var r=M(this);R(arguments.length,1);for(var n,o=r.entries,i=!1,u=_(t),s=_(e),c=0;c<o.length;c++)(n=o[c]).key===u&&(i?tt(o,c--,1):(i=!0,n.value=s));i||Q(o,{key:u,value:s}),a||(this.size=o.length),r.updateURL()},sort:function(){var t=M(this);I(t.entries,function(t,e){return t.key>e.key?1:-1}),t.updateURL()},forEach:function(t){for(var e,r=M(this).entries,n=b(t,arguments.length>1?arguments[1]:void 0),o=0;o<r.length;)n((e=r[o++]).value,e.key,this)},keys:function(){return new mt(this,"keys")},values:function(){return new mt(this,"values")},entries:function(){return new mt(this,"entries")}},{enumerable:!0}),c(kt,C,kt.entries,{name:"entries"}),c(kt,"toString",function(){return M(this).serialize()},{enumerable:!0}),a&&l(kt,"size",{get:function(){return M(this).entries.length},configurable:!0,enumerable:!0}),d(St,j),t({global:!0,constructor:!0,forced:!s},{URLSearchParams:St}),!s&&m(q)){var Et=i(H.has),_t=i(H.set),Ot=function(t){if(E(t)){var e,r=t.body;if(S(r)===j)return e=t.headers?new q(t.headers):new q,Et(e,"content-type")||_t(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),O(t,{body:T(0,_(r)),headers:T(0,e)})}return t};if(m(D)&&t({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return D(t,arguments.length>1?Ot(arguments[1]):{})}}),m(F)){var Tt=function(t){return v(this,z),new F(t,arguments.length>1?Ot(arguments[1]):{})};z.constructor=Tt,Tt.prototype=z,t({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Tt})}}return gp={URLSearchParams:St,getState:M}}function _p(){if(wp)return dp;wp=1,qi();var t,e=Dr(),r=g(),n=pp(),o=u(),i=bi(),a=ft(),s=Je(),c=Pi(),l=Oi(),f=ae(),d=function(){if(ip)return op;ip=1;var t=g(),e=ft(),r=w(),n=y(),o=On(),i=Br(),a=ct(),u=ie(),s=pt(),c=Object.assign,l=Object.defineProperty,f=e([].concat);return op=!c||n(function(){if(t&&1!==c({b:1},c(l({},"a",{enumerable:!0,get:function(){l(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},r={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(t){r[t]=t}),7!==c({},e)[n]||o(c({},r)).join("")!==i})?function(e,n){for(var c=u(e),l=arguments.length,d=1,p=i.f,h=a.f;l>d;)for(var v,m=s(arguments[d++]),y=p?f(o(m),p(m)):o(m),g=y.length,b=0;g>b;)v=y[b++],t&&!r(h,m,v)||(c[v]=m[v]);return c}:c,op}(),p=vp(),h=so(),v=Fi().codeAt,m=mp(),b=Di(),S=In(),k=ju(),E=Ep(),_=Ve(),O=_.set,T=_.getterFor("URL"),A=E.URLSearchParams,x=E.getState,P=o.URL,R=o.TypeError,U=o.parseInt,I=Math.floor,C=Math.pow,j=a("".charAt),L=a(/./.exec),B=a([].join),M=a(1.1.toString),N=a([].pop),D=a([].push),F=a("".replace),q=a([].shift),z=a("".split),H=a("".slice),G=a("".toLowerCase),W=a([].unshift),V="Invalid scheme",$="Invalid host",J="Invalid port",Y=/[a-z]/i,K=/[\d+-.a-z]/i,Q=/\d/,X=/^0x/i,Z=/^[0-7]+$/,tt=/^\d+$/,et=/^[\da-f]+$/i,rt=/[\0\t\n\r #%/:<>?@[\\\]^|]/,nt=/[\0\t\n\r #/:<>?@[\\\]^|]/,ot=/^[\u0000-\u0020]+/,it=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,at=/[\t\n\r]/g,ut=function(t){var e,r,n,o;if("number"==typeof t){for(e=[],r=0;r<4;r++)W(e,t%256),t=I(t/256);return B(e,".")}if("object"==typeof t){for(e="",n=function(t){for(var e=null,r=1,n=null,o=0,i=0;i<8;i++)0!==t[i]?(o>r&&(e=n,r=o),n=null,o=0):(null===n&&(n=i),++o);return o>r?n:e}(t),r=0;r<8;r++)o&&0===t[r]||(o&&(o=!1),n===r?(e+=r?":":"::",o=!0):(e+=M(t[r],16),r<7&&(e+=":")));return"["+e+"]"}return t},st={},lt=d({},st,{" ":1,'"':1,"<":1,">":1,"`":1}),dt=d({},lt,{"#":1,"?":1,"{":1,"}":1}),ht=d({},dt,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),vt=function(t,e){var r=v(t,0);return r>32&&r<127&&!f(e,t)?t:encodeURIComponent(t)},mt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},yt=function(t,e){var r;return 2===t.length&&L(Y,j(t,0))&&(":"===(r=j(t,1))||!e&&"|"===r)},gt=function(t){var e;return t.length>1&&yt(H(t,0,2))&&(2===t.length||"/"===(e=j(t,2))||"\\"===e||"?"===e||"#"===e)},bt=function(t){return"."===t||"%2e"===G(t)},wt=function(t){return".."===(t=G(t))||"%2e."===t||".%2e"===t||"%2e%2e"===t},St={},kt={},Et={},_t={},Ot={},Tt={},At={},xt={},Pt={},Rt={},Ut={},It={},Ct={},jt={},Lt={},Bt={},Mt={},Nt={},Dt={},Ft={},qt={},zt=function(t,e,r){var n,o,i,a=b(t);if(e){if(o=this.parse(a))throw new R(o);this.searchParams=null}else{if(void 0!==r&&(n=new zt(r,!0)),o=this.parse(a,null,n))throw new R(o);(i=x(new A)).bindURL(this),this.searchParams=i}};zt.prototype={type:"URL",parse:function(e,r,n){var o,i,a,u,s=this,c=r||St,l=0,d="",v=!1,m=!1,y=!1;for(e=b(e),r||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=F(e,ot,""),e=F(e,it,"$1")),e=F(e,at,""),o=p(e);l<=o.length;){switch(i=o[l],c){case St:if(!i||!L(Y,i)){if(r)return V;c=Et;continue}d+=G(i),c=kt;break;case kt:if(i&&(L(K,i)||"+"===i||"-"===i||"."===i))d+=G(i);else{if(":"!==i){if(r)return V;d="",c=Et,l=0;continue}if(r&&(s.isSpecial()!==f(mt,d)||"file"===d&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=d,r)return void(s.isSpecial()&&mt[s.scheme]===s.port&&(s.port=null));d="","file"===s.scheme?c=jt:s.isSpecial()&&n&&n.scheme===s.scheme?c=_t:s.isSpecial()?c=xt:"/"===o[l+1]?(c=Ot,l++):(s.cannotBeABaseURL=!0,D(s.path,""),c=Dt)}break;case Et:if(!n||n.cannotBeABaseURL&&"#"!==i)return V;if(n.cannotBeABaseURL&&"#"===i){s.scheme=n.scheme,s.path=h(n.path),s.query=n.query,s.fragment="",s.cannotBeABaseURL=!0,c=qt;break}c="file"===n.scheme?jt:Tt;continue;case _t:if("/"!==i||"/"!==o[l+1]){c=Tt;continue}c=Pt,l++;break;case Ot:if("/"===i){c=Rt;break}c=Nt;continue;case Tt:if(s.scheme=n.scheme,i===t)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=h(n.path),s.query=n.query;else if("/"===i||"\\"===i&&s.isSpecial())c=At;else if("?"===i)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=h(n.path),s.query="",c=Ft;else{if("#"!==i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=h(n.path),s.path.length--,c=Nt;continue}s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=h(n.path),s.query=n.query,s.fragment="",c=qt}break;case At:if(!s.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,c=Nt;continue}c=Rt}else c=Pt;break;case xt:if(c=Pt,"/"!==i||"/"!==j(d,l+1))continue;l++;break;case Pt:if("/"!==i&&"\\"!==i){c=Rt;continue}break;case Rt:if("@"===i){v&&(d="%40"+d),v=!0,a=p(d);for(var g=0;g<a.length;g++){var w=a[g];if(":"!==w||y){var S=vt(w,ht);y?s.password+=S:s.username+=S}else y=!0}d=""}else if(i===t||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()){if(v&&""===d)return"Invalid authority";l-=p(d).length+1,d="",c=Ut}else d+=i;break;case Ut:case It:if(r&&"file"===s.scheme){c=Bt;continue}if(":"!==i||m){if(i===t||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()){if(s.isSpecial()&&""===d)return $;if(r&&""===d&&(s.includesCredentials()||null!==s.port))return;if(u=s.parseHost(d))return u;if(d="",c=Mt,r)return;continue}"["===i?m=!0:"]"===i&&(m=!1),d+=i}else{if(""===d)return $;if(u=s.parseHost(d))return u;if(d="",c=Ct,r===It)return}break;case Ct:if(!L(Q,i)){if(i===t||"/"===i||"?"===i||"#"===i||"\\"===i&&s.isSpecial()||r){if(""!==d){var k=U(d,10);if(k>65535)return J;s.port=s.isSpecial()&&k===mt[s.scheme]?null:k,d=""}if(r)return;c=Mt;continue}return J}d+=i;break;case jt:if(s.scheme="file","/"===i||"\\"===i)c=Lt;else{if(!n||"file"!==n.scheme){c=Nt;continue}switch(i){case t:s.host=n.host,s.path=h(n.path),s.query=n.query;break;case"?":s.host=n.host,s.path=h(n.path),s.query="",c=Ft;break;case"#":s.host=n.host,s.path=h(n.path),s.query=n.query,s.fragment="",c=qt;break;default:gt(B(h(o,l),""))||(s.host=n.host,s.path=h(n.path),s.shortenPath()),c=Nt;continue}}break;case Lt:if("/"===i||"\\"===i){c=Bt;break}n&&"file"===n.scheme&&!gt(B(h(o,l),""))&&(yt(n.path[0],!0)?D(s.path,n.path[0]):s.host=n.host),c=Nt;continue;case Bt:if(i===t||"/"===i||"\\"===i||"?"===i||"#"===i){if(!r&&yt(d))c=Nt;else if(""===d){if(s.host="",r)return;c=Mt}else{if(u=s.parseHost(d))return u;if("localhost"===s.host&&(s.host=""),r)return;d="",c=Mt}continue}d+=i;break;case Mt:if(s.isSpecial()){if(c=Nt,"/"!==i&&"\\"!==i)continue}else if(r||"?"!==i)if(r||"#"!==i){if(i!==t&&(c=Nt,"/"!==i))continue}else s.fragment="",c=qt;else s.query="",c=Ft;break;case Nt:if(i===t||"/"===i||"\\"===i&&s.isSpecial()||!r&&("?"===i||"#"===i)){if(wt(d)?(s.shortenPath(),"/"===i||"\\"===i&&s.isSpecial()||D(s.path,"")):bt(d)?"/"===i||"\\"===i&&s.isSpecial()||D(s.path,""):("file"===s.scheme&&!s.path.length&&yt(d)&&(s.host&&(s.host=""),d=j(d,0)+":"),D(s.path,d)),d="","file"===s.scheme&&(i===t||"?"===i||"#"===i))for(;s.path.length>1&&""===s.path[0];)q(s.path);"?"===i?(s.query="",c=Ft):"#"===i&&(s.fragment="",c=qt)}else d+=vt(i,dt);break;case Dt:"?"===i?(s.query="",c=Ft):"#"===i?(s.fragment="",c=qt):i!==t&&(s.path[0]+=vt(i,st));break;case Ft:r||"#"!==i?i!==t&&("'"===i&&s.isSpecial()?s.query+="%27":s.query+="#"===i?"%23":vt(i,st)):(s.fragment="",c=qt);break;case qt:i!==t&&(s.fragment+=vt(i,lt))}l++}},parseHost:function(t){var e,r,n;if("["===j(t,0)){if("]"!==j(t,t.length-1))return $;if(e=function(t){var e,r,n,o,i,a,u,s=[0,0,0,0,0,0,0,0],c=0,l=null,f=0,d=function(){return j(t,f)};if(":"===d()){if(":"!==j(t,1))return;f+=2,l=++c}for(;d();){if(8===c)return;if(":"!==d()){for(e=r=0;r<4&&L(et,d());)e=16*e+U(d(),16),f++,r++;if("."===d()){if(0===r)return;if(f-=r,c>6)return;for(n=0;d();){if(o=null,n>0){if(!("."===d()&&n<4))return;f++}if(!L(Q,d()))return;for(;L(Q,d());){if(i=U(d(),10),null===o)o=i;else{if(0===o)return;o=10*o+i}if(o>255)return;f++}s[c]=256*s[c]+o,2!==++n&&4!==n||c++}if(4!==n)return;break}if(":"===d()){if(f++,!d())return}else if(d())return;s[c++]=e}else{if(null!==l)return;f++,l=++c}}if(null!==l)for(a=c-l,c=7;0!==c&&a>0;)u=s[c],s[c--]=s[l+a-1],s[l+--a]=u;else if(8!==c)return;return s}(H(t,1,-1)),!e)return $;this.host=e}else if(this.isSpecial()){if(t=m(t),L(rt,t))return $;if(e=function(t){var e,r,n,o,i,a,u,s=z(t,".");if(s.length&&""===s[s.length-1]&&s.length--,(e=s.length)>4)return t;for(r=[],n=0;n<e;n++){if(""===(o=s[n]))return t;if(i=10,o.length>1&&"0"===j(o,0)&&(i=L(X,o)?16:8,o=H(o,8===i?1:2)),""===o)a=0;else{if(!L(10===i?tt:8===i?Z:et,o))return t;a=U(o,i)}D(r,a)}for(n=0;n<e;n++)if(a=r[n],n===e-1){if(a>=C(256,5-e))return null}else if(a>255)return null;for(u=N(r),n=0;n<r.length;n++)u+=r[n]*C(256,3-n);return u}(t),null===e)return $;this.host=e}else{if(L(nt,t))return $;for(e="",r=p(t),n=0;n<r.length;n++)e+=vt(r[n],st);this.host=e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return f(mt,this.scheme)},shortenPath:function(){var t=this.path,e=t.length;!e||"file"===this.scheme&&1===e&&yt(t[0],!0)||t.length--},serialize:function(){var t=this,e=t.scheme,r=t.username,n=t.password,o=t.host,i=t.port,a=t.path,u=t.query,s=t.fragment,c=e+":";return null!==o?(c+="//",t.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=ut(o),null!==i&&(c+=":"+i)):"file"===e&&(c+="//"),c+=t.cannotBeABaseURL?a[0]:a.length?"/"+B(a,"/"):"",null!==u&&(c+="?"+u),null!==s&&(c+="#"+s),c},setHref:function(t){var e=this.parse(t);if(e)throw new R(e);this.searchParams.update()},getOrigin:function(){var t=this.scheme,e=this.port;if("blob"===t)try{return new Ht(t.path[0]).origin}catch(t){return"null"}return"file"!==t&&this.isSpecial()?t+"://"+ut(this.host)+(null!==e?":"+e:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(b(t)+":",St)},getUsername:function(){return this.username},setUsername:function(t){var e=p(b(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<e.length;r++)this.username+=vt(e[r],ht)}},getPassword:function(){return this.password},setPassword:function(t){var e=p(b(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<e.length;r++)this.password+=vt(e[r],ht)}},getHost:function(){var t=this.host,e=this.port;return null===t?"":null===e?ut(t):ut(t)+":"+e},setHost:function(t){this.cannotBeABaseURL||this.parse(t,Ut)},getHostname:function(){var t=this.host;return null===t?"":ut(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,It)},getPort:function(){var t=this.port;return null===t?"":b(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""===(t=b(t))?this.port=null:this.parse(t,Ct))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+B(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,Mt))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""===(t=b(t))?this.query=null:("?"===j(t,0)&&(t=H(t,1)),this.query="",this.parse(t,Ft)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!==(t=b(t))?("#"===j(t,0)&&(t=H(t,1)),this.fragment="",this.parse(t,qt)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ht=function(t){var e=l(this,Gt),n=k(arguments.length,1)>1?arguments[1]:void 0,o=O(e,new zt(t,!1,n));r||(e.href=o.serialize(),e.origin=o.getOrigin(),e.protocol=o.getProtocol(),e.username=o.getUsername(),e.password=o.getPassword(),e.host=o.getHost(),e.hostname=o.getHostname(),e.port=o.getPort(),e.pathname=o.getPathname(),e.search=o.getSearch(),e.searchParams=o.getSearchParams(),e.hash=o.getHash())},Gt=Ht.prototype,Wt=function(t,e){return{get:function(){return T(this)[t]()},set:e&&function(t){return T(this)[e](t)},configurable:!0,enumerable:!0}};if(r&&(c(Gt,"href",Wt("serialize","setHref")),c(Gt,"origin",Wt("getOrigin")),c(Gt,"protocol",Wt("getProtocol","setProtocol")),c(Gt,"username",Wt("getUsername","setUsername")),c(Gt,"password",Wt("getPassword","setPassword")),c(Gt,"host",Wt("getHost","setHost")),c(Gt,"hostname",Wt("getHostname","setHostname")),c(Gt,"port",Wt("getPort","setPort")),c(Gt,"pathname",Wt("getPathname","setPathname")),c(Gt,"search",Wt("getSearch","setSearch")),c(Gt,"searchParams",Wt("getSearchParams")),c(Gt,"hash",Wt("getHash","setHash"))),s(Gt,"toJSON",function(){return T(this).serialize()},{enumerable:!0}),s(Gt,"toString",function(){return T(this).serialize()},{enumerable:!0}),P){var Vt=P.createObjectURL,$t=P.revokeObjectURL;Vt&&s(Ht,"createObjectURL",i(Vt,P)),$t&&s(Ht,"revokeObjectURL",i($t,P))}return S(Ht,"URL"),e({global:!0,constructor:!0,forced:!n,sham:!r},{URL:Ht}),dp}Sp||(Sp=1,_p());var Op,Tp={};!function(){if(Op)return Tp;Op=1;var t=Dr(),e=w();t({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return e(URL.prototype.toString,this)}})}();var Ap;function xp(t){return xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xp(t)}function Pp(t,e,r){return e=Cp(e),function(t,e){if(e&&("object"===xp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Up()?Reflect.construct(e,r||[],Cp(t).constructor):e.apply(t,r))}function Rp(t){var e="function"==typeof Map?new Map:void 0;return Rp=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(Up())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&Ip(o,r.prototype),o}(t,arguments,Cp(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ip(r,t)},Rp(t)}function Up(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Up=function(){return!!t})()}function Ip(t,e){return Ip=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ip(t,e)}function Cp(t){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cp(t)}Ap||(Ap=1,Ep());var jp=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pp(this,e,[t])).originalRequest=o,r.originalResponse=i,r.causingError=n,null!=n&&(t+=", caused by ".concat(n.toString())),null!=o){var a=o.getHeader("X-Request-ID")||"n/a",u=o.getMethod(),s=o.getURL(),c=i?i.getStatus():"n/a",l=i?i.getBody()||"":"n/a";t+=", originated from request (method: ".concat(u,", url: ").concat(s,", response code: ").concat(c,", response text: ").concat(l,", request id: ").concat(a,")")}return r.message=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ip(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Rp(Error)),Lp=!1;function Bp(t){Lp&&console.log(t)}function Mp(t){return Mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mp(t)}function Np(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dp(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dp(t){var e=function(t,e){if("object"!=Mp(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=Mp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==Mp(e)?e:e+""}var Fp=function(){return Np(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,e){return Promise.resolve(null)}}])}();const qp="function"==typeof Buffer,zp=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),Hp=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Gp=(t=>{let e={};return t.forEach((t,r)=>e[t]=r),e})(Hp),Wp=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Vp=String.fromCharCode.bind(String),$p=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,t=>"+"==t?"-":"_")),Jp=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Yp=t=>{let e,r,n,o,i="";const a=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|o,i+=Hp[e>>18&63]+Hp[e>>12&63]+Hp[e>>6&63]+Hp[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},Kp="function"==typeof btoa?t=>btoa(t):qp?t=>Buffer.from(t,"binary").toString("base64"):Yp,Qp=qp?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let r=0,n=t.length;r<n;r+=4096)e.push(Vp.apply(null,t.subarray(r,r+4096)));return Kp(e.join(""))},Xp=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?Vp(192|e>>>6)+Vp(128|63&e):Vp(224|e>>>12&15)+Vp(128|e>>>6&63)+Vp(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return Vp(240|e>>>18&7)+Vp(128|e>>>12&63)+Vp(128|e>>>6&63)+Vp(128|63&e)},Zp=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,th=t=>t.replace(Zp,Xp),eh=qp?t=>Buffer.from(t,"utf8").toString("base64"):zp?t=>Qp(zp.encode(t)):t=>Kp(th(t)),rh=(t,e=!1)=>e?$p(eh(t)):eh(t),nh=t=>{if(t=t.replace(/\s+/g,""),!Wp.test(t))throw new TypeError("malformed base64.");let e,r,n;t+="==".slice(2-(3&t.length));let o=[];for(let i=0;i<t.length;)e=Gp[t.charAt(i++)]<<18|Gp[t.charAt(i++)]<<12|(r=Gp[t.charAt(i++)])<<6|(n=Gp[t.charAt(i++)]),64===r?o.push(Vp(e>>16&255)):64===n?o.push(Vp(e>>16&255,e>>8&255)):o.push(Vp(e>>16&255,e>>8&255,255&e));return o.join("")},oh=rh;var ih,ah;var uh,sh,ch,lh={};var fh=function(){if(ch)return sh;ch=1;var t=ah?ih:(ah=1,ih=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}),e=function(){if(uh)return lh;uh=1;var t=Object.prototype.hasOwnProperty;function e(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function r(t){try{return encodeURIComponent(t)}catch(t){return null}}return lh.stringify=function(e,n){n=n||"";var o,i,a=[];for(i in"string"!=typeof n&&(n="?"),e)if(t.call(e,i)){if((o=e[i])||null!=o&&!isNaN(o)||(o=""),i=r(i),o=r(o),null===i||null===o)continue;a.push(i+"="+o)}return a.length?n+a.join("&"):""},lh.parse=function(t){for(var r,n=/([^=?#&]+)=?([^&]*)/g,o={};r=n.exec(t);){var i=e(r[1]),a=e(r[2]);null===i||null===a||i in o||(o[i]=a)}return o},lh}(),n=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,s=/^[a-zA-Z]:/;function c(t){return(t||"").toString().replace(n,"")}var l=[["#","hash"],["?","query"],function(t,e){return p(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function d(t){var e,n=("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{}).location||{},o={},a=typeof(t=t||n);if("blob:"===t.protocol)o=new v(unescape(t.pathname),{});else if("string"===a)for(e in o=new v(t,{}),f)delete o[e];else if("object"===a){for(e in t)e in f||(o[e]=t[e]);void 0===o.slashes&&(o.slashes=i.test(t.href))}return o}function p(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function h(t,e){t=(t=c(t)).replace(o,""),e=e||{};var r,n=u.exec(t),i=n[1]?n[1].toLowerCase():"",a=!!n[2],s=!!n[3],l=0;return a?s?(r=n[2]+n[3]+n[4],l=n[2].length+n[3].length):(r=n[2]+n[4],l=n[2].length):s?(r=n[3]+n[4],l=n[3].length):r=n[4],"file:"===i?l>=2&&(r=r.slice(2)):p(i)?r=n[4]:i?a&&(r=r.slice(2)):l>=2&&p(e.protocol)&&(r=n[4]),{protocol:i,slashes:a||p(i),slashesCount:l,rest:r}}function v(r,n,i){if(r=(r=c(r)).replace(o,""),!(this instanceof v))return new v(r,n,i);var a,u,f,m,y,g,b=l.slice(),w=typeof n,S=this,k=0;for("object"!==w&&"string"!==w&&(i=n,n=null),i&&"function"!=typeof i&&(i=e.parse),a=!(u=h(r||"",n=d(n))).protocol&&!u.slashes,S.slashes=u.slashes||a&&n.slashes,S.protocol=u.protocol||n.protocol||"",r=u.rest,("file:"===u.protocol&&(2!==u.slashesCount||s.test(r))||!u.slashes&&(u.protocol||u.slashesCount<2||!p(S.protocol)))&&(b[3]=[/(.*)/,"pathname"]);k<b.length;k++)"function"!=typeof(m=b[k])?(f=m[0],g=m[1],f!=f?S[g]=r:"string"==typeof f?~(y="@"===f?r.lastIndexOf(f):r.indexOf(f))&&("number"==typeof m[2]?(S[g]=r.slice(0,y),r=r.slice(y+m[2])):(S[g]=r.slice(y),r=r.slice(0,y))):(y=f.exec(r))&&(S[g]=y[1],r=r.slice(0,y.index)),S[g]=S[g]||a&&m[3]&&n[g]||"",m[4]&&(S[g]=S[g].toLowerCase())):r=m(r,S);i&&(S.query=i(S.query)),a&&n.slashes&&"/"!==S.pathname.charAt(0)&&(""!==S.pathname||""!==n.pathname)&&(S.pathname=function(t,e){if(""===t)return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,o=r[n-1],i=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(i=!0),r.splice(n,1),a--);return i&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}(S.pathname,n.pathname)),"/"!==S.pathname.charAt(0)&&p(S.protocol)&&(S.pathname="/"+S.pathname),t(S.port,S.protocol)||(S.host=S.hostname,S.port=""),S.username=S.password="",S.auth&&(~(y=S.auth.indexOf(":"))?(S.username=S.auth.slice(0,y),S.username=encodeURIComponent(decodeURIComponent(S.username)),S.password=S.auth.slice(y+1),S.password=encodeURIComponent(decodeURIComponent(S.password))):S.username=encodeURIComponent(decodeURIComponent(S.auth)),S.auth=S.password?S.username+":"+S.password:S.username),S.origin="file:"!==S.protocol&&p(S.protocol)&&S.host?S.protocol+"//"+S.host:"null",S.href=S.toString()}return v.prototype={set:function(r,n,o){var i=this;switch(r){case"query":"string"==typeof n&&n.length&&(n=(o||e.parse)(n)),i[r]=n;break;case"port":i[r]=n,t(n,i.protocol)?n&&(i.host=i.hostname+":"+n):(i.host=i.hostname,i[r]="");break;case"hostname":i[r]=n,i.port&&(n+=":"+i.port),i.host=n;break;case"host":i[r]=n,a.test(n)?(n=n.split(":"),i.port=n.pop(),i.hostname=n.join(":")):(i.hostname=n,i.port="");break;case"protocol":i.protocol=n.toLowerCase(),i.slashes=!o;break;case"pathname":case"hash":if(n){var u="pathname"===r?"/":"#";i[r]=n.charAt(0)!==u?u+n:n}else i[r]=n;break;case"username":case"password":i[r]=encodeURIComponent(n);break;case"auth":var s=n.indexOf(":");~s?(i.username=n.slice(0,s),i.username=encodeURIComponent(decodeURIComponent(i.username)),i.password=n.slice(s+1),i.password=encodeURIComponent(decodeURIComponent(i.password))):i.username=encodeURIComponent(decodeURIComponent(n))}for(var c=0;c<l.length;c++){var f=l[c];f[4]&&(i[f[1]]=i[f[1]].toLowerCase())}return i.auth=i.password?i.username+":"+i.password:i.username,i.origin="file:"!==i.protocol&&p(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(t){t&&"function"==typeof t||(t=e.stringify);var r,n=this,o=n.host,i=n.protocol;i&&":"!==i.charAt(i.length-1)&&(i+=":");var u=i+(n.protocol&&n.slashes||p(n.protocol)?"//":"");return n.username?(u+=n.username,n.password&&(u+=":"+n.password),u+="@"):n.password?(u+=":"+n.password,u+="@"):"file:"!==n.protocol&&p(n.protocol)&&!o&&"/"!==n.pathname&&(u+="@"),(":"===o[o.length-1]||a.test(n.hostname)&&!n.port)&&(o+=":"),u+=o+n.pathname,(r="object"==typeof n.query?t(n.query):n.query)&&(u+="?"!==r.charAt(0)?"?"+r:r),n.hash&&(u+=n.hash),u}},v.extractProtocol=h,v.location=d,v.trimLeft=c,v.qs=e,sh=v}(),dh=n(fh);function ph(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ph=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),u=new R(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};c(w,a,function(){return this});var S=Object.getPrototypeOf,k=S&&S(S(U([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function _(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==mh(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(l).then(function(t){c.value=t,a(c)},function(t){return r("throw",t,a,u)})}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=d;return function(i,a){if(o===h)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?v:p,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=v,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function U(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(mh(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},_(O.prototype),c(O.prototype,u,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},_(E),c(E,s,"Generator"),c(E,a,function(){return this}),c(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=U,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:U(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function hh(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function vh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e);else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||yh(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mh(t){return mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(t)}function yh(t,e){if(t){if("string"==typeof t)return gh(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gh(t,e):void 0}}function gh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function wh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?bh(Object(r),!0).forEach(function(e){Sh(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bh(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Sh(t,e,r){return(e=Eh(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eh(n.key),n)}}function Eh(t){var e=function(t,e){if("object"!=mh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=mh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==mh(e)?e:e+""}var _h="tus-v1",Oh="ietf-draft-03",Th="ietf-draft-05",Ah={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:Lh,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:_h},xh=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return e=t,r=[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(e){return t._urlStorage.findUploadsByFingerprint(e)})}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,e=this.file;if(e)if([_h,Oh,Th].includes(this.options.protocol))if(this.options.endpoint||this.options.uploadUrl||this.url){var r=this.options.retryDelays;if(null==r||"[object Array]"===Object.prototype.toString.call(r)){if(this.options.parallelUploads>1)for(var n=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];n<o.length;n++){var i=o[n];if(this.options[i])return void this._emitError(new Error("tus: cannot use the ".concat(i," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(e,this.options).then(function(r){return Bp(null==r?"No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.":"Calculated fingerprint: ".concat(r)),t._fingerprint=r,t._source?t._source:t.options.fileReader.openFile(e,t.options.chunkSize)}).then(function(e){if(t._source=e,t.options.uploadLengthDeferred)t._size=null;else if(null!=t.options.uploadSize){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size))return void t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(t._size=t._source.size,null==t._size)return void t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));t.options.parallelUploads>1||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()}).catch(function(e){t._emitError(e)})}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var e,r=this,n=this._size,o=0;this._parallelUploads=[];var i=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,a=null!==(e=this.options.parallelUploadBoundaries)&&void 0!==e?e:function(t,e){for(var r=Math.floor(t/e),n=[],o=0;o<e;o++)n.push({start:r*o,end:r*(o+1)});return n[e-1].end=t,n}(this._source.size,i);this._parallelUploadUrls&&a.forEach(function(t,e){t.uploadUrl=r._parallelUploadUrls[e]||null}),this._parallelUploadUrls=new Array(a.length);var u,s=a.map(function(e,i){var u=0;return r._source.slice(e.start,e.end).then(function(s){var c=s.value;return new Promise(function(s,l){var f=wh(wh({},r.options),{},{uploadUrl:e.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:r.options.metadataForPartialUploads,headers:wh(wh({},r.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:s,onError:l,onProgress:function(t){o=o-u+t,u=t,r._emitProgress(o,n)},onUploadUrlAvailable:function(){r._parallelUploadUrls[i]=d.url,r._parallelUploadUrls.filter(function(t){return Boolean(t)}).length===a.length&&r._saveUploadInUrlStorage()}}),d=new t(c,f);d.start(),r._parallelUploads.push(d)})})});Promise.all(s).then(function(){(u=r._openRequest("POST",r.options.endpoint)).setHeader("Upload-Concat","final;".concat(r._parallelUploadUrls.join(" ")));var t=Ph(r.options.metadata);return""!==t&&u.setHeader("Upload-Metadata",t),r._sendRequest(u,null)}).then(function(t){if(Rh(t.getStatus(),200)){var e=t.getHeader("Location");null!=e?(r.url=Bh(r.options.endpoint,e),Bp("Created upload at ".concat(r.url)),r._emitSuccess(t)):r._emitHttpError(u,t,"tus: invalid or missing Location header")}else r._emitHttpError(u,t,"tus: unexpected response while creating upload")}).catch(function(t){r._emitError(t)})}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?(Bp("Resuming upload from previous URL: ".concat(this.url)),void this._resumeUpload()):null!=this.options.uploadUrl?(Bp("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,void this._resumeUpload()):(Bp("Creating a new upload"),void this._createUpload())}},{key:"abort",value:function(e){var r=this;if(null!=this._parallelUploads){var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=yh(t))||e){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(this._parallelUploads);try{for(o.s();!(n=o.n()).done;)n.value.abort(e)}catch(t){o.e(t)}finally{o.f()}}return null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),e&&null!=this.url?t.terminate(this.url,this.options).then(function(){return r._removeFromUrlStorage()}):Promise.resolve()}},{key:"_emitHttpError",value:function(t,e,r,n){this._emitError(new jp(r,n,t,e))}},{key:"_emitError",value:function(t){var e=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),jh(t,this._retryAttempt,this.options))){var r=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout(function(){e.start()},r))}if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}}},{key:"_emitSuccess",value:function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess({lastResponse:t})}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,r){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,r)}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?e.setHeader("Upload-Defer-Length","1"):e.setHeader("Upload-Length","".concat(this._size));var r,n=Ph(this.options.metadata);""!==n&&e.setHeader("Upload-Metadata",n),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,r=this._addChunkToRequest(e)):(this.options.protocol!==Oh&&this.options.protocol!==Th||e.setHeader("Upload-Complete","?0"),r=this._sendRequest(e,null)),r.then(function(r){if(Rh(r.getStatus(),200)){var n=r.getHeader("Location");if(null!=n){if(t.url=Bh(t.options.endpoint,n),Bp("Created upload at ".concat(t.url)),"function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),0===t._size)return t._emitSuccess(r),void t._source.close();t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(e,r):(t._offset=0,t._performUpload())})}else t._emitHttpError(e,r,"tus: invalid or missing Location header")}else t._emitHttpError(e,r,"tus: unexpected response while creating upload")}).catch(function(r){t._emitHttpError(e,null,"tus: failed to create upload",r)})}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=this._openRequest("HEAD",this.url);this._sendRequest(e,null).then(function(r){var n=r.getStatus();if(!Rh(n,200))return 423===n?void t._emitHttpError(e,r,"tus: upload is currently locked; retry later"):(Rh(n,400)&&t._removeFromUrlStorage(),t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitHttpError(e,r,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var o=Number.parseInt(r.getHeader("Upload-Offset"),10);if(Number.isNaN(o))t._emitHttpError(e,r,"tus: invalid or missing offset value");else{var i=Number.parseInt(r.getHeader("Upload-Length"),10);!Number.isNaN(i)||t.options.uploadLengthDeferred||t.options.protocol!==_h?("function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(o===i)return t._emitProgress(i,i),void t._emitSuccess(r);t._offset=o,t._performUpload()})):t._emitHttpError(e,r,"tus: invalid or missing length value")}}).catch(function(r){t._emitHttpError(e,null,"tus: failed to resume upload",r)})}},{key:"_performUpload",value:function(){var t,e=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset","".concat(this._offset)),this._addChunkToRequest(t).then(function(r){Rh(r.getStatus(),200)?e._handleUploadResponse(t,r):e._emitHttpError(t,r,"tus: unexpected response while uploading chunk")}).catch(function(r){e._aborted||e._emitHttpError(t,null,"tus: failed to upload chunk at offset ".concat(e._offset),r)}))}},{key:"_addChunkToRequest",value:function(t){var e=this,r=this._offset,n=this._offset+this.options.chunkSize;return t.setProgressHandler(function(t){e._emitProgress(r+t,e._size)}),this.options.protocol===_h?t.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===Th&&t.setHeader("Content-Type","application/partial-upload"),(n===Number.POSITIVE_INFINITY||n>this._size)&&!this.options.uploadLengthDeferred&&(n=this._size),this._source.slice(r,n).then(function(r){var n=r.value,o=r.done,i=null!=n&&n.size?n.size:0;e.options.uploadLengthDeferred&&o&&(e._size=e._offset+i,t.setHeader("Upload-Length","".concat(e._size)));var a=e._offset+i;return!e.options.uploadLengthDeferred&&o&&a!==e._size?Promise.reject(new Error("upload was configured with a size of ".concat(e._size," bytes, but the source is done after ").concat(a," bytes"))):null===n?e._sendRequest(t):(e.options.protocol!==Oh&&e.options.protocol!==Th||t.setHeader("Upload-Complete",o?"?1":"?0"),e._emitProgress(e._offset,e._size),e._sendRequest(t,n))})}},{key:"_handleUploadResponse",value:function(t,e){var r=Number.parseInt(e.getHeader("Upload-Offset"),10);if(Number.isNaN(r))this._emitHttpError(t,e,"tus: invalid or missing offset value");else{if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size)return this._emitSuccess(e),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(t,e){var r=Uh(t,e,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(e){t._emitError(e)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then(function(e){t._urlStorageKey=e})}},{key:"_sendRequest",value:function(t){return Ih(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],n=[{key:"terminate",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Uh("DELETE",e,r);return Ih(n,null,r).then(function(t){if(204!==t.getStatus())throw new jp("tus: unexpected response while terminating upload",null,n,t)}).catch(function(o){if(o instanceof jp||(o=new jp("tus: failed to terminate upload",o,n,null)),!jh(o,0,r))throw o;var i=r.retryDelays[0],a=r.retryDelays.slice(1),u=wh(wh({},r),{},{retryDelays:a});return new Promise(function(t){return setTimeout(t,i)}).then(function(){return t.terminate(e,u)})})}}],r&&kh(e.prototype,r),n&&kh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function Ph(t){return Object.entries(t).map(function(t){var e=vh(t,2),r=e[0],n=e[1];return"".concat(r," ").concat(oh(String(n)))}).join(",")}function Rh(t,e){return t>=e&&t<e+100}function Uh(t,e,r){var n=r.httpStack.createRequest(t,e);r.protocol===Oh?n.setHeader("Upload-Draft-Interop-Version","5"):r.protocol===Th?n.setHeader("Upload-Draft-Interop-Version","6"):n.setHeader("Tus-Resumable","1.0.0");for(var o=r.headers||{},i=0,a=Object.entries(o);i<a.length;i++){var u=vh(a[i],2),s=u[0],c=u[1];n.setHeader(s,c)}if(r.addRequestId){var l="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)});n.setHeader("X-Request-ID",l)}return n}function Ih(t,e,r){return Ch.apply(this,arguments)}function Ch(){var t;return t=ph().mark(function t(e,r,n){var o;return ph().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof n.onBeforeRequest){t.next=3;break}return t.next=3,n.onBeforeRequest(e);case 3:return t.next=5,e.send(r);case 5:if(o=t.sent,"function"!=typeof n.onAfterResponse){t.next=9;break}return t.next=9,n.onAfterResponse(e,o);case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}},t)}),Ch=function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){hh(i,n,o,a,u,"next",t)}function u(t){hh(i,n,o,a,u,"throw",t)}a(void 0)})},Ch.apply(this,arguments)}function jh(t,e,r){return!(null==r.retryDelays||e>=r.retryDelays.length||null==t.originalRequest)&&(r&&"function"==typeof r.onShouldRetry?r.onShouldRetry(t,e,r):Lh(t))}function Lh(t){var e,r=t.originalResponse?t.originalResponse.getStatus():0;return(!Rh(r,400)||409===r||423===r)&&(e=!0,"undefined"!=typeof navigator&&!1===navigator.onLine&&(e=!1),e)}function Bh(t,e){return new dh(e,t).toString()}xh.defaultOptions=Ah;var Mh=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function Nh(t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var t=n.response;e(t)},n.onerror=function(t){r(t)},n.open("GET",t),n.send()})}function Dh(t){return Dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(t)}function Fh(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qh(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function qh(t){var e=function(t,e){if("object"!=Dh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=Dh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==Dh(e)?e:e+""}var zh=function(){return Fh(function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._file=e,this.size=e.size},[{key:"slice",value:function(t,e){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return r=this._file.slice(t,e),new Promise(function(t,e){var n=new FileReader;n.onload=function(){var e=new Uint8Array(n.result);t({value:e})},n.onerror=function(t){e(t)},n.readAsArrayBuffer(r)});var r,n=this._file.slice(t,e),o=e>=this.size;return Promise.resolve({value:n,done:o})}},{key:"close",value:function(){}}])}();function Hh(t){return Hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(t)}function Gh(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wh(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wh(t){var e=function(t,e){if("object"!=Hh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=Hh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==Hh(e)?e:e+""}function Vh(t){return void 0===t?0:void 0!==t.size?t.size:t.length}var $h=function(){return Gh(function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1},[{key:"slice",value:function(t,e){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,e)}},{key:"_readUntilEnoughDataOrDone",value:function(t,e){var r=this,n=e<=this._bufferOffset+Vh(this._buffer);if(this._done||n){var o=this._getDataFromBuffer(t,e),i=null==o&&this._done;return Promise.resolve({value:o,done:i})}return this._reader.read().then(function(n){var o=n.value;return n.done?r._done=!0:void 0===r._buffer?r._buffer=o:r._buffer=function(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var r=new t.constructor(t.length+e.length);return r.set(t),r.set(e,t.length),r}throw new Error("Unknown data type")}(r._buffer,o),r._readUntilEnoughDataOrDone(t,e)})}},{key:"_getDataFromBuffer",value:function(t,e){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var r=0===Vh(this._buffer);return this._done&&r?null:this._buffer.slice(0,e-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])}();function Jh(t){return Jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(t)}function Yh(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Yh=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),u=new R(n||[]);return o(a,"_invoke",{value:T(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};c(w,a,function(){return this});var S=Object.getPrototypeOf,k=S&&S(S(U([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=y.prototype=Object.create(w);function _(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Jh(l)&&n.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,a,u)},function(t){r("throw",t,a,u)}):e.resolve(l).then(function(t){c.value=t,a(c)},function(t){return r("throw",t,a,u)})}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e(function(e,o){r(t,n,e,o)})}return i=i?i.then(o,o):o()}})}function T(e,r,n){var o=d;return function(i,a){if(o===h)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?v:p,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=v,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function U(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Jh(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},_(O.prototype),c(O.prototype,u,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},_(E),c(E,s,"Generator"),c(E,a,function(){return this}),c(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=U,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:U(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Kh(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Qh(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xh(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xh(t){var e=function(t,e){if("object"!=Jh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=Jh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==Jh(e)?e:e+""}var Zh=function(){return Qh(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},[{key:"openFile",value:(t=Yh().mark(function t(e,r){var n;return Yh().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Mh()||!e||void 0===e.uri){t.next=11;break}return t.prev=1,t.next=4,Nh(e.uri);case 4:return n=t.sent,t.abrupt("return",new zh(n));case 8:throw t.prev=8,t.t0=t.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(t.t0));case 11:if("function"!=typeof e.slice||void 0===e.size){t.next=13;break}return t.abrupt("return",Promise.resolve(new zh(e)));case 13:if("function"!=typeof e.read){t.next=18;break}if(r=Number(r),Number.isFinite(r)){t.next=17;break}return t.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return t.abrupt("return",Promise.resolve(new $h(e,r)));case 18:return t.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return t.stop()}},t,null,[[1,8]])}),e=function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){Kh(i,n,o,a,u,"next",t)}function u(t){Kh(i,n,o,a,u,"throw",t)}a(void 0)})},function(t,r){return e.apply(this,arguments)})}]);var t,e}();function tv(t){return tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(t)}function ev(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rv(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nv(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function nv(t){var e=function(t,e){if("object"!=tv(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=tv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==tv(e)?e:e+""}var ov=function(){return rv(function t(){ev(this,t)},[{key:"createRequest",value:function(t,e){return new iv(t,e)}},{key:"getName",value:function(){return"XHRHttpStack"}}])}(),iv=function(){return rv(function t(e,r){ev(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,r,!0),this._method=e,this._url=r,this._headers={}},[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,e){this._xhr.setRequestHeader(t,e),this._headers[t]=e}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(r,n){t._xhr.onload=function(){r(new av(t._xhr))},t._xhr.onerror=function(t){n(t)},t._xhr.send(e)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}(),av=function(){return rv(function t(e){ev(this,t),this._xhr=e},[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}();function uv(t){return uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uv(t)}function sv(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cv(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function cv(t){var e=function(t,e){if("object"!=uv(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=uv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==uv(e)?e:e+""}var lv=!1;try{lv="localStorage"in window;var fv="tusSupport",dv=localStorage.getItem(fv);localStorage.setItem(fv,dv),null===dv&&localStorage.removeItem(fv)}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;lv=!1}var pv=lv,hv=function(){return sv(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var e=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,e){var r=Math.round(1e12*Math.random()),n="tus::".concat(t,"::").concat(r);return localStorage.setItem(n,JSON.stringify(e)),Promise.resolve(n)}},{key:"_findEntries",value:function(t){for(var e=[],r=0;r<localStorage.length;r++){var n=localStorage.key(r);if(0===n.indexOf(t))try{var o=JSON.parse(localStorage.getItem(n));o.urlStorageKey=n,e.push(o)}catch(t){}}return e}}])}();function vv(t){return vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(t)}function mv(t,e,r){return r&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_v(n.key),n)}}(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yv(t,e,r){return e=bv(e),function(t,e){if(e&&("object"===vv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gv()?Reflect.construct(e,r||[],bv(t).constructor):e.apply(t,r))}function gv(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(gv=function(){return!!t})()}function bv(t){return bv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bv(t)}function wv(t,e){return wv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wv(t,e)}function Sv(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function kv(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Sv(Object(r),!0).forEach(function(e){Ev(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sv(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Ev(t,e,r){return(e=_v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _v(t){var e=function(t,e){if("object"!=vv(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=vv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vv(e)?e:e+""}var Ov,Tv=kv(kv({},xh.defaultOptions),{},{httpStack:new ov,fileReader:new Zh,urlStorage:pv?new hv:new Fp,fingerprint:function(t,e){return Mh()?Promise.resolve(function(t,e){var r=t.exif?function(t){var e=0;if(0===t.length)return e;for(var r=0;r<t.length;r++){e=(e<<5)-e+t.charCodeAt(r),e&=e}return e}(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",r,e.endpoint].join("/")}(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}}),Av=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yv(this,e,[t,r=kv(kv({},Tv),r)])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wv(t,e)}(e,t),mv(e,0,[{key:"terminate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=kv(kv({},Tv),e),xh.terminate(t,e)}}])}(xh),xv="function"==typeof XMLHttpRequest&&"function"==typeof Blob&&"function"==typeof Blob.prototype.slice,Pv=Object.freeze({__proto__:null,DefaultHttpStack:ov,DetailedError:jp,Upload:Av,canStoreURLs:pv,defaultOptions:Tv,enableDebugLog:function(){Lp=!0},isSupported:xv}),Rv={};!function(){if(Ov)return Rv;Ov=1;var t=Dr(),e=na().filter;t({target:"Array",proto:!0,forced:!uo()("filter")},{filter:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var Uv,Iv={};!function(){if(Uv)return Iv;Uv=1;var t=Dr(),e=na().find,r=xn(),n="find",o=!0;n in[]&&Array(1)[n](function(){o=!1}),t({target:"Array",proto:!0,forced:o},{find:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),r(n)}();var Cv,jv,Lv={};if(function(){if(Cv)return Lv;Cv=1;var t=Dr(),e=ft(),r=At(),n=ie(),o=mr(),i=Oo(),a=Di(),u=y(),s=Ad(),c=qr(),l=xd(),f=Pd(),d=kt(),p=Rd(),h=[],v=e(h.sort),m=e(h.push),g=u(function(){h.sort(void 0)}),b=u(function(){h.sort(null)}),w=c("sort"),S=!u(function(){if(d)return d<70;if(!(l&&l>3)){if(f)return!0;if(p)return p<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)h.push({k:e+n,v:r})}for(h.sort(function(t,e){return e.v-t.v}),n=0;n<h.length;n++)e=h[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});t({target:"Array",proto:!0,forced:g||!b||!w||!S},{sort:function(t){void 0!==t&&r(t);var e=n(this);if(S)return void 0===t?v(e):v(e,t);var u,c,l=[],f=o(e);for(c=0;c<f;c++)c in e&&m(l,e[c]);for(s(l,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:a(e)>a(r)?1:-1}}(t)),u=o(l),c=0;c<u;)e[c]=l[c++];for(;c<f;)i(e,c++);return e}})}(),function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e():t.StarmusAudioEditor=e()}("undefined"!=typeof window?window:globalThis,function(){function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",r=document.getElementById("starmus-editor-notice");r&&(t?(r.textContent=t,r.className="starmus-alert starmus-alert--".concat(e),r.hidden=!1):r.hidden=!0)}function e(t){var e=Math.floor(t/60),r=Math.floor(t%60);return e+":"+String(r).padStart(2,"0")}return{init:function(){var r=window.STARMUS_EDITOR_DATA;if(r){var n=r.restUrl,o=r.nonce,i=r.postId,a=r.audioUrl,u=r.annotations,s=void 0===u?[]:u,c=document.getElementById("overview"),l=document.getElementById("zoomview"),f=document.getElementById("play"),d=document.getElementById("back5"),p=document.getElementById("fwd5"),h=document.getElementById("zoom-in"),v=document.getElementById("zoom-out"),m=document.getElementById("zoom-fit"),y=document.getElementById("loop"),g=document.getElementById("add-region"),b=document.getElementById("save"),w=document.getElementById("regions-list");document.getElementById("starmus-editor-notice");var S=document.getElementById("starmus-time-cur"),k=document.getElementById("starmus-time-dur");if(a&&c&&l&&f&&g&&b&&w){var E=!1,_=function(t){E=!!t,b.disabled=!E};_(!1),window.addEventListener("beforeunload",function(t){E&&(t.preventDefault(),t.returnValue="")});var O=new Audio(a);O.crossOrigin="anonymous",O.addEventListener("error",function(){return t("Audio load error â check CORS or URL.","error")}),O.addEventListener("loadedmetadata",function(){var r=O.duration;if(!isFinite(r)||r<=0)t("Invalid audio file â cannot initialize.","error");else{var a=function(t){var e=(t||[]).filter(function(t){return isFinite(t.startTime)&&isFinite(t.endTime)&&t.startTime>=0&&t.endTime>t.startTime&&t.endTime<=r});e.sort(function(t,e){return t.startTime-e.startTime});var n,o=[],i=-1,a=ba(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;s.startTime>=i&&(o.push({id:s.id||u(),startTime:s.startTime,endTime:s.endTime,label:(s.label||"").trim().slice(0,200)}),i=s.endTime)}}catch(t){a.e(t)}finally{a.f()}return o},u=function(){var t,e;return(null===(t=window.crypto)||void 0===t||null===(e=t.randomUUID)||void 0===e?void 0:e.call(t))||"id-"+Math.random().toString(36).slice(2)+Date.now()},T=a(s);"undefined"!=typeof Peaks?Peaks.init({containers:{overview:c,zoomview:l},mediaElement:O,webAudio:{audioContext:new(window.AudioContext||window.webkitAudioContext),multiChannel:!1},height:180,zoomLevels:[64,128,256,512,1024,2048],segments:T,keyboard:!1,showPlayheadTime:!0},function(s,c){if(s)return console.error("Peaks init error:",s),void t("Could not load editor (see console).","error");k.textContent=e(r),O.addEventListener("timeupdate",function(){S.textContent=e(O.currentTime)}),f.addEventListener("click",function(){return O.paused?O.play():O.pause()}),O.addEventListener("play",function(){f.textContent="Pause",f.setAttribute("aria-pressed","true")}),O.addEventListener("pause",function(){f.textContent="Play",f.setAttribute("aria-pressed","false")}),d.onclick=function(){return O.currentTime=Math.max(0,O.currentTime-5)},p.onclick=function(){return O.currentTime=Math.min(r,O.currentTime+5)},h.onclick=function(){return c.zoom.zoomIn()},v.onclick=function(){return c.zoom.zoomOut()},m.onclick=function(){return c.zoom.zoom(0)};var l=!1;y.onchange=function(){return l=y.checked},O.addEventListener("timeupdate",function(){if(l){var t=O.currentTime,e=c.segments.getSegments();if(e.length){var r=e.find(function(e){return t>=e.startTime&&t<e.endTime});r&&t>=r.endTime&&(O.currentTime=r.startTime)}}});var T=function(){var t=a(c.segments.getSegments());if(w.innerHTML="",!t.length)return w.innerHTML='<tr><td colspan="5">No annotations. Click âAdd Regionâ.</td></tr>',void _(!1);t.forEach(function(t){var e=document.createElement("tr");e.innerHTML='<td><input data-id="'.concat(t.id,'" data-key="label" value="').concat((""+t.label).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),'"/></td>')+'<td><input data-id="'.concat(t.id,'" data-key="startTime" value="').concat(t.startTime.toFixed(2),'" step="0.01"/></td>')+'<td><input data-id="'.concat(t.id,'" data-key="endTime" value="').concat(t.endTime.toFixed(2),'" step="0.01"/></td>')+"<td>".concat((t.endTime-t.startTime).toFixed(2),"s</td>")+'<td><button data-act="jump" data-id="'.concat(t.id,'">Jump</button> <button data-act="del" data-id="').concat(t.id,'">Delete</button></td>'),w.appendChild(e)}),_(!0)};w.addEventListener("input",function(t){var e=t.target.dataset.id,r=t.target.dataset.key;if(e&&r){var n=c.segments.getSegment(e);if(n){var o=t.target.value;("startTime"!==r&&"endTime"!==r||(o=parseFloat(o),!isNaN(o)))&&(n.update(wa({},r,o)),_(!0),T())}}}),w.addEventListener("click",function(t){var e=t.target.dataset.act,r=t.target.dataset.id;if(e&&r){var n=c.segments.getSegment(r);n&&("jump"===e?(O.currentTime=n.startTime,O.play()):"del"===e&&(c.segments.removeById(r),_(!0),T()))}}),g.onclick=function(){var t=O.currentTime||0,e=Math.max(0,t-2),n=Math.min(r,t+2);c.segments.add({id:u(),startTime:e,endTime:n,label:""}),T()},b.onclick=ma(Ea().m(function e(){var r,u,s;return Ea().w(function(e){for(;;)switch(e.p=e.n){case 0:if(E){e.n=1;break}return e.a(2);case 1:return _(!1),r=a(c.segments.getSegments()),e.p=2,e.n=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":o},body:JSON.stringify({postId:i,annotations:r})});case 3:return u=e.v,e.n=4,u.json();case 4:if(s=e.v,u.ok&&s.success){e.n=5;break}throw new Error(s.message);case 5:c.segments.removeAll(),c.segments.add(a(s.annotations||[])),T(),t("Annotations saved.","success"),e.n=7;break;case 6:e.p=6,t("Save failed: "+e.v.message,"error");case 7:return e.a(2)}},e,null,[[2,6]])})),T()}):t("Peaks.js not loaded â cannot initialize editor.","error")}})}else t("Missing required editor elements.","error")}else console.error("STARMUS_EDITOR_DATA not defined â cannot initialize.")}}}),window.STARMUS_EDITOR_DATA?(window.STARMUS_BOOTSTRAP=window.STARMUS_EDITOR_DATA,window.STARMUS_BOOTSTRAP.pageType="editor"):window.STARMUS_RERECORDER_DATA?(window.STARMUS_BOOTSTRAP=window.STARMUS_RERECORDER_DATA,window.STARMUS_BOOTSTRAP.pageType="rerecorder"):window.STARMUS_RECORDER_DATA&&(window.STARMUS_BOOTSTRAP=window.STARMUS_RECORDER_DATA,window.STARMUS_BOOTSTRAP.pageType="recorder"),window.Starmus_DisableOptionalNodes=!0,window.Starmus_DisableOptionalNodes){var Bv,Mv=null===(Bv=window.AudioContext||window.webkitAudioContext)||void 0===Bv?void 0:Bv.prototype;Mv&&(Mv.createConstantSource&&(Mv.createConstantSource=function(){throw new Error("ConstantSourceNode disabled for stability.")}),Mv.createIIRFilter&&(Mv.createIIRFilter=function(){throw new Error("IIRFilterNode disabled for stability.")}))}function Nv(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:e.instanceId||null,event:t,severity:e.severity||"info",message:e.message||"",data:e.data||{}})}catch(t){console.warn("[Starmus] Global telemetry emit failed:",t)}}function Dv(t){return Fv.apply(this,arguments)}function Fv(){return(Fv=ma(Ea().m(function t(e){return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e){t.n=1;break}return t.a(2);case 1:if("suspended"!==e.state){t.n=6;break}return t.p=2,t.n=3,e.resume();case 3:t.n=5;break;case 4:t.p=4,t.v;case 5:console.log("[Starmus] AudioContext resumed");case 6:return t.a(2)}},t,null,[[2,4]])}))).apply(this,arguments)}function qv(){try{return navigator.deviceMemory||null}catch(t){return null}}function zv(){try{return navigator.hardwareConcurrency||null}catch(t){return null}}function Hv(t){var e=t.capabilities||{},r=t.network||{};if(/\bCrOS\b|Chrome OS/i.test(navigator.userAgent))return"A";if(!e.mediaRecorder||!e.webrtc)return"C";var n=qv(),o=zv();if(null!=n&&n<1)return"C";if(null!=o){if(1===o)return"C";if(2===o)return"B"}return/wv|Crosswalk|Android WebView|Opera Mini/i.test(navigator.userAgent)?"C":"2g"===r.effectiveType||"slow-2g"===r.effectiveType||null!=n&&n<2?"B":"A"}function Gv(t){return Wv.apply(this,arguments)}function Wv(){return(Wv=ma(Ea().m(function t(e){var r,n;return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:if("C"!==e){t.n=1;break}return t.a(2,"C");case 1:if(!navigator.storage||!navigator.storage.estimate){t.n=6;break}return t.p=2,t.n=3,navigator.storage.estimate();case 3:if(r=t.v,!((n=(r.quota||0)/1024/1024)&&n<80)){t.n=4;break}return t.a(2,"C");case 4:t.n=6;break;case 5:t.p=5,t.v;case 6:if(!navigator.permissions||!navigator.permissions.query){t.n=11;break}return t.p=7,t.n=8,navigator.permissions.query({name:"microphone"});case 8:if("denied"!==t.v.state){t.n=9;break}return t.a(2,"C");case 9:t.n=11;break;case 10:t.p=10,t.v;case 11:return t.a(2,e)}},t,null,[[7,10],[2,5]])}))).apply(this,arguments)}function Vv(t,e){var r,n=t.getState(),o=n.env||{},i=n.calibration||{},a=n.source||{},u=function(t,r){var n=e.querySelector('[name="'.concat(t,'"]'));n&&(n.value=r)};o&&Object.keys(o).length>0&&u("_starmus_env",JSON.stringify(o)),i.complete&&u("_starmus_calibration",JSON.stringify(i)),a.transcript&&u("first_pass_transcription",a.transcript.trim()),a.waveform_data&&u("waveform_json",JSON.stringify(a.waveform_data)),u("user_agent",navigator.userAgent||""),u("device_fingerprint",(null==o||null===(r=o.identifiers)||void 0===r?void 0:r.visitorId)||"")}window.tus=Pv,window.Peaks=e,window.PeaksVersion=e.prototype?"loaded":"missing",(jv="undefined"!=typeof window?window:globalThis).Starmus||(jv.Starmus={}),jv.Starmus.Peaks=e,window.SPARXSTAR=window.SPARXSTAR||{},window.SPARXSTAR.StarmusReady=!0,Sc().then(function(){return console.log("[Starmus] Offline queue initialized")}).catch(function(t){return console.error("[Starmus] Offline queue init failed:",t)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),window.StarmusApp=window.StarmusApp||{},window.StarmusApp.isRecordingSupported=function(){try{var t=!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),e=!!window.MediaRecorder,r=!(!window.AudioContext&&!window.webkitAudioContext);return t&&e&&r}catch(t){return!1}};var $v=new Map;function Jv(t,e){return Yv.apply(this,arguments)}function Yv(){return Yv=ma(Ea().m(function t(e,r){var n,o,i,a,u,s,c,l;return Ea().w(function(t){for(;;)switch(t.n){case 0:if((n=r.getAttribute("data-starmus-id"))||(n="starmus_"+Date.now()+"_"+Math.random().toString(16).slice(2),r.setAttribute("data-starmus-id",n)),!$v.has(n)){t.n=1;break}return t.a(2,n);case 1:return o=Hv(e),t.n=2,Gv(o);case 2:return o=t.v,console.log("[Starmus] Instance ".concat(n," â Tier ").concat(o)),Nv("TIER_ASSIGN",{instanceId:n,severity:"info",message:"Tier ".concat(o," assigned"),data:{tier:o}}),i=pa({instanceId:n,env:e,tier:o}),a={step1:r.querySelector(".starmus-step-1"),step2:r.querySelector(".starmus-step-2"),continueBtn:r.querySelector('[data-starmus-action="continue"]'),messageBox:r.querySelector("[data-starmus-message-box]"),setupMicBtn:r.querySelector('[data-starmus-action="setup-mic"]'),setupContainer:r.querySelector("[data-starmus-setup-container]"),recordBtn:r.querySelector('[data-starmus-action="record"]'),pauseBtn:r.querySelector('[data-starmus-action="pause"]'),resumeBtn:r.querySelector('[data-starmus-action="resume"]'),stopBtn:r.querySelector('[data-starmus-action="stop"]'),submitBtn:r.querySelector('[data-starmus-action="submit"]'),resetBtn:r.querySelector('[data-starmus-action="reset"]'),fileInput:r.querySelector('input[type="file"]'),statusEl:r.querySelector("[data-starmus-status]"),progressEl:r.querySelector("[data-starmus-progress]"),progressWrap:r.querySelector(".starmus-progress-wrap"),recorderContainer:r.querySelector("[data-starmus-recorder-container]"),fallbackContainer:r.querySelector("[data-starmus-fallback-container]"),timer:r.querySelector("[data-starmus-timer]"),timerElapsed:r.querySelector(".starmus-timer-elapsed"),durationProgress:r.querySelector("[data-starmus-duration-progress]"),volumeMeter:r.querySelector("[data-starmus-volume-meter]"),waveformBox:r.querySelector("[data-starmus-waveform]"),reviewControls:r.querySelector(".starmus-review-controls"),playBtn:r.querySelector('[data-starmus-action="play"]'),transcriptBox:r.querySelector("[data-starmus-transcript]")},"C"===o&&(a.recorderContainer&&(a.recorderContainer.style.display="none"),a.fallbackContainer&&(a.fallbackContainer.style.display="block"),null!==(u=window.StarmusHooks)&&void 0!==u&&u.doAction&&window.StarmusHooks.doAction("starmus_tier_c_revealed",n,e)),qc(i,a),dl(i,n,e),"C"!==o&&Vd(i,n),$v.set(n,{store:i,form:r,elements:a,tier:o}),i.subscribe(function(){var t=i.getState();if("C"===t.tier&&"C"!==o&&!0===t.fallbackActive){var e=o;o="C",a.recorderContainer&&(a.recorderContainer.style.display="none"),a.fallbackContainer&&(a.fallbackContainer.style.display="block"),console.warn("[Starmus] Instance ".concat(n," downgraded from ").concat(e," â C")),Nv("TIER_DOWNGRADE",{instanceId:n,severity:"warning",message:"Runtime tier downgrade from ".concat(e," to C"),data:{previousTier:e,currentTier:"C",reason:"audio_graph_failure"}})}}),s="A"===o&&!(!window.SpeechRecognition&&!window.webkitSpeechRecognition),i.dispatch({type:"starmus/init",payload:{instanceId:n,env:e,tier:o,speechSupported:s}}),a.continueBtn&&a.continueBtn.addEventListener("click",function(t){t.preventDefault();var e=a.step1;if(e){var o=e.querySelector('[name="starmus_title"]'),u=e.querySelector('[name="starmus_language"]'),s=e.querySelector('[name="starmus_recording_type"]'),c=e.querySelector('[name="agreement_to_terms"]'),l=a.messageBox,f=[];if(o&&o.value.trim()||f.push("Title"),u&&u.value.trim()||f.push("Language"),s&&s.value.trim()||f.push("Recording Type"),c&&c.checked||f.push("Consent"),f.length>0)l&&(l.textContent="Missing: "+f.join(", "),l.style.display="block");else if(l&&(l.textContent="",l.style.display="none"),i.dispatch({type:"starmus/ui/step-continue"}),window.innerWidth<768){var d=r.closest(".starmus-recorder-form")||r;d.classList.add("starmus-immersive"),document.body.classList.add("starmus-lock-scroll"),history.pushState({starmusMode:"immersive",instanceId:n},"","#recording-mode");var p=function(){d.classList.remove("starmus-immersive"),document.body.classList.remove("starmus-lock-scroll");var t=d.querySelector(".starmus-close-immersive");t&&t.remove(),window.removeEventListener("popstate",p)};if(window.addEventListener("popstate",p),!d.querySelector(".starmus-close-immersive")){var h=document.createElement("button");h.innerHTML="&times;",h.className="starmus-close-immersive",h.setAttribute("aria-label","Close fullscreen mode"),h.onclick=function(t){t.preventDefault(),history.back()},d.style.position="relative",d.insertBefore(h,d.firstChild)}}}}),"true"===r.dataset.starmusRerecord&&i.dispatch({type:"starmus/ui/step-continue"}),"C"!==o&&(a.setupMicBtn&&a.setupMicBtn.addEventListener("click",function(){var t=ma(Ea().m(function t(e){var r,o;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(e.preventDefault(),!(r=window.AudioContext||window.webkitAudioContext)){t.n=1;break}return o=new r({latencyHint:"interactive"}),t.n=1,Dv(o);case 1:fa.dispatch("setup-mic",{},{instanceId:n});case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),a.recordBtn&&a.recordBtn.addEventListener("click",function(){var t=ma(Ea().m(function t(e){var r,o;return Ea().w(function(t){for(;;)switch(t.n){case 0:if(e.preventDefault(),!(r=window.AudioContext||window.webkitAudioContext)){t.n=1;break}return o=new r({latencyHint:"interactive"}),t.n=1,Dv(o);case 1:fa.dispatch("start-recording",{},{instanceId:n});case 2:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),a.pauseBtn&&a.pauseBtn.addEventListener("click",function(t){t.preventDefault(),fa.dispatch("pause-mic",{},{instanceId:n})}),a.resumeBtn&&a.resumeBtn.addEventListener("click",function(t){t.preventDefault(),fa.dispatch("resume-mic",{},{instanceId:n})}),a.stopBtn&&a.stopBtn.addEventListener("click",function(t){t.preventDefault(),fa.dispatch("stop-mic",{},{instanceId:n})})),a.fileInput&&a.fileInput.addEventListener("change",function(){var t,e=null===(t=a.fileInput.files)||void 0===t?void 0:t[0];e&&fa.dispatch("attach-file",{file:e},{instanceId:n})}),r.addEventListener("submit",function(t){t.preventDefault(),Vv(i,r);var e=new FormData(r),o={};e.forEach(function(t,e){return o[e]=t}),fa.dispatch("submit",{formFields:o},{instanceId:n})}),a.resetBtn&&a.resetBtn.addEventListener("click",function(t){t.preventDefault(),i.dispatch({type:"starmus/reset"}),fa.dispatch("reset",{},{instanceId:n})}),c=null,l=null,a.playBtn&&a.playBtn.addEventListener("click",function(t){var e;t.preventDefault();var r=i.getState().source||{},n=r.blob||r.file;n&&(c||(c=new Audio,l=URL.createObjectURL(n),c.src=l,c.addEventListener("ended",function(){i.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!1}})})),(null===(e=i.getState().recorder)||void 0===e?void 0:e.isPlaying)?(c.pause(),i.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!1}})):c.play().then(function(){i.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!0}})}).catch(function(t){return console.error("[Starmus] Playback failed:",t)}))}),fa.subscribe("reset",function(t,e){if(e.instanceId===n){if(c)try{c.pause()}catch(t){}l&&URL.revokeObjectURL(l),c=null,l=null}}),t.a(2,n)}},t)})),Yv.apply(this,arguments)}function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=ma(Ea().m(function t(e){var r,n,o,i,a,u;return Ea().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=e.detail||{},null!=(n=document.querySelectorAll('form[data-starmus="recorder"]'))&&n.length){t.n=1;break}return t.a(2);case 1:o=ba(n),t.p=2,o.s();case 3:if((i=o.n()).done){t.n=5;break}return a=i.value,t.n=4,Jv(r,a);case 4:t.n=3;break;case 5:t.n=7;break;case 6:t.p=6,u=t.v,o.e(u);case 7:return t.p=7,o.f(),t.f(7);case 8:return t.a(2)}},t,null,[[2,6,7,8]])}))).apply(this,arguments)}function Xv(){var t=function(){try{return navigator.connection||navigator.mozConnection||navigator.webkitConnection||null}catch(t){return null}}(),e=t?{effectiveType:t.effectiveType||"unknown",downlink:t.downlink||null,saveData:t.saveData||!1}:{effectiveType:"unknown",downlink:null,saveData:!1},r={browser:{userAgent:navigator.userAgent},device:{type:/mobile|android|iphone|ipad/i.test(navigator.userAgent)?"mobile":"desktop",memory:qv(),concurrency:zv()},capabilities:{webrtc:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),mediaRecorder:!(!navigator.mediaDevices||!window.MediaRecorder),indexedDB:!!window.indexedDB},network:e};Nv("E_ENV_FALLBACK_INIT",{severity:"warning",message:"Environment-ready event not fired; using fallback env",data:{fallbackEnv:r}}),Kv({detail:r})}var Zv=!1,tm=null;return document.addEventListener("sparxstar:environment-ready",function(t){Zv=!0,tm&&(clearTimeout(tm),tm=null),Kv(t)}),tm=setTimeout(function(){Zv||(console.warn("[Starmus] Using fallback initialization"),Xv())},2e3),"undefined"!=typeof window&&(window.STARMUS=window.STARMUS||{},window.STARMUS.instances=$v,window.StarmusHooks=window.StarmusHooks||{doAction:fa.dispatch},window.CommandBus=fa),window.createStore=pa,window.initCore=dl,window.initUI=qc,window.initRecorder=Vd,window.StarmusTus=ic,window.StarmusTranscriptController=Yd,window.StarmusOfflineQueue=Sc,window.StarmusQueueSubmission=Ec,window.initOffline=Ac,window.initAutoMetadata=ep,window.StarmusIntegrator=!0,window.StarmusRecorder=Vd,window.initStarmusRecorder=Vd,console.log("[Starmus] Runtime globals wired"),t.StarmusTranscript=Yd,t.StarmusTus=ic,t.createStore=pa,t.getOfflineQueue=Sc,t.initAutoMetadata=ep,t.initCore=dl,t.initOffline=Ac,t.initRecorder=Vd,t.initUI=qc,t.queueSubmission=Ec,t}({},Peaks);
