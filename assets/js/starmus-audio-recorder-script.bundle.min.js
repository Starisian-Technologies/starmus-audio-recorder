import*as t from"tus-js-client";import e from"peaks.js";var r,n,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o={};function a(){if(n)return r;n=1;var t=function(t){return t&&t.Math===Math&&t};return r=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof i&&i)||t("object"==typeof r&&r)||function(){return this}()||Function("return this")()}var u,c,s,f,l,d,p,v,m={};function h(){return c?u:(c=1,u=function(t){try{return!!t()}catch(t){return!0}})}function y(){if(f)return s;f=1;var t=h();return s=!t(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}function g(){if(d)return l;d=1;var t=h();return l=!t(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})}function b(){if(v)return p;v=1;var t=g(),e=Function.prototype.call;return p=t?e.bind(e):function(){return e.apply(e,arguments)},p}var w,S,O,k,E,A,T,x,I,C,P,R,M,_,j,N,B,U,L,D,F,q,z,H,W,G,V,Q,$,Y,J,K,X,Z,tt,et,rt,nt,it,ot,at,ut={};function ct(){if(w)return ut;w=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return ut.f=r?function(t){var r=e(this,t);return!!r&&r.enumerable}:t,ut}function st(){return O?S:(O=1,S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}})}function ft(){if(E)return k;E=1;var t=g(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return k=t?n:function(t){return function(){return r.apply(t,arguments)}},k}function lt(){if(T)return A;T=1;var t=ft(),e=t({}.toString),r=t("".slice);return A=function(t){return r(e(t),8,-1)}}function dt(){if(I)return x;I=1;var t=ft(),e=h(),r=lt(),n=Object,i=t("".split);return x=e(function(){return!n("z").propertyIsEnumerable(0)})?function(t){return"String"===r(t)?i(t,""):n(t)}:n}function pt(){return P?C:(P=1,C=function(t){return null==t})}function vt(){if(M)return R;M=1;var t=pt(),e=TypeError;return R=function(r){if(t(r))throw new e("Can't call method on "+r);return r}}function mt(){if(j)return _;j=1;var t=dt(),e=vt();return _=function(r){return t(e(r))}}function ht(){if(B)return N;B=1;var t="object"==typeof document&&document.all;return N=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(t){return"function"==typeof t}}function yt(){if(L)return U;L=1;var t=ht();return U=function(e){return"object"==typeof e?null!==e:t(e)}}function gt(){if(F)return D;F=1;var t=a(),e=ht();return D=function(r,n){return arguments.length<2?(i=t[r],e(i)?i:void 0):t[r]&&t[r][n];var i},D}function bt(){if(z)return q;z=1;var t=ft();return q=t({}.isPrototypeOf)}function wt(){if(W)return H;W=1;var t=a().navigator,e=t&&t.userAgent;return H=e?String(e):""}function St(){if(V)return G;V=1;var t,e,r=a(),n=wt(),i=r.process,o=r.Deno,u=i&&i.versions||o&&o.version,c=u&&u.v8;return c&&(e=(t=c.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!e&&n&&(!(t=n.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=n.match(/Chrome\/(\d+)/))&&(e=+t[1]),G=e}function Ot(){if($)return Q;$=1;var t=St(),e=h(),r=a().String;return Q=!!Object.getOwnPropertySymbols&&!e(function(){var e=Symbol("symbol detection");return!r(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&t&&t<41})}function kt(){if(J)return Y;J=1;var t=Ot();return Y=t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function Et(){if(X)return K;X=1;var t=gt(),e=ht(),r=bt(),n=kt(),i=Object;return K=n?function(t){return"symbol"==typeof t}:function(n){var o=t("Symbol");return e(o)&&r(o.prototype,i(n))}}function At(){if(tt)return Z;tt=1;var t=String;return Z=function(e){try{return t(e)}catch(t){return"Object"}}}function Tt(){if(rt)return et;rt=1;var t=ht(),e=At(),r=TypeError;return et=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")}}function xt(){if(it)return nt;it=1;var t=Tt(),e=pt();return nt=function(r,n){var i=r[n];return e(i)?void 0:t(i)}}function It(){if(at)return ot;at=1;var t=b(),e=ht(),r=yt(),n=TypeError;return ot=function(i,o){var a,u;if("string"===o&&e(a=i.toString)&&!r(u=t(a,i)))return u;if(e(a=i.valueOf)&&!r(u=t(a,i)))return u;if("string"!==o&&e(a=i.toString)&&!r(u=t(a,i)))return u;throw new n("Can't convert object to primitive value")}}var Ct,Pt,Rt,Mt,_t,jt,Nt,Bt,Ut,Lt,Dt,Ft,qt,zt,Ht,Wt,Gt,Vt,Qt,$t,Yt,Jt,Kt,Xt,Zt={exports:{}};function te(){return Pt?Ct:(Pt=1,Ct=!1)}function ee(){if(Mt)return Rt;Mt=1;var t=a(),e=Object.defineProperty;return Rt=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch(e){t[r]=n}return n}}function re(){if(_t)return Zt.exports;_t=1;var t=te(),e=a(),r=ee(),n="__core-js_shared__",i=Zt.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Zt.exports}function ne(){if(Nt)return jt;Nt=1;var t=re();return jt=function(e,r){return t[e]||(t[e]=r||{})}}function ie(){if(Ut)return Bt;Ut=1;var t=vt(),e=Object;return Bt=function(r){return e(t(r))}}function oe(){if(Dt)return Lt;Dt=1;var t=ft(),e=ie(),r=t({}.hasOwnProperty);return Lt=Object.hasOwn||function(t,n){return r(e(t),n)}}function ae(){if(qt)return Ft;qt=1;var t=ft(),e=0,r=Math.random(),n=t(1.1.toString);return Ft=function(t){return"Symbol("+(void 0===t?"":t)+")_"+n(++e+r,36)}}function ue(){if(Ht)return zt;Ht=1;var t=a(),e=ne(),r=oe(),n=ae(),i=Ot(),o=kt(),u=t.Symbol,c=e("wks"),s=o?u.for||u:u&&u.withoutSetter||n;return zt=function(t){return r(c,t)||(c[t]=i&&r(u,t)?u[t]:s("Symbol."+t)),c[t]}}function ce(){if(Gt)return Wt;Gt=1;var t=b(),e=yt(),r=Et(),n=xt(),i=It(),o=ue(),a=TypeError,u=o("toPrimitive");return Wt=function(o,c){if(!e(o)||r(o))return o;var s,f=n(o,u);if(f){if(void 0===c&&(c="default"),s=t(f,o,c),!e(s)||r(s))return s;throw new a("Can't convert object to primitive value")}return void 0===c&&(c="number"),i(o,c)}}function se(){if(Qt)return Vt;Qt=1;var t=ce(),e=Et();return Vt=function(r){var n=t(r,"string");return e(n)?n:n+""}}function fe(){if(Yt)return $t;Yt=1;var t=a(),e=yt(),r=t.document,n=e(r)&&e(r.createElement);return $t=function(t){return n?r.createElement(t):{}}}function le(){if(Kt)return Jt;Kt=1;var t=y(),e=h(),r=fe();return Jt=!t&&!e(function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})}function de(){if(Xt)return m;Xt=1;var t=y(),e=b(),r=ct(),n=st(),i=mt(),o=se(),a=oe(),u=le(),c=Object.getOwnPropertyDescriptor;return m.f=t?c:function(t,s){if(t=i(t),s=o(s),u)try{return c(t,s)}catch(t){}if(a(t,s))return n(!e(r.f,t,s),t[s])},m}var pe,ve,me,he,ye,ge,be,we={};function Se(){if(ve)return pe;ve=1;var t=y(),e=h();return pe=t&&e(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}function Oe(){if(he)return me;he=1;var t=yt(),e=String,r=TypeError;return me=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")}}function ke(){if(ye)return we;ye=1;var t=y(),e=le(),r=Se(),n=Oe(),i=se(),o=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",s="configurable",f="writable";return we.f=t?r?function(t,e,r){if(n(t),e=i(e),n(r),"function"==typeof t&&"prototype"===e&&"value"in r&&f in r&&!r[f]){var o=u(t,e);o&&o[f]&&(t[e]=r.value,r={configurable:s in r?r[s]:o[s],enumerable:c in r?r[c]:o[c],writable:!1})}return a(t,e,r)}:a:function(t,r,u){if(n(t),r=i(r),n(u),e)try{return a(t,r,u)}catch(t){}if("get"in u||"set"in u)throw new o("Accessors not supported");return"value"in u&&(t[r]=u.value),t},we}function Ee(){if(be)return ge;be=1;var t=y(),e=ke(),r=st();return ge=t?function(t,n,i){return e.f(t,n,r(1,i))}:function(t,e,r){return t[e]=r,t}}var Ae,Te,xe,Ie,Ce,Pe,Re,Me,_e,je,Ne,Be,Ue,Le,De,Fe={exports:{}};function qe(){if(Te)return Ae;Te=1;var t=y(),e=oe(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&"something"===function(){}.name,a=i&&(!t||t&&n(r,"name").configurable);return Ae={EXISTS:i,PROPER:o,CONFIGURABLE:a}}function ze(){if(Ie)return xe;Ie=1;var t=ft(),e=ht(),r=re(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(t){return n(t)}),xe=r.inspectSource}function He(){if(Me)return Re;Me=1;var t=ne(),e=ae(),r=t("keys");return Re=function(t){return r[t]||(r[t]=e(t))}}function We(){return je?_e:(je=1,_e={})}function Ge(){if(Be)return Ne;Be=1;var t,e,r,n=function(){if(Pe)return Ce;Pe=1;var t=a(),e=ht(),r=t.WeakMap;return Ce=e(r)&&/native code/.test(String(r))}(),i=a(),o=yt(),u=Ee(),c=oe(),s=re(),f=He(),l=We(),d="Object already initialized",p=i.TypeError,v=i.WeakMap;if(n||s.state){var m=s.state||(s.state=new v);m.get=m.get,m.has=m.has,m.set=m.set,t=function(t,e){if(m.has(t))throw new p(d);return e.facade=t,m.set(t,e),e},e=function(t){return m.get(t)||{}},r=function(t){return m.has(t)}}else{var h=f("state");l[h]=!0,t=function(t,e){if(c(t,h))throw new p(d);return e.facade=t,u(t,h,e),e},e=function(t){return c(t,h)?t[h]:{}},r=function(t){return c(t,h)}}return Ne={set:t,get:e,has:r,enforce:function(n){return r(n)?e(n):t(n,{})},getterFor:function(t){return function(r){var n;if(!o(r)||(n=e(r)).type!==t)throw new p("Incompatible receiver, "+t+" required");return n}}}}function Ve(){if(Ue)return Fe.exports;Ue=1;var t=ft(),e=h(),r=ht(),n=oe(),i=y(),o=qe().CONFIGURABLE,a=ze(),u=Ge(),c=u.enforce,s=u.get,f=String,l=Object.defineProperty,d=t("".slice),p=t("".replace),v=t([].join),m=i&&!e(function(){return 8!==l(function(){},"length",{value:8}).length}),g=String(String).split("String"),b=Fe.exports=function(t,e,r){"Symbol("===d(f(e),0,7)&&(e="["+p(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!n(t,"name")||o&&t.name!==e)&&(i?l(t,"name",{value:e,configurable:!0}):t.name=e),m&&r&&n(r,"arity")&&t.length!==r.arity&&l(t,"length",{value:r.arity});try{r&&n(r,"constructor")&&r.constructor?i&&l(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var a=c(t);return n(a,"source")||(a.source=v(g,"string"==typeof e?e:"")),t};return Function.prototype.toString=b(function(){return r(this)&&s(this).source||a(this)},"toString"),Fe.exports}function Qe(){if(De)return Le;De=1;var t=ht(),e=ke(),r=Ve(),n=ee();return Le=function(i,o,a,u){u||(u={});var c=u.enumerable,s=void 0!==u.name?u.name:o;if(t(a)&&r(a,s,u),u.global)c?i[o]=a:n(o,a);else{try{u.unsafe?i[o]&&(c=!0):delete i[o]}catch(t){}c?i[o]=a:e.f(i,o,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return i}}var $e,Ye,Je,Ke,Xe,Ze,tr,er,rr,nr,ir,or,ar,ur,cr,sr,fr,lr={};function dr(){if(Ke)return Je;Ke=1;var t=function(){if(Ye)return $e;Ye=1;var t=Math.ceil,e=Math.floor;return $e=Math.trunc||function(r){var n=+r;return(n>0?e:t)(n)}}();return Je=function(e){var r=+e;return r!=r||0===r?0:t(r)}}function pr(){if(Ze)return Xe;Ze=1;var t=dr(),e=Math.max,r=Math.min;return Xe=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)}}function vr(){if(er)return tr;er=1;var t=dr(),e=Math.min;return tr=function(r){var n=t(r);return n>0?e(n,9007199254740991):0}}function mr(){if(nr)return rr;nr=1;var t=vr();return rr=function(e){return t(e.length)}}function hr(){if(or)return ir;or=1;var t=mt(),e=pr(),r=mr(),n=function(n){return function(i,o,a){var u=t(i),c=r(u);if(0===c)return!n&&-1;var s,f=e(a,c);if(n&&o!=o){for(;c>f;)if((s=u[f++])!=s)return!0}else for(;c>f;f++)if((n||f in u)&&u[f]===o)return n||f||0;return!n&&-1}};return ir={includes:n(!0),indexOf:n(!1)}}function yr(){if(ur)return ar;ur=1;var t=ft(),e=oe(),r=mt(),n=hr().indexOf,i=We(),o=t([].push);return ar=function(t,a){var u,c=r(t),s=0,f=[];for(u in c)!e(i,u)&&e(c,u)&&o(f,u);for(;a.length>s;)e(c,u=a[s++])&&(~n(f,u)||o(f,u));return f}}function gr(){return sr?cr:(sr=1,cr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}function br(){if(fr)return lr;fr=1;var t=yr(),e=gr().concat("length","prototype");return lr.f=Object.getOwnPropertyNames||function(r){return t(r,e)},lr}var wr,Sr,Or,kr,Er,Ar,Tr,xr,Ir,Cr,Pr,Rr,Mr,_r,jr={};function Nr(){if(Or)return Sr;Or=1;var t=gt(),e=ft(),r=br(),n=(wr||(wr=1,jr.f=Object.getOwnPropertySymbols),jr),i=Oe(),o=e([].concat);return Sr=t("Reflect","ownKeys")||function(t){var e=r.f(i(t)),a=n.f;return a?o(e,a(t)):e}}function Br(){if(Er)return kr;Er=1;var t=oe(),e=Nr(),r=de(),n=ke();return kr=function(i,o,a){for(var u=e(o),c=n.f,s=r.f,f=0;f<u.length;f++){var l=u[f];t(i,l)||a&&t(a,l)||c(i,l,s(o,l))}}}function Ur(){if(Tr)return Ar;Tr=1;var t=h(),e=ht(),r=/#|\.prototype\./,n=function(r,n){var c=o[i(r)];return c===u||c!==a&&(e(n)?t(n):!!n)},i=n.normalize=function(t){return String(t).replace(r,".").toLowerCase()},o=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return Ar=n}function Lr(){if(Ir)return xr;Ir=1;var t=a(),e=de().f,r=Ee(),n=Qe(),i=ee(),o=Br(),u=Ur();return xr=function(a,c){var s,f,l,d,p,v=a.target,m=a.global,h=a.stat;if(s=m?t:h?t[v]||i(v,{}):t[v]&&t[v].prototype)for(f in c){if(d=c[f],l=a.dontCallGetSet?(p=e(s,f))&&p.value:s[f],!u(m?f:v+(h?".":"#")+f,a.forced)&&void 0!==l){if(typeof d==typeof l)continue;o(d,l)}(a.sham||l&&l.sham)&&r(d,"sham",!0),n(s,f,d,a)}}}function Dr(){if(Pr)return Cr;Pr=1;var t=lt(),e=ft();return Cr=function(r){if("Function"===t(r))return e(r)}}function Fr(){if(Mr)return Rr;Mr=1;var t=h();return Rr=function(e,r){var n=[][e];return!!n&&t(function(){n.call(null,r||function(){return 1},1)})}}!function(){if(_r)return o;_r=1;var t=Lr(),e=Dr(),r=hr().indexOf,n=Fr(),i=e([].indexOf),a=!!i&&1/i([1],1,-0)<0;t({target:"Array",proto:!0,forced:a||!n("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return a?i(this,t,e)||0:r(this,t,e)}})}();var qr,zr,Hr,Wr,Gr,Vr,Qr,$r,Yr,Jr,Kr,Xr,Zr,tn,en,rn,nn,on,an,un,cn,sn,fn,ln,dn,pn,vn,mn,hn,yn,gn,bn,wn,Sn,On,kn={};function En(){if(zr)return qr;zr=1;var t=yr(),e=gr();return qr=Object.keys||function(r){return t(r,e)}}function An(){if(Gr)return Wr;Gr=1;var t=gt();return Wr=t("document","documentElement")}function Tn(){if(Qr)return Vr;Qr=1;var t,e=Oe(),r=function(){if(Hr)return kn;Hr=1;var t=y(),e=Se(),r=ke(),n=Oe(),i=mt(),o=En();return kn.f=t&&!e?Object.defineProperties:function(t,e){n(t);for(var a,u=i(e),c=o(e),s=c.length,f=0;s>f;)r.f(t,a=c[f++],u[a]);return t},kn}(),n=gr(),i=We(),o=An(),a=fe(),u=He(),c="prototype",s="script",f=u("IE_PROTO"),l=function(){},d=function(t){return"<"+s+">"+t+"</"+s+">"},p=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{t=new ActiveXObject("htmlfile")}catch(t){}var e,r,i;v="undefined"!=typeof document?document.domain&&t?p(t):(r=a("iframe"),i="java"+s+":",r.style.display="none",o.appendChild(r),r.src=String(i),(e=r.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):p(t);for(var u=n.length;u--;)delete v[c][n[u]];return v()};return i[f]=!0,Vr=Object.create||function(t,n){var i;return null!==t?(l[c]=e(t),i=new l,l[c]=null,i[f]=t):i=v(),void 0===n?i:r.f(i,n)}}function xn(){if(Yr)return $r;Yr=1;var t=ue(),e=Tn(),r=ke().f,n=t("unscopables"),i=Array.prototype;return void 0===i[n]&&r(i,n,{configurable:!0,value:e(null)}),$r=function(t){i[n][t]=!0}}function In(){return Kr?Jr:(Kr=1,Jr={})}function Cn(){if(en)return tn;en=1;var t=oe(),e=ht(),r=ie(),n=He(),i=function(){if(Zr)return Xr;Zr=1;var t=h();return Xr=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})}(),o=n("IE_PROTO"),a=Object,u=a.prototype;return tn=i?a.getPrototypeOf:function(n){var i=r(n);if(t(i,o))return i[o];var c=i.constructor;return e(c)&&i instanceof c?c.prototype:i instanceof a?u:null}}function Pn(){if(nn)return rn;nn=1;var t,e,r,n=h(),i=ht(),o=yt(),a=Tn(),u=Cn(),c=Qe(),s=ue(),f=te(),l=s("iterator"),d=!1;return[].keys&&("next"in(r=[].keys())?(e=u(u(r)))!==Object.prototype&&(t=e):d=!0),!o(t)||n(function(){var e={};return t[l].call(e)!==e})?t={}:f&&(t=a(t)),i(t[l])||c(t,l,function(){return this}),rn={IteratorPrototype:t,BUGGY_SAFARI_ITERATORS:d}}function Rn(){if(an)return on;an=1;var t=ke().f,e=oe(),r=ue()("toStringTag");return on=function(n,i,o){n&&!o&&(n=n.prototype),n&&!e(n,r)&&t(n,r,{configurable:!0,value:i})}}function Mn(){if(dn)return ln;dn=1;var t=yt();return ln=function(e){return t(e)||null===e}}function _n(){if(vn)return pn;vn=1;var t=Mn(),e=String,r=TypeError;return pn=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")}}function jn(){if(hn)return mn;hn=1;var t=function(){if(fn)return sn;fn=1;var t=ft(),e=Tt();return sn=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch(t){}}}(),e=yt(),r=vt(),n=_n();return mn=Object.setPrototypeOf||("__proto__"in{}?function(){var i,o=!1,a={};try{(i=t(Object.prototype,"__proto__","set"))(a,[]),o=a instanceof Array}catch(t){}return function(t,a){return r(t),n(a),e(t)?(o?i(t,a):t.__proto__=a,t):t}}():void 0)}function Nn(){if(gn)return yn;gn=1;var t=Lr(),e=b(),r=te(),n=qe(),i=ht(),o=function(){if(cn)return un;cn=1;var t=Pn().IteratorPrototype,e=Tn(),r=st(),n=Rn(),i=In(),o=function(){return this};return un=function(a,u,c,s){var f=u+" Iterator";return a.prototype=e(t,{next:r(+!s,c)}),n(a,f,!1,!0),i[f]=o,a}}(),a=Cn(),u=jn(),c=Rn(),s=Ee(),f=Qe(),l=ue(),d=In(),p=Pn(),v=n.PROPER,m=n.CONFIGURABLE,h=p.IteratorPrototype,y=p.BUGGY_SAFARI_ITERATORS,g=l("iterator"),w="keys",S="values",O="entries",k=function(){return this};return yn=function(n,l,p,b,E,A,T){o(p,l,b);var x,I,C,P=function(t){if(t===E&&N)return N;if(!y&&t&&t in _)return _[t];switch(t){case w:case S:case O:return function(){return new p(this,t)}}return function(){return new p(this)}},R=l+" Iterator",M=!1,_=n.prototype,j=_[g]||_["@@iterator"]||E&&_[E],N=!y&&j||P(E),B="Array"===l&&_.entries||j;if(B&&(x=a(B.call(new n)))!==Object.prototype&&x.next&&(r||a(x)===h||(u?u(x,h):i(x[g])||f(x,g,k)),c(x,R,!0,!0),r&&(d[R]=k)),v&&E===S&&j&&j.name!==S&&(!r&&m?s(_,"name",S):(M=!0,N=function(){return e(j,this)})),E)if(I={values:P(S),keys:A?N:P(w),entries:P(O)},T)for(C in I)(y||M||!(C in _))&&f(_,C,I[C]);else t({target:l,proto:!0,forced:y||M},I);return r&&!T||_[g]===N||f(_,g,N,{name:E}),d[l]=N,I}}function Bn(){return wn?bn:(wn=1,bn=function(t,e){return{value:t,done:e}})}function Un(){if(On)return Sn;On=1;var t=mt(),e=xn(),r=In(),n=Ge(),i=ke().f,o=Nn(),a=Bn(),u=te(),c=y(),s="Array Iterator",f=n.set,l=n.getterFor(s);Sn=o(Array,"Array",function(e,r){f(this,{type:s,target:t(e),index:0,kind:r})},function(){var t=l(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,a(void 0,!0);switch(t.kind){case"keys":return a(r,!1);case"values":return a(e[r],!1)}return a([r,e[r]],!1)},"values");var d=r.Arguments=r.Array;if(e("keys"),e("values"),e("entries"),!u&&c&&"values"!==d.name)try{i(d,"name",{value:"values"})}catch(t){}return Sn}Un();var Ln,Dn,Fn,qn,zn,Hn,Wn,Gn,Vn,Qn,$n,Yn,Jn,Kn,Xn,Zn={};function ti(){if(Dn)return Ln;Dn=1;var t=lt();return Ln=Array.isArray||function(e){return"Array"===t(e)}}function ei(){if(qn)return Fn;qn=1;var t={};return t[ue()("toStringTag")]="z",Fn="[object z]"===String(t)}function ri(){if(Hn)return zn;Hn=1;var t=ei(),e=ht(),r=lt(),n=ue()("toStringTag"),i=Object,o="Arguments"===r(function(){return arguments}());return zn=t?r:function(t){var a,u,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(u=function(t,e){try{return t[e]}catch(t){}}(a=i(t),n))?u:o?r(a):"Object"===(c=r(a))&&e(a.callee)?"Arguments":c}}function ni(){if(Gn)return Wn;Gn=1;var t=ft(),e=h(),r=ht(),n=ri(),i=gt(),o=ze(),a=function(){},u=i("Reflect","construct"),c=/^\s*(?:class|function)\b/,s=t(c.exec),f=!c.test(a),l=function(t){if(!r(t))return!1;try{return u(a,[],t),!0}catch(t){return!1}},d=function(t){if(!r(t))return!1;switch(n(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!s(c,o(t))}catch(t){return!0}};return d.sham=!0,Wn=!u||e(function(){var t;return l(l.call)||!l(Object)||!l(function(){t=!0})||t})?d:l}function ii(){if(Qn)return Vn;Qn=1;var t=y(),e=ke(),r=st();return Vn=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o}}function oi(){if(Yn)return $n;Yn=1;var t=h(),e=ue(),r=St(),n=e("species");return $n=function(e){return r>=51||!t(function(){var t=[];return(t.constructor={})[n]=function(){return{foo:1}},1!==t[e](Boolean).foo})}}function ai(){if(Kn)return Jn;Kn=1;var t=ft();return Jn=t([].slice)}!function(){if(Xn)return Zn;Xn=1;var t=Lr(),e=ti(),r=ni(),n=yt(),i=pr(),o=mr(),a=mt(),u=ii(),c=ue(),s=oi(),f=ai(),l=s("slice"),d=c("species"),p=Array,v=Math.max;t({target:"Array",proto:!0,forced:!l},{slice:function(t,c){var s,l,m,h=a(this),y=o(h),g=i(t,y),b=i(void 0===c?y:c,y);if(e(h)&&(s=h.constructor,(r(s)&&(s===p||e(s.prototype))||n(s)&&null===(s=s[d]))&&(s=void 0),s===p||void 0===s))return f(h,g,b);for(l=new(void 0===s?p:s)(v(b-g,0)),m=0;g<b;g++,m++)g in h&&u(l,m,h[g]);return l.length=m,l}})}();var ui,ci,si,fi,li,di,pi,vi,mi,hi,yi,gi={};function bi(){if(fi)return si;fi=1;var t=TypeError;return si=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}}function wi(){if(di)return li;di=1;var t=ti(),e=ni(),r=yt(),n=ue()("species"),i=Array;return li=function(o){var a;return t(o)&&(a=o.constructor,(e(a)&&(a===i||t(a.prototype))||r(a)&&null===(a=a[n]))&&(a=void 0)),void 0===a?i:a}}function Si(){if(vi)return pi;vi=1;var t=wi();return pi=function(e,r){return new(t(e))(0===r?0:r)}}function Oi(){if(hi)return mi;hi=1;var t=At(),e=TypeError;return mi=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))}}!function(){if(yi)return gi;yi=1;var t=Lr(),e=ie(),r=pr(),n=dr(),i=mr(),o=function(){if(ci)return ui;ci=1;var t=y(),e=ti(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();return ui=i?function(t,i){if(e(t)&&!n(t,"length").writable)throw new r("Cannot set read only .length");return t.length=i}:function(t,e){return t.length=e}}(),a=bi(),u=Si(),c=ii(),s=Oi(),f=oi()("splice"),l=Math.max,d=Math.min;t({target:"Array",proto:!0,forced:!f},{splice:function(t,f){var p,v,m,h,y,g,b=e(this),w=i(b),S=r(t,w),O=arguments.length;for(0===O?p=v=0:1===O?(p=0,v=w-S):(p=O-2,v=d(l(n(f),0),w-S)),a(w+p-v),m=u(b,v),h=0;h<v;h++)(y=S+h)in b&&c(m,h,b[y]);if(m.length=v,p<v){for(h=S;h<w-v;h++)g=h+p,(y=h+v)in b?b[g]=b[y]:s(b,g);for(h=w;h>w-v+p;h--)s(b,h-1)}else if(p>v)for(h=w-v;h>S;h--)g=h+p-1,(y=h+v-1)in b?b[g]=b[y]:s(b,g);for(h=0;h<p;h++)b[h+S]=arguments[h+2];return o(b,w-v+p),m}})}();var ki,Ei,Ai,Ti={};!function(){if(Ai)return Ti;Ai=1;var t=ei(),e=Qe(),r=function(){if(Ei)return ki;Ei=1;var t=ei(),e=ri();return ki=t?{}.toString:function(){return"[object "+e(this)+"]"}}();t||e(Object.prototype,"toString",r,{unsafe:!0})}();var xi,Ii,Ci,Pi,Ri,Mi,_i,ji,Ni,Bi,Ui,Li,Di,Fi,qi,zi,Hi,Wi,Gi,Vi,Qi,$i,Yi,Ji,Ki,Xi,Zi,to,eo,ro,no,io,oo,ao,uo,co,so,fo,lo={exports:{}},po={};function vo(){if(xi)return po;xi=1;var t=lt(),e=mt(),r=br().f,n=ai(),i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];return po.f=function(o){return i&&"Window"===t(o)?function(t){try{return r(t)}catch(t){return n(i)}}(o):r(e(o))},po}function mo(){if(Ri)return Pi;Ri=1;var t=h(),e=yt(),r=lt(),n=function(){if(Ci)return Ii;Ci=1;var t=h();return Ii=t(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})}(),i=Object.isExtensible,o=t(function(){});return Pi=o||n?function(t){return!!e(t)&&((!n||"ArrayBuffer"!==r(t))&&(!i||i(t)))}:i}function ho(){if(ji)return lo.exports;ji=1;var t=Lr(),e=ft(),r=We(),n=yt(),i=oe(),o=ke().f,a=br(),u=vo(),c=mo(),s=ae(),f=function(){if(_i)return Mi;_i=1;var t=h();return Mi=!t(function(){return Object.isExtensible(Object.preventExtensions({}))})}(),l=!1,d=s("meta"),p=0,v=function(t){o(t,d,{value:{objectID:"O"+p++,weakData:{}}})},m=lo.exports={enable:function(){m.enable=function(){},l=!0;var r=a.f,n=e([].splice),i={};i[d]=1,r(i).length&&(a.f=function(t){for(var e=r(t),i=0,o=e.length;i<o;i++)if(e[i]===d){n(e,i,1);break}return e},t({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,d)){if(!c(t))return"F";if(!e)return"E";v(t)}return t[d].objectID},getWeakData:function(t,e){if(!i(t,d)){if(!c(t))return!0;if(!e)return!1;v(t)}return t[d].weakData},onFreeze:function(t){return f&&l&&c(t)&&!i(t,d)&&v(t),t}};return r[d]=!0,lo.exports}function yo(){if(Bi)return Ni;Bi=1;var t=Dr(),e=Tt(),r=g(),n=t(t.bind);return Ni=function(t,i){return e(t),void 0===i?t:r?n(t,i):function(){return t.apply(i,arguments)}},Ni}function go(){if(Li)return Ui;Li=1;var t=ue(),e=In(),r=t("iterator"),n=Array.prototype;return Ui=function(t){return void 0!==t&&(e.Array===t||n[r]===t)}}function bo(){if(Fi)return Di;Fi=1;var t=ri(),e=xt(),r=pt(),n=In(),i=ue()("iterator");return Di=function(o){if(!r(o))return e(o,i)||e(o,"@@iterator")||n[t(o)]}}function wo(){if(zi)return qi;zi=1;var t=b(),e=Tt(),r=Oe(),n=At(),i=bo(),o=TypeError;return qi=function(a,u){var c=arguments.length<2?i(a):u;if(e(c))return r(t(c,a));throw new o(n(a)+" is not iterable")},qi}function So(){if(Wi)return Hi;Wi=1;var t=b(),e=Oe(),r=xt();return Hi=function(n,i,o){var a,u;e(n);try{if(!(a=r(n,"return"))){if("throw"===i)throw o;return o}a=t(a,n)}catch(t){u=!0,a=t}if("throw"===i)throw o;if(u)throw a;return e(a),o}}function Oo(){if(Vi)return Gi;Vi=1;var t=yo(),e=b(),r=Oe(),n=At(),i=go(),o=mr(),a=bt(),u=wo(),c=bo(),s=So(),f=TypeError,l=function(t,e){this.stopped=t,this.result=e},d=l.prototype;return Gi=function(p,v,m){var h,y,g,b,w,S,O,k=m&&m.that,E=!(!m||!m.AS_ENTRIES),A=!(!m||!m.IS_RECORD),T=!(!m||!m.IS_ITERATOR),x=!(!m||!m.INTERRUPTED),I=t(v,k),C=function(t){return h&&s(h,"normal"),new l(!0,t)},P=function(t){return E?(r(t),x?I(t[0],t[1],C):I(t[0],t[1])):x?I(t,C):I(t)};if(A)h=p.iterator;else if(T)h=p;else{if(!(y=c(p)))throw new f(n(p)+" is not iterable");if(i(y)){for(g=0,b=o(p);b>g;g++)if((w=P(p[g]))&&a(d,w))return w;return new l(!1)}h=u(p,y)}for(S=A?p.next:h.next;!(O=e(S,h)).done;){try{w=P(O.value)}catch(t){s(h,"throw",t)}if("object"==typeof w&&w&&a(d,w))return w}return new l(!1)}}function ko(){if($i)return Qi;$i=1;var t=bt(),e=TypeError;return Qi=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")}}function Eo(){if(Ji)return Yi;Ji=1;var t=ue()("iterator"),e=!1;try{var r=0,n={next:function(){return{done:!!r++}},return:function(){e=!0}};n[t]=function(){return this},Array.from(n,function(){throw 2})}catch(t){}return Yi=function(r,n){try{if(!n&&!e)return!1}catch(t){return!1}var i=!1;try{var o={};o[t]=function(){return{next:function(){return{done:i=!0}}}},r(o)}catch(t){}return i}}function Ao(){if(Xi)return Ki;Xi=1;var t=ht(),e=yt(),r=jn();return Ki=function(n,i,o){var a,u;return r&&t(a=i.constructor)&&a!==o&&e(u=a.prototype)&&u!==o.prototype&&r(n,u),n}}function To(){if(to)return Zi;to=1;var t=Lr(),e=a(),r=ft(),n=Ur(),i=Qe(),o=ho(),u=Oo(),c=ko(),s=ht(),f=pt(),l=yt(),d=h(),p=Eo(),v=Rn(),m=Ao();return Zi=function(a,h,y){var g=-1!==a.indexOf("Map"),b=-1!==a.indexOf("Weak"),w=g?"set":"add",S=e[a],O=S&&S.prototype,k=S,E={},A=function(t){var e=r(O[t]);i(O,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(b&&!l(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return b&&!l(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(b&&!l(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(n(a,!s(S)||!(b||O.forEach&&!d(function(){(new S).entries().next()}))))k=y.getConstructor(h,a,g,w),o.enable();else if(n(a,!0)){var T=new k,x=T[w](b?{}:-0,1)!==T,I=d(function(){T.has(1)}),C=p(function(t){new S(t)}),P=!b&&d(function(){for(var t=new S,e=5;e--;)t[w](e,e);return!t.has(-0)});C||((k=h(function(t,e){c(t,O);var r=m(new S,t,k);return f(e)||u(e,r[w],{that:r,AS_ENTRIES:g}),r})).prototype=O,O.constructor=k),(I||P)&&(A("delete"),A("has"),g&&A("get")),(P||x)&&A(w),b&&O.clear&&delete O.clear}return E[a]=k,t({global:!0,constructor:!0,forced:k!==S},E),v(k,a),b||y.setStrong(k,a,g),k}}function xo(){if(ro)return eo;ro=1;var t=Ve(),e=ke();return eo=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)}}function Io(){if(io)return no;io=1;var t=Qe();return no=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e}}function Co(){if(ao)return oo;ao=1;var t=gt(),e=xo(),r=ue(),n=y(),i=r("species");return oo=function(r){var o=t(r);n&&o&&!o[i]&&e(o,i,{configurable:!0,get:function(){return this}})}}function Po(){if(co)return uo;co=1;var t=Tn(),e=xo(),r=Io(),n=yo(),i=ko(),o=pt(),a=Oo(),u=Nn(),c=Bn(),s=Co(),f=y(),l=ho().fastKey,d=Ge(),p=d.set,v=d.getterFor;return uo={getConstructor:function(u,c,s,d){var m=u(function(e,r){i(e,h),p(e,{type:c,index:t(null),first:null,last:null,size:0}),f||(e.size=0),o(r)||a(r,e[d],{that:e,AS_ENTRIES:s})}),h=m.prototype,y=v(c),g=function(t,e,r){var n,i,o=y(t),a=b(t,e);return a?a.value=r:(o.last=a={index:i=l(e,!0),key:e,value:r,previous:n=o.last,next:null,removed:!1},o.first||(o.first=a),n&&(n.next=a),f?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},b=function(t,e){var r,n=y(t),i=l(e);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key===e)return r};return r(h,{clear:function(){for(var e=y(this),r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=null),r=r.next;e.first=e.last=null,e.index=t(null),f?e.size=0:this.size=0},delete:function(t){var e=this,r=y(e),n=b(e,t);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first===n&&(r.first=i),r.last===n&&(r.last=o),f?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=y(this),i=n(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(i(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!b(this,t)}}),r(h,s?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),f&&e(h,"size",{configurable:!0,get:function(){return y(this).size}}),m},setStrong:function(t,e,r){var n=e+" Iterator",i=v(e),o=v(n);u(t,e,function(t,e){p(this,{type:n,target:t,state:i(t),kind:e,last:null})},function(){for(var t=o(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?c("keys"===e?r.key:"values"===e?r.value:[r.key,r.value],!1):(t.target=null,c(void 0,!0))},r?"entries":"values",!r,!0),s(e)}},uo}fo||(fo=1,so||(so=1,To()("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Po())));var Ro,Mo,_o,jo,No,Bo={};function Uo(){if(Mo)return Ro;Mo=1;var t=ri(),e=String;return Ro=function(r){if("Symbol"===t(r))throw new TypeError("Cannot convert a Symbol value to a string");return e(r)}}function Lo(){if(jo)return _o;jo=1;var t=ft(),e=dr(),r=Uo(),n=vt(),i=t("".charAt),o=t("".charCodeAt),a=t("".slice),u=function(t){return function(u,c){var s,f,l=r(n(u)),d=e(c),p=l.length;return d<0||d>=p?t?"":void 0:(s=o(l,d))<55296||s>56319||d+1===p||(f=o(l,d+1))<56320||f>57343?t?i(l,d):s:t?a(l,d,d+2):f-56320+(s-55296<<10)+65536}};return _o={codeAt:u(!1),charAt:u(!0)}}!function(){if(No)return Bo;No=1;var t=Lo().charAt,e=Uo(),r=Ge(),n=Nn(),i=Bn(),o="String Iterator",a=r.set,u=r.getterFor(o);n(String,"String",function(t){a(this,{type:o,string:e(t),index:0})},function(){var e,r=u(this),n=r.string,o=r.index;return o>=n.length?i(void 0,!0):(e=t(n,o),r.index+=e.length,i(e,!1))})}();var Do,Fo,qo={};Fo||(Fo=1,function(){if(Do)return qo;Do=1;var t=Lr(),e=a();t({global:!0,forced:e.globalThis!==e},{globalThis:e})}());var zo,Ho,Wo,Go,Vo,Qo,$o,Yo,Jo,Ko={};function Xo(){return Ho?zo:(Ho=1,zo={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})}function Zo(){if(Go)return Wo;Go=1;var t=fe()("span").classList,e=t&&t.constructor&&t.constructor.prototype;return Wo=e===Object.prototype?void 0:e}function ta(){if(Qo)return Vo;Qo=1;var t=yo(),e=ft(),r=dt(),n=ie(),i=mr(),o=Si(),a=e([].push),u=function(e){var u=1===e,c=2===e,s=3===e,f=4===e,l=6===e,d=7===e,p=5===e||l;return function(v,m,h,y){for(var g,b,w=n(v),S=r(w),O=i(S),k=t(m,h),E=0,A=y||o,T=u?A(v,O):c||d?A(v,0):void 0;O>E;E++)if((p||E in S)&&(b=k(g=S[E],E,w),e))if(u)T[E]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return E;case 2:a(T,g)}else switch(e){case 4:return!1;case 7:a(T,g)}return l?-1:s||f?f:T}};return Vo={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}}!function(){if(Jo)return Ko;Jo=1;var t=a(),e=Xo(),r=Zo(),n=function(){if(Yo)return $o;Yo=1;var t=ta().forEach,e=Fr()("forEach");return $o=e?[].forEach:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)},$o}(),i=Ee(),o=function(t){if(t&&t.forEach!==n)try{i(t,"forEach",n)}catch(e){t.forEach=n}};for(var u in e)e[u]&&o(t[u]&&t[u].prototype);o(r)}();var ea,ra={};!function(){if(ea)return ra;ea=1;var t=a(),e=Xo(),r=Zo(),n=Un(),i=Ee(),o=Rn(),u=ue()("iterator"),c=n.values,s=function(t,r){if(t){if(t[u]!==c)try{i(t,u,c)}catch(e){t[u]=c}if(o(t,r,!0),e[r])for(var a in n)if(t[a]!==n[a])try{i(t,a,n[a])}catch(e){t[a]=n[a]}}};for(var f in e)s(t[f]&&t[f].prototype,f);s(r,"DOMTokenList")}(),function(t){var e=!(!t.starmusConfig||!t.starmusConfig.debug);function r(){if(e)try{(console.log||function(){}).apply(console,arguments)}catch(t){}}var n="function"==typeof Set,i={},o={};void 0===t.StarmusHooks&&(t.StarmusHooks={}),t.StarmusHooks.subscribe=function(t,e){var r,o;return i[t]||(i[t]=n?new Set:[]),r=i[t],o=e,n?r.add(o):-1===r.indexOf(o)&&r.push(o),function(){i[t]&&function(t,e){if(n)t.delete(e);else{var r=t.indexOf(e);-1!==r&&t.splice(r,1)}}(i[t],e)}},t.StarmusHooks.dispatch=function(t,e,a){e=e||{};var u=t+"::"+((a=a||{}).instanceId||"");if(o[u])r("Prevented recursive dispatch:",t);else{o[u]=!0;try{var c=i[t];if(!c)return;!function(t,e){if(n)t.forEach(e);else for(var r=t.slice(),i=0;i<r.length;i++)e(r[i])}(c,function(r){try{r(e,a)}catch(e){console.error("Error executing handler for command "+t+":",e)}})}finally{delete o[u]}}},t.StarmusHooks.debugLog=r}("undefined"!=typeof window?window:globalThis);var na="undefined"!=typeof window?window:globalThis,ia=na.StarmusHooks&&na.StarmusHooks.debugLog||function(){},oa=na.StarmusHooks&&na.StarmusHooks.dispatch||function(){},aa=na.StarmusHooks&&na.StarmusHooks.subscribe||function(){};"undefined"!=typeof module&&module.exports&&(module.exports={debugLog:ia,subscribe:na.StarmusHooks.subscribe,dispatch:na.StarmusHooks.dispatch});var ua,ca={subscribe:aa,dispatch:oa,unsubscribeInstance:function(t){}},sa={};function fa(t){return window.StarmusStore.createStore(t)}function la(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function da(t,e,r,n,i,o,a){try{var u=t[o](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,i)}function pa(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var o=t.apply(e,r);function a(t){da(o,n,i,a,u,"next",t)}function u(t){da(o,n,i,a,u,"throw",t)}a(void 0)})}}function va(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ma(t,e,r){return e&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ea(n.key),n)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ha(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ta(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function ya(t,e,r){return(e=Ea(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ga(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function ba(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ga(Object(r),!0).forEach(function(e){ya(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ga(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function wa(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var c=n&&n.prototype instanceof u?n:u,s=Object.create(c.prototype);return Sa(s,"_invoke",function(r,n,i){var o,u,c,s=0,f=i||[],l=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,r){return o=e,u=0,c=t,d.n=r,a}};function p(r,n){for(u=r,c=n,e=0;!l&&s&&!i&&e<f.length;e++){var i,o=f[e],p=d.p,v=o[2];r>3?(i=v===n)&&(c=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=t):o[0]<=p&&((i=r<2&&p<o[1])?(u=0,d.v=n,d.n=o[1]):p<v&&(i=r<3||o[0]>n||n>v)&&(o[4]=r,o[5]=n,d.n=v,u=0))}if(i||r>1)return a;throw l=!0,n}return function(i,f,v){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&p(f,v),u=f,c=v;(e=u<2?t:c)||!l;){o||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(s=2,o){if(u||(i="next"),e=o[i]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=o.return)&&e.call(o),u<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),u=1);o=t}else if((e=(l=d.n<0)?c:r.call(n,d))!==a)break}catch(e){o=t,u=1,c=e}finally{s=1}}return{value:e,done:l}}}(r,i,o),!0),s}var a={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var f=[][n]?e(e([][n]())):(Sa(e={},n,function(){return this}),e),l=s.prototype=u.prototype=Object.create(f);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Sa(t,i,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=s,Sa(l,"constructor",s),Sa(s,"constructor",c),c.displayName="GeneratorFunction",Sa(s,i,"GeneratorFunction"),Sa(l),Sa(l,i,"Generator"),Sa(l,n,function(){return this}),Sa(l,"toString",function(){return"[object Generator]"}),(wa=function(){return{w:o,m:d}})()}function Sa(t,e,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Sa=function(t,e,r,n){function o(e,r){Sa(t,e,function(t){return this._invoke(e,r,t)})}e?i?i(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(o("next",0),o("throw",1),o("return",2))},Sa(t,e,r,n)}function Oa(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(typeof t+" is not iterable")}function ka(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,u=[],c=!0,s=!1;try{if(o=(r=r.call(t)).next,0===e);else for(;!(c=(n=o.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){s=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw i}}return u}}(t,e)||Ta(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ea(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof e?e:e+""}function Aa(t){return Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(t)}function Ta(t,e){if(t){if("string"==typeof t)return la(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?la(t,e):void 0}}!function(){if(ua)return sa;ua=1;var t=y(),e=qe().EXISTS,r=ft(),n=xo(),i=Function.prototype,o=r(i.toString),a=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=r(a.exec);t&&!e&&n(i,"name",{configurable:!0,get:function(){try{return u(a,o(this))[1]}catch(t){return""}}})}(),function(t){var e={instanceId:null,env:{},tier:null,status:"uninitialized",error:null,source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""},calibration:{phase:null,message:"",volumePercent:0,complete:!1,gain:1},recorder:{duration:0,amplitude:0,isPlaying:!1,isPaused:!1},submission:{progress:0,isQueued:!1}};function r(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function n(t,e){var n=r(t);for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n}function i(t){var i=n(e,t||{}),o=[];return{getState:function(){return i},dispatch:function(t){i=function(t,i){if(!i||!i.type)return t;switch(!t.instanceId&&i.payload&&i.payload.instanceId&&(t=n(t,{instanceId:i.payload.instanceId})),i.type){case"starmus/tier-ready":return t.tier?t:n(t,{tier:i.payload&&i.payload.tier?i.payload.tier:t.tier});case"starmus/init":return n(t,n(i.payload||{},{status:"idle",error:null}));case"starmus/ui/step-continue":return n(t,{status:"ready_to_record",error:null});case"starmus/calibration-start":return n(t,{status:"calibrating"});case"starmus/calibration-update":return n(t,{calibration:n(t.calibration,{message:i.message,volumePercent:i.volumePercent})});case"starmus/calibration-complete":return n(t,{status:"ready",calibration:n(t.calibration,n(i.calibration||{},{complete:!0}))});case"starmus/mic-start":return n(t,{status:"recording",error:null,recorder:n(t.recorder,{duration:0,amplitude:0,isPaused:!1})});case"starmus/mic-pause":return n(t,{status:"paused",recorder:n(t.recorder,{isPaused:!0})});case"starmus/mic-resume":return n(t,{status:"recording",recorder:n(t.recorder,{isPaused:!1})});case"starmus/mic-stop":return n(t,{status:"processing"});case"starmus/recorder-tick":return n(t,{recorder:n(t.recorder,{duration:i.duration,amplitude:i.amplitude})});case"starmus/recording-available":return n(t,{status:"ready_to_submit",source:n(t.source,{kind:"blob",blob:i.payload.blob,fileName:i.payload.fileName})});case"starmus/recorder-playback-state":return n(t,{recorder:n(t.recorder,{isPlaying:i.isPlaying})});case"starmus/transcript-update":return n(t,{source:n(t.source,{transcript:i.transcript})});case"starmus/transcript-interim":return n(t,{source:n(t.source,{interimTranscript:i.interim})});case"starmus/env-update":return n(t,{env:n(t.env,i.payload||{}),tier:i.tier||t.tier});case"starmus/file-attached":return n(t,{status:"ready_to_submit",source:{kind:"file",file:i.file,fileName:i.file.name}});case"starmus/submit-start":return n(t,{status:"submitting",error:null});case"starmus/submit-progress":return n(t,{submission:n(t.submission,{progress:i.progress})});case"starmus/submit-complete":return n(t,{status:"complete",submission:{progress:1,isQueued:!1}});case"starmus/submit-queued":return n(t,{status:"complete",submission:{progress:0,isQueued:!0}});case"starmus/error":return n(t,{error:i.error||i.payload});case"starmus/reset":return n(r(e),{instanceId:t.instanceId,env:t.env,tier:t.tier,status:"idle",source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""}});default:return t}}(i,t);for(var a=0;a<o.length;a++)try{o[a](i)}catch(t){console.error(t)}},subscribe:function(t){return-1===o.indexOf(t)&&o.push(t),function(){var e=o.indexOf(t);-1!==e&&o.splice(e,1)}}}}t.StarmusStore=t.StarmusStore||{},t.StarmusStore.createStore=i,"undefined"!=typeof module&&module.exports&&(module.exports={createStore:i}),"undefined"!=typeof exports&&(exports.createStore=i)}("undefined"!=typeof window?window:globalThis);var xa,Ia={};!function(){if(xa)return Ia;xa=1;var t=Lr(),e=h(),r=ti(),n=yt(),i=ie(),o=mr(),a=bi(),u=ii(),c=Si(),s=oi(),f=ue(),l=St(),d=f("isConcatSpreadable"),p=l>=51||!e(function(){var t=[];return t[d]=!1,t.concat()[0]!==t}),v=function(t){if(!n(t))return!1;var e=t[d];return void 0!==e?!!e:r(t)};t({target:"Array",proto:!0,arity:1,forced:!p||!s("concat")},{concat:function(t){var e,r,n,s,f,l=i(this),d=c(l,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(v(f=-1===e?l:arguments[e]))for(s=o(f),a(p+s),r=0;r<s;r++,p++)r in f&&u(d,p,f[r]);else a(p+1),u(d,p++,f);return d.length=p,d}})}();var Ca,Pa={};!function(){if(Ca)return Pa;Ca=1;var t=Lr(),e=ft(),r=dt(),n=mt(),i=Fr(),o=e([].join);t({target:"Array",proto:!0,forced:r!==Object||!i("join",",")},{join:function(t){return o(n(this),void 0===t?",":t)}})}();var Ra,Ma,_a,ja,Na,Ba,Ua,La={};function Da(){if(Ma)return Ra;Ma=1;var t=Tt(),e=ie(),r=dt(),n=mr(),i=TypeError,o="Reduce of empty array with no initial value",a=function(a){return function(u,c,s,f){var l=e(u),d=r(l),p=n(l);if(t(c),0===p&&s<2)throw new i(o);var v=a?p-1:0,m=a?-1:1;if(s<2)for(;;){if(v in d){f=d[v],v+=m;break}if(v+=m,a?v<0:p<=v)throw new i(o)}for(;a?v>=0:p>v;v+=m)v in d&&(f=c(f,d[v],v,l));return f}};return Ra={left:a(!1),right:a(!0)}}function Fa(){if(ja)return _a;ja=1;var t=a(),e=wt(),r=lt(),n=function(t){return e.slice(0,t.length)===t};return _a=n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&"string"==typeof Bun.version?"BUN":t.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(t.process)?"NODE":t.window&&t.document?"BROWSER":"REST"}function qa(){if(Ba)return Na;Ba=1;var t=Fa();return Na="NODE"===t}!function(){if(Ua)return La;Ua=1;var t=Lr(),e=Da().left,r=Fr(),n=St();t({target:"Array",proto:!0,forced:!qa()&&n>79&&n<83||!r("reduce")},{reduce:function(t){var r=arguments.length;return e(this,t,r,r>1?arguments[1]:void 0)}})}();var za,Ha,Wa,Ga={};!function(){if(Wa)return Ga;Wa=1;var t=Lr(),e=function(){if(Ha)return za;Ha=1;var t=y(),e=h(),r=ft(),n=Cn(),i=En(),o=mt(),a=r(ct().f),u=r([].push),c=t&&e(function(){var t=Object.create(null);return t[2]=2,!a(t,2)}),s=function(e){return function(r){for(var s,f=o(r),l=i(f),d=c&&null===n(f),p=l.length,v=0,m=[];p>v;)s=l[v++],t&&!(d?s in f:a(f,s))||u(m,e?[s,f[s]]:f[s]);return m}};return za={entries:s(!0),values:s(!1)}}().entries;t({target:"Object",stat:!0},{entries:function(t){return e(t)}})}();var Va,Qa={};!function(){if(Va)return Qa;Va=1;var t=Lr(),e=ie(),r=En();t({target:"Object",stat:!0,forced:h()(function(){r(1)})},{keys:function(t){return r(e(t))}})}();var $a,Ya,Ja,Ka,Xa,Za,tu,eu,ru,nu,iu,ou,au,uu,cu,su,fu,lu,du,pu,vu,mu,hu,yu,gu,bu,wu,Su,Ou,ku,Eu,Au,Tu={};function xu(){if(Ya)return $a;Ya=1;var t=a();return $a=t}function Iu(){if(Ka)return Ja;Ka=1;var t=ni(),e=At(),r=TypeError;return Ja=function(n){if(t(n))return n;throw new r(e(n)+" is not a constructor")}}function Cu(){if(Za)return Xa;Za=1;var t=Oe(),e=Iu(),r=pt(),n=ue()("species");return Xa=function(i,o){var a,u=t(i).constructor;return void 0===u||r(a=t(u)[n])?o:e(a)}}function Pu(){if(eu)return tu;eu=1;var t=g(),e=Function.prototype,r=e.apply,n=e.call;return tu="object"==typeof Reflect&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),tu}function Ru(){if(nu)return ru;nu=1;var t=TypeError;return ru=function(e,r){if(e<r)throw new t("Not enough arguments");return e}}function Mu(){if(ou)return iu;ou=1;var t=wt();return iu=/(?:ipad|iphone|ipod).*applewebkit/i.test(t)}function _u(){if(uu)return au;uu=1;var t,e,r,n,i=a(),o=Pu(),u=yo(),c=ht(),s=oe(),f=h(),l=An(),d=ai(),p=fe(),v=Ru(),m=Mu(),y=qa(),g=i.setImmediate,b=i.clearImmediate,w=i.process,S=i.Dispatch,O=i.Function,k=i.MessageChannel,E=i.String,A=0,T={},x="onreadystatechange";f(function(){t=i.location});var I=function(t){if(s(T,t)){var e=T[t];delete T[t],e()}},C=function(t){return function(){I(t)}},P=function(t){I(t.data)},R=function(e){i.postMessage(E(e),t.protocol+"//"+t.host)};return g&&b||(g=function(t){v(arguments.length,1);var r=c(t)?t:O(t),n=d(arguments,1);return T[++A]=function(){o(r,void 0,n)},e(A),A},b=function(t){delete T[t]},y?e=function(t){w.nextTick(C(t))}:S&&S.now?e=function(t){S.now(C(t))}:k&&!m?(n=(r=new k).port2,r.port1.onmessage=P,e=u(n.postMessage,n)):i.addEventListener&&c(i.postMessage)&&!i.importScripts&&t&&"file:"!==t.protocol&&!f(R)?(e=R,i.addEventListener("message",P,!1)):e=x in p("script")?function(t){l.appendChild(p("script"))[x]=function(){l.removeChild(this),I(t)}}:function(t){setTimeout(C(t),0)}),au={set:g,clear:b}}function ju(){if(su)return cu;su=1;var t=a(),e=y(),r=Object.getOwnPropertyDescriptor;return cu=function(n){if(!e)return t[n];var i=r(t,n);return i&&i.value}}function Nu(){if(lu)return fu;lu=1;var t=function(){this.head=null,this.tail=null};return t.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},fu=t}function Bu(){if(yu)return hu;yu=1;var t,e,r,n,i,o=a(),u=ju(),c=yo(),s=_u().set,f=Nu(),l=Mu(),d=function(){if(pu)return du;pu=1;var t=wt();return du=/ipad|iphone|ipod/i.test(t)&&"undefined"!=typeof Pebble}(),p=function(){if(mu)return vu;mu=1;var t=wt();return vu=/web0s(?!.*chrome)/i.test(t)}(),v=qa(),m=o.MutationObserver||o.WebKitMutationObserver,h=o.document,y=o.process,g=o.Promise,b=u("queueMicrotask");if(!b){var w=new f,S=function(){var e,r;for(v&&(e=y.domain)&&e.exit();r=w.get();)try{r()}catch(e){throw w.head&&t(),e}e&&e.enter()};l||v||p||!m||!h?!d&&g&&g.resolve?((n=g.resolve(void 0)).constructor=g,i=c(n.then,n),t=function(){i(S)}):v?t=function(){y.nextTick(S)}:(s=c(s,o),t=function(){s(S)}):(e=!0,r=h.createTextNode(""),new m(S).observe(r,{characterData:!0}),t=function(){r.data=e=!e}),b=function(e){w.head||t(),w.add(e)}}return hu=b}function Uu(){return bu||(bu=1,gu=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}),gu}function Lu(){return Su?wu:(Su=1,wu=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}})}function Du(){if(ku)return Ou;ku=1;var t=a();return Ou=t.Promise}function Fu(){if(Au)return Eu;Au=1;var t=a(),e=Du(),r=ht(),n=Ur(),i=ze(),o=ue(),u=Fa(),c=te(),s=St(),f=e&&e.prototype,l=o("species"),d=!1,p=r(t.PromiseRejectionEvent),v=n("Promise",function(){var t=i(e),r=t!==String(e);if(!r&&66===s)return!0;if(c&&(!f.catch||!f.finally))return!0;if(!s||s<51||!/native code/.test(t)){var n=new e(function(t){t(1)}),o=function(t){t(function(){},function(){})};if((n.constructor={})[l]=o,!(d=n.then(function(){})instanceof o))return!0}return!(r||"BROWSER"!==u&&"DENO"!==u||p)});return Eu={CONSTRUCTOR:v,REJECTION_EVENT:p,SUBCLASSING:d}}var qu,zu,Hu={};function Wu(){if(qu)return Hu;qu=1;var t=Tt(),e=TypeError,r=function(r){var n,i;this.promise=new r(function(t,r){if(void 0!==n||void 0!==i)throw new e("Bad Promise constructor");n=t,i=r}),this.resolve=t(n),this.reject=t(i)};return Hu.f=function(t){return new r(t)},Hu}var Gu,Vu,Qu,$u={};function Yu(){if(Vu)return Gu;Vu=1;var t=Du(),e=Eo(),r=Fu().CONSTRUCTOR;return Gu=r||!e(function(e){t.all(e).then(void 0,function(){})})}var Ju,Ku={};var Xu,Zu={};var tc,ec={};var rc,nc,ic,oc,ac={};function uc(){if(nc)return rc;nc=1;var t=Oe(),e=yt(),r=Wu();return rc=function(n,i){if(t(n),e(i)&&i.constructor===n)return i;var o=r.f(n);return(0,o.resolve)(i),o.promise}}oc||(oc=1,function(){if(zu)return Tu;zu=1;var t,e,r,n,i=Lr(),o=te(),u=qa(),c=a(),s=xu(),f=b(),l=Qe(),d=jn(),p=Rn(),v=Co(),m=Tt(),h=ht(),y=yt(),g=ko(),w=Cu(),S=_u().set,O=Bu(),k=Uu(),E=Lu(),A=Nu(),T=Ge(),x=Du(),I=Fu(),C=Wu(),P="Promise",R=I.CONSTRUCTOR,M=I.REJECTION_EVENT,_=I.SUBCLASSING,j=T.getterFor(P),N=T.set,B=x&&x.prototype,U=x,L=B,D=c.TypeError,F=c.document,q=c.process,z=C.f,H=z,W=!!(F&&F.createEvent&&c.dispatchEvent),G="unhandledrejection",V=function(t){var e;return!(!y(t)||!h(e=t.then))&&e},Q=function(t,e){var r,n,i,o=e.value,a=1===e.state,u=a?t.ok:t.fail,c=t.resolve,s=t.reject,l=t.domain;try{u?(a||(2===e.rejection&&X(e),e.rejection=1),!0===u?r=o:(l&&l.enter(),r=u(o),l&&(l.exit(),i=!0)),r===t.promise?s(new D("Promise-chain cycle")):(n=V(r))?f(n,r,c,s):c(r)):s(o)}catch(t){l&&!i&&l.exit(),s(t)}},$=function(t,e){t.notified||(t.notified=!0,O(function(){for(var r,n=t.reactions;r=n.get();)Q(r,t);t.notified=!1,e&&!t.rejection&&J(t)}))},Y=function(t,e,r){var n,i;W?((n=F.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),c.dispatchEvent(n)):n={promise:e,reason:r},!M&&(i=c["on"+t])?i(n):t===G&&k("Unhandled promise rejection",r)},J=function(t){f(S,c,function(){var e,r=t.facade,n=t.value;if(K(t)&&(e=E(function(){u?q.emit("unhandledRejection",n,r):Y(G,r,n)}),t.rejection=u||K(t)?2:1,e.error))throw e.value})},K=function(t){return 1!==t.rejection&&!t.parent},X=function(t){f(S,c,function(){var e=t.facade;u?q.emit("rejectionHandled",e):Y("rejectionhandled",e,t.value)})},Z=function(t,e,r){return function(n){t(e,n,r)}},tt=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,$(t,!0))},et=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw new D("Promise can't be resolved itself");var n=V(e);n?O(function(){var r={done:!1};try{f(n,e,Z(et,r,t),Z(tt,r,t))}catch(e){tt(r,e,t)}}):(t.value=e,t.state=1,$(t,!1))}catch(e){tt({done:!1},e,t)}}};if(R&&(L=(U=function(e){g(this,L),m(e),f(t,this);var r=j(this);try{e(Z(et,r),Z(tt,r))}catch(t){tt(r,t)}}).prototype,(t=function(t){N(this,{type:P,done:!1,notified:!1,parent:!1,reactions:new A,rejection:!1,state:0,value:null})}).prototype=l(L,"then",function(t,e){var r=j(this),n=z(w(this,U));return r.parent=!0,n.ok=!h(t)||t,n.fail=h(e)&&e,n.domain=u?q.domain:void 0,0===r.state?r.reactions.add(n):O(function(){Q(n,r)}),n.promise}),e=function(){var e=new t,r=j(e);this.promise=e,this.resolve=Z(et,r),this.reject=Z(tt,r)},C.f=z=function(t){return t===U||t===r?new e(t):H(t)},!o&&h(x)&&B!==Object.prototype)){n=B.then,_||l(B,"then",function(t,e){var r=this;return new U(function(t,e){f(n,r,t,e)}).then(t,e)},{unsafe:!0});try{delete B.constructor}catch(t){}d&&d(B,L)}i({global:!0,constructor:!0,wrap:!0,forced:R},{Promise:U}),r=s.Promise,p(U,P,!1,!0),v(P)}(),function(){if(Qu)return $u;Qu=1;var t=Lr(),e=b(),r=Tt(),n=Wu(),i=Lu(),o=Oo();t({target:"Promise",stat:!0,forced:Yu()},{all:function(t){var a=this,u=n.f(a),c=u.resolve,s=u.reject,f=i(function(){var n=r(a.resolve),i=[],u=0,f=1;o(t,function(t){var r=u++,o=!1;f++,e(n,a,t).then(function(t){o||(o=!0,i[r]=t,--f||c(i))},s)}),--f||c(i)});return f.error&&s(f.value),u.promise}})}(),function(){if(Ju)return Ku;Ju=1;var t=Lr(),e=te(),r=Fu().CONSTRUCTOR,n=Du(),i=gt(),o=ht(),a=Qe(),u=n&&n.prototype;if(t({target:"Promise",proto:!0,forced:r,real:!0},{catch:function(t){return this.then(void 0,t)}}),!e&&o(n)){var c=i("Promise").prototype.catch;u.catch!==c&&a(u,"catch",c,{unsafe:!0})}}(),function(){if(Xu)return Zu;Xu=1;var t=Lr(),e=b(),r=Tt(),n=Wu(),i=Lu(),o=Oo();t({target:"Promise",stat:!0,forced:Yu()},{race:function(t){var a=this,u=n.f(a),c=u.reject,s=i(function(){var n=r(a.resolve);o(t,function(t){e(n,a,t).then(u.resolve,c)})});return s.error&&c(s.value),u.promise}})}(),function(){if(tc)return ec;tc=1;var t=Lr(),e=Wu();t({target:"Promise",stat:!0,forced:Fu().CONSTRUCTOR},{reject:function(t){var r=e.f(this);return(0,r.reject)(t),r.promise}})}(),function(){if(ic)return ac;ic=1;var t=Lr(),e=gt(),r=te(),n=Du(),i=Fu().CONSTRUCTOR,o=uc(),a=e("Promise"),u=r&&!i;t({target:"Promise",stat:!0,forced:r||i},{resolve:function(t){return o(u&&this===a?n:this,t)}})}());var cc,sc={};!function(){if(cc)return sc;cc=1;var t=Lr(),e=te(),r=Du(),n=h(),i=gt(),o=ht(),a=Cu(),u=uc(),c=Qe(),s=r&&r.prototype;if(t({target:"Promise",proto:!0,real:!0,forced:!!r&&n(function(){s.finally.call({then:function(){}},function(){})})},{finally:function(t){var e=a(this,i("Promise")),r=o(t);return this.then(r?function(r){return u(e,t()).then(function(){return r})}:t,r?function(r){return u(e,t()).then(function(){throw r})}:t)}}),!e&&o(r)){var f=i("Promise").prototype.finally;s.finally!==f&&c(s,"finally",f,{unsafe:!0})}}();var fc,lc,dc,pc,vc,mc,hc,yc,gc,bc,wc,Sc={};function Oc(){if(lc)return fc;lc=1;var t=Oe();return fc=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r}}function kc(){if(bc)return gc;bc=1;var t,e,r=b(),n=ft(),i=Uo(),o=Oc(),u=function(){if(pc)return dc;pc=1;var t=h(),e=a().RegExp,r=t(function(){var t=e("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),n=r||t(function(){return!e("a","y").sticky}),i=r||t(function(){var t=e("^r","gy");return t.lastIndex=2,null!==t.exec("str")});return dc={BROKEN_CARET:i,MISSED_STICKY:n,UNSUPPORTED_Y:r}}(),c=ne(),s=Tn(),f=Ge().get,l=function(){if(mc)return vc;mc=1;var t=h(),e=a().RegExp;return vc=t(function(){var t=e(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})}(),d=function(){if(yc)return hc;yc=1;var t=h(),e=a().RegExp;return hc=t(function(){var t=e("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})}(),p=c("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,m=v,y=n("".charAt),g=n("".indexOf),w=n("".replace),S=n("".slice),O=(e=/b*/g,r(v,t=/a/,"a"),r(v,e,"a"),0!==t.lastIndex||0!==e.lastIndex),k=u.BROKEN_CARET,E=void 0!==/()??/.exec("")[1];return(O||E||k||l||d)&&(m=function(t){var e,n,a,u,c,l,d,h=this,b=f(h),A=i(t),T=b.raw;if(T)return T.lastIndex=h.lastIndex,e=r(m,T,A),h.lastIndex=T.lastIndex,e;var x=b.groups,I=k&&h.sticky,C=r(o,h),P=h.source,R=0,M=A;if(I&&(C=w(C,"y",""),-1===g(C,"g")&&(C+="g"),M=S(A,h.lastIndex),h.lastIndex>0&&(!h.multiline||h.multiline&&"\n"!==y(A,h.lastIndex-1))&&(P="(?: "+P+")",M=" "+M,R++),n=new RegExp("^(?:"+P+")",C)),E&&(n=new RegExp("^"+P+"$(?!\\s)",C)),O&&(a=h.lastIndex),u=r(v,I?n:h,M),I?u?(u.input=S(u.input,R),u[0]=S(u[0],R),u.index=h.lastIndex,h.lastIndex+=u[0].length):h.lastIndex=0:O&&u&&(h.lastIndex=h.global?u.index+u[0].length:a),E&&u&&u.length>1&&r(p,u[0],n,function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(u[c]=void 0)}),u&&x)for(u.groups=l=s(null),c=0;c<x.length;c++)l[(d=x[c])[0]]=u[d[1]];return u}),gc=m}function Ec(){if(wc)return Sc;wc=1;var t=Lr(),e=kc();return t({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e}),Sc}Ec();var Ac,Tc,xc,Ic,Cc,Pc,Rc,Mc,_c,jc,Nc,Bc,Uc,Lc={};function Dc(){if(Ic)return xc;Ic=1;var t=Lo().charAt;return xc=function(e,r,n){return r+(n?t(e,r).length:1)}}function Fc(){if(Pc)return Cc;Pc=1;var t=ft(),e=ie(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return Cc=function(t,c,s,f,l,d){var p=s+t.length,v=f.length,m=u;return void 0!==l&&(l=e(l),m=a),i(d,m,function(e,i){var a;switch(n(i,0)){case"$":return"$";case"&":return t;case"`":return o(c,0,s);case"'":return o(c,p);case"<":a=l[o(i,1,-1)];break;default:var u=+i;if(0===u)return e;if(u>v){var d=r(u/10);return 0===d?e:d<=v?void 0===f[d-1]?n(i,1):f[d-1]+n(i,1):e}a=f[u-1]}return void 0===a?"":a})}}function qc(){if(jc)return _c;jc=1;var t=b(),e=oe(),r=bt(),n=function(){if(Mc)return Rc;Mc=1;var t=a(),e=h(),r=t.RegExp,n=!e(function(){var t=!0;try{r(".","d")}catch(e){t=!1}var e={},n="",i=t?"dgimsy":"gimsy",o=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var u in t&&(a.hasIndices="d"),a)o(u,a[u]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(e)!==i||n!==i});return Rc={correct:n}}(),i=Oc(),o=RegExp.prototype;return _c=n.correct?function(t){return t.flags}:function(a){return n.correct||!r(o,a)||e(a,"flags")?a.flags:t(i,a)}}!function(){if(Uc)return Lc;Uc=1;var t=Pu(),e=b(),r=ft(),n=function(){if(Tc)return Ac;Tc=1,Ec();var t=b(),e=Qe(),r=kc(),n=h(),i=ue(),o=Ee(),a=i("species"),u=RegExp.prototype;return Ac=function(c,s,f,l){var d=i(c),p=!n(function(){var t={};return t[d]=function(){return 7},7!==""[c](t)}),v=p&&!n(function(){var t=!1,e=/a/;if("split"===c){var r={};r[a]=function(){return e},(e={constructor:r,flags:""})[d]=/./[d]}return e.exec=function(){return t=!0,null},e[d](""),!t});if(!p||!v||f){var m=/./[d],h=s(d,""[c],function(e,n,i,o,a){var c=n.exec;return c===r||c===u.exec?p&&!a?{done:!0,value:t(m,n,i,o)}:{done:!0,value:t(e,i,n,o)}:{done:!1}});e(String.prototype,c,h[0]),e(u,d,h[1])}l&&o(u[d],"sham",!0)}}(),i=h(),o=Oe(),a=ht(),u=yt(),c=dr(),s=vr(),f=Uo(),l=vt(),d=Dc(),p=xt(),v=Fc(),m=qc(),y=function(){if(Bc)return Nc;Bc=1;var t=b(),e=Oe(),r=ht(),n=lt(),i=kc(),o=TypeError;return Nc=function(a,u){var c=a.exec;if(r(c)){var s=t(c,a,u);return null!==s&&e(s),s}if("RegExp"===n(a))return t(i,a,u);throw new o("RegExp#exec called on incompatible receiver")}}(),g=ue()("replace"),w=Math.max,S=Math.min,O=r([].concat),k=r([].push),E=r("".indexOf),A=r("".slice),T=function(t){return void 0===t?t:String(t)},x="$0"==="a".replace(/./,"$0"),I=!!/./[g]&&""===/./[g]("a","$0");n("replace",function(r,n,i){var h=I?"$":"$0";return[function(t,r){var i=l(this),o=u(t)?p(t,g):void 0;return o?e(o,t,i,r):e(n,f(i),t,r)},function(e,r){var u=o(this),l=f(e);if("string"==typeof r&&-1===E(r,h)&&-1===E(r,"$<")){var p=i(n,u,l,r);if(p.done)return p.value}var g=a(r);g||(r=f(r));var b,x=f(m(u)),I=-1!==E(x,"g");I&&(b=-1!==E(x,"u"),u.lastIndex=0);for(var C,P=[];null!==(C=y(u,l))&&(k(P,C),I);){""===f(C[0])&&(u.lastIndex=d(l,s(u.lastIndex),b))}for(var R="",M=0,_=0;_<P.length;_++){for(var j,N=f((C=P[_])[0]),B=w(S(c(C.index),l.length),0),U=[],L=1;L<C.length;L++)k(U,T(C[L]));var D=C.groups;if(g){var F=O([N],U,B,l);void 0!==D&&k(F,D),j=f(t(r,void 0,F))}else j=v(N,l,B,U,D,r);B>=M&&(R+=A(l,M,B)+j,M=B+N.length)}return R+A(l,M)}]},!!i(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!x||I)}();var zc={chunkSize:1048576,retryDelays:[0,3e3,5e3,1e4,2e4,6e4],maxChunkRetries:3};function Hc(){return window.starmusTus||window.starmusConfig||{}}function Wc(t){var e=("string"==typeof t?t:String(t)).replace(/[\r\n\t]/g," ");return e.length>500?e.slice(0,497)+"...":e}function Gc(t){return t&&"object"===Aa(t)?t:{}}function Vc(t,e){return Qc.apply(this,arguments)}function Qc(){return Qc=pa(wa().m(function t(e,r){var n,i,o,a,u,c,s,f=arguments;return wa().w(function(t){for(;;)switch(t.n){case 0:if(n=f.length>2&&void 0!==f[2]?f[2]:{},i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>4&&void 0!==f[4]?f[4]:"",a=f.length>5?f[5]:void 0,window.tus&&window.tus.Upload){t.n=1;break}throw ia("[TUS] No tus library â failing over"),new Error("TUS_NOT_AVAILABLE");case 1:if(u=Hc(),c=u.endpoint||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.tusUpload){t.n=2;break}throw new Error("TUS_ENDPOINT_NOT_CONFIGURED");case 2:if(s=ba({filename:Wc(r),filetype:e.type||"audio/webm"},Object.entries(Gc(n)).reduce(function(t,e){var r=ka(e,2),n=r[0],i=r[1];return t[n]=Wc(i),t},{})),i)try{s.starmus_meta=Wc(JSON.stringify(i))}catch(t){ia("[TUS] Metadata sanitization failed",t)}return t.a(2,new Promise(function(t,r){var n,i={endpoint:c,chunkSize:u.chunkSize||zc.chunkSize,retryDelays:u.retryDelays||zc.retryDelays,metadata:s,fingerprint:function(t){return["starmus",o,t.size,t.lastModified||""].join("-")},onError:function(t){ia("[TUS] Upload error",t),r(t)},onProgress:function(t,e){"function"==typeof a&&a(t,e)},onSuccess:function(){return pa(wa().m(function r(){var o,a,c;return wa().w(function(r){for(;;)switch(r.p=r.n){case 0:if(ia("[TUS] Upload success",n.url),!u.removeFingerprintOnSuccess||null===(o=window.tus)||void 0===o||null===(o=o.defaultOptions)||void 0===o||!o.removeFingerprint){r.n=5;break}return r.p=1,r.n=2,window.tus.defaultOptions.fingerprint(e,i);case 2:return a=r.v,r.n=3,window.tus.defaultOptions.removeFingerprint(a);case 3:r.n=5;break;case 4:r.p=4,c=r.v,ia("[TUS] Failed to remove fingerprint",c);case 5:t(n.url);case 6:return r.a(2)}},r,null,[[1,4]])}))()}};(n=new window.tus.Upload(e,i)).findPreviousUploads().then(function(t){t&&t.length>0&&(ia("[TUS] Resuming from previous upload",t[0].uploadUrl),n.resumeFromPreviousUpload(t[0]))}).finally(function(){n.start()})}))}},t)})),Qc.apply(this,arguments)}function $c(t,e){return Yc.apply(this,arguments)}function Yc(){return Yc=pa(wa().m(function t(e,r){var n,i,o,a,u,c,s,f,l,d,p,v,m,h,y,g,b,w,S=arguments;return wa().w(function(t){for(;;)switch(t.n){case 0:if(w=function(){return w=pa(wa().m(function t(r,n,i,o,a,u,c,s,f,l){return wa().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,a){var p=new FormData;p.append("audio_chunk",n,"".concat(i,".part").concat(r)),p.append("chunk_index",r),p.append("total_chunks",d),u?p.append("upload_id",u):p.append("create_upload_id","1"),Object.entries(c).forEach(function(t){var e=ka(t,2),r=e[0],n=e[1];return p.append(r,n)}),o&&p.append("_starmus_meta",JSON.stringify(o));var v=new XMLHttpRequest;v.open("POST",s,!0),v.setRequestHeader("X-WP-Nonce",f),v.upload&&"function"==typeof l&&(v.upload.onprogress=function(t){t.lengthComputable&&l(start+t.loaded,e.size)}),v.onload=function(){if(v.status>=200&&v.status<300)try{var e=JSON.parse(v.responseText);!u&&e.upload_id&&(window.lastUploadId=e.upload_id),t(e)}catch(t){a(new Error("Invalid JSON chunk response"))}else a(new Error("Chunk ".concat(r," failed: ").concat(v.status)))},v.onerror=function(){return a(new Error("Network error during chunk upload"))},v.send(p)}))},t)})),w.apply(this,arguments)},b=function(t,e,r,n,i,o,a,u,c,s){return w.apply(this,arguments)},n=S.length>2&&void 0!==S[2]?S[2]:{},i=S.length>3&&void 0!==S[3]?S[3]:{},o=S.length>4&&void 0!==S[4]?S[4]:"",a=S.length>5?S[5]:void 0,u=Hc(),c=u.chunkedUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.chunkedUpload,s=u.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",c){t.n=1;break}throw new Error("CHUNKED_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:if(s){t.n=2;break}throw new Error("CHUNKED_UPLOAD_NONCE_MISSING");case 2:f=Gc(n),l=u.chunkSize||zc.chunkSize,d=Math.ceil(e.size/l),p="starmus_chunked_".concat(o,"_").concat(r,"_").concat(e.size),v=localStorage.getItem(p)||null,m=wa().m(function t(){var n,d,m,y,g,w;return wa().w(function(t){for(;;)switch(t.p=t.n){case 0:n=0,d=!1,m=h*l,y=Math.min(m+l,e.size),g=e.slice(m,y);case 1:if(d||!(n<(u.maxChunkRetries||zc.maxChunkRetries))){t.n=7;break}return t.p=2,t.n=3,b(h,g,r,i,o,v,f,c,s,a);case 3:d=!0,t.n=6;break;case 4:if(t.p=4,w=t.v,!(++n>=(u.maxChunkRetries||zc.maxChunkRetries))){t.n=5;break}throw w;case 5:return t.n=6,new Promise(function(t){return setTimeout(t,300*n*n)});case 6:t.n=1;break;case 7:!v&&0===h&&window.lastUploadId&&(v=window.lastUploadId,localStorage.setItem(p,v));case 8:return t.a(2)}},t,null,[[2,4]])}),h=0;case 3:if(!(h<d)){t.n=5;break}return t.d(Oa(m()),4);case 4:h++,t.n=3;break;case 5:return(y=new FormData).append("upload_id",v),y.append("finalize","1"),(g=new XMLHttpRequest).open("POST",c,!0),g.setRequestHeader("X-WP-Nonce",s),t.a(2,new Promise(function(t,e){g.onload=function(){if(g.status>=200&&g.status<300)try{var r=JSON.parse(g.responseText);localStorage.removeItem(p),t(r)}catch(t){e(new Error("Invalid JSON on finalize"))}else e(new Error("Finalize failed: ".concat(g.status)))},g.onerror=function(){return e(new Error("Network error on finalize"))},g.send(y)}))}},t)})),Yc.apply(this,arguments)}function Jc(t,e){return Kc.apply(this,arguments)}function Kc(){return Kc=pa(wa().m(function t(e,r){var n,i,o,a,u,c,s,f=arguments;return wa().w(function(t){for(;;)switch(t.n){case 0:if(n=f.length>2&&void 0!==f[2]?f[2]:{},i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>5?f[5]:void 0,a=Hc(),u=a.directUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.directUpload,c=a.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",u){t.n=1;break}throw new Error("DIRECT_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:return s=Gc(n),t.a(2,new Promise(function(t,n){var a=new FormData;Object.entries(s).forEach(function(t){var e=ka(t,2),r=e[0],n=e[1];return a.append(r,n)}),a.append("audio_file",e,r),null!=i&&i.transcript&&a.append("_starmus_transcript",i.transcript),null!=i&&i.calibration&&a.append("_starmus_calibration",JSON.stringify(i.calibration)),null!=i&&i.env&&a.append("_starmus_env",JSON.stringify(i.env));var f=new XMLHttpRequest;f.open("POST",u,!0),c&&f.setRequestHeader("X-WP-Nonce",c),f.upload&&"function"==typeof o&&(f.upload.onprogress=function(t){t.lengthComputable&&o(t.loaded,t.total)}),f.onload=function(){if(f.status>=200&&f.status<300)try{t(JSON.parse(f.responseText))}catch(t){n(new Error("Invalid JSON response"))}else n(new Error("Upload failed: ".concat(f.status)))},f.onerror=function(){return n(new Error("Network error on direct upload"))},f.send(a)}))}},t)})),Kc.apply(this,arguments)}function Xc(t,e,r,n,i,o){return Zc.apply(this,arguments)}function Zc(){return(Zc=pa(wa().m(function t(e,r,n,i,o,a){var u,c;return wa().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Vc(e,r,n,i,o,a);case 1:case 4:case 6:return t.a(2,t.v);case 2:return t.p=2,u=t.v,ia("[Uploader] TUS failed, trying fallback",u),t.p=3,t.n=4,$c(e,r,n,i,o,a);case 5:return t.p=5,c=t.v,ia("[Uploader] Chunked REST failed, trying direct",c),t.n=6,Jc(e,r,n,i,o,a)}},t,null,[[3,5],[0,2]])}))).apply(this,arguments)}function ts(t,e){var r=null==e?void 0:e.downlink;r&&0!==r||(r={"slow-2g":.05,"2g":.15,"3g":.75,"4g":8}[null==e?void 0:e.effectiveType]||.5);var n=1e6*(r=Math.min(r,10))/8;return Math.ceil(t/n*1.5)}function es(t){return isFinite(t)?t<60?"~".concat(t,"s"):"~".concat(Math.ceil(t/60)," min"):"Calculating..."}var rs={uploadWithTus:Vc,uploadWithChunkedRest:$c,uploadDirect:Jc,uploadWithPriority:Xc,isTusAvailable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var e=Hc();return!!(window.tus&&window.tus.Upload&&e.endpoint&&t>1048576)}catch(t){return!1}},estimateUploadTime:ts,formatUploadEstimate:es};"undefined"!=typeof window&&(window.StarmusTus=rs);var ns,is={};!function(){if(ns)return is;ns=1;var t=Lr(),e=ta().map;t({target:"Array",proto:!0,forced:!oi()("map")},{map:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}();var os,as,us,cs,ss,fs={};function ls(){if(as)return os;as=1;var t=ft();return os=t(1.1.valueOf)}function ds(){if(cs)return us;cs=1;var t=dr(),e=Uo(),r=vt(),n=RangeError;return us=function(i){var o=e(r(this)),a="",u=t(i);if(u<0||u===1/0)throw new n("Wrong number of repetitions");for(;u>0;(u>>>=1)&&(o+=o))1&u&&(a+=o);return a}}!function(){if(ss)return fs;ss=1;var t=Lr(),e=ft(),r=dr(),n=ls(),i=ds(),o=h(),a=RangeError,u=String,c=Math.floor,s=e(i),f=e("".slice),l=e(1.1.toFixed),d=function(t,e,r){return 0===e?r:e%2==1?d(t,e-1,r*t):d(t*t,e/2,r)},p=function(t,e,r){for(var n=-1,i=r;++n<6;)i+=e*t[n],t[n]=i%1e7,i=c(i/1e7)},v=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=c(n/e),n=n%e*1e7},m=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=u(t[e]);r=""===r?n:r+s("0",7-n.length)+n}return r};t({target:"Number",proto:!0,forced:o(function(){return"0.000"!==l(8e-5,3)||"1"!==l(.9,0)||"1.25"!==l(1.255,2)||"1000000000000000128"!==l(0xde0b6b3a7640080,0)})||!o(function(){l({})})},{toFixed:function(t){var e,i,o,c,l=n(this),h=r(t),y=[0,0,0,0,0,0],g="",b="0";if(h<0||h>20)throw new a("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return u(l);if(l<0&&(g="-",l=-l),l>1e-21)if(i=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(l*d(2,69,1))-69)<0?l*d(2,-e,1):l/d(2,e,1),i*=4503599627370496,(e=52-e)>0){for(p(y,0,i),o=h;o>=7;)p(y,1e7,0),o-=7;for(p(y,d(10,o,1),0),o=e-1;o>=23;)v(y,1<<23),o-=23;v(y,1<<o),p(y,1,1),v(y,2),b=m(y)}else p(y,0,i),p(y,1<<-e,0),b=m(y)+s("0",h);return b=h>0?g+((c=b.length)<=h?"0."+s("0",h-c)+b:f(b,0,c-h)+"."+f(b,c-h)):g+b}})}();var ps,vs={};!function(){if(ps)return vs;ps=1;var t=qe().PROPER,e=Qe(),r=Oe(),n=Uo(),i=h(),o=qc(),a="toString",u=RegExp.prototype,c=u[a],s=i(function(){return"/a/b"!==c.call({source:"a",flags:"b"})}),f=t&&c.name!==a;(s||f)&&e(u,a,function(){var t=r(this);return"/"+n(t.source)+"/"+n(o(t))},{unsafe:!0})}();var ms={dbName:"StarmusSubmissions",storeName:"pendingSubmissions",dbVersion:1,maxRetries:10,retryDelays:[0,5e3,1e4,3e4,6e4,12e4,3e5,6e5,12e5,18e5],maxBlobSize:41943040},hs=function(){return ma(function t(){va(this,t),this.db=null,this.isProcessing=!1},[{key:"init",value:(o=pa(wa().m(function t(){var e=this;return wa().w(function(t){for(;;)switch(t.n){case 0:if(window.indexedDB){t.n=1;break}return console.error("[Offline] IndexedDB not supported. Offline uploads disabled."),t.a(2);case 1:return t.a(2,new Promise(function(t){var r=indexedDB.open(ms.dbName,ms.dbVersion);r.onerror=function(e){ia("[Offline] DB open failed:",e),t()},r.onblocked=function(){ia("[Offline] DB open blocked â other tab open")},r.onsuccess=function(r){e.db=r.target.result,e.db.onversionchange=function(){e.db.close(),ia("[Offline] DB version changed â closed connection")},ia("[Offline] DB ready"),t()},r.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(ms.storeName)){var r=e.createObjectStore(ms.storeName,{keyPath:"id"});r.createIndex("timestamp","timestamp",{unique:!1}),r.createIndex("retryCount","retryCount",{unique:!1}),ia("[Offline] Created object store:",ms.storeName)}}}))}},t)})),function(){return o.apply(this,arguments)})},{key:"add",value:(i=pa(wa().m(function t(e,r,n){var i,o,a,u,c,s=this,f=arguments;return wa().w(function(t){for(;;)switch(t.n){case 0:if(i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>4&&void 0!==f[4]?f[4]:{},this.db){t.n=1;break}throw new Error("OfflineQueue: DB not initialized");case 1:if(!(r.size>ms.maxBlobSize)){t.n=2;break}throw a="Audio too large (".concat((r.size/1024/1024).toFixed(2),"â¯MB) â exceeds limit of ").concat(ms.maxBlobSize/1024/1024,"â¯MB"),ia("[Offline] "+a),new Error(a);case 2:return u=new Blob([r],{type:r.type}),c={id:"starmus-offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),instanceId:e,fileName:n,timestamp:Date.now(),audioBlob:u,formFields:i,metadata:o,retryCount:0,lastAttempt:null,error:null},t.a(2,new Promise(function(t,e){var r=s.db.transaction([ms.storeName],"readwrite");r.objectStore(ms.storeName).add(c),r.oncomplete=function(){ia("[Offline] Queued submission:",c.id),s._notifyQueueUpdate(),t(c.id)},r.onerror=function(t){var r=t.target.error;r&&"QuotaExceededError"===r.name?(ia("[Offline] IndexedDB quota exceeded â cannot save offline"),e(new Error("IndexedDB quota exceeded â cannot store offline"))):(ia("[Offline] Transaction error:",r),e(r))}}))}},t,this)})),function(t,e,r){return i.apply(this,arguments)})},{key:"getAll",value:(n=pa(wa().m(function t(){var e=this;return wa().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2,[]);case 1:return t.a(2,new Promise(function(t,r){var n=e.db.transaction([ms.storeName],"readonly").objectStore(ms.storeName).getAll();n.onsuccess=function(){return t(n.result||[])},n.onerror=function(){return r(n.error)}}))}},t,this)})),function(){return n.apply(this,arguments)})},{key:"remove",value:(r=pa(wa().m(function t(e){var r=this;return wa().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2);case 1:return t.a(2,new Promise(function(t,n){var i=r.db.transaction([ms.storeName],"readwrite");i.objectStore(ms.storeName).delete(e),i.oncomplete=function(){ia("[Offline] Removed from queue:",e),r._notifyQueueUpdate(),t()},i.onerror=function(t){return n(t.target.error)}}))}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"_updateRetry",value:(e=pa(wa().m(function t(e,r,n){var i=this;return wa().w(function(t){for(;;)switch(t.n){case 0:if(this.db){t.n=1;break}return t.a(2);case 1:return t.a(2,new Promise(function(t,o){var a=i.db.transaction([ms.storeName],"readwrite"),u=a.objectStore(ms.storeName),c=u.get(e);c.onsuccess=function(){var t=c.result;t&&(t.retryCount=r,t.lastAttempt=Date.now(),t.error=n||null,u.put(t))},c.onerror=function(t){return o(t.target.error)},a.oncomplete=function(){return t()}}))}},t,this)})),function(t,r,n){return e.apply(this,arguments)})},{key:"processQueue",value:(t=pa(wa().m(function t(){var e,r,n,i,o,a,u,c,s,f,l,d,p,v,m,h,y;return wa().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.isProcessing&&navigator.onLine){t.n=1;break}return t.a(2);case 1:return this.isProcessing=!0,ia("[Offline] Processing queue..."),t.p=2,t.n=3,this.getAll();case 3:e=t.v,ia("[Offline] ".concat(e.length," submissions pending")),r=ha(e),t.p=4,r.s();case 5:if((n=r.n()).done){t.n=14;break}if(i=n.value,o=i.id,a=i.audioBlob,u=i.fileName,c=i.formFields,s=i.metadata,f=i.retryCount,l=i.instanceId,!(f>=ms.maxRetries)){t.n=6;break}return ia("[Offline] Max retries exceeded for",o),t.a(3,13);case 6:if(null===i.lastAttempt){t.n=7;break}if(d=ms.retryDelays[Math.min(f,ms.retryDelays.length-1)],!(Date.now()-i.lastAttempt<d)){t.n=7;break}return t.a(3,13);case 7:return t.p=7,ia("[Offline] Uploading queued item",o),t.n=8,Xc(a,u,c,s,l,null);case 8:return p=t.v,ia("[Offline] Upload succeeded for",o,p),t.n=9,this.remove(o);case 9:t.n=13;break;case 10:if(t.p=10,m=t.v,ia("[Offline] Upload failed for",o,m),v=m&&m.message?m.message:String(m),/400|Invalid JSON|QuotaExceeded/i.test(v)){t.n=12;break}return t.n=11,this._updateRetry(o,f+1,v);case 11:t.n=13;break;case 12:ia("[Offline] Nonâretryable error, leaving in queue for manual review:",o);case 13:t.n=5;break;case 14:t.n=16;break;case 15:t.p=15,h=t.v,r.e(h);case 16:return t.p=16,r.f(),t.f(16);case 17:t.n=19;break;case 18:t.p=18,y=t.v,console.error("[Offline] Queue processing error:",y);case 19:return t.p=19,this.isProcessing=!1,t.f(19);case 20:return t.a(2)}},t,this,[[7,10],[4,15,16,17],[2,18,19,20]])})),function(){return t.apply(this,arguments)})},{key:"setupNetworkListeners",value:function(){var t=this;window.addEventListener("online",function(){ia("[Offline] Network online â processing queue"),t.processQueue()}),window.addEventListener("offline",function(){ia("[Offline] Network offline â queue paused")}),setInterval(function(){navigator.onLine&&t.processQueue().catch(function(t){return ia("[Offline] Retry error",t)})},6e4)}},{key:"_notifyQueueUpdate",value:function(){window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&this.getAll().then(function(t){var e=t.map(function(t){return{id:t.id,fileName:t.fileName,retryCount:t.retryCount,error:t.error,timestamp:t.timestamp}});window.StarmusHooks.doAction("starmus_offline_queue_updated",e)}).catch(function(t){return ia("[Offline] Queue notification failed",t)})}}]);var t,e,r,n,i,o}(),ys=new hs;function gs(){return bs.apply(this,arguments)}function bs(){return(bs=pa(wa().m(function t(){return wa().w(function(t){for(;;)switch(t.n){case 0:if(ys.db){t.n=2;break}return t.n=1,ys.init();case 1:ys.setupNetworkListeners();case 2:return t.a(2,ys)}},t)}))).apply(this,arguments)}function ws(t,e,r,n,i){return Ss.apply(this,arguments)}function Ss(){return(Ss=pa(wa().m(function t(e,r,n,i,o){var a;return wa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,gs();case 1:return a=t.v,t.a(2,a.add(e,r,n,i,o))}},t)}))).apply(this,arguments)}function Os(){return(Os=pa(wa().m(function t(){var e,r;return wa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,gs();case 1:return e=t.v,t.n=2,e.getAll();case 2:return r=t.v,t.a(2,r.length)}},t)}))).apply(this,arguments)}function ks(){return gs()}"undefined"!=typeof window&&(window.initOffline=ks);var Es,As,Ts;function xs(){if(As)return Es;As=1;var t=a().isFinite;return Es=Number.isFinite||function(e){return"number"==typeof e&&t(e)}}Ts||(Ts=1,Lr()({target:"Number",stat:!0},{isFinite:xs()}));var Is,Cs,Ps,Rs,Ms,_s={};!function(){if(Ms)return _s;Ms=1;var t=Lr(),e=function(){if(Cs)return Is;Cs=1;var t=ft(),e=vr(),r=Uo(),n=ds(),i=vt(),o=t(n),a=t("".slice),u=Math.ceil,c=function(t){return function(n,c,s){var f,l,d=r(i(n)),p=e(c),v=d.length,m=void 0===s?" ":r(s);return p<=v||""===m?d:((l=o(m,u((f=p-v)/m.length))).length>f&&(l=a(l,0,f)),t?d+l:l+d)}};return Is={start:c(!1),end:c(!0)}}().start;t({target:"String",proto:!0,forced:function(){if(Rs)return Ps;Rs=1;var t=wt();return Ps=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(t)}()},{padStart:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}})}(),window.StarmusInstances=window.StarmusInstances||{};var js=!1;function Ns(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}function Bs(t,e){var r;"error"!==t.status&&"complete"!==t.status||console.log("[StarmusUI] Render called with state:",{status:t.status,calibrationComplete:null===(r=t.calibration)||void 0===r?void 0:r.complete,instanceId:t.instanceId});var n=t.status,i=t.error,o=t.source,a=void 0===o?{}:o,u=t.submission,c=void 0===u?{}:u,s=t.calibration,f=void 0===s?{}:s,l=t.recorder,d=void 0===l?{}:l,p=t.instanceId;if("C"===t.tier||!0===t.fallbackActive)return["recordBtn","pauseBtn","resumeBtn","stopBtn","recorderContainer"].forEach(function(t){e[t]&&(e[t].style.display="none")}),void(e.fallbackContainer&&(e.fallbackContainer.style.display="block"));if(e.step1&&e.step2){var v="idle"!==n&&"uninitialized"!==n;e.step1.style.display=v?"none":"block",e.step2.style.display=v?"block":"none"}if(e.timer||e.timerElapsed){var m=function(t){if(!Number.isFinite(t))return"00m 00s";var e=Math.floor(t/60),r=Math.floor(t%60);return"".concat(e.toString().padStart(2,"0"),"m ").concat(r.toString().padStart(2,"0"),"s")}(d.duration||0);e.timerElapsed?e.timerElapsed.textContent=m:e.timer&&(e.timer.textContent=m),e.timer&&("recording"===n?e.timer.classList.add("starmus-timer--recording"):e.timer.classList.remove("starmus-timer--recording"))}if(e.durationProgress){var h=d.duration||0,y="recording"===n||"paused"===n||"calibrating"===n;if(e.durationProgress.parentElement&&(e.durationProgress.parentElement.style.display=y?"block":"none"),y){var g=Math.min(100,h/1200*100);e.durationProgress.style.setProperty("--starmus-recording-progress","".concat(g,"%")),e.durationProgress.setAttribute("aria-valuenow",Math.floor(h)),h>=1020?e.durationProgress.setAttribute("data-level","danger"):h>=900?e.durationProgress.setAttribute("data-level","warning"):e.durationProgress.setAttribute("data-level","safe"),h>=1200&&"recording"===n&&window.CommandBus&&window.CommandBus.dispatch("stop-mic",{},{instanceId:p})}}if(e.volumeMeter){var b="recording"===n||"paused"===n||"calibrating"===n;if(e.volumeMeter.parentElement&&(e.volumeMeter.parentElement.style.display=b?"block":"none"),b){var w=Math.max(0,Math.min(100,"calibrating"===n?f.volumePercent||0:d.amplitude||0));e.volumeMeter.style.setProperty("--starmus-audio-level","".concat(w,"%"));var S=w/100;S<.6?e.volumeMeter.setAttribute("data-level","safe"):S<.85?e.volumeMeter.setAttribute("data-level","hot"):e.volumeMeter.setAttribute("data-level","clip"),"recording"===n&&function(t,e){if(t>=.85&&!js){js=!0;var r=e.messageBox||document.querySelector("[data-starmus-message-box]");r&&(r.textContent="â ï¸ Your microphone is too loud. Move back 6â12 inches or speak softer for a cleaner recording.",r.style.display="block",r.setAttribute("role","alert"),r.setAttribute("aria-live","assertive"),setTimeout(function(){r.style.display="none",r.removeAttribute("role"),r.removeAttribute("aria-live")},6e3))}}(S,e)}else e.volumeMeter.style.setProperty("--starmus-audio-level","0%"),e.volumeMeter.removeAttribute("data-level")}var O="recording"===n,k="paused"===n,E="ready"===n,A="calibrating"===n,T="ready_to_submit"===n,x=f&&!0===f.complete,I=O||k||A;if(e.recordBtn&&(e.recordBtn.style.display=E&&x&&!I&&!T?"inline-flex":"none"),e.pauseBtn&&(e.pauseBtn.style.display=O?"inline-flex":"none"),e.resumeBtn&&(e.resumeBtn.style.display=k?"inline-flex":"none"),e.stopBtn&&(e.stopBtn.style.display=I?"inline-flex":"none",e.stopBtn.disabled=A,e.stopBtn.innerHTML=A?'<span class="dashicons dashicons-update"></span> Calibrating...':'<span class="dashicons dashicons-media-default"></span> Stop'),e.submitBtn&&(e.submitBtn.disabled="ready_to_submit"!==n,e.submitBtn.textContent="submitting"===n?"Uploadingâ¦":"Submit Recording"),e.transcriptBox){var C,P,R=(null===(C=a.transcript)||void 0===C?void 0:C.length)>0,M=(null===(P=a.interimTranscript)||void 0===P?void 0:P.length)>0;R||M?(e.transcriptBox.style.display="block",e.transcriptBox.innerHTML=(R?'<span class="starmus-transcript--final">'.concat(Ns(a.transcript),"</span>"):"")+(M?' <span class="starmus-transcript--interim">'.concat(Ns(a.interimTranscript),"</span>"):"")):e.transcriptBox.style.display="none"}if(e.statusEl){var _=e.statusEl,j="",N="starmus-status";if(i)j=i.message||"An error occurred.",N+=" starmus-status--error";else switch(n){case"ready":j="Mic calibrated. Click Start Recording.",N+=" starmus-status--success";break;case"recording":j="Recording...",N+=" starmus-status--recording";break;case"paused":j="Paused â Resume or Stop.";break;case"submitting":j="Uploading ".concat(Math.round(100*c.progress),"%");break;case"complete":j="Upload successful!",N+=" starmus-status--success";break;default:j=""}_.className=N,_.textContent=j,_.style.display=j?"block":"none"}}function Us(t,e){var r,n,i,o,a,u,c;console.log("[StarmusUI] initInstance called with elements:",{recordBtn:!!e.recordBtn,setupMicBtn:!!e.setupMicBtn,volumeMeter:!!e.volumeMeter,timer:!!e.timer,elementKeys:Object.keys(e)});var s=t.getState().instanceId,f=window.CommandBus||window.StarmusHooks;function l(t){if(!f)return console.warn("[StarmusUI] No CommandBus detected.");console.log("[StarmusUI] Dispatching:",t),f.dispatch(t,{},{instanceId:s})}console.log("[StarmusUI] CommandBus found:",!!f,"Instance ID:",s),console.log("[StarmusUI] Attaching event listeners..."),e.recordBtn?(console.log("[StarmusUI] Record button element:",e.recordBtn),console.log("[StarmusUI] Button disabled:",e.recordBtn.disabled),console.log("[StarmusUI] Button style display:",getComputedStyle(e.recordBtn).display),console.log("[StarmusUI] Button style visibility:",getComputedStyle(e.recordBtn).visibility),console.log("[StarmusUI] Button style pointer-events:",getComputedStyle(e.recordBtn).pointerEvents),e.recordBtn.addEventListener("click",function(t){console.log("[StarmusUI] Record button clicked! Event:",t),console.log("[StarmusUI] Button disabled at click time:",e.recordBtn.disabled),l("start-recording")}),e.recordBtn.addEventListener("mousedown",function(t){console.log("[StarmusUI] Record button MOUSEDOWN detected!",t)}),setTimeout(function(){console.log("[StarmusUI] Testing manual click..."),e.recordBtn.click();var t=e.recordBtn.getBoundingClientRect(),r=t.left+t.width/2,n=t.top+t.height/2,i=document.elementFromPoint(r,n);console.log("[StarmusUI] Button position:",{x:r,y:n}),console.log("[StarmusUI] Element at button center:",i),console.log("[StarmusUI] Is the button the top element?",i===e.recordBtn),i!==e.recordBtn&&(console.log("[StarmusUI] *** FOUND THE PROBLEM! Another element is covering the button ***"),console.log("[StarmusUI] Covering element classes:",null==i?void 0:i.className),console.log("[StarmusUI] Covering element z-index:",getComputedStyle(i).zIndex))},2e3),console.log("[StarmusUI] Record button listener attached")):console.log("[StarmusUI] No record button found!"),null===(r=e.pauseBtn)||void 0===r||r.addEventListener("click",function(){return l("pause-mic")}),null===(n=e.resumeBtn)||void 0===n||n.addEventListener("click",function(){return l("resume-mic")}),null===(i=e.stopBtn)||void 0===i||i.addEventListener("click",function(){return l("stop-mic")}),null===(o=e.submitBtn)||void 0===o||o.addEventListener("click",function(){var t,r=e.submitBtn.closest("form"),n={},i=ha((r?new FormData(r):new FormData).entries());try{for(i.s();!(t=i.n()).done;){var o=ka(t.value,2),a=o[0],u=o[1];n[a]=u}}catch(t){i.e(t)}finally{i.f()}l("submit")}),null===(a=e.resetBtn)||void 0===a||a.addEventListener("click",function(){return l("reset")}),null===(u=e.playBtn)||void 0===u||u.addEventListener("click",function(){return l("play")}),null===(c=e.setupMicBtn)||void 0===c||c.addEventListener("click",function(){return l("setup-mic")}),e.continueBtn&&e.continueBtn.addEventListener("click",function(){console.log("[StarmusUI] Continue button clicked!"),t.dispatch({type:"starmus/ui/step-continue",payload:{}})}),e.fileInput&&e.fileInput.addEventListener("change",function(t){var e,r=null===(e=t.target.files)||void 0===e?void 0:e[0];r&&f.dispatch("file-attached",{file:r},{instanceId:s})});var d=t.subscribe(function(t){return Bs(t,e)});return Bs(t.getState(),e),d}"undefined"!=typeof window&&(window.initUI=Us),document.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll('[data-starmus-action="next"]');t.length&&t.forEach(function(t){t.addEventListener("click",function(){try{var e;if(!window.StarmusStore||!window.StarmusStore.createStore)return void console.error("[Starmus] Store not available");var r=t.closest("[data-starmus-instance]");if(!r)return;var n=r.getAttribute("data-starmus-instance"),i=null===(e=window.StarmusInstances)||void 0===e||null===(e=e[n])||void 0===e?void 0:e.store;if(!i)return void console.error("[Starmus] No store for instance",n);i.dispatch({type:"starmus/ui/step-continue"});var o=document.querySelector("#starmus_step1_"+n),a=document.querySelector("#starmus_step2_"+n);o&&(o.style.display="none"),a&&(a.style.display="block"),console.log("[Starmus] Continue â Recording step enabled",n)}catch(t){console.error("[Starmus Continue Error]",t)}})})});var Ls,Ds,Fs,qs,zs,Hs,Ws,Gs={};function Vs(){return Ds?Ls:(Ds=1,Ls="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff")}function Qs(){if(qs)return Fs;qs=1;var t=ft(),e=vt(),r=Uo(),n=Vs(),i=t("".replace),o=RegExp("^["+n+"]+"),a=RegExp("(^|[^"+n+"])["+n+"]+$"),u=function(t){return function(n){var u=r(e(n));return 1&t&&(u=i(u,o,"")),2&t&&(u=i(u,a,"$1")),u}};return Fs={start:u(1),end:u(2),trim:u(3)}}!function(){if(Ws)return Gs;Ws=1;var t=Lr(),e=Qs().trim,r=function(){if(Hs)return zs;Hs=1;var t=qe().PROPER,e=h(),r=Vs();return zs=function(n){return e(function(){return!!r[n]()||"âÂá "!=="âÂá "[n]()||t&&r[n].name!==n})}}();t({target:"String",proto:!0,forced:r("trim")},{trim:function(){return e(this)}})}();var $s=window.StarmusHooks||{},Ys=$s.subscribe||function(){},Js=$s.debugLog||function(){};function Ks(t,e,r){function n(n){var i=t.getState(),o=i.source||{},a=i.calibration||{},u=i.env||r||{};if("submitting"!==i.status){var c=o.blob||o.file,s=o.fileName||o.file&&o.file.name||"recording.webm";if(c){var f={transcript:(o.transcript||"").trim()||null,calibration:a.complete?{gain:a.gain,snr:a.snr,noiseFloor:a.noiseFloor,speechLevel:a.speechLevel,timestamp:a.timestamp||(new Date).toISOString()}:null,env:u},l=es(ts(c.size,u.network));Js("[Upload] Estimated duration: ".concat(l,", size: ").concat((c.size/1024/1024).toFixed(2),"MB")),t.dispatch({type:"starmus/submit-start"}),Promise.resolve().then(function(){if(!navigator.onLine)throw new Error("OFFLINE_FAST_PATH");return Js("[Upload] Starting unified upload pipeline..."),Xc({blob:c,fileName:s,formFields:n,metadata:f,instanceId:e,onProgress:d})}).then(function(e){Js("[Upload] Success:",e.method),t.dispatch({type:"starmus/submit-complete",payload:e})}).catch(function(r){var i=(null==r?void 0:r.message)||String(r),o=/not configured/i.test(i);"OFFLINE_FAST_PATH"===i||!o&&"TUS_ENDPOINT_NOT_CONFIGURED"!==i?(Js("[Upload] Failed or offline. Attempting offline queue..."),ws(e,c,s,n,f).then(function(e){return Js("[Upload] Queued offline:",e),t.dispatch({type:"starmus/submit-queued",submissionId:e}),function(){return Os.apply(this,arguments)}()}).then(function(t){Js("[Upload] Offline queue size: ".concat(t))}).catch(function(e){console.error("[Upload] Queue save failed:",e),t.dispatch({type:"starmus/error",payload:{message:"Upload failed and could not be saved offline. "+("STORAGE_QUOTA_EXCEEDED"===e.message?"Storage quota exceeded.":"Please try again.")}})})):t.dispatch({type:"starmus/error",payload:{message:i||"Upload failed."}})})}else t.dispatch({type:"starmus/error",payload:{message:"Please record or attach audio before submitting."}})}function d(e,r){t.dispatch({type:"starmus/submit-progress",progress:e/r})}}return Ys("submit",function(t,r){(null==r?void 0:r.instanceId)===e&&n(t.formFields||{})}),Ys("continue",function(r,n){(null==n?void 0:n.instanceId)===e&&(Js("[StarmusCore] Continue command"),t.dispatch({type:"starmus/ui/step-continue",payload:{}}))}),Ys("reset",function(r,n){(null==n?void 0:n.instanceId)===e&&t.dispatch({type:"starmus/reset"})}),{handleSubmit:n}}"undefined"!=typeof window&&(window.initCore=Ks),"undefined"!=typeof module&&module.exports&&(module.exports={initCore:Ks});var Xs,Zs,tf,ef,rf,nf,of,af,uf,cf,sf,ff,lf,df,pf,vf,mf,hf,yf,gf={};function bf(){return Zs?Xs:(Zs=1,Xs="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView)}function wf(){if(ef)return tf;ef=1;var t=dr(),e=vr(),r=RangeError;return tf=function(n){if(void 0===n)return 0;var i=t(n),o=e(i);if(i!==o)throw new r("Wrong length or index");return o}}function Sf(){if(cf)return uf;cf=1;var t=nf?rf:(nf=1,rf=Math.sign||function(t){var e=+t;return 0===e||e!=e?e:e<0?-1:1}),e=function(){if(af)return of;af=1;var t=4503599627370496;return of=function(e){return e+t-t}}(),r=Math.abs;return uf=function(n,i,o,a){var u=+n,c=r(u),s=t(u);if(c<a)return s*e(c/a/i)*a*i;var f=(1+i/2220446049250313e-31)*c,l=f-(f-c);return l>o||l!=l?s*(1/0):s*l}}function Of(){if(df)return lf;df=1;var t=Array,e=Math.abs,r=Math.pow,n=Math.floor,i=Math.log,o=Math.LN2;return lf={pack:function(a,u,c){var s,f,l,d=t(c),p=8*c-u-1,v=(1<<p)-1,m=v>>1,h=23===u?r(2,-24)-r(2,-77):0,y=a<0||0===a&&1/a<0?1:0,g=0;for((a=e(a))!=a||a===1/0?(f=a!=a?1:0,s=v):(s=n(i(a)/o),a*(l=r(2,-s))<1&&(s--,l*=2),(a+=s+m>=1?h/l:h*r(2,1-m))*l>=2&&(s++,l/=2),s+m>=v?(f=0,s=v):s+m>=1?(f=(a*l-1)*r(2,u),s+=m):(f=a*r(2,m-1)*r(2,u),s=0));u>=8;)d[g++]=255&f,f/=256,u-=8;for(s=s<<u|f,p+=u;p>0;)d[g++]=255&s,s/=256,p-=8;return d[g-1]|=128*y,d},unpack:function(t,e){var n,i=t.length,o=8*i-e-1,a=(1<<o)-1,u=a>>1,c=o-7,s=i-1,f=t[s--],l=127&f;for(f>>=7;c>0;)l=256*l+t[s--],c-=8;for(n=l&(1<<-c)-1,l>>=-c,c+=e;c>0;)n=256*n+t[s--],c-=8;if(0===l)l=1-u;else{if(l===a)return n?NaN:f?-1/0:1/0;n+=r(2,e),l-=u}return(f?-1:1)*n*r(2,l-e)}}}function kf(){if(vf)return pf;vf=1;var t=ie(),e=pr(),r=mr();return pf=function(n){for(var i=t(this),o=r(i),a=arguments.length,u=e(a>1?arguments[1]:void 0,o),c=a>2?arguments[2]:void 0,s=void 0===c?o:e(c,o);s>u;)i[u++]=n;return i},pf}function Ef(){if(hf)return mf;hf=1;var t=a(),e=ft(),r=y(),n=bf(),i=qe(),o=Ee(),u=xo(),c=Io(),s=h(),f=ko(),l=dr(),d=vr(),p=wf(),v=function(){if(ff)return sf;ff=1;var t=Sf();return sf=Math.fround||function(e){return t(e,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)}}(),m=Of(),g=Cn(),b=jn(),w=kf(),S=ai(),O=Ao(),k=Br(),E=Rn(),A=Ge(),T=i.PROPER,x=i.CONFIGURABLE,I="ArrayBuffer",C="DataView",P="prototype",R="Wrong index",M=A.getterFor(I),_=A.getterFor(C),j=A.set,N=t[I],B=N,U=B&&B[P],L=t[C],D=L&&L[P],F=Object.prototype,q=t.Array,z=t.RangeError,H=e(w),W=e([].reverse),G=m.pack,V=m.unpack,Q=function(t){return[255&t]},$=function(t){return[255&t,t>>8&255]},Y=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},J=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},K=function(t){return G(v(t),23,4)},X=function(t){return G(t,52,8)},Z=function(t,e,r){u(t[P],e,{configurable:!0,get:function(){return r(this)[e]}})},tt=function(t,e,r,n){var i=_(t),o=p(r),a=!!n;if(o+e>i.byteLength)throw new z(R);var u=i.bytes,c=o+i.byteOffset,s=S(u,c,c+e);return a?s:W(s)},et=function(t,e,r,n,i,o){var a=_(t),u=p(r),c=n(+i),s=!!o;if(u+e>a.byteLength)throw new z(R);for(var f=a.bytes,l=u+a.byteOffset,d=0;d<e;d++)f[l+d]=c[s?d:e-d-1]};if(n){var rt=T&&N.name!==I;s(function(){N(1)})&&s(function(){new N(-1)})&&!s(function(){return new N,new N(1.5),new N(NaN),1!==N.length||rt&&!x})?rt&&x&&o(N,"name",I):((B=function(t){return f(this,U),O(new N(p(t)),this,B)})[P]=U,U.constructor=B,k(B,N)),b&&g(D)!==F&&b(D,F);var nt=new L(new B(2)),it=e(D.setInt8);nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||c(D,{setInt8:function(t,e){it(this,t,e<<24>>24)},setUint8:function(t,e){it(this,t,e<<24>>24)}},{unsafe:!0})}else U=(B=function(t){f(this,U);var e=p(t);j(this,{type:I,bytes:H(q(e),0),byteLength:e}),r||(this.byteLength=e,this.detached=!1)})[P],D=(L=function(t,e,n){f(this,D),f(t,U);var i=M(t),o=i.byteLength,a=l(e);if(a<0||a>o)throw new z("Wrong offset");if(a+(n=void 0===n?o-a:d(n))>o)throw new z("Wrong length");j(this,{type:C,buffer:t,byteLength:n,byteOffset:a,bytes:i.bytes}),r||(this.buffer=t,this.byteLength=n,this.byteOffset=a)})[P],r&&(Z(B,"byteLength",M),Z(L,"buffer",_),Z(L,"byteLength",_),Z(L,"byteOffset",_)),c(D,{getInt8:function(t){return tt(this,1,t)[0]<<24>>24},getUint8:function(t){return tt(this,1,t)[0]},getInt16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return J(tt(this,4,t,arguments.length>1&&arguments[1]))},getUint32:function(t){return J(tt(this,4,t,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(t){return V(tt(this,4,t,arguments.length>1&&arguments[1]),23)},getFloat64:function(t){return V(tt(this,8,t,arguments.length>1&&arguments[1]),52)},setInt8:function(t,e){et(this,1,t,Q,e)},setUint8:function(t,e){et(this,1,t,Q,e)},setInt16:function(t,e){et(this,2,t,$,e,arguments.length>2&&arguments[2])},setUint16:function(t,e){et(this,2,t,$,e,arguments.length>2&&arguments[2])},setInt32:function(t,e){et(this,4,t,Y,e,arguments.length>2&&arguments[2])},setUint32:function(t,e){et(this,4,t,Y,e,arguments.length>2&&arguments[2])},setFloat32:function(t,e){et(this,4,t,K,e,arguments.length>2&&arguments[2])},setFloat64:function(t,e){et(this,8,t,X,e,arguments.length>2&&arguments[2])}});return E(B,I),E(L,C),mf={ArrayBuffer:B,DataView:L}}!function(){if(yf)return gf;yf=1;var t=Lr(),e=a(),r=Ef(),n=Co(),i="ArrayBuffer",o=r[i];t({global:!0,constructor:!0,forced:e[i]!==o},{ArrayBuffer:o}),n(i)}();var Af,Tf={};!function(){if(Af)return Tf;Af=1;var t=Lr(),e=Dr(),r=h(),n=Ef(),i=Oe(),o=pr(),a=vr(),u=n.ArrayBuffer,c=n.DataView,s=c.prototype,f=e(u.prototype.slice),l=e(s.getUint8),d=e(s.setUint8);t({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:r(function(){return!new u(2).slice(1,void 0).byteLength})},{slice:function(t,e){if(f&&void 0===e)return f(i(this),t);for(var r=i(this).byteLength,n=o(t,r),s=o(void 0===e?r:e,r),p=new u(a(s-n)),v=new c(this),m=new c(p),h=0;n<s;)d(m,h++,l(v,n++));return p}})}();var xf,If;If||(If=1,xf||(xf=1,To()("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Po())));var Cf,Pf,Rf,Mf={};!function(){if(Rf)return Mf;Rf=1;var t=Lr(),e=function(){if(Pf)return Cf;Pf=1;var t=a(),e=h(),r=ft(),n=Uo(),i=Qs().trim,o=Vs(),u=r("".charAt),c=t.parseFloat,s=t.Symbol,f=s&&s.iterator,l=1/c(o+"-0")!=-1/0||f&&!e(function(){c(Object(f))});return Cf=l?function(t){var e=i(n(t)),r=c(e);return 0===r&&"-"===u(e,0)?-0:r}:c}();t({global:!0,forced:parseFloat!==e},{parseFloat:e})}();var _f,jf,Nf,Bf,Uf,Lf,Df,Ff,qf,zf,Hf,Wf,Gf,Vf,Qf,$f,Yf,Jf,Kf,Xf,Zf,tl,el={exports:{}};function rl(){if(jf)return _f;jf=1;var t,e,r,n=bf(),i=y(),o=a(),u=ht(),c=yt(),s=oe(),f=ri(),l=At(),d=Ee(),p=Qe(),v=xo(),m=bt(),h=Cn(),g=jn(),b=ue(),w=ae(),S=Ge(),O=S.enforce,k=S.get,E=o.Int8Array,A=E&&E.prototype,T=o.Uint8ClampedArray,x=T&&T.prototype,I=E&&h(E),C=A&&h(A),P=Object.prototype,R=o.TypeError,M=b("toStringTag"),_=w("TYPED_ARRAY_TAG"),j="TypedArrayConstructor",N=n&&!!g&&"Opera"!==f(o.opera),B=!1,U={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},D=function(t){var e=h(t);if(c(e)){var r=k(e);return r&&s(r,j)?r[j]:D(e)}},F=function(t){if(!c(t))return!1;var e=f(t);return s(U,e)||s(L,e)};for(t in U)(r=(e=o[t])&&e.prototype)?O(r)[j]=e:N=!1;for(t in L)(r=(e=o[t])&&e.prototype)&&(O(r)[j]=e);if((!N||!u(I)||I===Function.prototype)&&(I=function(){throw new R("Incorrect invocation")},N))for(t in U)o[t]&&g(o[t],I);if((!N||!C||C===P)&&(C=I.prototype,N))for(t in U)o[t]&&g(o[t].prototype,C);if(N&&h(x)!==C&&g(x,C),i&&!s(C,M))for(t in B=!0,v(C,M,{configurable:!0,get:function(){return c(this)?this[_]:void 0}}),U)o[t]&&d(o[t],_,t);return _f={NATIVE_ARRAY_BUFFER_VIEWS:N,TYPED_ARRAY_TAG:B&&_,aTypedArray:function(t){if(F(t))return t;throw new R("Target is not a typed array")},aTypedArrayConstructor:function(t){if(u(t)&&(!g||m(I,t)))return t;throw new R(l(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(i){if(r)for(var a in U){var u=o[a];if(u&&s(u.prototype,t))try{delete u.prototype[t]}catch(r){try{u.prototype[t]=e}catch(t){}}}C[t]&&!r||p(C,t,r?e:N&&A[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,a;if(i){if(g){if(r)for(n in U)if((a=o[n])&&s(a,t))try{delete a[t]}catch(t){}if(I[t]&&!r)return;try{return p(I,t,r?e:N&&I[t]||e)}catch(t){}}for(n in U)!(a=o[n])||a[t]&&!r||p(a,t,e)}},getTypedArrayConstructor:D,isView:function(t){if(!c(t))return!1;var e=f(t);return"DataView"===e||s(U,e)||s(L,e)},isTypedArray:F,TypedArray:I,TypedArrayPrototype:C}}function nl(){if(Lf)return Uf;Lf=1;var t=yt(),e=Math.floor;return Uf=Number.isInteger||function(r){return!t(r)&&isFinite(r)&&e(r)===r}}function il(){if(Ff)return Df;Ff=1;var t=dr(),e=RangeError;return Df=function(r){var n=t(r);if(n<0)throw new e("The argument can't be less than 0");return n}}function ol(){if(zf)return qf;zf=1;var t=il(),e=RangeError;return qf=function(r,n){var i=t(r);if(i%n)throw new e("Wrong offset");return i}}function al(){if(Wf)return Hf;Wf=1;var t=Math.round;return Hf=function(e){var r=t(e);return r<0?0:r>255?255:255&r}}function ul(){if(Vf)return Gf;Vf=1;var t=ri();return Gf=function(e){var r=t(e);return"BigInt64Array"===r||"BigUint64Array"===r}}function cl(){if($f)return Qf;$f=1;var t=ce(),e=TypeError;return Qf=function(r){var n=t(r,"number");if("number"==typeof n)throw new e("Can't convert number to bigint");return BigInt(n)}}function sl(){if(Jf)return Yf;Jf=1;var t=yo(),e=b(),r=Iu(),n=ie(),i=mr(),o=wo(),a=bo(),u=go(),c=ul(),s=rl().aTypedArrayConstructor,f=cl();return Yf=function(l){var d,p,v,m,h,y,g,b,w=r(this),S=n(l),O=arguments.length,k=O>1?arguments[1]:void 0,E=void 0!==k,A=a(S);if(A&&!u(A))for(b=(g=o(S,A)).next,S=[];!(y=e(b,g)).done;)S.push(y.value);for(E&&O>2&&(k=t(k,arguments[2])),p=i(S),v=new(s(w))(p),m=c(v),d=0;p>d;d++)h=E?k(S[d],d):S[d],v[d]=m?f(h):+h;return v},Yf}function fl(){if(Xf)return Kf;Xf=1;var t=mr();return Kf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),a=new e(o);o>i;)a[i]=r[i++];return a},Kf}function ll(){if(Zf)return el.exports;Zf=1;var t=Lr(),e=a(),r=b(),n=y(),i=function(){if(Bf)return Nf;Bf=1;var t=a(),e=h(),r=Eo(),n=rl().NATIVE_ARRAY_BUFFER_VIEWS,i=t.ArrayBuffer,o=t.Int8Array;return Nf=!n||!e(function(){o(1)})||!e(function(){new o(-1)})||!r(function(t){new o,new o(null),new o(1.5),new o(t)},!0)||e(function(){return 1!==new o(new i(2),1,void 0).length})}(),o=rl(),u=Ef(),c=ko(),s=st(),f=Ee(),l=nl(),d=vr(),p=wf(),v=ol(),m=al(),g=se(),w=oe(),S=ri(),O=yt(),k=Et(),E=Tn(),A=bt(),T=jn(),x=br().f,I=sl(),C=ta().forEach,P=Co(),R=xo(),M=ke(),_=de(),j=fl(),N=Ge(),B=Ao(),U=N.get,L=N.set,D=N.enforce,F=M.f,q=_.f,z=e.RangeError,H=u.ArrayBuffer,W=H.prototype,G=u.DataView,V=o.NATIVE_ARRAY_BUFFER_VIEWS,Q=o.TYPED_ARRAY_TAG,$=o.TypedArray,Y=o.TypedArrayPrototype,J=o.isTypedArray,K="BYTES_PER_ELEMENT",X="Wrong length",Z=function(t,e){R(t,e,{configurable:!0,get:function(){return U(this)[e]}})},tt=function(t){var e;return A(W,t)||"ArrayBuffer"===(e=S(t))||"SharedArrayBuffer"===e},et=function(t,e){return J(t)&&!k(e)&&e in t&&l(+e)&&e>=0},rt=function(t,e){return e=g(e),et(t,e)?s(2,t[e]):q(t,e)},nt=function(t,e,r){return e=g(e),!(et(t,e)&&O(r)&&w(r,"value"))||w(r,"get")||w(r,"set")||r.configurable||w(r,"writable")&&!r.writable||w(r,"enumerable")&&!r.enumerable?F(t,e,r):(t[e]=r.value,t)};return n?(V||(_.f=rt,M.f=nt,Z(Y,"buffer"),Z(Y,"byteOffset"),Z(Y,"byteLength"),Z(Y,"length")),t({target:"Object",stat:!0,forced:!V},{getOwnPropertyDescriptor:rt,defineProperty:nt}),el.exports=function(n,o,a){var u=n.match(/\d+/)[0]/8,s=n+(a?"Clamped":"")+"Array",l="get"+n,h="set"+n,y=e[s],g=y,b=g&&g.prototype,w={},S=function(t,e){F(t,e,{get:function(){return function(t,e){var r=U(t);return r.view[l](e*u+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var n=U(t);n.view[h](e*u+n.byteOffset,a?m(r):r,!0)}(this,e,t)},enumerable:!0})};V?i&&(g=o(function(t,e,n,i){return c(t,b),B(O(e)?tt(e)?void 0!==i?new y(e,v(n,u),i):void 0!==n?new y(e,v(n,u)):new y(e):J(e)?j(g,e):r(I,g,e):new y(p(e)),t,g)}),T&&T(g,$),C(x(y),function(t){t in g||f(g,t,y[t])}),g.prototype=b):(g=o(function(t,e,n,i){c(t,b);var o,a,s,f=0,l=0;if(O(e)){if(!tt(e))return J(e)?j(g,e):r(I,g,e);o=e,l=v(n,u);var m=e.byteLength;if(void 0===i){if(m%u)throw new z(X);if((a=m-l)<0)throw new z(X)}else if((a=d(i)*u)+l>m)throw new z(X);s=a/u}else s=p(e),o=new H(a=s*u);for(L(t,{buffer:o,byteOffset:l,byteLength:a,length:s,view:new G(o)});f<s;)S(t,f++)}),T&&T(g,$),b=g.prototype=E(Y)),b.constructor!==g&&f(b,"constructor",g),D(b).TypedArrayConstructor=g,Q&&f(b,Q,s);var k=g!==y;w[s]=g,t({global:!0,constructor:!0,forced:k,sham:!V},w),K in g||f(g,K,u),K in b||f(b,K,u),P(s)}):el.exports=function(){},el.exports}tl||(tl=1,ll()("Float32",function(t){return function(e,r,n){return t(this,e,r,n)}}));var dl,pl,vl,ml={};!function(){if(vl)return ml;vl=1;var t=ft(),e=rl(),r=function(){if(pl)return dl;pl=1;var t=ie(),e=pr(),r=mr(),n=Oi(),i=Math.min;return dl=[].copyWithin||function(o,a){var u=t(this),c=r(u),s=e(o,c),f=e(a,c),l=arguments.length>2?arguments[2]:void 0,d=i((void 0===l?c:e(l,c))-f,c-s),p=1;for(f<s&&s<f+d&&(p=-1,f+=d-1,s+=d-1);d-- >0;)f in u?u[s]=u[f]:n(u,s),s+=p,f+=p;return u},dl}(),n=t(r),i=e.aTypedArray;(0,e.exportTypedArrayMethod)("copyWithin",function(t,e){return n(i(this),t,e,arguments.length>2?arguments[2]:void 0)})}();var hl,yl={};!function(){if(hl)return yl;hl=1;var t=rl(),e=ta().every,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("every",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var gl,bl={};!function(){if(gl)return bl;gl=1;var t=rl(),e=kf(),r=cl(),n=ri(),i=b(),o=ft(),a=h(),u=t.aTypedArray,c=t.exportTypedArrayMethod,s=o("".slice);c("fill",function(t){var o=arguments.length;u(this);var a="Big"===s(n(this),0,3)?r(t):+t;return i(e,this,a,o>1?arguments[1]:void 0,o>2?arguments[2]:void 0)},a(function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t}))}();var wl,Sl,Ol,kl={};!function(){if(Ol)return kl;Ol=1;var t=rl(),e=ta().filter,r=function(){if(Sl)return wl;Sl=1;var t=fl(),e=rl().getTypedArrayConstructor;return wl=function(r,n){return t(e(r),n)}}(),n=t.aTypedArray;(0,t.exportTypedArrayMethod)("filter",function(t){var i=e(n(this),t,arguments.length>1?arguments[1]:void 0);return r(this,i)})}();var El,Al={};!function(){if(El)return Al;El=1;var t=rl(),e=ta().find,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("find",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Tl,xl={};!function(){if(Tl)return xl;Tl=1;var t=rl(),e=ta().findIndex,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("findIndex",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Il,Cl={};!function(){if(Il)return Cl;Il=1;var t=rl(),e=ta().forEach,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("forEach",function(t){e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Pl,Rl={};!function(){if(Pl)return Rl;Pl=1;var t=rl(),e=hr().includes,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("includes",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var Ml,_l={};!function(){if(Ml)return _l;Ml=1;var t=rl(),e=hr().indexOf,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("indexOf",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var jl,Nl={};!function(){if(jl)return Nl;jl=1;var t=a(),e=h(),r=ft(),n=rl(),i=Un(),o=ue()("iterator"),u=t.Uint8Array,c=r(i.values),s=r(i.keys),f=r(i.entries),l=n.aTypedArray,d=n.exportTypedArrayMethod,p=u&&u.prototype,v=!e(function(){p[o].call([1])}),m=!!p&&p.values&&p[o]===p.values&&"values"===p.values.name,y=function(){return c(l(this))};d("entries",function(){return f(l(this))},v),d("keys",function(){return s(l(this))},v),d("values",y,v||!m,{name:"values"}),d(o,y,v||!m,{name:"values"})}();var Bl,Ul={};!function(){if(Bl)return Ul;Bl=1;var t=rl(),e=ft(),r=t.aTypedArray,n=t.exportTypedArrayMethod,i=e([].join);n("join",function(t){return i(r(this),t)})}();var Ll,Dl,Fl,ql={};!function(){if(Fl)return ql;Fl=1;var t=rl(),e=Pu(),r=function(){if(Dl)return Ll;Dl=1;var t=Pu(),e=mt(),r=dr(),n=mr(),i=Fr(),o=Math.min,a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0,c=i("lastIndexOf");return Ll=u||!c?function(i){if(u)return t(a,this,arguments)||0;var c=e(this),s=n(c);if(0===s)return-1;var f=s-1;for(arguments.length>1&&(f=o(f,r(arguments[1]))),f<0&&(f=s+f);f>=0;f--)if(f in c&&c[f]===i)return f||0;return-1}:a,Ll}(),n=t.aTypedArray;(0,t.exportTypedArrayMethod)("lastIndexOf",function(t){var i=arguments.length;return e(r,n(this),i>1?[t,arguments[1]]:[t])})}();var zl,Hl={};!function(){if(zl)return Hl;zl=1;var t=rl(),e=ta().map,r=t.aTypedArray,n=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("map",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0,function(t,e){return new(n(t))(e)})})}();var Wl,Gl={};!function(){if(Wl)return Gl;Wl=1;var t=rl(),e=Da().left,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("reduce",function(t){var n=arguments.length;return e(r(this),t,n,n>1?arguments[1]:void 0)})}();var Vl,Ql={};!function(){if(Vl)return Ql;Vl=1;var t=rl(),e=Da().right,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("reduceRight",function(t){var n=arguments.length;return e(r(this),t,n,n>1?arguments[1]:void 0)})}();var $l,Yl={};!function(){if($l)return Yl;$l=1;var t=rl(),e=t.aTypedArray,r=t.exportTypedArrayMethod,n=Math.floor;r("reverse",function(){for(var t,r=this,i=e(r).length,o=n(i/2),a=0;a<o;)t=r[a],r[a++]=r[--i],r[i]=t;return r})}();var Jl,Kl={};!function(){if(Jl)return Kl;Jl=1;var t=a(),e=b(),r=rl(),n=mr(),i=ol(),o=ie(),u=h(),c=t.RangeError,s=t.Int8Array,f=s&&s.prototype,l=f&&f.set,d=r.aTypedArray,p=r.exportTypedArrayMethod,v=!u(function(){var t=new Uint8ClampedArray(2);return e(l,t,{length:1,0:3},1),3!==t[1]}),m=v&&r.NATIVE_ARRAY_BUFFER_VIEWS&&u(function(){var t=new s(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]});p("set",function(t){d(this);var r=i(arguments.length>1?arguments[1]:void 0,1),a=o(t);if(v)return e(l,this,a,r);var u=this.length,s=n(a),f=0;if(s+r>u)throw new c("Wrong length");for(;f<s;)this[r+f]=a[f++]},!v||m)}();var Xl,Zl={};!function(){if(Xl)return Zl;Xl=1;var t=rl(),e=h(),r=ai(),n=t.aTypedArray,i=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("slice",function(t,e){for(var o=r(n(this),t,e),a=i(this),u=0,c=o.length,s=new a(c);c>u;)s[u]=o[u++];return s},e(function(){new Int8Array(1).slice()}))}();var td,ed={};!function(){if(td)return ed;td=1;var t=rl(),e=ta().some,r=t.aTypedArray;(0,t.exportTypedArrayMethod)("some",function(t){return e(r(this),t,arguments.length>1?arguments[1]:void 0)})}();var rd,nd,id,od,ad,ud,cd,sd,fd,ld={};!function(){if(fd)return ld;fd=1;var t=a(),e=Dr(),r=h(),n=Tt(),i=function(){if(nd)return rd;nd=1;var t=ai(),e=Math.floor,r=function(n,i){var o=n.length;if(o<8)for(var a,u,c=1;c<o;){for(u=c,a=n[c];u&&i(n[u-1],a)>0;)n[u]=n[--u];u!==c++&&(n[u]=a)}else for(var s=e(o/2),f=r(t(n,0,s),i),l=r(t(n,s),i),d=f.length,p=l.length,v=0,m=0;v<d||m<p;)n[v+m]=v<d&&m<p?i(f[v],l[m])<=0?f[v++]:l[m++]:v<d?f[v++]:l[m++];return n};return rd=r}(),o=rl(),u=function(){if(od)return id;od=1;var t=wt().match(/firefox\/(\d+)/i);return id=!!t&&+t[1]}(),c=function(){if(ud)return ad;ud=1;var t=wt();return ad=/MSIE|Trident/.test(t)}(),s=St(),f=function(){if(sd)return cd;sd=1;var t=wt().match(/AppleWebKit\/(\d+)\./);return cd=!!t&&+t[1]}(),l=o.aTypedArray,d=o.exportTypedArrayMethod,p=t.Uint16Array,v=p&&e(p.prototype.sort),m=!(!v||r(function(){v(new p(2),null)})&&r(function(){v(new p(2),{})})),y=!!v&&!r(function(){if(s)return s<74;if(u)return u<67;if(c)return!0;if(f)return f<602;var t,e,r=new p(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(v(r,function(t,e){return(t/4|0)-(e/4|0)}),t=0;t<516;t++)if(r[t]!==n[t])return!0});d("sort",function(t){return void 0!==t&&n(t),y?v(this,t):i(l(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))},!y||m)}();var dd,pd={};!function(){if(dd)return pd;dd=1;var t=rl(),e=vr(),r=pr(),n=t.aTypedArray,i=t.getTypedArrayConstructor;(0,t.exportTypedArrayMethod)("subarray",function(t,o){var a=n(this),u=a.length,c=r(t,u);return new(i(a))(a.buffer,a.byteOffset+c*a.BYTES_PER_ELEMENT,e((void 0===o?u:r(o,u))-c))})}();var vd,md={};!function(){if(vd)return md;vd=1;var t=a(),e=Pu(),r=rl(),n=h(),i=ai(),o=t.Int8Array,u=r.aTypedArray,c=r.exportTypedArrayMethod,s=[].toLocaleString,f=!!o&&n(function(){s.call(new o(1))});c("toLocaleString",function(){return e(s,f?i(u(this)):u(this),i(arguments))},n(function(){return[1,2].toLocaleString()!==new o([1,2]).toLocaleString()})||!n(function(){o.prototype.toLocaleString.call([1,2])}))}();var hd,yd={};!function(){if(hd)return yd;hd=1;var t=rl().exportTypedArrayMethod,e=h(),r=a(),n=ft(),i=r.Uint8Array,o=i&&i.prototype||{},u=[].toString,c=n([].join);e(function(){u.call({})})&&(u=function(){return c(this)});var s=o.toString!==u;t("toString",u,s)}();var gd=new Map,bd=null;function wd(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:t,event:e,severity:r.severity||"info",message:r.message||"",data:r.data||{}})}catch(t){console.warn("[Starmus] Telemetry emit failed:",t)}}function Sd(t){return Od.apply(this,arguments)}function Od(){return(Od=pa(wa().m(function t(e){var r,n;return wa().w(function(t){for(;;)switch(t.n){case 0:if((r=e.getAudioTracks&&e.getAudioTracks()||[]).length){t.n=1;break}return t.a(2);case 1:if("live"!==(n=r[0]).readyState){t.n=2;break}return t.a(2);case 2:return t.a(2,new Promise(function(t){var e=0,r=setInterval(function(){("live"===n.readyState||e>100)&&(clearInterval(r),t()),e+=1},50);setTimeout(function(){clearInterval(r),t()},5e3)}))}},t)}))).apply(this,arguments)}function kd(){var t=window.AudioContext||window.webkitAudioContext;if(!t)throw new Error("AudioContext not supported in this browser");if((!bd||"closed"===bd.state)&&(bd=new t({latencyHint:"interactive"}),ia("[Recorder] Created AudioContext, state:",bd.state),"function"!=typeof bd.createMediaStreamSource))throw new Error("AudioContext lacks createMediaStreamSource");return bd}function Ed(t){var e=kd(),r=e.createMediaStreamSource(t);try{var n=function(t){var e=t.createMediaStreamDestination||t.createMediaStreamAudioDestination;if("function"!=typeof e)throw new Error("MediaStreamDestination not supported");var r=e.call(t);if(!r||!r.stream)throw new Error("Destination stream invalid");return r}(e),i=e.createBiquadFilter();i.type="highpass",i.frequency.value=85;var o=e.createDynamicsCompressor();o.threshold.value=-20,o.knee.value=40,o.ratio.value=12,o.attack.value=0,o.release.value=.25;var a=e.createAnalyser();return a.fftSize=2048,r.connect(i),i.connect(o),o.connect(a),a.connect(n),{audioContext:e,destinationStream:n.stream,analyser:a,nodes:[r,i,o,a,n],fallbackActive:!1}}catch(n){ia("[Recorder] Audio graph failed â fallback to raw stream:",n.message);var u=e.createAnalyser();return u.fftSize=2048,r.connect(u),{audioContext:e,destinationStream:t,analyser:u,nodes:[r,u],fallbackActive:!0}}}function Ad(t,e){return Td.apply(this,arguments)}function Td(){return(Td=pa(wa().m(function t(e,r){var n,i,o,a,u,c;return wa().w(function(t){for(;;)if(0===t.n)return n=kd(),(i=n.createAnalyser()).fftSize=2048,(o=n.createMediaStreamSource(e)).connect(i),a=new Float32Array(i.fftSize),u=[],c=performance.now(),t.a(2,new Promise(function(t){!function e(){if("running"===n.state){i.getFloatTimeDomainData(a);for(var s=0,f=0;f<a.length;f++)s+=a[f]*a[f];var l=Math.sqrt(s/a.length);if(isFinite(l)){u.push(l);var d=Math.min(100,2e3*l);r&&r("",d,!1),performance.now()-c<15e3?requestAnimationFrame(e):function(){var e=Math.max(1,Math.floor(u.length/3)),n=u.slice(0,e),a=u.slice(e,2*e),c=function(t){return t.length?t.reduce(function(t,e){return t+e},0)/t.length:0},s=c(n),f=c(a),l=f/Math.max(s,1e-6),d=l<3?6:Math.max(1,Math.min(4,.1/Math.max(f,1e-6))),p={gain:parseFloat(d.toFixed(3)),snr:parseFloat(l.toFixed(3)),noiseFloor:parseFloat(s.toFixed(6)),speechLevel:parseFloat(f.toFixed(6)),timestamp:(new Date).toISOString()};try{o.disconnect()}catch(t){}try{i.disconnect()}catch(t){}r&&r("",null,!0);t(p)}()}else requestAnimationFrame(e)}else requestAnimationFrame(e)}()}))},t)}))).apply(this,arguments)}function xd(t,e){ca.unsubscribeInstance&&ca.unsubscribeInstance(e),ca.subscribe("setup-mic",function(){var r=pa(wa().m(function r(n,i){var o,a,u,c,s;return wa().w(function(r){for(;;)switch(r.p=r.n){case 0:if(i.instanceId===e){r.n=1;break}return r.a(2);case 1:if(navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia){r.n=2;break}return wd(e,"E_RECORDER_UNSUPPORTED",{severity:"error",message:o="Microphone not supported."}),t.dispatch({type:"starmus/error",payload:{message:o,retryable:!1}}),r.a(2);case 2:return r.p=2,r.n=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:return a=r.v,wd(e,"E_MIC_ACCESS",{severity:"info",message:"Mic access granted â calibrating"}),t.dispatch({type:"starmus/calibration-start"}),r.n=4,Ad(a,function(e,r,n){t.dispatch({type:"starmus/calibration-update",message:e,volumePercent:r})});case 4:u=r.v,a.getTracks().forEach(function(t){return t.stop()}),t.dispatch({type:"starmus/calibration-complete",payload:{calibration:u},calibration:u}),r.n=6;break;case 5:r.p=5,s=r.v,c="NotAllowedError"===s.name?"Microphone permission denied.":"Failed to access microphone.",wd(e,"E_MIC_ACCESS",{severity:"error",message:c,data:{error:s.message}}),t.dispatch({type:"starmus/error",payload:{message:c,retryable:!0}});case 6:return r.a(2)}},r,null,[[2,5]])}));return function(t,e){return r.apply(this,arguments)}}()),ca.subscribe("start-recording",function(){var r=pa(wa().m(function r(n,i){var o,a,u,c,s,f,l,d,p,v,m;return wa().w(function(r){for(;;)switch(r.p=r.n){case 0:if(i.instanceId===e){r.n=1;break}return r.a(2);case 1:if("calibrating"!==(o=t.getState()).status){r.n=2;break}return t.dispatch({type:"starmus/error",payload:{message:"Please wait for calibration to complete.",retryable:!0}}),r.a(2);case 2:if(o.calibration&&o.calibration.complete){r.n=3;break}return t.dispatch({type:"starmus/error",payload:{message:"Please setup your microphone first.",retryable:!0}}),r.a(2);case 3:return r.p=3,a=function(){var r=gd.get(e);if(r&&"recording"===r.mediaRecorder.state){try{d.getFloatTimeDomainData(p);for(var n=0,i=0;i<p.length;i++)n+=p[i]*p[i];var o=Math.sqrt(n/p.length),u=Math.min(100,4e3*o),c=(performance.now()-v)/1e3;t.dispatch({type:"starmus/recorder-tick",duration:c,amplitude:u})}catch(t){}r.rafId=requestAnimationFrame(a)}},r.n=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:if(u=r.v,"suspended"!==(c=Ed(u)).audioContext.state){r.n=5;break}return r.n=5,c.audioContext.resume();case 5:return r.n=6,Sd(c.destinationStream);case 6:if(s=c.destinationStream,s.getAudioTracks().length){r.n=7;break}throw new Error("No audio tracks available");case 7:f=new MediaRecorder(s),l=[],f.ondataavailable=function(t){t.data&&t.data.size>0&&l.push(t.data)},f.onstop=function(){var r=gd.get(e);if(r){r.rafId&&cancelAnimationFrame(r.rafId);var n=new Blob(l,{type:f.mimeType||"audio/webm"}),i="starmus-recording-".concat(Date.now(),".webm");wd(e,"REC_COMPLETE",{severity:"info",message:"Recording stopped and blob created",data:{mimeType:f.mimeType||"audio/webm",chunkCount:l.length}}),t.dispatch({type:"starmus/recording-available",payload:{blob:n,fileName:i}}),u.getTracks().forEach(function(t){return t.stop()}),s.getTracks().forEach(function(t){return t.stop()}),c.nodes.forEach(function(t){try{t.disconnect()}catch(t){}}),gd.delete(e)}},gd.set(e,{mediaRecorder:f,rawStream:u,graph:c,rafId:null}),f.start(3e3),t.dispatch({type:"starmus/mic-start"}),d=c.analyser,p=new Float32Array(d.fftSize),v=performance.now(),requestAnimationFrame(a),r.n=9;break;case 8:r.p=8,m=r.v,console.error("[Recorder] ERROR start-recording:",m),wd(e,"E_RECORDER_START_FAIL",{severity:"error",message:m.message}),t.dispatch({type:"starmus/error",payload:{message:"Recording failed to start.",retryable:!0}});case 9:return r.a(2)}},r,null,[[3,8]])}));return function(t,e){return r.apply(this,arguments)}}()),ca.subscribe("stop-mic",function(r,n){if(n.instanceId===e){var i=gd.get(e);i&&i.mediaRecorder&&"recording"===i.mediaRecorder.state&&(i.mediaRecorder.stop(),t.dispatch({type:"starmus/mic-stop"}))}}),ca.subscribe("pause-mic",function(r,n){if(n.instanceId===e){var i=gd.get(e);i&&i.mediaRecorder&&"recording"===i.mediaRecorder.state&&"function"==typeof i.mediaRecorder.pause&&(t.dispatch({type:"starmus/mic-pause"}),i.mediaRecorder.pause())}}),ca.subscribe("resume-mic",function(r,n){if(n.instanceId===e){var i=gd.get(e);i&&i.mediaRecorder&&"paused"===i.mediaRecorder.state&&"function"==typeof i.mediaRecorder.resume&&(t.dispatch({type:"starmus/mic-resume"}),i.mediaRecorder.resume())}}),ca.subscribe("reset",function(t,r){if(r.instanceId===e){var n=gd.get(e);if(n){try{n.mediaRecorder&&"inactive"!==n.mediaRecorder.state&&n.mediaRecorder.stop()}catch(t){}n.rafId&&cancelAnimationFrame(n.rafId),n.rawStream&&n.rawStream.getTracks().forEach(function(t){return t.stop()}),n.graph&&n.graph.destinationStream&&n.graph.destinationStream.getTracks().forEach(function(t){return t.stop()}),n.graph&&n.graph.nodes&&n.graph.nodes.forEach(function(t){try{t.disconnect()}catch(t){}}),gd.delete(e)}}})}var Id=window.StarmusHooks||window.CommandBus,Cd=Id&&Id.debugLog?Id.debugLog:function(){},Pd=function(){return ma(function t(e,r,n){va(this,t),this.peaks=e,this.container=document.getElementById(r),this.data=Array.isArray(n)?n:[],this.activeTokenIndex=-1,this.isUserScrolling=!1,this.scrollTimeout=null,this.boundOnTimeUpdate=null,this.boundOnSeeked=null,this.boundOnClick=null,this.boundOnScroll=null,this.init()},[{key:"init",value:function(){this.container?(this.render(),this.bindEvents()):console.warn("[StarmusTranscript] Container not found. Transcript sync disabled.")}},{key:"render",value:function(){var t=this,e=document.createDocumentFragment();this.data.forEach(function(r,n){var i=document.createElement("span");i.textContent=r.text,i.className="starmus-word",i.dataset.index=n,i.dataset.start=r.start,i.dataset.end=r.end,"confidence"in r&&r.confidence<.8&&(i.dataset.confidence="low",i.title="Low confidence: ".concat(Math.round(100*r.confidence),"%")),e.appendChild(i),n<t.data.length-1&&e.appendChild(document.createTextNode(" "))}),this.container.innerHTML="",this.container.appendChild(e),this.activeTokenIndex=-1}},{key:"bindEvents",value:function(){var t=this;this.boundOnClick=function(e){var r=e.target;if(r.classList.contains("starmus-word")){var n=parseFloat(r.dataset.start);t.peaks&&t.peaks.player&&"function"==typeof t.peaks.player.seek&&(t.peaks.player.seek(n),Id&&"function"==typeof Id.dispatch&&Id.dispatch("starmus/transcript/seek",{time:n},{instanceId:t.peaks.instanceId}))}},this.container.addEventListener("click",this.boundOnClick),this.boundOnScroll=function(){t.isUserScrolling=!0,t.scrollTimeout&&clearTimeout(t.scrollTimeout),t.scrollTimeout=setTimeout(function(){t.isUserScrolling=!1},1e3)},this.container.addEventListener("scroll",this.boundOnScroll);var e=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;e&&"function"==typeof e.addEventListener?(this.boundOnTimeUpdate=function(){var r=e.currentTime;"number"!=typeof r||isNaN(r)||t.syncHighlight(r)},e.addEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked=function(){var r=e.currentTime;"number"!=typeof r||isNaN(r)||t.syncHighlight(r)},e.addEventListener("seeked",this.boundOnSeeked)):Cd("[StarmusTranscript] Player media element not found â sync disabled")}},{key:"findTokenIndex",value:function(t){if("number"!=typeof t||0===this.data.length)return-1;for(var e=0,r=this.data.length-1;e<=r;){var n=e+r>>1,i=this.data[n];if(t>=i.start&&t<=i.end)return n;t<i.start?r=n-1:e=n+1}return-1}},{key:"syncHighlight",value:function(t){var e=this.findTokenIndex(t);-1===e?this.clearHighlight():e!==this.activeTokenIndex&&this.updateDOM(e)}},{key:"updateDOM",value:function(t){var e=this.container.querySelectorAll(".starmus-word");this.activeTokenIndex>=0&&e[this.activeTokenIndex]&&e[this.activeTokenIndex].classList.remove("is-active"),this.activeTokenIndex=t;var r=e[t];r&&(r.classList.add("is-active"),this.isUserScrolling||this.scrollToWord(r))}},{key:"clearHighlight",value:function(){var t=this.container.querySelector(".starmus-word.is-active");t&&t.classList.remove("is-active"),this.activeTokenIndex=-1}},{key:"scrollToWord",value:function(t){t.scrollIntoView&&t.scrollIntoView({block:"center",behavior:"smooth"})}},{key:"updateData",value:function(t){this.data=Array.isArray(t)?t:[],this.render(),this.unbindEvents(),this.bindEvents()}},{key:"unbindEvents",value:function(){if(this.container){this.boundOnClick&&this.container.removeEventListener("click",this.boundOnClick),this.boundOnScroll&&this.container.removeEventListener("scroll",this.boundOnScroll);var t=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;t&&"function"==typeof t.removeEventListener&&(this.boundOnTimeUpdate&&t.removeEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked&&t.removeEventListener("seeked",this.boundOnSeeked))}}},{key:"destroy",value:function(){this.unbindEvents(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.container&&(this.container.innerHTML=""),this.data=[],this.activeTokenIndex=-1,this.isUserScrolling=!1}}])}();function Rd(t,e,r){return new Pd(t,e,r)}"undefined"!=typeof window&&(window.StarmusTranscript=Pd,window.StarmusTranscriptController={StarmusTranscript:Pd,init:Rd}),"undefined"!=typeof module&&module.exports&&(module.exports={StarmusTranscript:Pd,init:Rd});var Md,_d={};!function(){if(Md)return _d;Md=1;var t=Lr(),e=hr().includes,r=h(),n=xn();t({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")}();var jd,Nd,Bd,Ud,Ld,Dd,Fd,qd={};function zd(){if(Ud)return Bd;Ud=1;var t=function(){if(Nd)return jd;Nd=1;var t=yt(),e=lt(),r=ue()("match");return jd=function(n){var i;return t(n)&&(void 0!==(i=n[r])?!!i:"RegExp"===e(n))}}(),e=TypeError;return Bd=function(r){if(t(r))throw new e("The method doesn't accept regular expressions");return r}}function Hd(t,e){Object.keys(t).forEach(function(r){var n=t[r],i=e.querySelector('input[name="'.concat(r,'"]'));if(i||((i=document.createElement("input")).type="hidden",i.name=r,e.appendChild(i)),null==n)i.value="";else if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)i.value=String(n);else try{i.value=JSON.stringify(n)}catch(t){console.warn("[StarmusMetadataAuto] Could not serialize field",r,n),i.value=""}})}function Wd(t,e){t&&Array.isArray(e)&&1===t.nodeType?e.forEach(function(e){try{var r=t.querySelector('input[name="'.concat(e,'"]'));r&&r.parentNode&&(t.contains(r)?(r.parentNode.removeChild(r),console.debug("[StarmusMetadataAuto] Removed field:",e)):console.debug("[StarmusMetadataAuto] Field not a child of form:",e))}catch(t){console.warn("[StarmusMetadataAuto] Could not remove field",e,t.message)}}):console.warn("[StarmusMetadataAuto] Invalid form element or field names for clearHiddenFields")}function Gd(t){var e,r,n,i,o,a,u,c,s,f,l,d,p,v,m,h,y,g,b,w,S,O,k,E,A=new Date,T=A.toISOString().split("T")[0],x=A.toISOString();return{starmus_title:(null===(e=t.source)||void 0===e?void 0:e.title)||"",starmus_language:(null===(r=t.source)||void 0===r?void 0:r.language)||"",starmus_recording_type:(null===(n=t.source)||void 0===n?void 0:n.type)||"",audio_file_type:(null===(i=t.submission)||void 0===i||null===(i=i.blob)||void 0===i?void 0:i.type)||"audio/webm",agreement_to_terms:null!==(o=t.user)&&void 0!==o&&o.agreedToTerms?"1":"0",_starmus_calibration:t.calibration||{},_starmus_env:t.env||{},first_pass_transcription:(null===(a=t.source)||void 0===a?void 0:a.transcript)||"",recording_metadata:(null===(u=t.source)||void 0===u?void 0:u.metadata)||{},waveform_json:(null===(c=t.source)||void 0===c?void 0:c.waveform)||{},project_collection_id:(null===(s=t.submission)||void 0===s?void 0:s.collectionId)||"",accession_number:(null===(f=t.submission)||void 0===f?void 0:f.accession)||"",session_date:T,session_start_time:(null===(l=t.recorder)||void 0===l?void 0:l.startTime)||x,session_end_time:(null===(d=t.recorder)||void 0===d?void 0:d.endTime)||x,location:(null===(p=t.source)||void 0===p?void 0:p.location)||"",gps_coordinates:(null===(v=t.source)||void 0===v?void 0:v.gps)||"",contributor_id:(null===(m=t.user)||void 0===m?void 0:m.id)||"",interviewers_recorders:(null===(h=t.source)||void 0===h?void 0:h.interviewers)||"",recording_equipment:(null===(y=t.source)||void 0===y?void 0:y.equipment)||"",audio_files_originals:(null===(g=t.source)||void 0===g?void 0:g.originals)||[],media_condition_notes:(null===(b=t.source)||void 0===b?void 0:b.conditionNotes)||"",related_consent_agreement:(null===(w=t.source)||void 0===w?void 0:w.consent)||"",usage_restrictions_rights:(null===(S=t.source)||void 0===S?void 0:S.usageRights)||"",access_level:(null===(O=t.submission)||void 0===O?void 0:O.accessLevel)||"",audio_quality_score:(null===(k=t.submission)||void 0===k?void 0:k.qualityScore)||"",mic_rest_adjustments:(null===(E=t.calibration)||void 0===E?void 0:E.adjustments)||"",device:navigator.userAgent,user_agent:navigator.userAgent}}function Vd(t,e){var r=[];return e.forEach(function(e){var n=t[e];(null==n||"string"==typeof n&&""===n.trim()||Array.isArray(n)&&0===n.length)&&r.push(e)}),{valid:0===r.length,missing:r}}function Qd(t,e,r){if(t&&"function"==typeof t.getState&&"function"==typeof t.subscribe){if(e instanceof HTMLFormElement){var n=r||{},i=Array.isArray(n.trigger)?n.trigger:[n.trigger||"ready_to_submit"],o=Array.isArray(n.clearOn)?n.clearOn:[n.clearOn||"reset"],a=Array.isArray(n.requiredFields)?n.requiredFields:[],u=null,c=t.subscribe(s);return s(),c}console.warn("[StarmusMetadataAuto] Invalid form element â must be HTMLFormElement")}else console.warn("[StarmusMetadataAuto] Invalid store â cannot init auto metadata");function s(){var r=t.getState(),n=r.status;if(o.includes(n)&&Wd(e,Object.keys(Gd(r))),n!==u&&i.includes(n)){u=n;var c=Gd(r),s=a.length?Vd(c,a):{valid:!0,missing:[]},f=s.valid,l=s.missing;f||console.warn("[StarmusMetadataAuto] Missing required metadata fields:",l),Hd(c,e)}else u=n}}!function(){if(Fd)return qd;Fd=1;var t=Lr(),e=ft(),r=zd(),n=vt(),i=Uo(),o=function(){if(Dd)return Ld;Dd=1;var t=ue()("match");return Ld=function(e){var r=/./;try{"/./"[e](r)}catch(n){try{return r[t]=!1,"/./"[e](r)}catch(t){}}return!1}}(),a=e("".indexOf);t({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~a(i(n(this)),i(r(t)),arguments.length>1?arguments[1]:void 0)}})}(),"undefined"!=typeof window&&(window.StarmusMetadataAuto={initAutoMetadata:Qd,populateHiddenFields:Hd,buildMetadataMap:Gd,validateMetadata:Vd,clearHiddenFields:Wd});var $d,Yd={};!function(){if($d)return Yd;$d=1;var t=Lr(),e=y(),r=ke().f;t({target:"Object",stat:!0,forced:Object.defineProperty!==r,sham:!e},{defineProperty:r})}(),"undefined"!=typeof window&&(window.StarmusTus=t),"undefined"!=typeof window&&function(t){try{if("function"==typeof t.Peaks||"object"===Aa(t.Peaks))return t.Starmus=t.Starmus||{},void(t.Starmus.Peaks=t.Peaks);Object.defineProperty(t,"Peaks",{get:function(){return t.Starmus=t.Starmus||{},t.Starmus.Peaks},set:function(e){t.Starmus=t.Starmus||{},t.Starmus.Peaks=e},configurable:!0}),t.Peaks=e,t.Starmus.Peaks=e}catch(t){console.warn("[Starmus] Peaks.js exposure failed:",t)}}(window);var Jd,Kd,Xd=new Map;function Zd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:e.instanceId||null,event:t,severity:e.severity||"info",message:e.message||"",data:e.data||{}})}catch(t){console.warn("[Starmus Integrator] emitGlobalEvent failed:",t)}}function tp(){try{return navigator.deviceMemory||null}catch(t){return null}}function ep(){try{return navigator.hardwareConcurrency||null}catch(t){return null}}function rp(t){var e=t.capabilities||{},r=t.network||{};if(/\bCrOS\b|Chrome OS/i.test(navigator.userAgent))return"A";if(!e.mediaRecorder||!e.webrtc)return"C";var n=tp(),i=ep();if(n&&n<1)return"C";if(i){if(1===i)return"C";if(2===i)return"B"}return/wv|Crosswalk|Android WebView|Opera Mini/i.test(navigator.userAgent)?"C":"2g"===r.effectiveType||"slow-2g"===r.effectiveType||n&&n<2?"B":"A"}function np(t){return ip.apply(this,arguments)}function ip(){return(ip=pa(wa().m(function t(e){var r,n;return wa().w(function(t){for(;;)switch(t.p=t.n){case 0:if("C"!==e){t.n=1;break}return t.a(2,"C");case 1:if(!navigator.storage||!navigator.storage.estimate){t.n=6;break}return t.p=2,t.n=3,navigator.storage.estimate();case 3:if(r=t.v,!((n=(r.quota||0)/1024/1024)&&n<80)){t.n=4;break}return t.a(2,"C");case 4:t.n=6;break;case 5:t.p=5,t.v;case 6:if(!navigator.permissions||!navigator.permissions.query){t.n=11;break}return t.p=7,t.n=8,navigator.permissions.query({name:"microphone"});case 8:if("denied"!==t.v.state){t.n=9;break}return t.a(2,"C");case 9:t.n=11;break;case 10:t.p=10,t.v;case 11:return t.a(2,e)}},t,null,[[7,10],[2,5]])}))).apply(this,arguments)}function op(){return(op=pa(wa().m(function t(e,r){var n,i,o,a,u;return wa().w(function(t){for(;;)switch(t.n){case 0:if((n=r.getAttribute("data-starmus-id"))||(n="starmus_"+Date.now()+"_"+Math.random().toString(16).substr(2),r.setAttribute("data-starmus-id",n)),!Xd.has(n)){t.n=1;break}return t.a(2,n);case 1:return i=rp(e),t.n=2,np(i);case 2:return i=t.v,ia("[Starmus] Instance ".concat(n," â Tier ").concat(i)),Zd("TIER_ASSIGN",{instanceId:n,severity:"info",message:"Tier ".concat(i," assigned"),data:{tier:i}}),o=fa({instanceId:n,env:e,tier:i}),a={formEl:r,step1:r.querySelector(".starmus-step-1"),step2:r.querySelector(".starmus-step-2"),messageBox:r.querySelector("[data-starmus-message-box]"),statusEl:r.querySelector("[data-starmus-status]"),recorderContainer:r.querySelector("[data-starmus-recorder-container]"),fallbackContainer:r.querySelector("[data-starmus-fallback-container]"),recordBtn:r.querySelector('[data-starmus-action="record"]'),pauseBtn:r.querySelector('[data-starmus-action="pause"]'),resumeBtn:r.querySelector('[data-starmus-action="resume"]'),stopBtn:r.querySelector('[data-starmus-action="stop"]'),submitBtn:r.querySelector('[data-starmus-action="submit"]'),resetBtn:r.querySelector('[data-starmus-action="reset"]'),playBtn:r.querySelector('[data-starmus-action="play"]'),timer:r.querySelector("[data-starmus-timer]"),volumeMeter:r.querySelector("[data-starmus-volume-meter]"),durationProgress:r.querySelector("[data-starmus-duration-progress]")},Us(o,a),Ks(o,n,e),t.n=3,ks().catch(function(t){console.warn("[Starmus] offline init error",t)});case 3:return o.dispatch({type:"starmus/init",payload:{instanceId:n,env:e,tier:i}}),u=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&window.MediaRecorder&&(window.AudioContext||window.webkitAudioContext)),"C"!==i&&u?xd(o,n):(a.recorderContainer&&(a.recorderContainer.style.display="none"),a.fallbackContainer&&(a.fallbackContainer.style.display="block"),o.dispatch({type:"starmus/tier-ready",payload:{tier:"C",fallbackActive:!0}})),r.addEventListener("submit",function(t){t.preventDefault(),oa("submit",{},{instanceId:n})}),a.resetBtn&&a.resetBtn.addEventListener("click",function(t){t.preventDefault(),o.dispatch({type:"starmus/reset"}),oa("reset",{},{instanceId:n})}),u&&"C"!==i&&(a.recordBtn&&a.recordBtn.addEventListener("click",function(t){t.preventDefault(),oa("start-recording",{},{instanceId:n})}),a.pauseBtn&&a.pauseBtn.addEventListener("click",function(t){t.preventDefault(),oa("pause-mic",{},{instanceId:n})}),a.resumeBtn&&a.resumeBtn.addEventListener("click",function(t){t.preventDefault(),oa("resume-mic",{},{instanceId:n})}),a.stopBtn&&a.stopBtn.addEventListener("click",function(t){t.preventDefault(),oa("stop-mic",{},{instanceId:n})})),Xd.set(n,{store:o,elements:a,tier:i}),t.a(2,n)}},t)}))).apply(this,arguments)}Jd=function(){try{return navigator.connection||navigator.mozConnection||navigator.webkitConnection||null}catch(t){return null}}()||{},Kd={browser:{userAgent:navigator.userAgent},device:{type:/mobile|android|iphone|ipad/i.test(navigator.userAgent)?"mobile":"desktop",memory:tp(),concurrency:ep()},capabilities:{webrtc:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),mediaRecorder:!!window.MediaRecorder,indexedDB:!!window.indexedDB},network:{effectiveType:Jd.effectiveType||"unknown",downlink:Jd.downlink||null,saveData:Jd.saveData||!1}},document.querySelectorAll('form[data-starmus="recorder"]').forEach(function(t){(function(t,e){return op.apply(this,arguments)})(Kd,t).catch(function(e){console.error("[Starmus] wireInstance failed for form",t,e)})}),window.createStore=fa,window.initCore=Ks,window.initUI=Us,window.initRecorder=xd,window.StarmusTus=rs,window.StarmusTranscriptController=Pd,window.StarmusOfflineQueue=gs,window.StarmusQueueSubmission=ws,window.initOffline=ks,window.initAutoMetadata=Qd,window.StarmusIntegrator=!0,window.StarmusRecorder=xd,window.initStarmusRecorder=xd,console.log("[Starmus] Runtime globals wired");export{Pd as StarmusTranscript,rs as StarmusTus,fa as createStore,gs as getOfflineQueue,Qd as initAutoMetadata,Ks as initCore,ks as initOffline,xd as initRecorder,Us as initUI,ws as queueSubmission};
