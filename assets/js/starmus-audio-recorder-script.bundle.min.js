import*as e from"tus-js-client";import t from"peaks.js";var r,n,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o={};function a(){if(n)return r;n=1;var e=function(e){return e&&e.Math===Math&&e};return r=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof i&&i)||e("object"==typeof r&&r)||function(){return this}()||Function("return this")()}var u,s,c,f,l,d,p,v,h={};function m(){return s?u:(s=1,u=function(e){try{return!!e()}catch(e){return!0}})}function y(){if(f)return c;f=1;var e=m();return c=!e(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})}function g(){if(d)return l;d=1;var e=m();return l=!e(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})}function w(){if(v)return p;v=1;var e=g(),t=Function.prototype.call;return p=e?t.bind(t):function(){return t.apply(t,arguments)},p}var b,S,k,A,T,E,O,x,I,R,C,P,_,M,U,L,B,j,N,D,F,q,H,z,W,G,V,$,J,Q,Y,K,X,Z,ee,te,re,ne,ie,oe,ae,ue={};function se(){if(b)return ue;b=1;var e={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,r=t&&!e.call({1:2},1);return ue.f=r?function(e){var r=t(this,e);return!!r&&r.enumerable}:e,ue}function ce(){return k?S:(k=1,S=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}})}function fe(){if(T)return A;T=1;var e=g(),t=Function.prototype,r=t.call,n=e&&t.bind.bind(r,r);return A=e?n:function(e){return function(){return r.apply(e,arguments)}},A}function le(){if(O)return E;O=1;var e=fe(),t=e({}.toString),r=e("".slice);return E=function(e){return r(t(e),8,-1)}}function de(){if(I)return x;I=1;var e=fe(),t=m(),r=le(),n=Object,i=e("".split);return x=t(function(){return!n("z").propertyIsEnumerable(0)})?function(e){return"String"===r(e)?i(e,""):n(e)}:n}function pe(){return C?R:(C=1,R=function(e){return null==e})}function ve(){if(_)return P;_=1;var e=pe(),t=TypeError;return P=function(r){if(e(r))throw new t("Can't call method on "+r);return r}}function he(){if(U)return M;U=1;var e=de(),t=ve();return M=function(r){return e(t(r))}}function me(){if(B)return L;B=1;var e="object"==typeof document&&document.all;return L=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(e){return"function"==typeof e}}function ye(){if(N)return j;N=1;var e=me();return j=function(t){return"object"==typeof t?null!==t:e(t)}}function ge(){if(F)return D;F=1;var e=a(),t=me();return D=function(r,n){return arguments.length<2?(i=e[r],t(i)?i:void 0):e[r]&&e[r][n];var i},D}function we(){if(H)return q;H=1;var e=fe();return q=e({}.isPrototypeOf)}function be(){if(W)return z;W=1;var e=a().navigator,t=e&&e.userAgent;return z=t?String(t):""}function Se(){if(V)return G;V=1;var e,t,r=a(),n=be(),i=r.process,o=r.Deno,u=i&&i.versions||o&&o.version,s=u&&u.v8;return s&&(t=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!t&&n&&(!(e=n.match(/Edge\/(\d+)/))||e[1]>=74)&&(e=n.match(/Chrome\/(\d+)/))&&(t=+e[1]),G=t}function ke(){if(J)return $;J=1;var e=Se(),t=m(),r=a().String;return $=!!Object.getOwnPropertySymbols&&!t(function(){var t=Symbol("symbol detection");return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41})}function Ae(){if(Y)return Q;Y=1;var e=ke();return Q=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function Te(){if(X)return K;X=1;var e=ge(),t=me(),r=we(),n=Ae(),i=Object;return K=n?function(e){return"symbol"==typeof e}:function(n){var o=e("Symbol");return t(o)&&r(o.prototype,i(n))}}function Ee(){if(ee)return Z;ee=1;var e=String;return Z=function(t){try{return e(t)}catch(e){return"Object"}}}function Oe(){if(re)return te;re=1;var e=me(),t=Ee(),r=TypeError;return te=function(n){if(e(n))return n;throw new r(t(n)+" is not a function")}}function xe(){if(ie)return ne;ie=1;var e=Oe(),t=pe();return ne=function(r,n){var i=r[n];return t(i)?void 0:e(i)}}function Ie(){if(ae)return oe;ae=1;var e=w(),t=me(),r=ye(),n=TypeError;return oe=function(i,o){var a,u;if("string"===o&&t(a=i.toString)&&!r(u=e(a,i)))return u;if(t(a=i.valueOf)&&!r(u=e(a,i)))return u;if("string"!==o&&t(a=i.toString)&&!r(u=e(a,i)))return u;throw new n("Can't convert object to primitive value")}}var Re,Ce,Pe,_e,Me,Ue,Le,Be,je,Ne,De,Fe,qe,He,ze,We,Ge,Ve,$e,Je,Qe,Ye,Ke,Xe,Ze={exports:{}};function et(){return Ce?Re:(Ce=1,Re=!1)}function tt(){if(_e)return Pe;_e=1;var e=a(),t=Object.defineProperty;return Pe=function(r,n){try{t(e,r,{value:n,configurable:!0,writable:!0})}catch(t){e[r]=n}return n}}function rt(){if(Me)return Ze.exports;Me=1;var e=et(),t=a(),r=tt(),n="__core-js_shared__",i=Ze.exports=t[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.47.0",mode:e?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Ze.exports}function nt(){if(Le)return Ue;Le=1;var e=rt();return Ue=function(t,r){return e[t]||(e[t]=r||{})}}function it(){if(je)return Be;je=1;var e=ve(),t=Object;return Be=function(r){return t(e(r))}}function ot(){if(De)return Ne;De=1;var e=fe(),t=it(),r=e({}.hasOwnProperty);return Ne=Object.hasOwn||function(e,n){return r(t(e),n)}}function at(){if(qe)return Fe;qe=1;var e=fe(),t=0,r=Math.random(),n=e(1.1.toString);return Fe=function(e){return"Symbol("+(void 0===e?"":e)+")_"+n(++t+r,36)}}function ut(){if(ze)return He;ze=1;var e=a(),t=nt(),r=ot(),n=at(),i=ke(),o=Ae(),u=e.Symbol,s=t("wks"),c=o?u.for||u:u&&u.withoutSetter||n;return He=function(e){return r(s,e)||(s[e]=i&&r(u,e)?u[e]:c("Symbol."+e)),s[e]}}function st(){if(Ge)return We;Ge=1;var e=w(),t=ye(),r=Te(),n=xe(),i=Ie(),o=ut(),a=TypeError,u=o("toPrimitive");return We=function(o,s){if(!t(o)||r(o))return o;var c,f=n(o,u);if(f){if(void 0===s&&(s="default"),c=e(f,o,s),!t(c)||r(c))return c;throw new a("Can't convert object to primitive value")}return void 0===s&&(s="number"),i(o,s)}}function ct(){if($e)return Ve;$e=1;var e=st(),t=Te();return Ve=function(r){var n=e(r,"string");return t(n)?n:n+""}}function ft(){if(Qe)return Je;Qe=1;var e=a(),t=ye(),r=e.document,n=t(r)&&t(r.createElement);return Je=function(e){return n?r.createElement(e):{}}}function lt(){if(Ke)return Ye;Ke=1;var e=y(),t=m(),r=ft();return Ye=!e&&!t(function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a})}function dt(){if(Xe)return h;Xe=1;var e=y(),t=w(),r=se(),n=ce(),i=he(),o=ct(),a=ot(),u=lt(),s=Object.getOwnPropertyDescriptor;return h.f=e?s:function(e,c){if(e=i(e),c=o(c),u)try{return s(e,c)}catch(e){}if(a(e,c))return n(!t(r.f,e,c),e[c])},h}var pt,vt,ht,mt,yt,gt,wt,bt={};function St(){if(vt)return pt;vt=1;var e=y(),t=m();return pt=e&&t(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})}function kt(){if(mt)return ht;mt=1;var e=ye(),t=String,r=TypeError;return ht=function(n){if(e(n))return n;throw new r(t(n)+" is not an object")}}function At(){if(yt)return bt;yt=1;var e=y(),t=lt(),r=St(),n=kt(),i=ct(),o=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,s="enumerable",c="configurable",f="writable";return bt.f=e?r?function(e,t,r){if(n(e),t=i(t),n(r),"function"==typeof e&&"prototype"===t&&"value"in r&&f in r&&!r[f]){var o=u(e,t);o&&o[f]&&(e[t]=r.value,r={configurable:c in r?r[c]:o[c],enumerable:s in r?r[s]:o[s],writable:!1})}return a(e,t,r)}:a:function(e,r,u){if(n(e),r=i(r),n(u),t)try{return a(e,r,u)}catch(e){}if("get"in u||"set"in u)throw new o("Accessors not supported");return"value"in u&&(e[r]=u.value),e},bt}function Tt(){if(wt)return gt;wt=1;var e=y(),t=At(),r=ce();return gt=e?function(e,n,i){return t.f(e,n,r(1,i))}:function(e,t,r){return e[t]=r,e}}var Et,Ot,xt,It,Rt,Ct,Pt,_t,Mt,Ut,Lt,Bt,jt,Nt,Dt,Ft={exports:{}};function qt(){if(Ot)return Et;Ot=1;var e=y(),t=ot(),r=Function.prototype,n=e&&Object.getOwnPropertyDescriptor,i=t(r,"name"),o=i&&"something"===function(){}.name,a=i&&(!e||e&&n(r,"name").configurable);return Et={EXISTS:i,PROPER:o,CONFIGURABLE:a}}function Ht(){if(It)return xt;It=1;var e=fe(),t=me(),r=rt(),n=e(Function.toString);return t(r.inspectSource)||(r.inspectSource=function(e){return n(e)}),xt=r.inspectSource}function zt(){if(_t)return Pt;_t=1;var e=nt(),t=at(),r=e("keys");return Pt=function(e){return r[e]||(r[e]=t(e))}}function Wt(){return Ut?Mt:(Ut=1,Mt={})}function Gt(){if(Bt)return Lt;Bt=1;var e,t,r,n=function(){if(Ct)return Rt;Ct=1;var e=a(),t=me(),r=e.WeakMap;return Rt=t(r)&&/native code/.test(String(r))}(),i=a(),o=ye(),u=Tt(),s=ot(),c=rt(),f=zt(),l=Wt(),d="Object already initialized",p=i.TypeError,v=i.WeakMap;if(n||c.state){var h=c.state||(c.state=new v);h.get=h.get,h.has=h.has,h.set=h.set,e=function(e,t){if(h.has(e))throw new p(d);return t.facade=e,h.set(e,t),t},t=function(e){return h.get(e)||{}},r=function(e){return h.has(e)}}else{var m=f("state");l[m]=!0,e=function(e,t){if(s(e,m))throw new p(d);return t.facade=e,u(e,m,t),t},t=function(e){return s(e,m)?e[m]:{}},r=function(e){return s(e,m)}}return Lt={set:e,get:t,has:r,enforce:function(n){return r(n)?t(n):e(n,{})},getterFor:function(e){return function(r){var n;if(!o(r)||(n=t(r)).type!==e)throw new p("Incompatible receiver, "+e+" required");return n}}}}function Vt(){if(jt)return Ft.exports;jt=1;var e=fe(),t=m(),r=me(),n=ot(),i=y(),o=qt().CONFIGURABLE,a=Ht(),u=Gt(),s=u.enforce,c=u.get,f=String,l=Object.defineProperty,d=e("".slice),p=e("".replace),v=e([].join),h=i&&!t(function(){return 8!==l(function(){},"length",{value:8}).length}),g=String(String).split("String"),w=Ft.exports=function(e,t,r){"Symbol("===d(f(t),0,7)&&(t="["+p(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!n(e,"name")||o&&e.name!==t)&&(i?l(e,"name",{value:t,configurable:!0}):e.name=t),h&&r&&n(r,"arity")&&e.length!==r.arity&&l(e,"length",{value:r.arity});try{r&&n(r,"constructor")&&r.constructor?i&&l(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var a=s(e);return n(a,"source")||(a.source=v(g,"string"==typeof t?t:"")),e};return Function.prototype.toString=w(function(){return r(this)&&c(this).source||a(this)},"toString"),Ft.exports}function $t(){if(Dt)return Nt;Dt=1;var e=me(),t=At(),r=Vt(),n=tt();return Nt=function(i,o,a,u){u||(u={});var s=u.enumerable,c=void 0!==u.name?u.name:o;if(e(a)&&r(a,c,u),u.global)s?i[o]=a:n(o,a);else{try{u.unsafe?i[o]&&(s=!0):delete i[o]}catch(e){}s?i[o]=a:t.f(i,o,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return i}}var Jt,Qt,Yt,Kt,Xt,Zt,er,tr,rr,nr,ir,or,ar,ur,sr,cr,fr,lr={};function dr(){if(Kt)return Yt;Kt=1;var e=function(){if(Qt)return Jt;Qt=1;var e=Math.ceil,t=Math.floor;return Jt=Math.trunc||function(r){var n=+r;return(n>0?t:e)(n)}}();return Yt=function(t){var r=+t;return r!=r||0===r?0:e(r)}}function pr(){if(Zt)return Xt;Zt=1;var e=dr(),t=Math.max,r=Math.min;return Xt=function(n,i){var o=e(n);return o<0?t(o+i,0):r(o,i)}}function vr(){if(tr)return er;tr=1;var e=dr(),t=Math.min;return er=function(r){var n=e(r);return n>0?t(n,9007199254740991):0}}function hr(){if(nr)return rr;nr=1;var e=vr();return rr=function(t){return e(t.length)}}function mr(){if(or)return ir;or=1;var e=he(),t=pr(),r=hr(),n=function(n){return function(i,o,a){var u=e(i),s=r(u);if(0===s)return!n&&-1;var c,f=t(a,s);if(n&&o!=o){for(;s>f;)if((c=u[f++])!=c)return!0}else for(;s>f;f++)if((n||f in u)&&u[f]===o)return n||f||0;return!n&&-1}};return ir={includes:n(!0),indexOf:n(!1)}}function yr(){if(ur)return ar;ur=1;var e=fe(),t=ot(),r=he(),n=mr().indexOf,i=Wt(),o=e([].push);return ar=function(e,a){var u,s=r(e),c=0,f=[];for(u in s)!t(i,u)&&t(s,u)&&o(f,u);for(;a.length>c;)t(s,u=a[c++])&&(~n(f,u)||o(f,u));return f}}function gr(){return cr?sr:(cr=1,sr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}function wr(){if(fr)return lr;fr=1;var e=yr(),t=gr().concat("length","prototype");return lr.f=Object.getOwnPropertyNames||function(r){return e(r,t)},lr}var br,Sr,kr,Ar,Tr,Er,Or,xr,Ir,Rr,Cr,Pr,_r,Mr,Ur={};function Lr(){return br||(br=1,Ur.f=Object.getOwnPropertySymbols),Ur}function Br(){if(Tr)return Ar;Tr=1;var e=ot(),t=function(){if(kr)return Sr;kr=1;var e=ge(),t=fe(),r=wr(),n=Lr(),i=kt(),o=t([].concat);return Sr=e("Reflect","ownKeys")||function(e){var t=r.f(i(e)),a=n.f;return a?o(t,a(e)):t}}(),r=dt(),n=At();return Ar=function(i,o,a){for(var u=t(o),s=n.f,c=r.f,f=0;f<u.length;f++){var l=u[f];e(i,l)||a&&e(a,l)||s(i,l,c(o,l))}}}function jr(){if(Or)return Er;Or=1;var e=m(),t=me(),r=/#|\.prototype\./,n=function(r,n){var s=o[i(r)];return s===u||s!==a&&(t(n)?e(n):!!n)},i=n.normalize=function(e){return String(e).replace(r,".").toLowerCase()},o=n.data={},a=n.NATIVE="N",u=n.POLYFILL="P";return Er=n}function Nr(){if(Ir)return xr;Ir=1;var e=a(),t=dt().f,r=Tt(),n=$t(),i=tt(),o=Br(),u=jr();return xr=function(a,s){var c,f,l,d,p,v=a.target,h=a.global,m=a.stat;if(c=h?e:m?e[v]||i(v,{}):e[v]&&e[v].prototype)for(f in s){if(d=s[f],l=a.dontCallGetSet?(p=t(c,f))&&p.value:c[f],!u(h?f:v+(m?".":"#")+f,a.forced)&&void 0!==l){if(typeof d==typeof l)continue;o(d,l)}(a.sham||l&&l.sham)&&r(d,"sham",!0),n(c,f,d,a)}}}function Dr(){if(Cr)return Rr;Cr=1;var e=le(),t=fe();return Rr=function(r){if("Function"===e(r))return t(r)}}function Fr(){if(_r)return Pr;_r=1;var e=m();return Pr=function(t,r){var n=[][t];return!!n&&e(function(){n.call(null,r||function(){return 1},1)})}}!function(){if(Mr)return o;Mr=1;var e=Nr(),t=Dr(),r=mr().indexOf,n=Fr(),i=t([].indexOf),a=!!i&&1/i([1],1,-0)<0;e({target:"Array",proto:!0,forced:a||!n("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return a?i(this,e,t)||0:r(this,e,t)}})}();var qr,Hr,zr,Wr,Gr,Vr,$r,Jr,Qr,Yr,Kr,Xr,Zr,en,tn,rn,nn,on,an,un,sn,cn,fn,ln,dn,pn,vn,hn,mn,yn,gn,wn,bn,Sn,kn,An={};function Tn(){if(Hr)return qr;Hr=1;var e=yr(),t=gr();return qr=Object.keys||function(r){return e(r,t)}}function En(){if(Gr)return Wr;Gr=1;var e=ge();return Wr=e("document","documentElement")}function On(){if($r)return Vr;$r=1;var e,t=kt(),r=function(){if(zr)return An;zr=1;var e=y(),t=St(),r=At(),n=kt(),i=he(),o=Tn();return An.f=e&&!t?Object.defineProperties:function(e,t){n(e);for(var a,u=i(t),s=o(t),c=s.length,f=0;c>f;)r.f(e,a=s[f++],u[a]);return e},An}(),n=gr(),i=Wt(),o=En(),a=ft(),u=zt(),s="prototype",c="script",f=u("IE_PROTO"),l=function(){},d=function(e){return"<"+c+">"+e+"</"+c+">"},p=function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t},v=function(){try{e=new ActiveXObject("htmlfile")}catch(e){}var t,r,i;v="undefined"!=typeof document?document.domain&&e?p(e):(r=a("iframe"),i="java"+c+":",r.style.display="none",o.appendChild(r),r.src=String(i),(t=r.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F):p(e);for(var u=n.length;u--;)delete v[s][n[u]];return v()};return i[f]=!0,Vr=Object.create||function(e,n){var i;return null!==e?(l[s]=t(e),i=new l,l[s]=null,i[f]=e):i=v(),void 0===n?i:r.f(i,n)}}function xn(){if(Qr)return Jr;Qr=1;var e=ut(),t=On(),r=At().f,n=e("unscopables"),i=Array.prototype;return void 0===i[n]&&r(i,n,{configurable:!0,value:t(null)}),Jr=function(e){i[n][e]=!0}}function In(){return Kr?Yr:(Kr=1,Yr={})}function Rn(){if(tn)return en;tn=1;var e=ot(),t=me(),r=it(),n=zt(),i=function(){if(Zr)return Xr;Zr=1;var e=m();return Xr=!e(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})}(),o=n("IE_PROTO"),a=Object,u=a.prototype;return en=i?a.getPrototypeOf:function(n){var i=r(n);if(e(i,o))return i[o];var s=i.constructor;return t(s)&&i instanceof s?s.prototype:i instanceof a?u:null}}function Cn(){if(nn)return rn;nn=1;var e,t,r,n=m(),i=me(),o=ye(),a=On(),u=Rn(),s=$t(),c=ut(),f=et(),l=c("iterator"),d=!1;return[].keys&&("next"in(r=[].keys())?(t=u(u(r)))!==Object.prototype&&(e=t):d=!0),!o(e)||n(function(){var t={};return e[l].call(t)!==t})?e={}:f&&(e=a(e)),i(e[l])||s(e,l,function(){return this}),rn={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:d}}function Pn(){if(an)return on;an=1;var e=At().f,t=ot(),r=ut()("toStringTag");return on=function(n,i,o){n&&!o&&(n=n.prototype),n&&!t(n,r)&&e(n,r,{configurable:!0,value:i})}}function _n(){if(sn)return un;sn=1;var e=Cn().IteratorPrototype,t=On(),r=ce(),n=Pn(),i=In(),o=function(){return this};return un=function(a,u,s,c){var f=u+" Iterator";return a.prototype=t(e,{next:r(+!c,s)}),n(a,f,!1,!0),i[f]=o,a}}function Mn(){if(dn)return ln;dn=1;var e=ye();return ln=function(t){return e(t)||null===t}}function Un(){if(vn)return pn;vn=1;var e=Mn(),t=String,r=TypeError;return pn=function(n){if(e(n))return n;throw new r("Can't set "+t(n)+" as a prototype")}}function Ln(){if(mn)return hn;mn=1;var e=function(){if(fn)return cn;fn=1;var e=fe(),t=Oe();return cn=function(r,n,i){try{return e(t(Object.getOwnPropertyDescriptor(r,n)[i]))}catch(e){}}}(),t=ye(),r=ve(),n=Un();return hn=Object.setPrototypeOf||("__proto__"in{}?function(){var i,o=!1,a={};try{(i=e(Object.prototype,"__proto__","set"))(a,[]),o=a instanceof Array}catch(e){}return function(e,a){return r(e),n(a),t(e)?(o?i(e,a):e.__proto__=a,e):e}}():void 0)}function Bn(){if(gn)return yn;gn=1;var e=Nr(),t=w(),r=et(),n=qt(),i=me(),o=_n(),a=Rn(),u=Ln(),s=Pn(),c=Tt(),f=$t(),l=ut(),d=In(),p=Cn(),v=n.PROPER,h=n.CONFIGURABLE,m=p.IteratorPrototype,y=p.BUGGY_SAFARI_ITERATORS,g=l("iterator"),b="keys",S="values",k="entries",A=function(){return this};return yn=function(n,l,p,w,T,E,O){o(p,l,w);var x,I,R,C=function(e){if(e===T&&L)return L;if(!y&&e&&e in M)return M[e];switch(e){case b:case S:case k:return function(){return new p(this,e)}}return function(){return new p(this)}},P=l+" Iterator",_=!1,M=n.prototype,U=M[g]||M["@@iterator"]||T&&M[T],L=!y&&U||C(T),B="Array"===l&&M.entries||U;if(B&&(x=a(B.call(new n)))!==Object.prototype&&x.next&&(r||a(x)===m||(u?u(x,m):i(x[g])||f(x,g,A)),s(x,P,!0,!0),r&&(d[P]=A)),v&&T===S&&U&&U.name!==S&&(!r&&h?c(M,"name",S):(_=!0,L=function(){return t(U,this)})),T)if(I={values:C(S),keys:E?L:C(b),entries:C(k)},O)for(R in I)(y||_||!(R in M))&&f(M,R,I[R]);else e({target:l,proto:!0,forced:y||_},I);return r&&!O||M[g]===L||f(M,g,L,{name:T}),d[l]=L,I}}function jn(){return bn?wn:(bn=1,wn=function(e,t){return{value:e,done:t}})}function Nn(){if(kn)return Sn;kn=1;var e=he(),t=xn(),r=In(),n=Gt(),i=At().f,o=Bn(),a=jn(),u=et(),s=y(),c="Array Iterator",f=n.set,l=n.getterFor(c);Sn=o(Array,"Array",function(t,r){f(this,{type:c,target:e(t),index:0,kind:r})},function(){var e=l(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,a(void 0,!0);switch(e.kind){case"keys":return a(r,!1);case"values":return a(t[r],!1)}return a([r,t[r]],!1)},"values");var d=r.Arguments=r.Array;if(t("keys"),t("values"),t("entries"),!u&&s&&"values"!==d.name)try{i(d,"name",{value:"values"})}catch(e){}return Sn}Nn();var Dn,Fn,qn,Hn,zn,Wn,Gn,Vn,$n,Jn,Qn,Yn,Kn,Xn,Zn,ei={};function ti(){if(Fn)return Dn;Fn=1;var e=le();return Dn=Array.isArray||function(t){return"Array"===e(t)}}function ri(){if(Hn)return qn;Hn=1;var e={};return e[ut()("toStringTag")]="z",qn="[object z]"===String(e)}function ni(){if(Wn)return zn;Wn=1;var e=ri(),t=me(),r=le(),n=ut()("toStringTag"),i=Object,o="Arguments"===r(function(){return arguments}());return zn=e?r:function(e){var a,u,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(u=function(e,t){try{return e[t]}catch(e){}}(a=i(e),n))?u:o?r(a):"Object"===(s=r(a))&&t(a.callee)?"Arguments":s}}function ii(){if(Vn)return Gn;Vn=1;var e=fe(),t=m(),r=me(),n=ni(),i=ge(),o=Ht(),a=function(){},u=i("Reflect","construct"),s=/^\s*(?:class|function)\b/,c=e(s.exec),f=!s.test(a),l=function(e){if(!r(e))return!1;try{return u(a,[],e),!0}catch(e){return!1}},d=function(e){if(!r(e))return!1;switch(n(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!c(s,o(e))}catch(e){return!0}};return d.sham=!0,Gn=!u||t(function(){var e;return l(l.call)||!l(Object)||!l(function(){e=!0})||e})?d:l}function oi(){if(Jn)return $n;Jn=1;var e=y(),t=At(),r=ce();return $n=function(n,i,o){e?t.f(n,i,r(0,o)):n[i]=o}}function ai(){if(Yn)return Qn;Yn=1;var e=m(),t=ut(),r=Se(),n=t("species");return Qn=function(t){return r>=51||!e(function(){var e=[];return(e.constructor={})[n]=function(){return{foo:1}},1!==e[t](Boolean).foo})}}function ui(){if(Xn)return Kn;Xn=1;var e=fe();return Kn=e([].slice)}!function(){if(Zn)return ei;Zn=1;var e=Nr(),t=ti(),r=ii(),n=ye(),i=pr(),o=hr(),a=he(),u=oi(),s=ut(),c=ai(),f=ui(),l=c("slice"),d=s("species"),p=Array,v=Math.max;e({target:"Array",proto:!0,forced:!l},{slice:function(e,s){var c,l,h,m=a(this),y=o(m),g=i(e,y),w=i(void 0===s?y:s,y);if(t(m)&&(c=m.constructor,(r(c)&&(c===p||t(c.prototype))||n(c)&&null===(c=c[d]))&&(c=void 0),c===p||void 0===c))return f(m,g,w);for(l=new(void 0===c?p:c)(v(w-g,0)),h=0;g<w;g++,h++)g in m&&u(l,h,m[g]);return l.length=h,l}})}();var si,ci,fi,li,di,pi,vi,hi,mi,yi,gi,wi={};function bi(){if(li)return fi;li=1;var e=TypeError;return fi=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}}function Si(){if(pi)return di;pi=1;var e=ti(),t=ii(),r=ye(),n=ut()("species"),i=Array;return di=function(o){var a;return e(o)&&(a=o.constructor,(t(a)&&(a===i||e(a.prototype))||r(a)&&null===(a=a[n]))&&(a=void 0)),void 0===a?i:a}}function ki(){if(hi)return vi;hi=1;var e=Si();return vi=function(t,r){return new(e(t))(0===r?0:r)}}function Ai(){if(yi)return mi;yi=1;var e=Ee(),t=TypeError;return mi=function(r,n){if(!delete r[n])throw new t("Cannot delete property "+e(n)+" of "+e(r))}}!function(){if(gi)return wi;gi=1;var e=Nr(),t=it(),r=pr(),n=dr(),i=hr(),o=function(){if(ci)return si;ci=1;var e=y(),t=ti(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=e&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();return si=i?function(e,i){if(t(e)&&!n(e,"length").writable)throw new r("Cannot set read only .length");return e.length=i}:function(e,t){return e.length=t}}(),a=bi(),u=ki(),s=oi(),c=Ai(),f=ai()("splice"),l=Math.max,d=Math.min;e({target:"Array",proto:!0,forced:!f},{splice:function(e,f){var p,v,h,m,y,g,w=t(this),b=i(w),S=r(e,b),k=arguments.length;for(0===k?p=v=0:1===k?(p=0,v=b-S):(p=k-2,v=d(l(n(f),0),b-S)),a(b+p-v),h=u(w,v),m=0;m<v;m++)(y=S+m)in w&&s(h,m,w[y]);if(h.length=v,p<v){for(m=S;m<b-v;m++)g=m+p,(y=m+v)in w?w[g]=w[y]:c(w,g);for(m=b;m>b-v+p;m--)c(w,m-1)}else if(p>v)for(m=b-v;m>S;m--)g=m+p-1,(y=m+v-1)in w?w[g]=w[y]:c(w,g);for(m=0;m<p;m++)w[m+S]=arguments[m+2];return o(w,b-v+p),h}})}();var Ti,Ei,Oi,xi={};!function(){if(Oi)return xi;Oi=1;var e=ri(),t=$t(),r=function(){if(Ei)return Ti;Ei=1;var e=ri(),t=ni();return Ti=e?{}.toString:function(){return"[object "+t(this)+"]"}}();e||t(Object.prototype,"toString",r,{unsafe:!0})}();var Ii,Ri,Ci,Pi,_i,Mi,Ui,Li,Bi,ji,Ni,Di,Fi,qi,Hi,zi,Wi,Gi,Vi,$i,Ji,Qi,Yi,Ki,Xi,Zi,eo,to,ro,no,io,oo,ao,uo,so,co,fo,lo,po={exports:{}},vo={};function ho(){if(Ii)return vo;Ii=1;var e=le(),t=he(),r=wr().f,n=ui(),i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];return vo.f=function(o){return i&&"Window"===e(o)?function(e){try{return r(e)}catch(e){return n(i)}}(o):r(t(o))},vo}function mo(){if(_i)return Pi;_i=1;var e=m(),t=ye(),r=le(),n=function(){if(Ci)return Ri;Ci=1;var e=m();return Ri=e(function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})}(),i=Object.isExtensible,o=e(function(){});return Pi=o||n?function(e){return!!t(e)&&((!n||"ArrayBuffer"!==r(e))&&(!i||i(e)))}:i}function yo(){if(Li)return po.exports;Li=1;var e=Nr(),t=fe(),r=Wt(),n=ye(),i=ot(),o=At().f,a=wr(),u=ho(),s=mo(),c=at(),f=function(){if(Ui)return Mi;Ui=1;var e=m();return Mi=!e(function(){return Object.isExtensible(Object.preventExtensions({}))})}(),l=!1,d=c("meta"),p=0,v=function(e){o(e,d,{value:{objectID:"O"+p++,weakData:{}}})},h=po.exports={enable:function(){h.enable=function(){},l=!0;var r=a.f,n=t([].splice),i={};i[d]=1,r(i).length&&(a.f=function(e){for(var t=r(e),i=0,o=t.length;i<o;i++)if(t[i]===d){n(t,i,1);break}return t},e({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,d)){if(!s(e))return"F";if(!t)return"E";v(e)}return e[d].objectID},getWeakData:function(e,t){if(!i(e,d)){if(!s(e))return!0;if(!t)return!1;v(e)}return e[d].weakData},onFreeze:function(e){return f&&l&&s(e)&&!i(e,d)&&v(e),e}};return r[d]=!0,po.exports}function go(){if(ji)return Bi;ji=1;var e=Dr(),t=Oe(),r=g(),n=e(e.bind);return Bi=function(e,i){return t(e),void 0===i?e:r?n(e,i):function(){return e.apply(i,arguments)}},Bi}function wo(){if(Di)return Ni;Di=1;var e=ut(),t=In(),r=e("iterator"),n=Array.prototype;return Ni=function(e){return void 0!==e&&(t.Array===e||n[r]===e)}}function bo(){if(qi)return Fi;qi=1;var e=ni(),t=xe(),r=pe(),n=In(),i=ut()("iterator");return Fi=function(o){if(!r(o))return t(o,i)||t(o,"@@iterator")||n[e(o)]}}function So(){if(zi)return Hi;zi=1;var e=w(),t=Oe(),r=kt(),n=Ee(),i=bo(),o=TypeError;return Hi=function(a,u){var s=arguments.length<2?i(a):u;if(t(s))return r(e(s,a));throw new o(n(a)+" is not iterable")},Hi}function ko(){if(Gi)return Wi;Gi=1;var e=w(),t=kt(),r=xe();return Wi=function(n,i,o){var a,u;t(n);try{if(!(a=r(n,"return"))){if("throw"===i)throw o;return o}a=e(a,n)}catch(e){u=!0,a=e}if("throw"===i)throw o;if(u)throw a;return t(a),o}}function Ao(){if($i)return Vi;$i=1;var e=go(),t=w(),r=kt(),n=Ee(),i=wo(),o=hr(),a=we(),u=So(),s=bo(),c=ko(),f=TypeError,l=function(e,t){this.stopped=e,this.result=t},d=l.prototype;return Vi=function(p,v,h){var m,y,g,w,b,S,k,A=h&&h.that,T=!(!h||!h.AS_ENTRIES),E=!(!h||!h.IS_RECORD),O=!(!h||!h.IS_ITERATOR),x=!(!h||!h.INTERRUPTED),I=e(v,A),R=function(e){return m&&c(m,"normal"),new l(!0,e)},C=function(e){return T?(r(e),x?I(e[0],e[1],R):I(e[0],e[1])):x?I(e,R):I(e)};if(E)m=p.iterator;else if(O)m=p;else{if(!(y=s(p)))throw new f(n(p)+" is not iterable");if(i(y)){for(g=0,w=o(p);w>g;g++)if((b=C(p[g]))&&a(d,b))return b;return new l(!1)}m=u(p,y)}for(S=E?p.next:m.next;!(k=t(S,m)).done;){try{b=C(k.value)}catch(e){c(m,"throw",e)}if("object"==typeof b&&b&&a(d,b))return b}return new l(!1)}}function To(){if(Qi)return Ji;Qi=1;var e=we(),t=TypeError;return Ji=function(r,n){if(e(n,r))return r;throw new t("Incorrect invocation")}}function Eo(){if(Ki)return Yi;Ki=1;var e=ut()("iterator"),t=!1;try{var r=0,n={next:function(){return{done:!!r++}},return:function(){t=!0}};n[e]=function(){return this},Array.from(n,function(){throw 2})}catch(e){}return Yi=function(r,n){try{if(!n&&!t)return!1}catch(e){return!1}var i=!1;try{var o={};o[e]=function(){return{next:function(){return{done:i=!0}}}},r(o)}catch(e){}return i}}function Oo(){if(Zi)return Xi;Zi=1;var e=me(),t=ye(),r=Ln();return Xi=function(n,i,o){var a,u;return r&&e(a=i.constructor)&&a!==o&&t(u=a.prototype)&&u!==o.prototype&&r(n,u),n}}function xo(){if(to)return eo;to=1;var e=Nr(),t=a(),r=fe(),n=jr(),i=$t(),o=yo(),u=Ao(),s=To(),c=me(),f=pe(),l=ye(),d=m(),p=Eo(),v=Pn(),h=Oo();return eo=function(a,m,y){var g=-1!==a.indexOf("Map"),w=-1!==a.indexOf("Weak"),b=g?"set":"add",S=t[a],k=S&&S.prototype,A=S,T={},E=function(e){var t=r(k[e]);i(k,e,"add"===e?function(e){return t(this,0===e?0:e),this}:"delete"===e?function(e){return!(w&&!l(e))&&t(this,0===e?0:e)}:"get"===e?function(e){return w&&!l(e)?void 0:t(this,0===e?0:e)}:"has"===e?function(e){return!(w&&!l(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(n(a,!c(S)||!(w||k.forEach&&!d(function(){(new S).entries().next()}))))A=y.getConstructor(m,a,g,b),o.enable();else if(n(a,!0)){var O=new A,x=O[b](w?{}:-0,1)!==O,I=d(function(){O.has(1)}),R=p(function(e){new S(e)}),C=!w&&d(function(){for(var e=new S,t=5;t--;)e[b](t,t);return!e.has(-0)});R||((A=m(function(e,t){s(e,k);var r=h(new S,e,A);return f(t)||u(t,r[b],{that:r,AS_ENTRIES:g}),r})).prototype=k,k.constructor=A),(I||C)&&(E("delete"),E("has"),g&&E("get")),(C||x)&&E(b),w&&k.clear&&delete k.clear}return T[a]=A,e({global:!0,constructor:!0,forced:A!==S},T),v(A,a),w||y.setStrong(A,a,g),A}}function Io(){if(no)return ro;no=1;var e=Vt(),t=At();return ro=function(r,n,i){return i.get&&e(i.get,n,{getter:!0}),i.set&&e(i.set,n,{setter:!0}),t.f(r,n,i)}}function Ro(){if(oo)return io;oo=1;var e=$t();return io=function(t,r,n){for(var i in r)e(t,i,r[i],n);return t}}function Co(){if(uo)return ao;uo=1;var e=ge(),t=Io(),r=ut(),n=y(),i=r("species");return ao=function(r){var o=e(r);n&&o&&!o[i]&&t(o,i,{configurable:!0,get:function(){return this}})}}function Po(){if(co)return so;co=1;var e=On(),t=Io(),r=Ro(),n=go(),i=To(),o=pe(),a=Ao(),u=Bn(),s=jn(),c=Co(),f=y(),l=yo().fastKey,d=Gt(),p=d.set,v=d.getterFor;return so={getConstructor:function(u,s,c,d){var h=u(function(t,r){i(t,m),p(t,{type:s,index:e(null),first:null,last:null,size:0}),f||(t.size=0),o(r)||a(r,t[d],{that:t,AS_ENTRIES:c})}),m=h.prototype,y=v(s),g=function(e,t,r){var n,i,o=y(e),a=w(e,t);return a?a.value=r:(o.last=a={index:i=l(t,!0),key:t,value:r,previous:n=o.last,next:null,removed:!1},o.first||(o.first=a),n&&(n.next=a),f?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},w=function(e,t){var r,n=y(e),i=l(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key===t)return r};return r(m,{clear:function(){for(var t=y(this),r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=null),r=r.next;t.first=t.last=null,t.index=e(null),f?t.size=0:this.size=0},delete:function(e){var t=this,r=y(t),n=w(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first===n&&(r.first=i),r.last===n&&(r.last=o),f?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=y(this),i=n(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!w(this,e)}}),r(m,c?{get:function(e){var t=w(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),f&&t(m,"size",{configurable:!0,get:function(){return y(this).size}}),h},setStrong:function(e,t,r){var n=t+" Iterator",i=v(t),o=v(n);u(e,t,function(e,t){p(this,{type:n,target:e,state:i(e),kind:t,last:null})},function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?s("keys"===t?r.key:"values"===t?r.value:[r.key,r.value],!1):(e.target=null,s(void 0,!0))},r?"entries":"values",!r,!0),c(t)}},so}lo||(lo=1,fo||(fo=1,xo()("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Po())));var _o,Mo,Uo,Lo,Bo,jo={};function No(){if(Mo)return _o;Mo=1;var e=ni(),t=String;return _o=function(r){if("Symbol"===e(r))throw new TypeError("Cannot convert a Symbol value to a string");return t(r)}}function Do(){if(Lo)return Uo;Lo=1;var e=fe(),t=dr(),r=No(),n=ve(),i=e("".charAt),o=e("".charCodeAt),a=e("".slice),u=function(e){return function(u,s){var c,f,l=r(n(u)),d=t(s),p=l.length;return d<0||d>=p?e?"":void 0:(c=o(l,d))<55296||c>56319||d+1===p||(f=o(l,d+1))<56320||f>57343?e?i(l,d):c:e?a(l,d,d+2):f-56320+(c-55296<<10)+65536}};return Uo={codeAt:u(!1),charAt:u(!0)}}function Fo(){if(Bo)return jo;Bo=1;var e=Do().charAt,t=No(),r=Gt(),n=Bn(),i=jn(),o="String Iterator",a=r.set,u=r.getterFor(o);return n(String,"String",function(e){a(this,{type:o,string:t(e),index:0})},function(){var t,r=u(this),n=r.string,o=r.index;return o>=n.length?i(void 0,!0):(t=e(n,o),r.index+=t.length,i(t,!1))}),jo}Fo();var qo,Ho,zo={};Ho||(Ho=1,function(){if(qo)return zo;qo=1;var e=Nr(),t=a();e({global:!0,forced:t.globalThis!==t},{globalThis:t})}());var Wo,Go,Vo,$o,Jo,Qo,Yo,Ko,Xo,Zo={};function ea(){return Go?Wo:(Go=1,Wo={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})}function ta(){if($o)return Vo;$o=1;var e=ft()("span").classList,t=e&&e.constructor&&e.constructor.prototype;return Vo=t===Object.prototype?void 0:t}function ra(){if(Qo)return Jo;Qo=1;var e=go(),t=fe(),r=de(),n=it(),i=hr(),o=ki(),a=t([].push),u=function(t){var u=1===t,s=2===t,c=3===t,f=4===t,l=6===t,d=7===t,p=5===t||l;return function(v,h,m,y){for(var g,w,b=n(v),S=r(b),k=i(S),A=e(h,m),T=0,E=y||o,O=u?E(v,k):s||d?E(v,0):void 0;k>T;T++)if((p||T in S)&&(w=A(g=S[T],T,b),t))if(u)O[T]=w;else if(w)switch(t){case 3:return!0;case 5:return g;case 6:return T;case 2:a(O,g)}else switch(t){case 4:return!1;case 7:a(O,g)}return l?-1:c||f?f:O}};return Jo={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}}!function(){if(Xo)return Zo;Xo=1;var e=a(),t=ea(),r=ta(),n=function(){if(Ko)return Yo;Ko=1;var e=ra().forEach,t=Fr()("forEach");return Yo=t?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)},Yo}(),i=Tt(),o=function(e){if(e&&e.forEach!==n)try{i(e,"forEach",n)}catch(t){e.forEach=n}};for(var u in t)t[u]&&o(e[u]&&e[u].prototype);o(r)}();var na,ia={};!function(){if(na)return ia;na=1;var e=a(),t=ea(),r=ta(),n=Nn(),i=Tt(),o=Pn(),u=ut()("iterator"),s=n.values,c=function(e,r){if(e){if(e[u]!==s)try{i(e,u,s)}catch(t){e[u]=s}if(o(e,r,!0),t[r])for(var a in n)if(e[a]!==n[a])try{i(e,a,n[a])}catch(t){e[a]=n[a]}}};for(var f in t)c(e[f]&&e[f].prototype,f);c(r,"DOMTokenList")}(),function(e){var t=!(!e.starmusConfig||!e.starmusConfig.debug);function r(){if(t)try{(console.log||function(){}).apply(console,arguments)}catch(e){}}var n="function"==typeof Set,i={},o={};void 0===e.StarmusHooks&&(e.StarmusHooks={}),e.StarmusHooks.subscribe=function(e,t){var r,o;return i[e]||(i[e]=n?new Set:[]),r=i[e],o=t,n?r.add(o):-1===r.indexOf(o)&&r.push(o),function(){i[e]&&function(e,t){if(n)e.delete(t);else{var r=e.indexOf(t);-1!==r&&e.splice(r,1)}}(i[e],t)}},e.StarmusHooks.dispatch=function(e,t,a){t=t||{};var u=e+"::"+((a=a||{}).instanceId||"");if(o[u])r("Prevented recursive dispatch:",e);else{o[u]=!0;try{var s=i[e];if(!s)return;!function(e,t){if(n)e.forEach(t);else for(var r=e.slice(),i=0;i<r.length;i++)t(r[i])}(s,function(r){try{r(t,a)}catch(t){console.error("Error executing handler for command "+e+":",t)}})}finally{delete o[u]}}},e.StarmusHooks.debugLog=r}("undefined"!=typeof window?window:globalThis);var oa="undefined"!=typeof window?window:globalThis,aa=oa.StarmusHooks&&oa.StarmusHooks.debugLog||function(){},ua=oa.StarmusHooks&&oa.StarmusHooks.dispatch||function(){},sa=oa.StarmusHooks&&oa.StarmusHooks.subscribe||function(){};"undefined"!=typeof module&&module.exports&&(module.exports={debugLog:aa,subscribe:oa.StarmusHooks.subscribe,dispatch:oa.StarmusHooks.dispatch});var ca,fa={subscribe:sa,dispatch:ua,unsubscribeInstance:function(e){}},la={};function da(e){return window.StarmusStore.createStore(e)}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function va(e,t,r,n,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,i)}function ha(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){va(o,n,i,a,u,"next",e)}function u(e){va(o,n,i,a,u,"throw",e)}a(void 0)})}}function ma(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ya(e,t,r){return t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oa(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ia(e))||t){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function wa(e,t,r){return(t=Oa(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ba(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Sa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ba(Object(r),!0).forEach(function(t){wa(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ba(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ka(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var s=n&&n.prototype instanceof u?n:u,c=Object.create(s.prototype);return Aa(c,"_invoke",function(r,n,i){var o,u,s,c=0,f=i||[],l=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,u=0,s=e,d.n=r,a}};function p(r,n){for(u=r,s=n,t=0;!l&&c&&!i&&t<f.length;t++){var i,o=f[t],p=d.p,v=o[2];r>3?(i=v===n)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=r<2&&p<o[1])?(u=0,d.v=n,d.n=o[1]):p<v&&(i=r<3||o[0]>n||n>v)&&(o[4]=r,o[5]=n,d.n=v,u=0))}if(i||r>1)return a;throw l=!0,n}return function(i,f,v){if(c>1)throw TypeError("Generator is already running");for(l&&1===f&&p(f,v),u=f,s=v;(t=u<2?e:s)||!l;){o||(u?u<3?(u>1&&(d.n=-1),p(u,s)):d.n=s:d.v=s);try{if(c=2,o){if(u||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),u=1);o=e}else if((t=(l=d.n<0)?s:r.call(n,d))!==a)break}catch(t){o=e,u=1,s=t}finally{c=1}}return{value:t,done:l}}}(r,i,o),!0),c}var a={};function u(){}function s(){}function c(){}t=Object.getPrototypeOf;var f=[][n]?t(t([][n]())):(Aa(t={},n,function(){return this}),t),l=c.prototype=u.prototype=Object.create(f);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Aa(e,i,"GeneratorFunction")),e.prototype=Object.create(l),e}return s.prototype=c,Aa(l,"constructor",c),Aa(c,"constructor",s),s.displayName="GeneratorFunction",Aa(c,i,"GeneratorFunction"),Aa(l),Aa(l,i,"Generator"),Aa(l,n,function(){return this}),Aa(l,"toString",function(){return"[object Generator]"}),(ka=function(){return{w:o,m:d}})()}function Aa(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Aa=function(e,t,r,n){function o(t,r){Aa(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))},Aa(e,t,r,n)}function Ta(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(typeof e+" is not iterable")}function Ea(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,u=[],s=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t);else for(;!(s=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(e,t)||Ia(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oa(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function xa(e){return xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xa(e)}function Ia(e,t){if(e){if("string"==typeof e)return pa(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pa(e,t):void 0}}!function(){if(ca)return la;ca=1;var e=y(),t=qt().EXISTS,r=fe(),n=Io(),i=Function.prototype,o=r(i.toString),a=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=r(a.exec);e&&!t&&n(i,"name",{configurable:!0,get:function(){try{return u(a,o(this))[1]}catch(e){return""}}})}(),function(e){var t={instanceId:null,env:{},tier:null,status:"uninitialized",error:null,source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""},calibration:{phase:null,message:"",volumePercent:0,complete:!1,gain:1},recorder:{duration:0,amplitude:0,isPlaying:!1,isPaused:!1},submission:{progress:0,isQueued:!1}};function r(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function n(e,t){var n=r(e);for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function i(e){var i=n(t,e||{}),o=[];return{getState:function(){return i},dispatch:function(e){i=function(e,i){if(!i||!i.type)return e;switch(!e.instanceId&&i.payload&&i.payload.instanceId&&(e=n(e,{instanceId:i.payload.instanceId})),i.type){case"starmus/tier-ready":return e.tier?e:n(e,{tier:i.payload&&i.payload.tier?i.payload.tier:e.tier});case"starmus/init":return n(e,n(i.payload||{},{status:"idle",error:null}));case"starmus/ui/step-continue":return n(e,{status:"ready_to_record",error:null});case"starmus/calibration-start":return n(e,{status:"calibrating"});case"starmus/calibration-update":return n(e,{calibration:n(e.calibration,{message:i.message,volumePercent:i.volumePercent})});case"starmus/calibration-complete":return n(e,{status:"ready",calibration:n(e.calibration,n(i.calibration||{},{complete:!0}))});case"starmus/mic-start":return n(e,{status:"recording",error:null,recorder:n(e.recorder,{duration:0,amplitude:0,isPaused:!1})});case"starmus/mic-pause":return n(e,{status:"paused",recorder:n(e.recorder,{isPaused:!0})});case"starmus/mic-resume":return n(e,{status:"recording",recorder:n(e.recorder,{isPaused:!1})});case"starmus/mic-stop":return n(e,{status:"processing"});case"starmus/recorder-tick":return n(e,{recorder:n(e.recorder,{duration:i.duration,amplitude:i.amplitude})});case"starmus/recording-available":return n(e,{status:"ready_to_submit",source:n(e.source,{kind:"blob",blob:i.payload.blob,fileName:i.payload.fileName})});case"starmus/recorder-playback-state":return n(e,{recorder:n(e.recorder,{isPlaying:i.isPlaying})});case"starmus/transcript-update":return n(e,{source:n(e.source,{transcript:i.transcript})});case"starmus/transcript-interim":return n(e,{source:n(e.source,{interimTranscript:i.interim})});case"starmus/env-update":return n(e,{env:n(e.env,i.payload||{}),tier:i.tier||e.tier});case"starmus/file-attached":return n(e,{status:"ready_to_submit",source:{kind:"file",file:i.file,fileName:i.file.name}});case"starmus/submit-start":return n(e,{status:"submitting",error:null});case"starmus/submit-progress":return n(e,{submission:n(e.submission,{progress:i.progress})});case"starmus/submit-complete":return n(e,{status:"complete",submission:{progress:1,isQueued:!1}});case"starmus/submit-queued":return n(e,{status:"complete",submission:{progress:0,isQueued:!0}});case"starmus/error":return n(e,{error:i.error||i.payload});case"starmus/reset":return n(r(t),{instanceId:e.instanceId,env:e.env,tier:e.tier,status:"idle",source:{kind:null,blob:null,file:null,fileName:"",transcript:"",interimTranscript:""}});default:return e}}(i,e);for(var a=0;a<o.length;a++)try{o[a](i)}catch(e){console.error(e)}},subscribe:function(e){return-1===o.indexOf(e)&&o.push(e),function(){var t=o.indexOf(e);-1!==t&&o.splice(t,1)}}}}e.StarmusStore=e.StarmusStore||{},e.StarmusStore.createStore=i,"undefined"!=typeof module&&module.exports&&(module.exports={createStore:i}),"undefined"!=typeof exports&&(exports.createStore=i)}("undefined"!=typeof window?window:globalThis);var Ra,Ca={};!function(){if(Ra)return Ca;Ra=1;var e=Nr(),t=m(),r=ti(),n=ye(),i=it(),o=hr(),a=bi(),u=oi(),s=ki(),c=ai(),f=ut(),l=Se(),d=f("isConcatSpreadable"),p=l>=51||!t(function(){var e=[];return e[d]=!1,e.concat()[0]!==e}),v=function(e){if(!n(e))return!1;var t=e[d];return void 0!==t?!!t:r(e)};e({target:"Array",proto:!0,arity:1,forced:!p||!c("concat")},{concat:function(e){var t,r,n,c,f,l=i(this),d=s(l,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(v(f=-1===t?l:arguments[t]))for(c=o(f),a(p+c),r=0;r<c;r++,p++)r in f&&u(d,p,f[r]);else a(p+1),u(d,p++,f);return d.length=p,d}})}();var Pa,_a={};!function(){if(Pa)return _a;Pa=1;var e=Nr(),t=fe(),r=de(),n=he(),i=Fr(),o=t([].join);e({target:"Array",proto:!0,forced:r!==Object||!i("join",",")},{join:function(e){return o(n(this),void 0===e?",":e)}})}();var Ma,Ua,La,Ba,ja,Na,Da,Fa={};function qa(){if(Ua)return Ma;Ua=1;var e=Oe(),t=it(),r=de(),n=hr(),i=TypeError,o="Reduce of empty array with no initial value",a=function(a){return function(u,s,c,f){var l=t(u),d=r(l),p=n(l);if(e(s),0===p&&c<2)throw new i(o);var v=a?p-1:0,h=a?-1:1;if(c<2)for(;;){if(v in d){f=d[v],v+=h;break}if(v+=h,a?v<0:p<=v)throw new i(o)}for(;a?v>=0:p>v;v+=h)v in d&&(f=s(f,d[v],v,l));return f}};return Ma={left:a(!1),right:a(!0)}}function Ha(){if(Ba)return La;Ba=1;var e=a(),t=be(),r=le(),n=function(e){return t.slice(0,e.length)===e};return La=n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":e.Bun&&"string"==typeof Bun.version?"BUN":e.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(e.process)?"NODE":e.window&&e.document?"BROWSER":"REST"}function za(){if(Na)return ja;Na=1;var e=Ha();return ja="NODE"===e}!function(){if(Da)return Fa;Da=1;var e=Nr(),t=qa().left,r=Fr(),n=Se();e({target:"Array",proto:!0,forced:!za()&&n>79&&n<83||!r("reduce")},{reduce:function(e){var r=arguments.length;return t(this,e,r,r>1?arguments[1]:void 0)}})}();var Wa,Ga,Va,$a={};!function(){if(Va)return $a;Va=1;var e=Nr(),t=function(){if(Ga)return Wa;Ga=1;var e=y(),t=m(),r=fe(),n=Rn(),i=Tn(),o=he(),a=r(se().f),u=r([].push),s=e&&t(function(){var e=Object.create(null);return e[2]=2,!a(e,2)}),c=function(t){return function(r){for(var c,f=o(r),l=i(f),d=s&&null===n(f),p=l.length,v=0,h=[];p>v;)c=l[v++],e&&!(d?c in f:a(f,c))||u(h,t?[c,f[c]]:f[c]);return h}};return Wa={entries:c(!0),values:c(!1)}}().entries;e({target:"Object",stat:!0},{entries:function(e){return t(e)}})}();var Ja,Qa={};!function(){if(Ja)return Qa;Ja=1;var e=Nr(),t=it(),r=Tn();e({target:"Object",stat:!0,forced:m()(function(){r(1)})},{keys:function(e){return r(t(e))}})}();var Ya,Ka,Xa,Za,eu,tu,ru,nu,iu,ou,au,uu,su,cu,fu,lu,du,pu,vu,hu,mu,yu,gu,wu,bu,Su,ku,Au,Tu,Eu,Ou,xu,Iu={};function Ru(){if(Ka)return Ya;Ka=1;var e=a();return Ya=e}function Cu(){if(Za)return Xa;Za=1;var e=ii(),t=Ee(),r=TypeError;return Xa=function(n){if(e(n))return n;throw new r(t(n)+" is not a constructor")}}function Pu(){if(tu)return eu;tu=1;var e=kt(),t=Cu(),r=pe(),n=ut()("species");return eu=function(i,o){var a,u=e(i).constructor;return void 0===u||r(a=e(u)[n])?o:t(a)}}function _u(){if(nu)return ru;nu=1;var e=g(),t=Function.prototype,r=t.apply,n=t.call;return ru="object"==typeof Reflect&&Reflect.apply||(e?n.bind(r):function(){return n.apply(r,arguments)}),ru}function Mu(){if(ou)return iu;ou=1;var e=TypeError;return iu=function(t,r){if(t<r)throw new e("Not enough arguments");return t}}function Uu(){if(uu)return au;uu=1;var e=be();return au=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)}function Lu(){if(cu)return su;cu=1;var e,t,r,n,i=a(),o=_u(),u=go(),s=me(),c=ot(),f=m(),l=En(),d=ui(),p=ft(),v=Mu(),h=Uu(),y=za(),g=i.setImmediate,w=i.clearImmediate,b=i.process,S=i.Dispatch,k=i.Function,A=i.MessageChannel,T=i.String,E=0,O={},x="onreadystatechange";f(function(){e=i.location});var I=function(e){if(c(O,e)){var t=O[e];delete O[e],t()}},R=function(e){return function(){I(e)}},C=function(e){I(e.data)},P=function(t){i.postMessage(T(t),e.protocol+"//"+e.host)};return g&&w||(g=function(e){v(arguments.length,1);var r=s(e)?e:k(e),n=d(arguments,1);return O[++E]=function(){o(r,void 0,n)},t(E),E},w=function(e){delete O[e]},y?t=function(e){b.nextTick(R(e))}:S&&S.now?t=function(e){S.now(R(e))}:A&&!h?(n=(r=new A).port2,r.port1.onmessage=C,t=u(n.postMessage,n)):i.addEventListener&&s(i.postMessage)&&!i.importScripts&&e&&"file:"!==e.protocol&&!f(P)?(t=P,i.addEventListener("message",C,!1)):t=x in p("script")?function(e){l.appendChild(p("script"))[x]=function(){l.removeChild(this),I(e)}}:function(e){setTimeout(R(e),0)}),su={set:g,clear:w}}function Bu(){if(lu)return fu;lu=1;var e=a(),t=y(),r=Object.getOwnPropertyDescriptor;return fu=function(n){if(!t)return e[n];var i=r(e,n);return i&&i.value}}function ju(){if(pu)return du;pu=1;var e=function(){this.head=null,this.tail=null};return e.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},du=e}function Nu(){if(wu)return gu;wu=1;var e,t,r,n,i,o=a(),u=Bu(),s=go(),c=Lu().set,f=ju(),l=Uu(),d=function(){if(hu)return vu;hu=1;var e=be();return vu=/ipad|iphone|ipod/i.test(e)&&"undefined"!=typeof Pebble}(),p=function(){if(yu)return mu;yu=1;var e=be();return mu=/web0s(?!.*chrome)/i.test(e)}(),v=za(),h=o.MutationObserver||o.WebKitMutationObserver,m=o.document,y=o.process,g=o.Promise,w=u("queueMicrotask");if(!w){var b=new f,S=function(){var t,r;for(v&&(t=y.domain)&&t.exit();r=b.get();)try{r()}catch(t){throw b.head&&e(),t}t&&t.enter()};l||v||p||!h||!m?!d&&g&&g.resolve?((n=g.resolve(void 0)).constructor=g,i=s(n.then,n),e=function(){i(S)}):v?e=function(){y.nextTick(S)}:(c=s(c,o),e=function(){c(S)}):(t=!0,r=m.createTextNode(""),new h(S).observe(r,{characterData:!0}),e=function(){r.data=t=!t}),w=function(t){b.head||e(),b.add(t)}}return gu=w}function Du(){return Su||(Su=1,bu=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(e){}}),bu}function Fu(){return Au?ku:(Au=1,ku=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}})}function qu(){if(Eu)return Tu;Eu=1;var e=a();return Tu=e.Promise}function Hu(){if(xu)return Ou;xu=1;var e=a(),t=qu(),r=me(),n=jr(),i=Ht(),o=ut(),u=Ha(),s=et(),c=Se(),f=t&&t.prototype,l=o("species"),d=!1,p=r(e.PromiseRejectionEvent),v=n("Promise",function(){var e=i(t),r=e!==String(t);if(!r&&66===c)return!0;if(s&&(!f.catch||!f.finally))return!0;if(!c||c<51||!/native code/.test(e)){var n=new t(function(e){e(1)}),o=function(e){e(function(){},function(){})};if((n.constructor={})[l]=o,!(d=n.then(function(){})instanceof o))return!0}return!(r||"BROWSER"!==u&&"DENO"!==u||p)});return Ou={CONSTRUCTOR:v,REJECTION_EVENT:p,SUBCLASSING:d}}var zu,Wu,Gu={};function Vu(){if(zu)return Gu;zu=1;var e=Oe(),t=TypeError,r=function(r){var n,i;this.promise=new r(function(e,r){if(void 0!==n||void 0!==i)throw new t("Bad Promise constructor");n=e,i=r}),this.resolve=e(n),this.reject=e(i)};return Gu.f=function(e){return new r(e)},Gu}var $u,Ju,Qu,Yu={};function Ku(){if(Ju)return $u;Ju=1;var e=qu(),t=Eo(),r=Hu().CONSTRUCTOR;return $u=r||!t(function(t){e.all(t).then(void 0,function(){})})}var Xu,Zu={};var es,ts={};var rs,ns={};var is,os,as,us,ss={};function cs(){if(os)return is;os=1;var e=kt(),t=ye(),r=Vu();return is=function(n,i){if(e(n),t(i)&&i.constructor===n)return i;var o=r.f(n);return(0,o.resolve)(i),o.promise}}us||(us=1,function(){if(Wu)return Iu;Wu=1;var e,t,r,n,i=Nr(),o=et(),u=za(),s=a(),c=Ru(),f=w(),l=$t(),d=Ln(),p=Pn(),v=Co(),h=Oe(),m=me(),y=ye(),g=To(),b=Pu(),S=Lu().set,k=Nu(),A=Du(),T=Fu(),E=ju(),O=Gt(),x=qu(),I=Hu(),R=Vu(),C="Promise",P=I.CONSTRUCTOR,_=I.REJECTION_EVENT,M=I.SUBCLASSING,U=O.getterFor(C),L=O.set,B=x&&x.prototype,j=x,N=B,D=s.TypeError,F=s.document,q=s.process,H=R.f,z=H,W=!!(F&&F.createEvent&&s.dispatchEvent),G="unhandledrejection",V=function(e){var t;return!(!y(e)||!m(t=e.then))&&t},$=function(e,t){var r,n,i,o=t.value,a=1===t.state,u=a?e.ok:e.fail,s=e.resolve,c=e.reject,l=e.domain;try{u?(a||(2===t.rejection&&X(t),t.rejection=1),!0===u?r=o:(l&&l.enter(),r=u(o),l&&(l.exit(),i=!0)),r===e.promise?c(new D("Promise-chain cycle")):(n=V(r))?f(n,r,s,c):s(r)):c(o)}catch(e){l&&!i&&l.exit(),c(e)}},J=function(e,t){e.notified||(e.notified=!0,k(function(){for(var r,n=e.reactions;r=n.get();)$(r,e);e.notified=!1,t&&!e.rejection&&Y(e)}))},Q=function(e,t,r){var n,i;W?((n=F.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),s.dispatchEvent(n)):n={promise:t,reason:r},!_&&(i=s["on"+e])?i(n):e===G&&A("Unhandled promise rejection",r)},Y=function(e){f(S,s,function(){var t,r=e.facade,n=e.value;if(K(e)&&(t=T(function(){u?q.emit("unhandledRejection",n,r):Q(G,r,n)}),e.rejection=u||K(e)?2:1,t.error))throw t.value})},K=function(e){return 1!==e.rejection&&!e.parent},X=function(e){f(S,s,function(){var t=e.facade;u?q.emit("rejectionHandled",t):Q("rejectionhandled",t,e.value)})},Z=function(e,t,r){return function(n){e(t,n,r)}},ee=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,J(e,!0))},te=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new D("Promise can't be resolved itself");var n=V(t);n?k(function(){var r={done:!1};try{f(n,t,Z(te,r,e),Z(ee,r,e))}catch(t){ee(r,t,e)}}):(e.value=t,e.state=1,J(e,!1))}catch(t){ee({done:!1},t,e)}}};if(P&&(N=(j=function(t){g(this,N),h(t),f(e,this);var r=U(this);try{t(Z(te,r),Z(ee,r))}catch(e){ee(r,e)}}).prototype,(e=function(e){L(this,{type:C,done:!1,notified:!1,parent:!1,reactions:new E,rejection:!1,state:0,value:null})}).prototype=l(N,"then",function(e,t){var r=U(this),n=H(b(this,j));return r.parent=!0,n.ok=!m(e)||e,n.fail=m(t)&&t,n.domain=u?q.domain:void 0,0===r.state?r.reactions.add(n):k(function(){$(n,r)}),n.promise}),t=function(){var t=new e,r=U(t);this.promise=t,this.resolve=Z(te,r),this.reject=Z(ee,r)},R.f=H=function(e){return e===j||e===r?new t(e):z(e)},!o&&m(x)&&B!==Object.prototype)){n=B.then,M||l(B,"then",function(e,t){var r=this;return new j(function(e,t){f(n,r,e,t)}).then(e,t)},{unsafe:!0});try{delete B.constructor}catch(e){}d&&d(B,N)}i({global:!0,constructor:!0,wrap:!0,forced:P},{Promise:j}),r=c.Promise,p(j,C,!1,!0),v(C)}(),function(){if(Qu)return Yu;Qu=1;var e=Nr(),t=w(),r=Oe(),n=Vu(),i=Fu(),o=Ao();e({target:"Promise",stat:!0,forced:Ku()},{all:function(e){var a=this,u=n.f(a),s=u.resolve,c=u.reject,f=i(function(){var n=r(a.resolve),i=[],u=0,f=1;o(e,function(e){var r=u++,o=!1;f++,t(n,a,e).then(function(e){o||(o=!0,i[r]=e,--f||s(i))},c)}),--f||s(i)});return f.error&&c(f.value),u.promise}})}(),function(){if(Xu)return Zu;Xu=1;var e=Nr(),t=et(),r=Hu().CONSTRUCTOR,n=qu(),i=ge(),o=me(),a=$t(),u=n&&n.prototype;if(e({target:"Promise",proto:!0,forced:r,real:!0},{catch:function(e){return this.then(void 0,e)}}),!t&&o(n)){var s=i("Promise").prototype.catch;u.catch!==s&&a(u,"catch",s,{unsafe:!0})}}(),function(){if(es)return ts;es=1;var e=Nr(),t=w(),r=Oe(),n=Vu(),i=Fu(),o=Ao();e({target:"Promise",stat:!0,forced:Ku()},{race:function(e){var a=this,u=n.f(a),s=u.reject,c=i(function(){var n=r(a.resolve);o(e,function(e){t(n,a,e).then(u.resolve,s)})});return c.error&&s(c.value),u.promise}})}(),function(){if(rs)return ns;rs=1;var e=Nr(),t=Vu();e({target:"Promise",stat:!0,forced:Hu().CONSTRUCTOR},{reject:function(e){var r=t.f(this);return(0,r.reject)(e),r.promise}})}(),function(){if(as)return ss;as=1;var e=Nr(),t=ge(),r=et(),n=qu(),i=Hu().CONSTRUCTOR,o=cs(),a=t("Promise"),u=r&&!i;e({target:"Promise",stat:!0,forced:r||i},{resolve:function(e){return o(u&&this===a?n:this,e)}})}());var fs,ls={};!function(){if(fs)return ls;fs=1;var e=Nr(),t=et(),r=qu(),n=m(),i=ge(),o=me(),a=Pu(),u=cs(),s=$t(),c=r&&r.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!r&&n(function(){c.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=a(this,i("Promise")),r=o(e);return this.then(r?function(r){return u(t,e()).then(function(){return r})}:e,r?function(r){return u(t,e()).then(function(){throw r})}:e)}}),!t&&o(r)){var f=i("Promise").prototype.finally;c.finally!==f&&s(c,"finally",f,{unsafe:!0})}}();var ds,ps,vs,hs,ms,ys,gs,ws,bs,Ss,ks,As={};function Ts(){if(ps)return ds;ps=1;var e=kt();return ds=function(){var t=e(this),r="";return t.hasIndices&&(r+="d"),t.global&&(r+="g"),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),t.dotAll&&(r+="s"),t.unicode&&(r+="u"),t.unicodeSets&&(r+="v"),t.sticky&&(r+="y"),r}}function Es(){if(Ss)return bs;Ss=1;var e,t,r=w(),n=fe(),i=No(),o=Ts(),u=function(){if(hs)return vs;hs=1;var e=m(),t=a().RegExp,r=e(function(){var e=t("a","y");return e.lastIndex=2,null!==e.exec("abcd")}),n=r||e(function(){return!t("a","y").sticky}),i=r||e(function(){var e=t("^r","gy");return e.lastIndex=2,null!==e.exec("str")});return vs={BROKEN_CARET:i,MISSED_STICKY:n,UNSUPPORTED_Y:r}}(),s=nt(),c=On(),f=Gt().get,l=function(){if(ys)return ms;ys=1;var e=m(),t=a().RegExp;return ms=e(function(){var e=t(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)})}(),d=function(){if(ws)return gs;ws=1;var e=m(),t=a().RegExp;return gs=e(function(){var e=t("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})}(),p=s("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,h=v,y=n("".charAt),g=n("".indexOf),b=n("".replace),S=n("".slice),k=(t=/b*/g,r(v,e=/a/,"a"),r(v,t,"a"),0!==e.lastIndex||0!==t.lastIndex),A=u.BROKEN_CARET,T=void 0!==/()??/.exec("")[1];return(k||T||A||l||d)&&(h=function(e){var t,n,a,u,s,l,d,m=this,w=f(m),E=i(e),O=w.raw;if(O)return O.lastIndex=m.lastIndex,t=r(h,O,E),m.lastIndex=O.lastIndex,t;var x=w.groups,I=A&&m.sticky,R=r(o,m),C=m.source,P=0,_=E;if(I&&(R=b(R,"y",""),-1===g(R,"g")&&(R+="g"),_=S(E,m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==y(E,m.lastIndex-1))&&(C="(?: "+C+")",_=" "+_,P++),n=new RegExp("^(?:"+C+")",R)),T&&(n=new RegExp("^"+C+"$(?!\\s)",R)),k&&(a=m.lastIndex),u=r(v,I?n:m,_),I?u?(u.input=S(u.input,P),u[0]=S(u[0],P),u.index=m.lastIndex,m.lastIndex+=u[0].length):m.lastIndex=0:k&&u&&(m.lastIndex=m.global?u.index+u[0].length:a),T&&u&&u.length>1&&r(p,u[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(u[s]=void 0)}),u&&x)for(u.groups=l=c(null),s=0;s<x.length;s++)l[(d=x[s])[0]]=u[d[1]];return u}),bs=h}function Os(){if(ks)return As;ks=1;var e=Nr(),t=Es();return e({target:"RegExp",proto:!0,forced:/./.exec!==t},{exec:t}),As}Os();var xs,Is,Rs,Cs,Ps,_s,Ms,Us,Ls,Bs,js,Ns,Ds,Fs={};function qs(){if(Cs)return Rs;Cs=1;var e=Do().charAt;return Rs=function(t,r,n){return r+(n?e(t,r).length:1)}}function Hs(){if(_s)return Ps;_s=1;var e=fe(),t=it(),r=Math.floor,n=e("".charAt),i=e("".replace),o=e("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return Ps=function(e,s,c,f,l,d){var p=c+e.length,v=f.length,h=u;return void 0!==l&&(l=t(l),h=a),i(d,h,function(t,i){var a;switch(n(i,0)){case"$":return"$";case"&":return e;case"`":return o(s,0,c);case"'":return o(s,p);case"<":a=l[o(i,1,-1)];break;default:var u=+i;if(0===u)return t;if(u>v){var d=r(u/10);return 0===d?t:d<=v?void 0===f[d-1]?n(i,1):f[d-1]+n(i,1):t}a=f[u-1]}return void 0===a?"":a})}}function zs(){if(Bs)return Ls;Bs=1;var e=w(),t=ot(),r=we(),n=function(){if(Us)return Ms;Us=1;var e=a(),t=m(),r=e.RegExp,n=!t(function(){var e=!0;try{r(".","d")}catch(t){e=!1}var t={},n="",i=e?"dgimsy":"gimsy",o=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var u in e&&(a.hasIndices="d"),a)o(u,a[u]);return Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(t)!==i||n!==i});return Ms={correct:n}}(),i=Ts(),o=RegExp.prototype;return Ls=n.correct?function(e){return e.flags}:function(a){return n.correct||!r(o,a)||t(a,"flags")?a.flags:e(i,a)}}!function(){if(Ds)return Fs;Ds=1;var e=_u(),t=w(),r=fe(),n=function(){if(Is)return xs;Is=1,Os();var e=w(),t=$t(),r=Es(),n=m(),i=ut(),o=Tt(),a=i("species"),u=RegExp.prototype;return xs=function(s,c,f,l){var d=i(s),p=!n(function(){var e={};return e[d]=function(){return 7},7!==""[s](e)}),v=p&&!n(function(){var e=!1,t=/a/;if("split"===s){var r={};r[a]=function(){return t},(t={constructor:r,flags:""})[d]=/./[d]}return t.exec=function(){return e=!0,null},t[d](""),!e});if(!p||!v||f){var h=/./[d],m=c(d,""[s],function(t,n,i,o,a){var s=n.exec;return s===r||s===u.exec?p&&!a?{done:!0,value:e(h,n,i,o)}:{done:!0,value:e(t,i,n,o)}:{done:!1}});t(String.prototype,s,m[0]),t(u,d,m[1])}l&&o(u[d],"sham",!0)}}(),i=m(),o=kt(),a=me(),u=ye(),s=dr(),c=vr(),f=No(),l=ve(),d=qs(),p=xe(),v=Hs(),h=zs(),y=function(){if(Ns)return js;Ns=1;var e=w(),t=kt(),r=me(),n=le(),i=Es(),o=TypeError;return js=function(a,u){var s=a.exec;if(r(s)){var c=e(s,a,u);return null!==c&&t(c),c}if("RegExp"===n(a))return e(i,a,u);throw new o("RegExp#exec called on incompatible receiver")}}(),g=ut()("replace"),b=Math.max,S=Math.min,k=r([].concat),A=r([].push),T=r("".indexOf),E=r("".slice),O=function(e){return void 0===e?e:String(e)},x="$0"==="a".replace(/./,"$0"),I=!!/./[g]&&""===/./[g]("a","$0");n("replace",function(r,n,i){var m=I?"$":"$0";return[function(e,r){var i=l(this),o=u(e)?p(e,g):void 0;return o?t(o,e,i,r):t(n,f(i),e,r)},function(t,r){var u=o(this),l=f(t);if("string"==typeof r&&-1===T(r,m)&&-1===T(r,"$<")){var p=i(n,u,l,r);if(p.done)return p.value}var g=a(r);g||(r=f(r));var w,x=f(h(u)),I=-1!==T(x,"g");I&&(w=-1!==T(x,"u"),u.lastIndex=0);for(var R,C=[];null!==(R=y(u,l))&&(A(C,R),I);){""===f(R[0])&&(u.lastIndex=d(l,c(u.lastIndex),w))}for(var P="",_=0,M=0;M<C.length;M++){for(var U,L=f((R=C[M])[0]),B=b(S(s(R.index),l.length),0),j=[],N=1;N<R.length;N++)A(j,O(R[N]));var D=R.groups;if(g){var F=k([L],j,B,l);void 0!==D&&A(F,D),U=f(e(r,void 0,F))}else U=v(L,l,B,j,D,r);B>=_&&(P+=E(l,_,B)+U,_=B+L.length)}return P+E(l,_)}]},!!i(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!x||I)}();var Ws={chunkSize:1048576,retryDelays:[0,3e3,5e3,1e4,2e4,6e4],maxChunkRetries:3};function Gs(){return window.starmusTus||window.starmusConfig||{}}function Vs(e){var t=("string"==typeof e?e:String(e)).replace(/[\r\n\t]/g," ");return t.length>500?t.slice(0,497)+"...":t}function $s(e){return e&&"object"===xa(e)?e:{}}function Js(e,t){return Qs.apply(this,arguments)}function Qs(){return Qs=ha(ka().m(function e(t,r){var n,i,o,a,u,s,c,f=arguments;return ka().w(function(e){for(;;)switch(e.n){case 0:if(n=f.length>2&&void 0!==f[2]?f[2]:{},i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>4&&void 0!==f[4]?f[4]:"",a=f.length>5?f[5]:void 0,window.tus&&window.tus.Upload){e.n=1;break}throw aa("[TUS] No tus library â failing over"),new Error("TUS_NOT_AVAILABLE");case 1:if(u=Gs(),s=u.endpoint||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.tusUpload){e.n=2;break}throw new Error("TUS_ENDPOINT_NOT_CONFIGURED");case 2:if(c=Sa({filename:Vs(r),filetype:t.type||"audio/webm"},Object.entries($s(n)).reduce(function(e,t){var r=Ea(t,2),n=r[0],i=r[1];return e[n]=Vs(i),e},{})),i)try{c.starmus_meta=Vs(JSON.stringify(i))}catch(e){aa("[TUS] Metadata sanitization failed",e)}return e.a(2,new Promise(function(e,r){var n,i={endpoint:s,chunkSize:u.chunkSize||Ws.chunkSize,retryDelays:u.retryDelays||Ws.retryDelays,metadata:c,fingerprint:function(e){return["starmus",o,e.size,e.lastModified||""].join("-")},onError:function(e){aa("[TUS] Upload error",e),r(e)},onProgress:function(e,t){"function"==typeof a&&a(e,t)},onSuccess:function(){return ha(ka().m(function r(){var o,a,s;return ka().w(function(r){for(;;)switch(r.p=r.n){case 0:if(aa("[TUS] Upload success",n.url),!u.removeFingerprintOnSuccess||null===(o=window.tus)||void 0===o||null===(o=o.defaultOptions)||void 0===o||!o.removeFingerprint){r.n=5;break}return r.p=1,r.n=2,window.tus.defaultOptions.fingerprint(t,i);case 2:return a=r.v,r.n=3,window.tus.defaultOptions.removeFingerprint(a);case 3:r.n=5;break;case 4:r.p=4,s=r.v,aa("[TUS] Failed to remove fingerprint",s);case 5:e(n.url);case 6:return r.a(2)}},r,null,[[1,4]])}))()}};(n=new window.tus.Upload(t,i)).findPreviousUploads().then(function(e){e&&e.length>0&&(aa("[TUS] Resuming from previous upload",e[0].uploadUrl),n.resumeFromPreviousUpload(e[0]))}).finally(function(){n.start()})}))}},e)})),Qs.apply(this,arguments)}function Ys(e,t){return Ks.apply(this,arguments)}function Ks(){return Ks=ha(ka().m(function e(t,r){var n,i,o,a,u,s,c,f,l,d,p,v,h,m,y,g,w,b,S=arguments;return ka().w(function(e){for(;;)switch(e.n){case 0:if(b=function(){return b=ha(ka().m(function e(r,n,i,o,a,u,s,c,f,l){return ka().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var p=new FormData;p.append("audio_chunk",n,"".concat(i,".part").concat(r)),p.append("chunk_index",r),p.append("total_chunks",d),u?p.append("upload_id",u):p.append("create_upload_id","1"),Object.entries(s).forEach(function(e){var t=Ea(e,2),r=t[0],n=t[1];return p.append(r,n)}),o&&p.append("_starmus_meta",JSON.stringify(o));var v=new XMLHttpRequest;v.open("POST",c,!0),v.setRequestHeader("X-WP-Nonce",f),v.upload&&"function"==typeof l&&(v.upload.onprogress=function(e){e.lengthComputable&&l(start+e.loaded,t.size)}),v.onload=function(){if(v.status>=200&&v.status<300)try{var t=JSON.parse(v.responseText);!u&&t.upload_id&&(window.lastUploadId=t.upload_id),e(t)}catch(e){a(new Error("Invalid JSON chunk response"))}else a(new Error("Chunk ".concat(r," failed: ").concat(v.status)))},v.onerror=function(){return a(new Error("Network error during chunk upload"))},v.send(p)}))},e)})),b.apply(this,arguments)},w=function(e,t,r,n,i,o,a,u,s,c){return b.apply(this,arguments)},n=S.length>2&&void 0!==S[2]?S[2]:{},i=S.length>3&&void 0!==S[3]?S[3]:{},o=S.length>4&&void 0!==S[4]?S[4]:"",a=S.length>5?S[5]:void 0,u=Gs(),s=u.chunkedUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.chunkedUpload,c=u.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",s){e.n=1;break}throw new Error("CHUNKED_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:if(c){e.n=2;break}throw new Error("CHUNKED_UPLOAD_NONCE_MISSING");case 2:f=$s(n),l=u.chunkSize||Ws.chunkSize,d=Math.ceil(t.size/l),p="starmus_chunked_".concat(o,"_").concat(r,"_").concat(t.size),v=localStorage.getItem(p)||null,h=ka().m(function e(){var n,d,h,y,g,b;return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:n=0,d=!1,h=m*l,y=Math.min(h+l,t.size),g=t.slice(h,y);case 1:if(d||!(n<(u.maxChunkRetries||Ws.maxChunkRetries))){e.n=7;break}return e.p=2,e.n=3,w(m,g,r,i,o,v,f,s,c,a);case 3:d=!0,e.n=6;break;case 4:if(e.p=4,b=e.v,!(++n>=(u.maxChunkRetries||Ws.maxChunkRetries))){e.n=5;break}throw b;case 5:return e.n=6,new Promise(function(e){return setTimeout(e,300*n*n)});case 6:e.n=1;break;case 7:!v&&0===m&&window.lastUploadId&&(v=window.lastUploadId,localStorage.setItem(p,v));case 8:return e.a(2)}},e,null,[[2,4]])}),m=0;case 3:if(!(m<d)){e.n=5;break}return e.d(Ta(h()),4);case 4:m++,e.n=3;break;case 5:return(y=new FormData).append("upload_id",v),y.append("finalize","1"),(g=new XMLHttpRequest).open("POST",s,!0),g.setRequestHeader("X-WP-Nonce",c),e.a(2,new Promise(function(e,t){g.onload=function(){if(g.status>=200&&g.status<300)try{var r=JSON.parse(g.responseText);localStorage.removeItem(p),e(r)}catch(e){t(new Error("Invalid JSON on finalize"))}else t(new Error("Finalize failed: ".concat(g.status)))},g.onerror=function(){return t(new Error("Network error on finalize"))},g.send(y)}))}},e)})),Ks.apply(this,arguments)}function Xs(e,t){return Zs.apply(this,arguments)}function Zs(){return Zs=ha(ka().m(function e(t,r){var n,i,o,a,u,s,c,f=arguments;return ka().w(function(e){for(;;)switch(e.n){case 0:if(n=f.length>2&&void 0!==f[2]?f[2]:{},i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>5?f[5]:void 0,a=Gs(),u=a.directUpload||window.starmusConfig&&window.starmusConfig.endpoints&&window.starmusConfig.endpoints.directUpload,s=a.nonce||window.starmusConfig&&window.starmusConfig.nonce||"",u){e.n=1;break}throw new Error("DIRECT_UPLOAD_ENDPOINT_NOT_CONFIGURED");case 1:return c=$s(n),e.a(2,new Promise(function(e,n){var a=new FormData;Object.entries(c).forEach(function(e){var t=Ea(e,2),r=t[0],n=t[1];return a.append(r,n)}),a.append("audio_file",t,r),null!=i&&i.transcript&&a.append("_starmus_transcript",i.transcript),null!=i&&i.calibration&&a.append("_starmus_calibration",JSON.stringify(i.calibration)),null!=i&&i.env&&a.append("_starmus_env",JSON.stringify(i.env));var f=new XMLHttpRequest;f.open("POST",u,!0),s&&f.setRequestHeader("X-WP-Nonce",s),f.upload&&"function"==typeof o&&(f.upload.onprogress=function(e){e.lengthComputable&&o(e.loaded,e.total)}),f.onload=function(){if(f.status>=200&&f.status<300)try{e(JSON.parse(f.responseText))}catch(e){n(new Error("Invalid JSON response"))}else n(new Error("Upload failed: ".concat(f.status)))},f.onerror=function(){return n(new Error("Network error on direct upload"))},f.send(a)}))}},e)})),Zs.apply(this,arguments)}function ec(e,t,r,n,i,o){return tc.apply(this,arguments)}function tc(){return(tc=ha(ka().m(function e(t,r,n,i,o,a){var u,s;return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Js(t,r,n,i,o,a);case 1:case 4:case 6:return e.a(2,e.v);case 2:return e.p=2,u=e.v,aa("[Uploader] TUS failed, trying fallback",u),e.p=3,e.n=4,Ys(t,r,n,i,o,a);case 5:return e.p=5,s=e.v,aa("[Uploader] Chunked REST failed, trying direct",s),e.n=6,Xs(t,r,n,i,o,a)}},e,null,[[3,5],[0,2]])}))).apply(this,arguments)}function rc(e,t){var r=null==t?void 0:t.downlink;r&&0!==r||(r={"slow-2g":.05,"2g":.15,"3g":.75,"4g":8}[null==t?void 0:t.effectiveType]||.5);var n=1e6*(r=Math.min(r,10))/8;return Math.ceil(e/n*1.5)}function nc(e){return isFinite(e)?e<60?"~".concat(e,"s"):"~".concat(Math.ceil(e/60)," min"):"Calculating..."}var ic={uploadWithTus:Js,uploadWithChunkedRest:Ys,uploadDirect:Xs,uploadWithPriority:ec,isTusAvailable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var t=Gs();return!!(window.tus&&window.tus.Upload&&t.endpoint&&e>1048576)}catch(e){return!1}},estimateUploadTime:rc,formatUploadEstimate:nc};"undefined"!=typeof window&&(window.StarmusTus=ic);var oc,ac={};!function(){if(oc)return ac;oc=1;var e=Nr(),t=ra().map;e({target:"Array",proto:!0,forced:!ai()("map")},{map:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)}})}();var uc,sc,cc,fc,lc,dc={};function pc(){if(sc)return uc;sc=1;var e=fe();return uc=e(1.1.valueOf)}function vc(){if(fc)return cc;fc=1;var e=dr(),t=No(),r=ve(),n=RangeError;return cc=function(i){var o=t(r(this)),a="",u=e(i);if(u<0||u===1/0)throw new n("Wrong number of repetitions");for(;u>0;(u>>>=1)&&(o+=o))1&u&&(a+=o);return a}}!function(){if(lc)return dc;lc=1;var e=Nr(),t=fe(),r=dr(),n=pc(),i=vc(),o=m(),a=RangeError,u=String,s=Math.floor,c=t(i),f=t("".slice),l=t(1.1.toFixed),d=function(e,t,r){return 0===t?r:t%2==1?d(e,t-1,r*e):d(e*e,t/2,r)},p=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=s(i/1e7)},v=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=s(n/t),n=n%t*1e7},h=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=u(e[t]);r=""===r?n:r+c("0",7-n.length)+n}return r};e({target:"Number",proto:!0,forced:o(function(){return"0.000"!==l(8e-5,3)||"1"!==l(.9,0)||"1.25"!==l(1.255,2)||"1000000000000000128"!==l(0xde0b6b3a7640080,0)})||!o(function(){l({})})},{toFixed:function(e){var t,i,o,s,l=n(this),m=r(e),y=[0,0,0,0,0,0],g="",w="0";if(m<0||m>20)throw new a("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return u(l);if(l<0&&(g="-",l=-l),l>1e-21)if(i=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(l*d(2,69,1))-69)<0?l*d(2,-t,1):l/d(2,t,1),i*=4503599627370496,(t=52-t)>0){for(p(y,0,i),o=m;o>=7;)p(y,1e7,0),o-=7;for(p(y,d(10,o,1),0),o=t-1;o>=23;)v(y,1<<23),o-=23;v(y,1<<o),p(y,1,1),v(y,2),w=h(y)}else p(y,0,i),p(y,1<<-t,0),w=h(y)+c("0",m);return w=m>0?g+((s=w.length)<=m?"0."+c("0",m-s)+w:f(w,0,s-m)+"."+f(w,s-m)):g+w}})}();var hc,mc={};!function(){if(hc)return mc;hc=1;var e=qt().PROPER,t=$t(),r=kt(),n=No(),i=m(),o=zs(),a="toString",u=RegExp.prototype,s=u[a],c=i(function(){return"/a/b"!==s.call({source:"a",flags:"b"})}),f=e&&s.name!==a;(c||f)&&t(u,a,function(){var e=r(this);return"/"+n(e.source)+"/"+n(o(e))},{unsafe:!0})}();var yc={dbName:"StarmusSubmissions",storeName:"pendingSubmissions",dbVersion:1,maxRetries:10,retryDelays:[0,5e3,1e4,3e4,6e4,12e4,3e5,6e5,12e5,18e5],maxBlobSize:41943040},gc=function(){return ya(function e(){ma(this,e),this.db=null,this.isProcessing=!1},[{key:"init",value:(o=ha(ka().m(function e(){var t=this;return ka().w(function(e){for(;;)switch(e.n){case 0:if(window.indexedDB){e.n=1;break}return console.error("[Offline] IndexedDB not supported. Offline uploads disabled."),e.a(2);case 1:return e.a(2,new Promise(function(e){var r=indexedDB.open(yc.dbName,yc.dbVersion);r.onerror=function(t){aa("[Offline] DB open failed:",t),e()},r.onblocked=function(){aa("[Offline] DB open blocked â other tab open")},r.onsuccess=function(r){t.db=r.target.result,t.db.onversionchange=function(){t.db.close(),aa("[Offline] DB version changed â closed connection")},aa("[Offline] DB ready"),e()},r.onupgradeneeded=function(e){var t=e.target.result;if(!t.objectStoreNames.contains(yc.storeName)){var r=t.createObjectStore(yc.storeName,{keyPath:"id"});r.createIndex("timestamp","timestamp",{unique:!1}),r.createIndex("retryCount","retryCount",{unique:!1}),aa("[Offline] Created object store:",yc.storeName)}}}))}},e)})),function(){return o.apply(this,arguments)})},{key:"add",value:(i=ha(ka().m(function e(t,r,n){var i,o,a,u,s,c=this,f=arguments;return ka().w(function(e){for(;;)switch(e.n){case 0:if(i=f.length>3&&void 0!==f[3]?f[3]:{},o=f.length>4&&void 0!==f[4]?f[4]:{},this.db){e.n=1;break}throw new Error("OfflineQueue: DB not initialized");case 1:if(!(r.size>yc.maxBlobSize)){e.n=2;break}throw a="Audio too large (".concat((r.size/1024/1024).toFixed(2),"â¯MB) â exceeds limit of ").concat(yc.maxBlobSize/1024/1024,"â¯MB"),aa("[Offline] "+a),new Error(a);case 2:return u=new Blob([r],{type:r.type}),s={id:"starmus-offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),instanceId:t,fileName:n,timestamp:Date.now(),audioBlob:u,formFields:i,metadata:o,retryCount:0,lastAttempt:null,error:null},e.a(2,new Promise(function(e,t){var r=c.db.transaction([yc.storeName],"readwrite");r.objectStore(yc.storeName).add(s),r.oncomplete=function(){aa("[Offline] Queued submission:",s.id),c._notifyQueueUpdate(),e(s.id)},r.onerror=function(e){var r=e.target.error;r&&"QuotaExceededError"===r.name?(aa("[Offline] IndexedDB quota exceeded â cannot save offline"),t(new Error("IndexedDB quota exceeded â cannot store offline"))):(aa("[Offline] Transaction error:",r),t(r))}}))}},e,this)})),function(e,t,r){return i.apply(this,arguments)})},{key:"getAll",value:(n=ha(ka().m(function e(){var t=this;return ka().w(function(e){for(;;)switch(e.n){case 0:if(this.db){e.n=1;break}return e.a(2,[]);case 1:return e.a(2,new Promise(function(e,r){var n=t.db.transaction([yc.storeName],"readonly").objectStore(yc.storeName).getAll();n.onsuccess=function(){return e(n.result||[])},n.onerror=function(){return r(n.error)}}))}},e,this)})),function(){return n.apply(this,arguments)})},{key:"remove",value:(r=ha(ka().m(function e(t){var r=this;return ka().w(function(e){for(;;)switch(e.n){case 0:if(this.db){e.n=1;break}return e.a(2);case 1:return e.a(2,new Promise(function(e,n){var i=r.db.transaction([yc.storeName],"readwrite");i.objectStore(yc.storeName).delete(t),i.oncomplete=function(){aa("[Offline] Removed from queue:",t),r._notifyQueueUpdate(),e()},i.onerror=function(e){return n(e.target.error)}}))}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"_updateRetry",value:(t=ha(ka().m(function e(t,r,n){var i=this;return ka().w(function(e){for(;;)switch(e.n){case 0:if(this.db){e.n=1;break}return e.a(2);case 1:return e.a(2,new Promise(function(e,o){var a=i.db.transaction([yc.storeName],"readwrite"),u=a.objectStore(yc.storeName),s=u.get(t);s.onsuccess=function(){var e=s.result;e&&(e.retryCount=r,e.lastAttempt=Date.now(),e.error=n||null,u.put(e))},s.onerror=function(e){return o(e.target.error)},a.oncomplete=function(){return e()}}))}},e,this)})),function(e,r,n){return t.apply(this,arguments)})},{key:"processQueue",value:(e=ha(ka().m(function e(){var t,r,n,i,o,a,u,s,c,f,l,d,p,v,h,m,y;return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isProcessing&&navigator.onLine){e.n=1;break}return e.a(2);case 1:return this.isProcessing=!0,aa("[Offline] Processing queue..."),e.p=2,e.n=3,this.getAll();case 3:t=e.v,aa("[Offline] ".concat(t.length," submissions pending")),r=ga(t),e.p=4,r.s();case 5:if((n=r.n()).done){e.n=14;break}if(i=n.value,o=i.id,a=i.audioBlob,u=i.fileName,s=i.formFields,c=i.metadata,f=i.retryCount,l=i.instanceId,!(f>=yc.maxRetries)){e.n=6;break}return aa("[Offline] Max retries exceeded for",o),e.a(3,13);case 6:if(null===i.lastAttempt){e.n=7;break}if(d=yc.retryDelays[Math.min(f,yc.retryDelays.length-1)],!(Date.now()-i.lastAttempt<d)){e.n=7;break}return e.a(3,13);case 7:return e.p=7,aa("[Offline] Uploading queued item",o),e.n=8,ec(a,u,s,c,l,null);case 8:return p=e.v,aa("[Offline] Upload succeeded for",o,p),e.n=9,this.remove(o);case 9:e.n=13;break;case 10:if(e.p=10,h=e.v,aa("[Offline] Upload failed for",o,h),v=h&&h.message?h.message:String(h),/400|Invalid JSON|QuotaExceeded/i.test(v)){e.n=12;break}return e.n=11,this._updateRetry(o,f+1,v);case 11:e.n=13;break;case 12:aa("[Offline] Nonâretryable error, leaving in queue for manual review:",o);case 13:e.n=5;break;case 14:e.n=16;break;case 15:e.p=15,m=e.v,r.e(m);case 16:return e.p=16,r.f(),e.f(16);case 17:e.n=19;break;case 18:e.p=18,y=e.v,console.error("[Offline] Queue processing error:",y);case 19:return e.p=19,this.isProcessing=!1,e.f(19);case 20:return e.a(2)}},e,this,[[7,10],[4,15,16,17],[2,18,19,20]])})),function(){return e.apply(this,arguments)})},{key:"setupNetworkListeners",value:function(){var e=this;window.addEventListener("online",function(){aa("[Offline] Network online â processing queue"),e.processQueue()}),window.addEventListener("offline",function(){aa("[Offline] Network offline â queue paused")}),setInterval(function(){navigator.onLine&&e.processQueue().catch(function(e){return aa("[Offline] Retry error",e)})},6e4)}},{key:"_notifyQueueUpdate",value:function(){window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&this.getAll().then(function(e){var t=e.map(function(e){return{id:e.id,fileName:e.fileName,retryCount:e.retryCount,error:e.error,timestamp:e.timestamp}});window.StarmusHooks.doAction("starmus_offline_queue_updated",t)}).catch(function(e){return aa("[Offline] Queue notification failed",e)})}}]);var e,t,r,n,i,o}(),wc=new gc;function bc(){return Sc.apply(this,arguments)}function Sc(){return(Sc=ha(ka().m(function e(){return ka().w(function(e){for(;;)switch(e.n){case 0:if(wc.db){e.n=2;break}return e.n=1,wc.init();case 1:wc.setupNetworkListeners();case 2:return e.a(2,wc)}},e)}))).apply(this,arguments)}function kc(e,t,r,n,i){return Ac.apply(this,arguments)}function Ac(){return(Ac=ha(ka().m(function e(t,r,n,i,o){var a;return ka().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,bc();case 1:return a=e.v,e.a(2,a.add(t,r,n,i,o))}},e)}))).apply(this,arguments)}function Tc(){return Ec.apply(this,arguments)}function Ec(){return(Ec=ha(ka().m(function e(){var t,r;return ka().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,bc();case 1:return t=e.v,e.n=2,t.getAll();case 2:return r=e.v,e.a(2,r.length)}},e)}))).apply(this,arguments)}function Oc(){return bc()}"undefined"!=typeof window&&(window.initOffline=Oc);var xc,Ic,Rc;function Cc(){if(Ic)return xc;Ic=1;var e=a().isFinite;return xc=Number.isFinite||function(t){return"number"==typeof t&&e(t)}}Rc||(Rc=1,Nr()({target:"Number",stat:!0},{isFinite:Cc()}));var Pc,_c,Mc,Uc,Lc,Bc={};!function(){if(Lc)return Bc;Lc=1;var e=Nr(),t=function(){if(_c)return Pc;_c=1;var e=fe(),t=vr(),r=No(),n=vc(),i=ve(),o=e(n),a=e("".slice),u=Math.ceil,s=function(e){return function(n,s,c){var f,l,d=r(i(n)),p=t(s),v=d.length,h=void 0===c?" ":r(c);return p<=v||""===h?d:((l=o(h,u((f=p-v)/h.length))).length>f&&(l=a(l,0,f)),e?d+l:l+d)}};return Pc={start:s(!1),end:s(!0)}}().start;e({target:"String",proto:!0,forced:function(){if(Uc)return Mc;Uc=1;var e=be();return Mc=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(e)}()},{padStart:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)}})}(),window.StarmusInstances=window.StarmusInstances||{};var jc=!1;function Nc(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}function Dc(e,t){var r;"error"!==e.status&&"complete"!==e.status||console.log("[StarmusUI] Render called with state:",{status:e.status,calibrationComplete:null===(r=e.calibration)||void 0===r?void 0:r.complete,instanceId:e.instanceId});var n=e.status,i=e.error,o=e.source,a=void 0===o?{}:o,u=e.submission,s=void 0===u?{}:u,c=e.calibration,f=void 0===c?{}:c,l=e.recorder,d=void 0===l?{}:l,p=e.instanceId;if("C"===e.tier||!0===e.fallbackActive)return["recordBtn","pauseBtn","resumeBtn","stopBtn","recorderContainer"].forEach(function(e){t[e]&&(t[e].style.display="none")}),void(t.fallbackContainer&&(t.fallbackContainer.style.display="block"));if(t.step1&&t.step2){var v="idle"!==n&&"uninitialized"!==n;t.step1.style.display=v?"none":"block",t.step2.style.display=v?"block":"none"}if(t.timer||t.timerElapsed){var h=function(e){if(!Number.isFinite(e))return"00m 00s";var t=Math.floor(e/60),r=Math.floor(e%60);return"".concat(t.toString().padStart(2,"0"),"m ").concat(r.toString().padStart(2,"0"),"s")}(d.duration||0);t.timerElapsed?t.timerElapsed.textContent=h:t.timer&&(t.timer.textContent=h),t.timer&&("recording"===n?t.timer.classList.add("starmus-timer--recording"):t.timer.classList.remove("starmus-timer--recording"))}if(t.durationProgress){var m=d.duration||0,y="recording"===n||"paused"===n||"calibrating"===n;if(t.durationProgress.parentElement&&(t.durationProgress.parentElement.style.display=y?"block":"none"),y){var g=Math.min(100,m/1200*100);t.durationProgress.style.setProperty("--starmus-recording-progress","".concat(g,"%")),t.durationProgress.setAttribute("aria-valuenow",Math.floor(m)),m>=1020?t.durationProgress.setAttribute("data-level","danger"):m>=900?t.durationProgress.setAttribute("data-level","warning"):t.durationProgress.setAttribute("data-level","safe"),m>=1200&&"recording"===n&&window.CommandBus&&window.CommandBus.dispatch("stop-mic",{},{instanceId:p})}}if(t.volumeMeter){var w="recording"===n||"paused"===n||"calibrating"===n;if(t.volumeMeter.parentElement&&(t.volumeMeter.parentElement.style.display=w?"block":"none"),w){var b=Math.max(0,Math.min(100,"calibrating"===n?f.volumePercent||0:d.amplitude||0));t.volumeMeter.style.setProperty("--starmus-audio-level","".concat(b,"%"));var S=b/100;S<.6?t.volumeMeter.setAttribute("data-level","safe"):S<.85?t.volumeMeter.setAttribute("data-level","hot"):t.volumeMeter.setAttribute("data-level","clip"),"recording"===n&&function(e,t){if(e>=.85&&!jc){jc=!0;var r=t.messageBox||document.querySelector("[data-starmus-message-box]");r&&(r.textContent="â ï¸ Your microphone is too loud. Move back 6â12 inches or speak softer for a cleaner recording.",r.style.display="block",r.setAttribute("role","alert"),r.setAttribute("aria-live","assertive"),setTimeout(function(){r.style.display="none",r.removeAttribute("role"),r.removeAttribute("aria-live")},6e3))}}(S,t)}else t.volumeMeter.style.setProperty("--starmus-audio-level","0%"),t.volumeMeter.removeAttribute("data-level")}var k="recording"===n,A="paused"===n,T="ready"===n,E="calibrating"===n,O="ready_to_submit"===n,x=f&&!0===f.complete,I=k||A||E;if(t.recordBtn&&(t.recordBtn.style.display=T&&x&&!I&&!O?"inline-flex":"none"),t.pauseBtn&&(t.pauseBtn.style.display=k?"inline-flex":"none"),t.resumeBtn&&(t.resumeBtn.style.display=A?"inline-flex":"none"),t.stopBtn&&(t.stopBtn.style.display=I?"inline-flex":"none",t.stopBtn.disabled=E,t.stopBtn.innerHTML=E?'<span class="dashicons dashicons-update"></span> Calibrating...':'<span class="dashicons dashicons-media-default"></span> Stop'),t.submitBtn&&(t.submitBtn.disabled="ready_to_submit"!==n,t.submitBtn.textContent="submitting"===n?"Uploadingâ¦":"Submit Recording"),t.transcriptBox){var R,C,P=(null===(R=a.transcript)||void 0===R?void 0:R.length)>0,_=(null===(C=a.interimTranscript)||void 0===C?void 0:C.length)>0;P||_?(t.transcriptBox.style.display="block",t.transcriptBox.innerHTML=(P?'<span class="starmus-transcript--final">'.concat(Nc(a.transcript),"</span>"):"")+(_?' <span class="starmus-transcript--interim">'.concat(Nc(a.interimTranscript),"</span>"):"")):t.transcriptBox.style.display="none"}if(t.statusEl){var M=t.statusEl,U="",L="starmus-status";if(i)U=i.message||"An error occurred.",L+=" starmus-status--error";else switch(n){case"ready":U="Mic calibrated. Click Start Recording.",L+=" starmus-status--success";break;case"recording":U="Recording...",L+=" starmus-status--recording";break;case"paused":U="Paused â Resume or Stop.";break;case"submitting":U="Uploading ".concat(Math.round(100*s.progress),"%");break;case"complete":U="Upload successful!",L+=" starmus-status--success";break;default:U=""}M.className=L,M.textContent=U,M.style.display=U?"block":"none"}}function Fc(e,t){var r,n,i,o,a,u,s;console.log("[StarmusUI] initInstance called with elements:",{recordBtn:!!t.recordBtn,setupMicBtn:!!t.setupMicBtn,volumeMeter:!!t.volumeMeter,timer:!!t.timer,elementKeys:Object.keys(t)});var c=e.getState().instanceId,f=window.CommandBus||window.StarmusHooks;function l(e){if(!f)return console.warn("[StarmusUI] No CommandBus detected.");console.log("[StarmusUI] Dispatching:",e),f.dispatch(e,{},{instanceId:c})}console.log("[StarmusUI] CommandBus found:",!!f,"Instance ID:",c),console.log("[StarmusUI] Attaching event listeners..."),t.recordBtn?(console.log("[StarmusUI] Record button element:",t.recordBtn),console.log("[StarmusUI] Button disabled:",t.recordBtn.disabled),console.log("[StarmusUI] Button style display:",getComputedStyle(t.recordBtn).display),console.log("[StarmusUI] Button style visibility:",getComputedStyle(t.recordBtn).visibility),console.log("[StarmusUI] Button style pointer-events:",getComputedStyle(t.recordBtn).pointerEvents),t.recordBtn.addEventListener("click",function(e){console.log("[StarmusUI] Record button clicked! Event:",e),console.log("[StarmusUI] Button disabled at click time:",t.recordBtn.disabled),l("start-recording")}),t.recordBtn.addEventListener("mousedown",function(e){console.log("[StarmusUI] Record button MOUSEDOWN detected!",e)}),setTimeout(function(){console.log("[StarmusUI] Testing manual click..."),t.recordBtn.click();var e=t.recordBtn.getBoundingClientRect(),r=e.left+e.width/2,n=e.top+e.height/2,i=document.elementFromPoint(r,n);console.log("[StarmusUI] Button position:",{x:r,y:n}),console.log("[StarmusUI] Element at button center:",i),console.log("[StarmusUI] Is the button the top element?",i===t.recordBtn),i!==t.recordBtn&&(console.log("[StarmusUI] *** FOUND THE PROBLEM! Another element is covering the button ***"),console.log("[StarmusUI] Covering element classes:",null==i?void 0:i.className),console.log("[StarmusUI] Covering element z-index:",getComputedStyle(i).zIndex))},2e3),console.log("[StarmusUI] Record button listener attached")):console.log("[StarmusUI] No record button found!"),null===(r=t.pauseBtn)||void 0===r||r.addEventListener("click",function(){return l("pause-mic")}),null===(n=t.resumeBtn)||void 0===n||n.addEventListener("click",function(){return l("resume-mic")}),null===(i=t.stopBtn)||void 0===i||i.addEventListener("click",function(){return l("stop-mic")}),null===(o=t.submitBtn)||void 0===o||o.addEventListener("click",function(){var e,r=t.submitBtn.closest("form"),n={},i=ga((r?new FormData(r):new FormData).entries());try{for(i.s();!(e=i.n()).done;){var o=Ea(e.value,2),a=o[0],u=o[1];n[a]=u}}catch(e){i.e(e)}finally{i.f()}l("submit")}),null===(a=t.resetBtn)||void 0===a||a.addEventListener("click",function(){return l("reset")}),null===(u=t.playBtn)||void 0===u||u.addEventListener("click",function(){return l("play")}),null===(s=t.setupMicBtn)||void 0===s||s.addEventListener("click",function(){return l("setup-mic")}),t.continueBtn&&t.continueBtn.addEventListener("click",function(){console.log("[StarmusUI] Continue button clicked!"),e.dispatch({type:"starmus/ui/step-continue",payload:{}})}),t.fileInput&&t.fileInput.addEventListener("change",function(e){var t,r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&f.dispatch("file-attached",{file:r},{instanceId:c})});var d=e.subscribe(function(e){return Dc(e,t)});return Dc(e.getState(),t),d}"undefined"!=typeof window&&(window.initUI=Fc),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll('[data-starmus-action="next"]');e.length&&e.forEach(function(e){e.addEventListener("click",function(){try{var t;if(!window.StarmusStore||!window.StarmusStore.createStore)return void console.error("[Starmus] Store not available");var r=e.closest("[data-starmus-instance]");if(!r)return;var n=r.getAttribute("data-starmus-instance"),i=null===(t=window.StarmusInstances)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.store;if(!i)return void console.error("[Starmus] No store for instance",n);i.dispatch({type:"starmus/ui/step-continue"});var o=document.querySelector("#starmus_step1_"+n),a=document.querySelector("#starmus_step2_"+n);o&&(o.style.display="none"),a&&(a.style.display="block"),console.log("[Starmus] Continue â Recording step enabled",n)}catch(e){console.error("[Starmus Continue Error]",e)}})})});var qc,Hc={};!function(){if(qc)return Hc;qc=1;var e=Nr(),t=mr().includes,r=m(),n=xn();e({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")}();var zc,Wc,Gc,Vc,$c,Jc,Qc,Yc={};function Kc(){if(Vc)return Gc;Vc=1;var e=function(){if(Wc)return zc;Wc=1;var e=ye(),t=le(),r=ut()("match");return zc=function(n){var i;return e(n)&&(void 0!==(i=n[r])?!!i:"RegExp"===t(n))}}(),t=TypeError;return Gc=function(r){if(e(r))throw new t("The method doesn't accept regular expressions");return r}}!function(){if(Qc)return Yc;Qc=1;var e=Nr(),t=fe(),r=Kc(),n=ve(),i=No(),o=function(){if(Jc)return $c;Jc=1;var e=ut()("match");return $c=function(t){var r=/./;try{"/./"[t](r)}catch(n){try{return r[e]=!1,"/./"[t](r)}catch(e){}}return!1}}(),a=t("".indexOf);e({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~a(i(n(this)),i(r(e)),arguments.length>1?arguments[1]:void 0)}})}();var Xc,Zc,ef,tf,rf,nf,of,af={};function uf(){return Zc?Xc:(Zc=1,Xc="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff")}function sf(){if(tf)return ef;tf=1;var e=fe(),t=ve(),r=No(),n=uf(),i=e("".replace),o=RegExp("^["+n+"]+"),a=RegExp("(^|[^"+n+"])["+n+"]+$"),u=function(e){return function(n){var u=r(t(n));return 1&e&&(u=i(u,o,"")),2&e&&(u=i(u,a,"$1")),u}};return ef={start:u(1),end:u(2),trim:u(3)}}!function(){if(of)return af;of=1;var e=Nr(),t=sf().trim,r=function(){if(nf)return rf;nf=1;var e=qt().PROPER,t=m(),r=uf();return rf=function(n){return t(function(){return!!r[n]()||"âÂá "!=="âÂá "[n]()||e&&r[n].name!==n})}}();e({target:"String",proto:!0,forced:r("trim")},{trim:function(){return t(this)}})}();var cf=window.StarmusHooks||{},ff=cf.subscribe||function(){},lf=cf.debugLog||function(){};function df(e,t,r){lf("[StarmusCore] initCore",t,r);try{window.dispatchEvent(new CustomEvent("starmus-ready",{detail:{instanceId:t}})),lf("[StarmusCore] dispatched starmus-ready event")}catch(e){lf("[StarmusCore] failed to dispatch starmus-ready",e)}function n(e){return i.apply(this,arguments)}function i(){return(i=ha(ka().m(function n(i){var o,a,u,s,c,f,l,d,p,v,h,m,y,g,w,b,S;return ka().w(function(n){for(;;)switch(n.p=n.n){case 0:if(a=e.getState(),u=a.source||{},s=a.calibration||{},c=a.env||r||{},f=u.blob||u.file,l=u.fileName||u.file&&u.file.name||"recording.webm",f){n.n=1;break}return e.dispatch({type:"starmus/error",error:{message:"Please record or attach audio before submitting.",retryable:!1},status:a.status}),n.a(2);case 1:if(d={transcript:(null===(o=u.transcript)||void 0===o?void 0:o.trim())||null,calibration:s.complete?{gain:s.gain,snr:s.snr,noiseFloor:s.noiseFloor,speechLevel:s.speechLevel,timestamp:s.timestamp||(new Date).toISOString()}:null,env:c},p=rc(f.size,c.network),lf("[StarmusCore] Upload size: ".concat((f.size/1024/1024).toFixed(2),"â¯MB, estimated time: ").concat(nc(p))),e.dispatch({type:"starmus/submit-start"}),v=function(t,r){e.dispatch({type:"starmus/submit-progress",progress:t/r})},n.p=2,navigator.onLine){n.n=3;break}throw new Error("OFFLINE_FAST_PATH");case 3:return n.n=4,ec({blob:f,fileName:l,formFields:i,metadata:d,instanceId:t,onProgress:v});case 4:h=n.v,lf("[StarmusCore] Upload succeeded via",h.method,h),e.dispatch({type:"starmus/submit-complete",payload:h});try{window.dispatchEvent(new CustomEvent("starmus-upload-finished",{detail:{instanceId:t,method:h.method}}))}catch(e){}n.n=12;break;case 5:if(n.p=5,b=n.v,lf("[StarmusCore] Upload error",b),m=(null==b?void 0:b.message)||"",y=m.includes("not configured"),"OFFLINE_FAST_PATH"!==b.message&&y){n.n=11;break}return lf("[StarmusCore] Saving submission to offline queue for retry"),n.p=6,n.n=7,kc(t,f,l,i,d);case 7:return g=n.v,e.dispatch({type:"starmus/submit-queued",submissionId:g}),n.n=8,Tc();case 8:w=n.v,lf("[StarmusCore] Offline queue count: ".concat(w)),window.dispatchEvent(new CustomEvent("starmus-offline-queued",{detail:{instanceId:t,pending:w}})),n.n=10;break;case 9:n.p=9,S=n.v,console.error("[StarmusCore] Failed to save offline submission",S),e.dispatch({type:"starmus/error",error:{message:"Upload failed and could not be saved offline.",retryable:!1},status:"ready_to_submit"});case 10:n.n=12;break;case 11:e.dispatch({type:"starmus/error",error:{message:b.message||"Upload failed.",retryable:!1},status:"ready_to_submit"});case 12:return n.a(2)}},n,null,[[6,9],[2,5]])}))).apply(this,arguments)}return ff("submit",function(e,r){r&&r.instanceId===t&&n(e.formFields||{})}),ff("reset",function(r,n){n&&n.instanceId===t&&e.dispatch({type:"starmus/reset"})}),ff("continue",function(r,n){n&&n.instanceId===t&&e.dispatch({type:"starmus/ui/step-continue"})}),{handleSubmit:n}}"undefined"!=typeof window&&(window.initCore=df),"undefined"!=typeof module&&module.exports&&(module.exports={initCore:df});var pf,vf,hf,mf,yf,gf,wf,bf,Sf,kf,Af,Tf,Ef,Of,xf,If,Rf,Cf,Pf,_f={};function Mf(){return vf?pf:(vf=1,pf="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView)}function Uf(){if(mf)return hf;mf=1;var e=dr(),t=vr(),r=RangeError;return hf=function(n){if(void 0===n)return 0;var i=e(n),o=t(i);if(i!==o)throw new r("Wrong length or index");return o}}function Lf(){if(kf)return Sf;kf=1;var e=gf?yf:(gf=1,yf=Math.sign||function(e){var t=+e;return 0===t||t!=t?t:t<0?-1:1}),t=function(){if(bf)return wf;bf=1;var e=4503599627370496;return wf=function(t){return t+e-e}}(),r=Math.abs;return Sf=function(n,i,o,a){var u=+n,s=r(u),c=e(u);if(s<a)return c*t(s/a/i)*a*i;var f=(1+i/2220446049250313e-31)*s,l=f-(f-s);return l>o||l!=l?c*(1/0):c*l}}function Bf(){if(Of)return Ef;Of=1;var e=Array,t=Math.abs,r=Math.pow,n=Math.floor,i=Math.log,o=Math.LN2;return Ef={pack:function(a,u,s){var c,f,l,d=e(s),p=8*s-u-1,v=(1<<p)-1,h=v>>1,m=23===u?r(2,-24)-r(2,-77):0,y=a<0||0===a&&1/a<0?1:0,g=0;for((a=t(a))!=a||a===1/0?(f=a!=a?1:0,c=v):(c=n(i(a)/o),a*(l=r(2,-c))<1&&(c--,l*=2),(a+=c+h>=1?m/l:m*r(2,1-h))*l>=2&&(c++,l/=2),c+h>=v?(f=0,c=v):c+h>=1?(f=(a*l-1)*r(2,u),c+=h):(f=a*r(2,h-1)*r(2,u),c=0));u>=8;)d[g++]=255&f,f/=256,u-=8;for(c=c<<u|f,p+=u;p>0;)d[g++]=255&c,c/=256,p-=8;return d[g-1]|=128*y,d},unpack:function(e,t){var n,i=e.length,o=8*i-t-1,a=(1<<o)-1,u=a>>1,s=o-7,c=i-1,f=e[c--],l=127&f;for(f>>=7;s>0;)l=256*l+e[c--],s-=8;for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)n=256*n+e[c--],s-=8;if(0===l)l=1-u;else{if(l===a)return n?NaN:f?-1/0:1/0;n+=r(2,t),l-=u}return(f?-1:1)*n*r(2,l-t)}}}function jf(){if(If)return xf;If=1;var e=it(),t=pr(),r=hr();return xf=function(n){for(var i=e(this),o=r(i),a=arguments.length,u=t(a>1?arguments[1]:void 0,o),s=a>2?arguments[2]:void 0,c=void 0===s?o:t(s,o);c>u;)i[u++]=n;return i},xf}function Nf(){if(Cf)return Rf;Cf=1;var e=a(),t=fe(),r=y(),n=Mf(),i=qt(),o=Tt(),u=Io(),s=Ro(),c=m(),f=To(),l=dr(),d=vr(),p=Uf(),v=function(){if(Tf)return Af;Tf=1;var e=Lf();return Af=Math.fround||function(t){return e(t,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)}}(),h=Bf(),g=Rn(),w=Ln(),b=jf(),S=ui(),k=Oo(),A=Br(),T=Pn(),E=Gt(),O=i.PROPER,x=i.CONFIGURABLE,I="ArrayBuffer",R="DataView",C="prototype",P="Wrong index",_=E.getterFor(I),M=E.getterFor(R),U=E.set,L=e[I],B=L,j=B&&B[C],N=e[R],D=N&&N[C],F=Object.prototype,q=e.Array,H=e.RangeError,z=t(b),W=t([].reverse),G=h.pack,V=h.unpack,$=function(e){return[255&e]},J=function(e){return[255&e,e>>8&255]},Q=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Y=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},K=function(e){return G(v(e),23,4)},X=function(e){return G(e,52,8)},Z=function(e,t,r){u(e[C],t,{configurable:!0,get:function(){return r(this)[t]}})},ee=function(e,t,r,n){var i=M(e),o=p(r),a=!!n;if(o+t>i.byteLength)throw new H(P);var u=i.bytes,s=o+i.byteOffset,c=S(u,s,s+t);return a?c:W(c)},te=function(e,t,r,n,i,o){var a=M(e),u=p(r),s=n(+i),c=!!o;if(u+t>a.byteLength)throw new H(P);for(var f=a.bytes,l=u+a.byteOffset,d=0;d<t;d++)f[l+d]=s[c?d:t-d-1]};if(n){var re=O&&L.name!==I;c(function(){L(1)})&&c(function(){new L(-1)})&&!c(function(){return new L,new L(1.5),new L(NaN),1!==L.length||re&&!x})?re&&x&&o(L,"name",I):((B=function(e){return f(this,j),k(new L(p(e)),this,B)})[C]=j,j.constructor=B,A(B,L)),w&&g(D)!==F&&w(D,F);var ne=new N(new B(2)),ie=t(D.setInt8);ne.setInt8(0,2147483648),ne.setInt8(1,2147483649),!ne.getInt8(0)&&ne.getInt8(1)||s(D,{setInt8:function(e,t){ie(this,e,t<<24>>24)},setUint8:function(e,t){ie(this,e,t<<24>>24)}},{unsafe:!0})}else j=(B=function(e){f(this,j);var t=p(e);U(this,{type:I,bytes:z(q(t),0),byteLength:t}),r||(this.byteLength=t,this.detached=!1)})[C],D=(N=function(e,t,n){f(this,D),f(e,j);var i=_(e),o=i.byteLength,a=l(t);if(a<0||a>o)throw new H("Wrong offset");if(a+(n=void 0===n?o-a:d(n))>o)throw new H("Wrong length");U(this,{type:R,buffer:e,byteLength:n,byteOffset:a,bytes:i.bytes}),r||(this.buffer=e,this.byteLength=n,this.byteOffset=a)})[C],r&&(Z(B,"byteLength",_),Z(N,"buffer",M),Z(N,"byteLength",M),Z(N,"byteOffset",M)),s(D,{getInt8:function(e){return ee(this,1,e)[0]<<24>>24},getUint8:function(e){return ee(this,1,e)[0]},getInt16:function(e){var t=ee(this,2,e,arguments.length>1&&arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=ee(this,2,e,arguments.length>1&&arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return Y(ee(this,4,e,arguments.length>1&&arguments[1]))},getUint32:function(e){return Y(ee(this,4,e,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(e){return V(ee(this,4,e,arguments.length>1&&arguments[1]),23)},getFloat64:function(e){return V(ee(this,8,e,arguments.length>1&&arguments[1]),52)},setInt8:function(e,t){te(this,1,e,$,t)},setUint8:function(e,t){te(this,1,e,$,t)},setInt16:function(e,t){te(this,2,e,J,t,arguments.length>2&&arguments[2])},setUint16:function(e,t){te(this,2,e,J,t,arguments.length>2&&arguments[2])},setInt32:function(e,t){te(this,4,e,Q,t,arguments.length>2&&arguments[2])},setUint32:function(e,t){te(this,4,e,Q,t,arguments.length>2&&arguments[2])},setFloat32:function(e,t){te(this,4,e,K,t,arguments.length>2&&arguments[2])},setFloat64:function(e,t){te(this,8,e,X,t,arguments.length>2&&arguments[2])}});return T(B,I),T(N,R),Rf={ArrayBuffer:B,DataView:N}}!function(){if(Pf)return _f;Pf=1;var e=Nr(),t=a(),r=Nf(),n=Co(),i="ArrayBuffer",o=r[i];e({global:!0,constructor:!0,forced:t[i]!==o},{ArrayBuffer:o}),n(i)}();var Df,Ff={};!function(){if(Df)return Ff;Df=1;var e=Nr(),t=Dr(),r=m(),n=Nf(),i=kt(),o=pr(),a=vr(),u=n.ArrayBuffer,s=n.DataView,c=s.prototype,f=t(u.prototype.slice),l=t(c.getUint8),d=t(c.setUint8);e({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:r(function(){return!new u(2).slice(1,void 0).byteLength})},{slice:function(e,t){if(f&&void 0===t)return f(i(this),e);for(var r=i(this).byteLength,n=o(e,r),c=o(void 0===t?r:t,r),p=new u(a(c-n)),v=new s(this),h=new s(p),m=0;n<c;)d(h,m++,l(v,n++));return p}})}();var qf,Hf;Hf||(Hf=1,qf||(qf=1,xo()("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Po())));var zf,Wf,Gf,Vf={};!function(){if(Gf)return Vf;Gf=1;var e=Nr(),t=function(){if(Wf)return zf;Wf=1;var e=a(),t=m(),r=fe(),n=No(),i=sf().trim,o=uf(),u=r("".charAt),s=e.parseFloat,c=e.Symbol,f=c&&c.iterator,l=1/s(o+"-0")!=-1/0||f&&!t(function(){s(Object(f))});return zf=l?function(e){var t=i(n(e)),r=s(t);return 0===r&&"-"===u(t,0)?-0:r}:s}();e({global:!0,forced:parseFloat!==t},{parseFloat:t})}();var $f,Jf,Qf,Yf,Kf,Xf,Zf,el,tl,rl,nl,il,ol,al,ul,sl,cl,fl,ll,dl,pl,vl,hl={exports:{}};function ml(){if(Jf)return $f;Jf=1;var e,t,r,n=Mf(),i=y(),o=a(),u=me(),s=ye(),c=ot(),f=ni(),l=Ee(),d=Tt(),p=$t(),v=Io(),h=we(),m=Rn(),g=Ln(),w=ut(),b=at(),S=Gt(),k=S.enforce,A=S.get,T=o.Int8Array,E=T&&T.prototype,O=o.Uint8ClampedArray,x=O&&O.prototype,I=T&&m(T),R=E&&m(E),C=Object.prototype,P=o.TypeError,_=w("toStringTag"),M=b("TYPED_ARRAY_TAG"),U="TypedArrayConstructor",L=n&&!!g&&"Opera"!==f(o.opera),B=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},D=function(e){var t=m(e);if(s(t)){var r=A(t);return r&&c(r,U)?r[U]:D(t)}},F=function(e){if(!s(e))return!1;var t=f(e);return c(j,t)||c(N,t)};for(e in j)(r=(t=o[e])&&t.prototype)?k(r)[U]=t:L=!1;for(e in N)(r=(t=o[e])&&t.prototype)&&(k(r)[U]=t);if((!L||!u(I)||I===Function.prototype)&&(I=function(){throw new P("Incorrect invocation")},L))for(e in j)o[e]&&g(o[e],I);if((!L||!R||R===C)&&(R=I.prototype,L))for(e in j)o[e]&&g(o[e].prototype,R);if(L&&m(x)!==R&&g(x,R),i&&!c(R,_))for(e in B=!0,v(R,_,{configurable:!0,get:function(){return s(this)?this[M]:void 0}}),j)o[e]&&d(o[e],M,e);return $f={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:B&&M,aTypedArray:function(e){if(F(e))return e;throw new P("Target is not a typed array")},aTypedArrayConstructor:function(e){if(u(e)&&(!g||h(I,e)))return e;throw new P(l(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(i){if(r)for(var a in j){var u=o[a];if(u&&c(u.prototype,e))try{delete u.prototype[e]}catch(r){try{u.prototype[e]=t}catch(e){}}}R[e]&&!r||p(R,e,r?t:L&&E[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,a;if(i){if(g){if(r)for(n in j)if((a=o[n])&&c(a,e))try{delete a[e]}catch(e){}if(I[e]&&!r)return;try{return p(I,e,r?t:L&&I[e]||t)}catch(e){}}for(n in j)!(a=o[n])||a[e]&&!r||p(a,e,t)}},getTypedArrayConstructor:D,isView:function(e){if(!s(e))return!1;var t=f(e);return"DataView"===t||c(j,t)||c(N,t)},isTypedArray:F,TypedArray:I,TypedArrayPrototype:R}}function yl(){if(Xf)return Kf;Xf=1;var e=ye(),t=Math.floor;return Kf=Number.isInteger||function(r){return!e(r)&&isFinite(r)&&t(r)===r}}function gl(){if(el)return Zf;el=1;var e=dr(),t=RangeError;return Zf=function(r){var n=e(r);if(n<0)throw new t("The argument can't be less than 0");return n}}function wl(){if(rl)return tl;rl=1;var e=gl(),t=RangeError;return tl=function(r,n){var i=e(r);if(i%n)throw new t("Wrong offset");return i}}function bl(){if(il)return nl;il=1;var e=Math.round;return nl=function(t){var r=e(t);return r<0?0:r>255?255:255&r}}function Sl(){if(al)return ol;al=1;var e=ni();return ol=function(t){var r=e(t);return"BigInt64Array"===r||"BigUint64Array"===r}}function kl(){if(sl)return ul;sl=1;var e=st(),t=TypeError;return ul=function(r){var n=e(r,"number");if("number"==typeof n)throw new t("Can't convert number to bigint");return BigInt(n)}}function Al(){if(fl)return cl;fl=1;var e=go(),t=w(),r=Cu(),n=it(),i=hr(),o=So(),a=bo(),u=wo(),s=Sl(),c=ml().aTypedArrayConstructor,f=kl();return cl=function(l){var d,p,v,h,m,y,g,w,b=r(this),S=n(l),k=arguments.length,A=k>1?arguments[1]:void 0,T=void 0!==A,E=a(S);if(E&&!u(E))for(w=(g=o(S,E)).next,S=[];!(y=t(w,g)).done;)S.push(y.value);for(T&&k>2&&(A=e(A,arguments[2])),p=i(S),v=new(c(b))(p),h=s(v),d=0;p>d;d++)m=T?A(S[d],d):S[d],v[d]=h?f(m):+m;return v},cl}function Tl(){if(dl)return ll;dl=1;var e=hr();return ll=function(t,r,n){for(var i=0,o=arguments.length>2?n:e(r),a=new t(o);o>i;)a[i]=r[i++];return a},ll}function El(){if(pl)return hl.exports;pl=1;var e=Nr(),t=a(),r=w(),n=y(),i=function(){if(Yf)return Qf;Yf=1;var e=a(),t=m(),r=Eo(),n=ml().NATIVE_ARRAY_BUFFER_VIEWS,i=e.ArrayBuffer,o=e.Int8Array;return Qf=!n||!t(function(){o(1)})||!t(function(){new o(-1)})||!r(function(e){new o,new o(null),new o(1.5),new o(e)},!0)||t(function(){return 1!==new o(new i(2),1,void 0).length})}(),o=ml(),u=Nf(),s=To(),c=ce(),f=Tt(),l=yl(),d=vr(),p=Uf(),v=wl(),h=bl(),g=ct(),b=ot(),S=ni(),k=ye(),A=Te(),T=On(),E=we(),O=Ln(),x=wr().f,I=Al(),R=ra().forEach,C=Co(),P=Io(),_=At(),M=dt(),U=Tl(),L=Gt(),B=Oo(),j=L.get,N=L.set,D=L.enforce,F=_.f,q=M.f,H=t.RangeError,z=u.ArrayBuffer,W=z.prototype,G=u.DataView,V=o.NATIVE_ARRAY_BUFFER_VIEWS,$=o.TYPED_ARRAY_TAG,J=o.TypedArray,Q=o.TypedArrayPrototype,Y=o.isTypedArray,K="BYTES_PER_ELEMENT",X="Wrong length",Z=function(e,t){P(e,t,{configurable:!0,get:function(){return j(this)[t]}})},ee=function(e){var t;return E(W,e)||"ArrayBuffer"===(t=S(e))||"SharedArrayBuffer"===t},te=function(e,t){return Y(e)&&!A(t)&&t in e&&l(+t)&&t>=0},re=function(e,t){return t=g(t),te(e,t)?c(2,e[t]):q(e,t)},ne=function(e,t,r){return t=g(t),!(te(e,t)&&k(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?F(e,t,r):(e[t]=r.value,e)};return n?(V||(M.f=re,_.f=ne,Z(Q,"buffer"),Z(Q,"byteOffset"),Z(Q,"byteLength"),Z(Q,"length")),e({target:"Object",stat:!0,forced:!V},{getOwnPropertyDescriptor:re,defineProperty:ne}),hl.exports=function(n,o,a){var u=n.match(/\d+/)[0]/8,c=n+(a?"Clamped":"")+"Array",l="get"+n,m="set"+n,y=t[c],g=y,w=g&&g.prototype,b={},S=function(e,t){F(e,t,{get:function(){return function(e,t){var r=j(e);return r.view[l](t*u+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var n=j(e);n.view[m](t*u+n.byteOffset,a?h(r):r,!0)}(this,t,e)},enumerable:!0})};V?i&&(g=o(function(e,t,n,i){return s(e,w),B(k(t)?ee(t)?void 0!==i?new y(t,v(n,u),i):void 0!==n?new y(t,v(n,u)):new y(t):Y(t)?U(g,t):r(I,g,t):new y(p(t)),e,g)}),O&&O(g,J),R(x(y),function(e){e in g||f(g,e,y[e])}),g.prototype=w):(g=o(function(e,t,n,i){s(e,w);var o,a,c,f=0,l=0;if(k(t)){if(!ee(t))return Y(t)?U(g,t):r(I,g,t);o=t,l=v(n,u);var h=t.byteLength;if(void 0===i){if(h%u)throw new H(X);if((a=h-l)<0)throw new H(X)}else if((a=d(i)*u)+l>h)throw new H(X);c=a/u}else c=p(t),o=new z(a=c*u);for(N(e,{buffer:o,byteOffset:l,byteLength:a,length:c,view:new G(o)});f<c;)S(e,f++)}),O&&O(g,J),w=g.prototype=T(Q)),w.constructor!==g&&f(w,"constructor",g),D(w).TypedArrayConstructor=g,$&&f(w,$,c);var A=g!==y;b[c]=g,e({global:!0,constructor:!0,forced:A,sham:!V},b),K in g||f(g,K,u),K in w||f(w,K,u),C(c)}):hl.exports=function(){},hl.exports}vl||(vl=1,El()("Float32",function(e){return function(t,r,n){return e(this,t,r,n)}}));var Ol,xl,Il,Rl={};!function(){if(Il)return Rl;Il=1;var e=fe(),t=ml(),r=function(){if(xl)return Ol;xl=1;var e=it(),t=pr(),r=hr(),n=Ai(),i=Math.min;return Ol=[].copyWithin||function(o,a){var u=e(this),s=r(u),c=t(o,s),f=t(a,s),l=arguments.length>2?arguments[2]:void 0,d=i((void 0===l?s:t(l,s))-f,s-c),p=1;for(f<c&&c<f+d&&(p=-1,f+=d-1,c+=d-1);d-- >0;)f in u?u[c]=u[f]:n(u,c),c+=p,f+=p;return u},Ol}(),n=e(r),i=t.aTypedArray;(0,t.exportTypedArrayMethod)("copyWithin",function(e,t){return n(i(this),e,t,arguments.length>2?arguments[2]:void 0)})}();var Cl,Pl={};!function(){if(Cl)return Pl;Cl=1;var e=ml(),t=ra().every,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("every",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var _l,Ml={};!function(){if(_l)return Ml;_l=1;var e=ml(),t=jf(),r=kl(),n=ni(),i=w(),o=fe(),a=m(),u=e.aTypedArray,s=e.exportTypedArrayMethod,c=o("".slice);s("fill",function(e){var o=arguments.length;u(this);var a="Big"===c(n(this),0,3)?r(e):+e;return i(t,this,a,o>1?arguments[1]:void 0,o>2?arguments[2]:void 0)},a(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e}))}();var Ul,Ll,Bl,jl={};!function(){if(Bl)return jl;Bl=1;var e=ml(),t=ra().filter,r=function(){if(Ll)return Ul;Ll=1;var e=Tl(),t=ml().getTypedArrayConstructor;return Ul=function(r,n){return e(t(r),n)}}(),n=e.aTypedArray;(0,e.exportTypedArrayMethod)("filter",function(e){var i=t(n(this),e,arguments.length>1?arguments[1]:void 0);return r(this,i)})}();var Nl,Dl={};!function(){if(Nl)return Dl;Nl=1;var e=ml(),t=ra().find,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("find",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var Fl,ql={};!function(){if(Fl)return ql;Fl=1;var e=ml(),t=ra().findIndex,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("findIndex",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var Hl,zl={};!function(){if(Hl)return zl;Hl=1;var e=ml(),t=ra().forEach,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("forEach",function(e){t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var Wl,Gl={};!function(){if(Wl)return Gl;Wl=1;var e=ml(),t=mr().includes,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("includes",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var Vl,$l={};!function(){if(Vl)return $l;Vl=1;var e=ml(),t=mr().indexOf,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("indexOf",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var Jl,Ql={};!function(){if(Jl)return Ql;Jl=1;var e=a(),t=m(),r=fe(),n=ml(),i=Nn(),o=ut()("iterator"),u=e.Uint8Array,s=r(i.values),c=r(i.keys),f=r(i.entries),l=n.aTypedArray,d=n.exportTypedArrayMethod,p=u&&u.prototype,v=!t(function(){p[o].call([1])}),h=!!p&&p.values&&p[o]===p.values&&"values"===p.values.name,y=function(){return s(l(this))};d("entries",function(){return f(l(this))},v),d("keys",function(){return c(l(this))},v),d("values",y,v||!h,{name:"values"}),d(o,y,v||!h,{name:"values"})}();var Yl,Kl={};!function(){if(Yl)return Kl;Yl=1;var e=ml(),t=fe(),r=e.aTypedArray,n=e.exportTypedArrayMethod,i=t([].join);n("join",function(e){return i(r(this),e)})}();var Xl,Zl,ed,td={};!function(){if(ed)return td;ed=1;var e=ml(),t=_u(),r=function(){if(Zl)return Xl;Zl=1;var e=_u(),t=he(),r=dr(),n=hr(),i=Fr(),o=Math.min,a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0,s=i("lastIndexOf");return Xl=u||!s?function(i){if(u)return e(a,this,arguments)||0;var s=t(this),c=n(s);if(0===c)return-1;var f=c-1;for(arguments.length>1&&(f=o(f,r(arguments[1]))),f<0&&(f=c+f);f>=0;f--)if(f in s&&s[f]===i)return f||0;return-1}:a,Xl}(),n=e.aTypedArray;(0,e.exportTypedArrayMethod)("lastIndexOf",function(e){var i=arguments.length;return t(r,n(this),i>1?[e,arguments[1]]:[e])})}();var rd,nd={};!function(){if(rd)return nd;rd=1;var e=ml(),t=ra().map,r=e.aTypedArray,n=e.getTypedArrayConstructor;(0,e.exportTypedArrayMethod)("map",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0,function(e,t){return new(n(e))(t)})})}();var id,od={};!function(){if(id)return od;id=1;var e=ml(),t=qa().left,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("reduce",function(e){var n=arguments.length;return t(r(this),e,n,n>1?arguments[1]:void 0)})}();var ad,ud={};!function(){if(ad)return ud;ad=1;var e=ml(),t=qa().right,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("reduceRight",function(e){var n=arguments.length;return t(r(this),e,n,n>1?arguments[1]:void 0)})}();var sd,cd={};!function(){if(sd)return cd;sd=1;var e=ml(),t=e.aTypedArray,r=e.exportTypedArrayMethod,n=Math.floor;r("reverse",function(){for(var e,r=this,i=t(r).length,o=n(i/2),a=0;a<o;)e=r[a],r[a++]=r[--i],r[i]=e;return r})}();var fd,ld={};!function(){if(fd)return ld;fd=1;var e=a(),t=w(),r=ml(),n=hr(),i=wl(),o=it(),u=m(),s=e.RangeError,c=e.Int8Array,f=c&&c.prototype,l=f&&f.set,d=r.aTypedArray,p=r.exportTypedArrayMethod,v=!u(function(){var e=new Uint8ClampedArray(2);return t(l,e,{length:1,0:3},1),3!==e[1]}),h=v&&r.NATIVE_ARRAY_BUFFER_VIEWS&&u(function(){var e=new c(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]});p("set",function(e){d(this);var r=i(arguments.length>1?arguments[1]:void 0,1),a=o(e);if(v)return t(l,this,a,r);var u=this.length,c=n(a),f=0;if(c+r>u)throw new s("Wrong length");for(;f<c;)this[r+f]=a[f++]},!v||h)}();var dd,pd={};!function(){if(dd)return pd;dd=1;var e=ml(),t=m(),r=ui(),n=e.aTypedArray,i=e.getTypedArrayConstructor;(0,e.exportTypedArrayMethod)("slice",function(e,t){for(var o=r(n(this),e,t),a=i(this),u=0,s=o.length,c=new a(s);s>u;)c[u]=o[u++];return c},t(function(){new Int8Array(1).slice()}))}();var vd,hd={};!function(){if(vd)return hd;vd=1;var e=ml(),t=ra().some,r=e.aTypedArray;(0,e.exportTypedArrayMethod)("some",function(e){return t(r(this),e,arguments.length>1?arguments[1]:void 0)})}();var md,yd,gd,wd,bd,Sd,kd,Ad,Td,Ed={};function Od(){if(yd)return md;yd=1;var e=ui(),t=Math.floor,r=function(n,i){var o=n.length;if(o<8)for(var a,u,s=1;s<o;){for(u=s,a=n[s];u&&i(n[u-1],a)>0;)n[u]=n[--u];u!==s++&&(n[u]=a)}else for(var c=t(o/2),f=r(e(n,0,c),i),l=r(e(n,c),i),d=f.length,p=l.length,v=0,h=0;v<d||h<p;)n[v+h]=v<d&&h<p?i(f[v],l[h])<=0?f[v++]:l[h++]:v<d?f[v++]:l[h++];return n};return md=r}function xd(){if(wd)return gd;wd=1;var e=be().match(/firefox\/(\d+)/i);return gd=!!e&&+e[1]}function Id(){if(Sd)return bd;Sd=1;var e=be();return bd=/MSIE|Trident/.test(e)}function Rd(){if(Ad)return kd;Ad=1;var e=be().match(/AppleWebKit\/(\d+)\./);return kd=!!e&&+e[1]}!function(){if(Td)return Ed;Td=1;var e=a(),t=Dr(),r=m(),n=Oe(),i=Od(),o=ml(),u=xd(),s=Id(),c=Se(),f=Rd(),l=o.aTypedArray,d=o.exportTypedArrayMethod,p=e.Uint16Array,v=p&&t(p.prototype.sort),h=!(!v||r(function(){v(new p(2),null)})&&r(function(){v(new p(2),{})})),y=!!v&&!r(function(){if(c)return c<74;if(u)return u<67;if(s)return!0;if(f)return f<602;var e,t,r=new p(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(v(r,function(e,t){return(e/4|0)-(t/4|0)}),e=0;e<516;e++)if(r[e]!==n[e])return!0});d("sort",function(e){return void 0!==e&&n(e),y?v(this,e):i(l(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))},!y||h)}();var Cd,Pd={};!function(){if(Cd)return Pd;Cd=1;var e=ml(),t=vr(),r=pr(),n=e.aTypedArray,i=e.getTypedArrayConstructor;(0,e.exportTypedArrayMethod)("subarray",function(e,o){var a=n(this),u=a.length,s=r(e,u);return new(i(a))(a.buffer,a.byteOffset+s*a.BYTES_PER_ELEMENT,t((void 0===o?u:r(o,u))-s))})}();var _d,Md={};!function(){if(_d)return Md;_d=1;var e=a(),t=_u(),r=ml(),n=m(),i=ui(),o=e.Int8Array,u=r.aTypedArray,s=r.exportTypedArrayMethod,c=[].toLocaleString,f=!!o&&n(function(){c.call(new o(1))});s("toLocaleString",function(){return t(c,f?i(u(this)):u(this),i(arguments))},n(function(){return[1,2].toLocaleString()!==new o([1,2]).toLocaleString()})||!n(function(){o.prototype.toLocaleString.call([1,2])}))}();var Ud,Ld={};!function(){if(Ud)return Ld;Ud=1;var e=ml().exportTypedArrayMethod,t=m(),r=a(),n=fe(),i=r.Uint8Array,o=i&&i.prototype||{},u=[].toString,s=n([].join);t(function(){u.call({})})&&(u=function(){return s(this)});var c=o.toString!==u;e("toString",u,c)}();var Bd=new Map,jd=null;function Nd(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:e,event:t,severity:r.severity||"info",message:r.message||"",data:r.data||{}})}catch(e){console.warn("[Starmus] Telemetry emit failed:",e)}}function Dd(e){return Fd.apply(this,arguments)}function Fd(){return(Fd=ha(ka().m(function e(t){var r,n;return ka().w(function(e){for(;;)switch(e.n){case 0:if((r=t.getAudioTracks&&t.getAudioTracks()||[]).length){e.n=1;break}return e.a(2);case 1:if("live"!==(n=r[0]).readyState){e.n=2;break}return e.a(2);case 2:return e.a(2,new Promise(function(e){var t=0,r=setInterval(function(){("live"===n.readyState||t>100)&&(clearInterval(r),e()),t+=1},50);setTimeout(function(){clearInterval(r),e()},5e3)}))}},e)}))).apply(this,arguments)}function qd(){var e=window.AudioContext||window.webkitAudioContext;if(!e)throw new Error("AudioContext not supported in this browser");if((!jd||"closed"===jd.state)&&(jd=new e({latencyHint:"interactive"}),aa("[Recorder] Created AudioContext, state:",jd.state),"function"!=typeof jd.createMediaStreamSource))throw new Error("AudioContext lacks createMediaStreamSource");return jd}function Hd(e){var t=qd(),r=t.createMediaStreamSource(e);try{var n=function(e){var t=e.createMediaStreamDestination||e.createMediaStreamAudioDestination;if("function"!=typeof t)throw new Error("MediaStreamDestination not supported");var r=t.call(e);if(!r||!r.stream)throw new Error("Destination stream invalid");return r}(t),i=t.createBiquadFilter();i.type="highpass",i.frequency.value=85;var o=t.createDynamicsCompressor();o.threshold.value=-20,o.knee.value=40,o.ratio.value=12,o.attack.value=0,o.release.value=.25;var a=t.createAnalyser();return a.fftSize=2048,r.connect(i),i.connect(o),o.connect(a),a.connect(n),{audioContext:t,destinationStream:n.stream,analyser:a,nodes:[r,i,o,a,n],fallbackActive:!1}}catch(n){aa("[Recorder] Audio graph failed â fallback to raw stream:",n.message);var u=t.createAnalyser();return u.fftSize=2048,r.connect(u),{audioContext:t,destinationStream:e,analyser:u,nodes:[r,u],fallbackActive:!0}}}function zd(e,t){return Wd.apply(this,arguments)}function Wd(){return(Wd=ha(ka().m(function e(t,r){var n,i,o,a,u,s;return ka().w(function(e){for(;;)if(0===e.n)return n=qd(),(i=n.createAnalyser()).fftSize=2048,(o=n.createMediaStreamSource(t)).connect(i),a=new Float32Array(i.fftSize),u=[],s=performance.now(),e.a(2,new Promise(function(e){!function t(){if("running"===n.state){i.getFloatTimeDomainData(a);for(var c=0,f=0;f<a.length;f++)c+=a[f]*a[f];var l=Math.sqrt(c/a.length);if(isFinite(l)){u.push(l);var d=Math.min(100,2e3*l);r&&r("",d,!1),performance.now()-s<15e3?requestAnimationFrame(t):function(){var t=Math.max(1,Math.floor(u.length/3)),n=u.slice(0,t),a=u.slice(t,2*t),s=function(e){return e.length?e.reduce(function(e,t){return e+t},0)/e.length:0},c=s(n),f=s(a),l=f/Math.max(c,1e-6),d=l<3?6:Math.max(1,Math.min(4,.1/Math.max(f,1e-6))),p={gain:parseFloat(d.toFixed(3)),snr:parseFloat(l.toFixed(3)),noiseFloor:parseFloat(c.toFixed(6)),speechLevel:parseFloat(f.toFixed(6)),timestamp:(new Date).toISOString()};try{o.disconnect()}catch(e){}try{i.disconnect()}catch(e){}r&&r("",null,!0);e(p)}()}else requestAnimationFrame(t)}else requestAnimationFrame(t)}()}))},e)}))).apply(this,arguments)}function Gd(e,t){fa.unsubscribeInstance&&fa.unsubscribeInstance(t),fa.subscribe("setup-mic",function(){var r=ha(ka().m(function r(n,i){var o,a,u,s,c;return ka().w(function(r){for(;;)switch(r.p=r.n){case 0:if(i.instanceId===t){r.n=1;break}return r.a(2);case 1:if(navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia){r.n=2;break}return Nd(t,"E_RECORDER_UNSUPPORTED",{severity:"error",message:o="Microphone not supported."}),e.dispatch({type:"starmus/error",payload:{message:o,retryable:!1}}),r.a(2);case 2:return r.p=2,r.n=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:return a=r.v,Nd(t,"E_MIC_ACCESS",{severity:"info",message:"Mic access granted â calibrating"}),e.dispatch({type:"starmus/calibration-start"}),r.n=4,zd(a,function(t,r,n){e.dispatch({type:"starmus/calibration-update",message:t,volumePercent:r})});case 4:u=r.v,a.getTracks().forEach(function(e){return e.stop()}),e.dispatch({type:"starmus/calibration-complete",payload:{calibration:u},calibration:u}),r.n=6;break;case 5:r.p=5,c=r.v,s="NotAllowedError"===c.name?"Microphone permission denied.":"Failed to access microphone.",Nd(t,"E_MIC_ACCESS",{severity:"error",message:s,data:{error:c.message}}),e.dispatch({type:"starmus/error",payload:{message:s,retryable:!0}});case 6:return r.a(2)}},r,null,[[2,5]])}));return function(e,t){return r.apply(this,arguments)}}()),fa.subscribe("start-recording",function(){var r=ha(ka().m(function r(n,i){var o,a,u,s,c,f,l,d,p,v,h;return ka().w(function(r){for(;;)switch(r.p=r.n){case 0:if(i.instanceId===t){r.n=1;break}return r.a(2);case 1:if("calibrating"!==(o=e.getState()).status){r.n=2;break}return e.dispatch({type:"starmus/error",payload:{message:"Please wait for calibration to complete.",retryable:!0}}),r.a(2);case 2:if(o.calibration&&o.calibration.complete){r.n=3;break}return e.dispatch({type:"starmus/error",payload:{message:"Please setup your microphone first.",retryable:!0}}),r.a(2);case 3:return r.p=3,a=function(){var r=Bd.get(t);if(r&&"recording"===r.mediaRecorder.state){try{d.getFloatTimeDomainData(p);for(var n=0,i=0;i<p.length;i++)n+=p[i]*p[i];var o=Math.sqrt(n/p.length),u=Math.min(100,4e3*o),s=(performance.now()-v)/1e3;e.dispatch({type:"starmus/recorder-tick",duration:s,amplitude:u})}catch(e){}r.rafId=requestAnimationFrame(a)}},r.n=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:if(u=r.v,"suspended"!==(s=Hd(u)).audioContext.state){r.n=5;break}return r.n=5,s.audioContext.resume();case 5:return r.n=6,Dd(s.destinationStream);case 6:if(c=s.destinationStream,c.getAudioTracks().length){r.n=7;break}throw new Error("No audio tracks available");case 7:f=new MediaRecorder(c),l=[],f.ondataavailable=function(e){e.data&&e.data.size>0&&l.push(e.data)},f.onstop=function(){var r=Bd.get(t);if(r){r.rafId&&cancelAnimationFrame(r.rafId);var n=new Blob(l,{type:f.mimeType||"audio/webm"}),i="starmus-recording-".concat(Date.now(),".webm");Nd(t,"REC_COMPLETE",{severity:"info",message:"Recording stopped and blob created",data:{mimeType:f.mimeType||"audio/webm",chunkCount:l.length}}),e.dispatch({type:"starmus/recording-available",payload:{blob:n,fileName:i}}),u.getTracks().forEach(function(e){return e.stop()}),c.getTracks().forEach(function(e){return e.stop()}),s.nodes.forEach(function(e){try{e.disconnect()}catch(e){}}),Bd.delete(t)}},Bd.set(t,{mediaRecorder:f,rawStream:u,graph:s,rafId:null}),f.start(3e3),e.dispatch({type:"starmus/mic-start"}),d=s.analyser,p=new Float32Array(d.fftSize),v=performance.now(),requestAnimationFrame(a),r.n=9;break;case 8:r.p=8,h=r.v,console.error("[Recorder] ERROR start-recording:",h),Nd(t,"E_RECORDER_START_FAIL",{severity:"error",message:h.message}),e.dispatch({type:"starmus/error",payload:{message:"Recording failed to start.",retryable:!0}});case 9:return r.a(2)}},r,null,[[3,8]])}));return function(e,t){return r.apply(this,arguments)}}()),fa.subscribe("stop-mic",function(r,n){if(n.instanceId===t){var i=Bd.get(t);i&&i.mediaRecorder&&"recording"===i.mediaRecorder.state&&(i.mediaRecorder.stop(),e.dispatch({type:"starmus/mic-stop"}))}}),fa.subscribe("pause-mic",function(r,n){if(n.instanceId===t){var i=Bd.get(t);i&&i.mediaRecorder&&"recording"===i.mediaRecorder.state&&"function"==typeof i.mediaRecorder.pause&&(e.dispatch({type:"starmus/mic-pause"}),i.mediaRecorder.pause())}}),fa.subscribe("resume-mic",function(r,n){if(n.instanceId===t){var i=Bd.get(t);i&&i.mediaRecorder&&"paused"===i.mediaRecorder.state&&"function"==typeof i.mediaRecorder.resume&&(e.dispatch({type:"starmus/mic-resume"}),i.mediaRecorder.resume())}}),fa.subscribe("reset",function(e,r){if(r.instanceId===t){var n=Bd.get(t);if(n){try{n.mediaRecorder&&"inactive"!==n.mediaRecorder.state&&n.mediaRecorder.stop()}catch(e){}n.rafId&&cancelAnimationFrame(n.rafId),n.rawStream&&n.rawStream.getTracks().forEach(function(e){return e.stop()}),n.graph&&n.graph.destinationStream&&n.graph.destinationStream.getTracks().forEach(function(e){return e.stop()}),n.graph&&n.graph.nodes&&n.graph.nodes.forEach(function(e){try{e.disconnect()}catch(e){}}),Bd.delete(t)}}})}var Vd=window.StarmusHooks||window.CommandBus,$d=Vd&&Vd.debugLog?Vd.debugLog:function(){},Jd=function(){return ya(function e(t,r,n){ma(this,e),this.peaks=t,this.container=document.getElementById(r),this.data=Array.isArray(n)?n:[],this.activeTokenIndex=-1,this.isUserScrolling=!1,this.scrollTimeout=null,this.boundOnTimeUpdate=null,this.boundOnSeeked=null,this.boundOnClick=null,this.boundOnScroll=null,this.init()},[{key:"init",value:function(){this.container?(this.render(),this.bindEvents()):console.warn("[StarmusTranscript] Container not found. Transcript sync disabled.")}},{key:"render",value:function(){var e=this,t=document.createDocumentFragment();this.data.forEach(function(r,n){var i=document.createElement("span");i.textContent=r.text,i.className="starmus-word",i.dataset.index=n,i.dataset.start=r.start,i.dataset.end=r.end,"confidence"in r&&r.confidence<.8&&(i.dataset.confidence="low",i.title="Low confidence: ".concat(Math.round(100*r.confidence),"%")),t.appendChild(i),n<e.data.length-1&&t.appendChild(document.createTextNode(" "))}),this.container.innerHTML="",this.container.appendChild(t),this.activeTokenIndex=-1}},{key:"bindEvents",value:function(){var e=this;this.boundOnClick=function(t){var r=t.target;if(r.classList.contains("starmus-word")){var n=parseFloat(r.dataset.start);e.peaks&&e.peaks.player&&"function"==typeof e.peaks.player.seek&&(e.peaks.player.seek(n),Vd&&"function"==typeof Vd.dispatch&&Vd.dispatch("starmus/transcript/seek",{time:n},{instanceId:e.peaks.instanceId}))}},this.container.addEventListener("click",this.boundOnClick),this.boundOnScroll=function(){e.isUserScrolling=!0,e.scrollTimeout&&clearTimeout(e.scrollTimeout),e.scrollTimeout=setTimeout(function(){e.isUserScrolling=!1},1e3)},this.container.addEventListener("scroll",this.boundOnScroll);var t=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;t&&"function"==typeof t.addEventListener?(this.boundOnTimeUpdate=function(){var r=t.currentTime;"number"!=typeof r||isNaN(r)||e.syncHighlight(r)},t.addEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked=function(){var r=t.currentTime;"number"!=typeof r||isNaN(r)||e.syncHighlight(r)},t.addEventListener("seeked",this.boundOnSeeked)):$d("[StarmusTranscript] Player media element not found â sync disabled")}},{key:"findTokenIndex",value:function(e){if("number"!=typeof e||0===this.data.length)return-1;for(var t=0,r=this.data.length-1;t<=r;){var n=t+r>>1,i=this.data[n];if(e>=i.start&&e<=i.end)return n;e<i.start?r=n-1:t=n+1}return-1}},{key:"syncHighlight",value:function(e){var t=this.findTokenIndex(e);-1===t?this.clearHighlight():t!==this.activeTokenIndex&&this.updateDOM(t)}},{key:"updateDOM",value:function(e){var t=this.container.querySelectorAll(".starmus-word");this.activeTokenIndex>=0&&t[this.activeTokenIndex]&&t[this.activeTokenIndex].classList.remove("is-active"),this.activeTokenIndex=e;var r=t[e];r&&(r.classList.add("is-active"),this.isUserScrolling||this.scrollToWord(r))}},{key:"clearHighlight",value:function(){var e=this.container.querySelector(".starmus-word.is-active");e&&e.classList.remove("is-active"),this.activeTokenIndex=-1}},{key:"scrollToWord",value:function(e){e.scrollIntoView&&e.scrollIntoView({block:"center",behavior:"smooth"})}},{key:"updateData",value:function(e){this.data=Array.isArray(e)?e:[],this.render(),this.unbindEvents(),this.bindEvents()}},{key:"unbindEvents",value:function(){if(this.container){this.boundOnClick&&this.container.removeEventListener("click",this.boundOnClick),this.boundOnScroll&&this.container.removeEventListener("scroll",this.boundOnScroll);var e=this.peaks&&this.peaks.player&&this.peaks.player.getMediaElement?this.peaks.player.getMediaElement():null;e&&"function"==typeof e.removeEventListener&&(this.boundOnTimeUpdate&&e.removeEventListener("timeupdate",this.boundOnTimeUpdate),this.boundOnSeeked&&e.removeEventListener("seeked",this.boundOnSeeked))}}},{key:"destroy",value:function(){this.unbindEvents(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.container&&(this.container.innerHTML=""),this.data=[],this.activeTokenIndex=-1,this.isUserScrolling=!1}}])}();function Qd(e,t,r){return new Jd(e,t,r)}function Yd(e,t){Object.keys(e).forEach(function(r){var n=e[r],i=t.querySelector('input[name="'.concat(r,'"]'));if(i||((i=document.createElement("input")).type="hidden",i.name=r,t.appendChild(i)),null==n)i.value="";else if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)i.value=String(n);else try{i.value=JSON.stringify(n)}catch(e){console.warn("[StarmusMetadataAuto] Could not serialize field",r,n),i.value=""}})}function Kd(e,t){e&&Array.isArray(t)&&1===e.nodeType?t.forEach(function(t){try{var r=e.querySelector('input[name="'.concat(t,'"]'));r&&r.parentNode&&(e.contains(r)?(r.parentNode.removeChild(r),console.debug("[StarmusMetadataAuto] Removed field:",t)):console.debug("[StarmusMetadataAuto] Field not a child of form:",t))}catch(e){console.warn("[StarmusMetadataAuto] Could not remove field",t,e.message)}}):console.warn("[StarmusMetadataAuto] Invalid form element or field names for clearHiddenFields")}function Xd(e){var t,r,n,i,o,a,u,s,c,f,l,d,p,v,h,m,y,g,w,b,S,k,A,T,E=new Date,O=E.toISOString().split("T")[0],x=E.toISOString();return{starmus_title:(null===(t=e.source)||void 0===t?void 0:t.title)||"",starmus_language:(null===(r=e.source)||void 0===r?void 0:r.language)||"",starmus_recording_type:(null===(n=e.source)||void 0===n?void 0:n.type)||"",audio_file_type:(null===(i=e.submission)||void 0===i||null===(i=i.blob)||void 0===i?void 0:i.type)||"audio/webm",agreement_to_terms:null!==(o=e.user)&&void 0!==o&&o.agreedToTerms?"1":"0",_starmus_calibration:e.calibration||{},_starmus_env:e.env||{},first_pass_transcription:(null===(a=e.source)||void 0===a?void 0:a.transcript)||"",recording_metadata:(null===(u=e.source)||void 0===u?void 0:u.metadata)||{},waveform_json:(null===(s=e.source)||void 0===s?void 0:s.waveform)||{},project_collection_id:(null===(c=e.submission)||void 0===c?void 0:c.collectionId)||"",accession_number:(null===(f=e.submission)||void 0===f?void 0:f.accession)||"",session_date:O,session_start_time:(null===(l=e.recorder)||void 0===l?void 0:l.startTime)||x,session_end_time:(null===(d=e.recorder)||void 0===d?void 0:d.endTime)||x,location:(null===(p=e.source)||void 0===p?void 0:p.location)||"",gps_coordinates:(null===(v=e.source)||void 0===v?void 0:v.gps)||"",contributor_id:(null===(h=e.user)||void 0===h?void 0:h.id)||"",interviewers_recorders:(null===(m=e.source)||void 0===m?void 0:m.interviewers)||"",recording_equipment:(null===(y=e.source)||void 0===y?void 0:y.equipment)||"",audio_files_originals:(null===(g=e.source)||void 0===g?void 0:g.originals)||[],media_condition_notes:(null===(w=e.source)||void 0===w?void 0:w.conditionNotes)||"",related_consent_agreement:(null===(b=e.source)||void 0===b?void 0:b.consent)||"",usage_restrictions_rights:(null===(S=e.source)||void 0===S?void 0:S.usageRights)||"",access_level:(null===(k=e.submission)||void 0===k?void 0:k.accessLevel)||"",audio_quality_score:(null===(A=e.submission)||void 0===A?void 0:A.qualityScore)||"",mic_rest_adjustments:(null===(T=e.calibration)||void 0===T?void 0:T.adjustments)||"",device:navigator.userAgent,user_agent:navigator.userAgent}}function Zd(e,t){var r=[];return t.forEach(function(t){var n=e[t];(null==n||"string"==typeof n&&""===n.trim()||Array.isArray(n)&&0===n.length)&&r.push(t)}),{valid:0===r.length,missing:r}}function ep(e,t,r){if(e&&"function"==typeof e.getState&&"function"==typeof e.subscribe){if(t instanceof HTMLFormElement){var n=r||{},i=Array.isArray(n.trigger)?n.trigger:[n.trigger||"ready_to_submit"],o=Array.isArray(n.clearOn)?n.clearOn:[n.clearOn||"reset"],a=Array.isArray(n.requiredFields)?n.requiredFields:[],u=null,s=e.subscribe(c);return c(),s}console.warn("[StarmusMetadataAuto] Invalid form element â must be HTMLFormElement")}else console.warn("[StarmusMetadataAuto] Invalid store â cannot init auto metadata");function c(){var r=e.getState(),n=r.status;if(o.includes(n)&&Kd(t,Object.keys(Xd(r))),n!==u&&i.includes(n)){u=n;var s=Xd(r),c=a.length?Zd(s,a):{valid:!0,missing:[]},f=c.valid,l=c.missing;f||console.warn("[StarmusMetadataAuto] Missing required metadata fields:",l),Yd(s,t)}else u=n}}"undefined"!=typeof window&&(window.StarmusTranscript=Jd,window.StarmusTranscriptController={StarmusTranscript:Jd,init:Qd}),"undefined"!=typeof module&&module.exports&&(module.exports={StarmusTranscript:Jd,init:Qd}),"undefined"!=typeof window&&(window.StarmusMetadataAuto={initAutoMetadata:ep,populateHiddenFields:Yd,buildMetadataMap:Xd,validateMetadata:Zd,clearHiddenFields:Kd});var tp,rp,np,ip,op,ap,up,sp,cp,fp,lp={};function dp(){if(rp)return tp;rp=1;var e=m(),t=ut(),r=y(),n=et(),i=t("iterator");return tp=!e(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,o=new URLSearchParams("a=1&a=2&b=3"),a="";return e.pathname="c%20d",t.forEach(function(e,r){t.delete("b"),a+=r+e}),o.delete("a",2),o.delete("b",void 0),n&&(!e.toJSON||!o.has("a",1)||o.has("a",2)||!o.has("a",void 0)||o.has("b"))||!t.size&&(n||!r)||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[i]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("https://a#Ð±").hash||"a1c3"!==a||"x"!==new URL("https://x",void 0).host})}function pp(){if(ap)return op;ap=1;var e=kt(),t=ko();return op=function(r,n,i,o){try{return o?n(e(i)[0],i[1]):n(i)}catch(e){t(r,"throw",e)}}}function vp(){if(sp)return up;sp=1;var e=go(),t=w(),r=it(),n=pp(),i=wo(),o=ii(),a=hr(),u=oi(),s=So(),c=bo(),f=Array;return up=function(l){var d=r(l),p=o(this),v=arguments.length,h=v>1?arguments[1]:void 0,m=void 0!==h;m&&(h=e(h,v>2?arguments[2]:void 0));var y,g,w,b,S,k,A=c(d),T=0;if(!A||this===f&&i(A))for(y=a(d),g=p?new this(y):f(y);y>T;T++)k=m?h(d[T],T):d[T],u(g,T,k);else for(g=p?new this:[],S=(b=s(d,A)).next;!(w=t(S,b)).done;T++)k=m?n(b,h,[w.value,T],!0):w.value,u(g,T,k);return g.length=T,g},up}function hp(){if(fp)return cp;fp=1;var e=fe(),t=2147483647,r=/[^\0-\u007E]/,n=/[.\u3002\uFF0E\uFF61]/g,i="Overflow: input needs wider integers to process",o=RangeError,a=e(n.exec),u=Math.floor,s=String.fromCharCode,c=e("".charCodeAt),f=e([].join),l=e([].push),d=e("".replace),p=e("".split),v=e("".toLowerCase),h=function(e){return e+22+75*(e<26)},m=function(e,t,r){var n=0;for(e=r?u(e/700):e>>1,e+=u(e/t);e>455;)e=u(e/35),n+=36;return u(n+36*e/(e+38))},y=function(e){var r=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=c(e,r++);if(i>=55296&&i<=56319&&r<n){var o=c(e,r++);56320==(64512&o)?l(t,((1023&i)<<10)+(1023&o)+65536):(l(t,i),r--)}else l(t,i)}return t}(e);var n,a,d=e.length,p=128,v=0,y=72;for(n=0;n<e.length;n++)(a=e[n])<128&&l(r,s(a));var g=r.length,w=g;for(g&&l(r,"-");w<d;){var b=t;for(n=0;n<e.length;n++)(a=e[n])>=p&&a<b&&(b=a);var S=w+1;if(b-p>u((t-v)/S))throw new o(i);for(v+=(b-p)*S,p=b,n=0;n<e.length;n++){if((a=e[n])<p&&++v>t)throw new o(i);if(a===p){for(var k=v,A=36;;){var T=A<=y?1:A>=y+26?26:A-y;if(k<T)break;var E=k-T,O=36-T;l(r,s(h(T+E%O))),k=u(E/O),A+=36}l(r,s(h(k))),y=m(v,S,w===g),v=0,w++}}v++,p++}return f(r,"")};return cp=function(e){var t,i,o=[],u=p(d(v(e),n,"."),".");for(t=0;t<u.length;t++)i=u[t],l(o,a(r,i)?"xn--"+y(i):i);return f(o,".")}}var mp,yp,gp,wp,bp,Sp={};function kp(){if(gp)return yp;gp=1,Nn(),function(){if(mp)return Sp;mp=1;var e=Nr(),t=fe(),r=pr(),n=RangeError,i=String.fromCharCode,o=String.fromCodePoint,a=t([].join);e({target:"String",stat:!0,arity:1,forced:!!o&&1!==o.length},{fromCodePoint:function(e){for(var t,o=[],u=arguments.length,s=0;u>s;){if(t=+arguments[s++],r(t,1114111)!==t)throw new n(t+" is not a valid code point");o[s]=t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320)}return a(o,"")}})}();var e=Nr(),t=a(),r=Bu(),n=ge(),i=w(),o=fe(),u=y(),s=dp(),c=$t(),f=Io(),l=Ro(),d=Pn(),p=_n(),v=Gt(),h=To(),m=me(),g=ot(),b=go(),S=ni(),k=kt(),A=ye(),T=No(),E=On(),O=ce(),x=So(),I=bo(),R=jn(),C=Mu(),P=ut(),_=Od(),M=P("iterator"),U="URLSearchParams",L=U+"Iterator",B=v.set,j=v.getterFor(U),N=v.getterFor(L),D=r("fetch"),F=r("Request"),q=r("Headers"),H=F&&F.prototype,z=q&&q.prototype,W=t.TypeError,G=t.encodeURIComponent,V=String.fromCharCode,$=n("String","fromCodePoint"),J=parseInt,Q=o("".charAt),Y=o([].join),K=o([].push),X=o("".replace),Z=o([].shift),ee=o([].splice),te=o("".split),re=o("".slice),ne=o(/./.exec),ie=/\+/g,oe=/^[0-9a-f]+$/i,ae=function(e,t){var r=re(e,t,t+2);return ne(oe,r)?J(r,16):NaN},ue=function(e){for(var t=0,r=128;r>0&&0!==(e&r);r>>=1)t++;return t},se=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},le=function(e){for(var t=(e=X(e,ie," ")).length,r="",n=0;n<t;){var i=Q(e,n);if("%"===i){if("%"===Q(e,n+1)||n+3>t){r+="%",n++;continue}var o=ae(e,n+1);if(o!=o){r+=i,n++;continue}n+=2;var a=ue(o);if(0===a)i=V(o);else{if(1===a||a>4){r+="ï¿½",n++;continue}for(var u=[o],s=1;s<a&&!(++n+3>t||"%"!==Q(e,n));){var c=ae(e,n+1);if(c!=c){n+=3;break}if(c>191||c<128)break;K(u,c),n+=2,s++}if(u.length!==a){r+="ï¿½";continue}var f=se(u);null===f?r+="ï¿½":i=$(f)}}r+=i,n++}return r},de=/[!'()~]|%20/g,pe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ve=function(e){return pe[e]},he=function(e){return X(G(e),de,ve)},we=p(function(e,t){B(this,{type:L,target:j(e).entries,index:0,kind:t})},U,function(){var e=N(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,R(void 0,!0);var n=t[r];switch(e.kind){case"keys":return R(n.key,!1);case"values":return R(n.value,!1)}return R([n.key,n.value],!1)},!0),be=function(e){this.entries=[],this.url=null,void 0!==e&&(A(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Q(e,0)?re(e,1):e:T(e)))};be.prototype={type:U,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,o,a,u,s,c=this.entries,f=I(e);if(f)for(r=(t=x(e,f)).next;!(n=i(r,t)).done;){if(a=(o=x(k(n.value))).next,(u=i(a,o)).done||(s=i(a,o)).done||!i(a,o).done)throw new W("Expected sequence with length 2");K(c,{key:T(u.value),value:T(s.value)})}else for(var l in e)g(e,l)&&K(c,{key:l,value:T(e[l])})},parseQuery:function(e){if(e)for(var t,r,n=this.entries,i=te(e,"&"),o=0;o<i.length;)(t=i[o++]).length&&(r=te(t,"="),K(n,{key:le(Z(r)),value:le(Y(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],K(r,he(e.key)+"="+he(e.value));return Y(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Se=function(){h(this,ke);var e=B(this,new be(arguments.length>0?arguments[0]:void 0));u||(this.size=e.entries.length)},ke=Se.prototype;if(l(ke,{append:function(e,t){var r=j(this);C(arguments.length,2),K(r.entries,{key:T(e),value:T(t)}),u||this.size++,r.updateURL()},delete:function(e){for(var t=j(this),r=C(arguments.length,1),n=t.entries,i=T(e),o=r<2?void 0:arguments[1],a=void 0===o?o:T(o),s=0;s<n.length;){var c=n[s];if(c.key!==i||void 0!==a&&c.value!==a)s++;else if(ee(n,s,1),void 0!==a)break}u||(this.size=n.length),t.updateURL()},get:function(e){var t=j(this).entries;C(arguments.length,1);for(var r=T(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){var t=j(this).entries;C(arguments.length,1);for(var r=T(e),n=[],i=0;i<t.length;i++)t[i].key===r&&K(n,t[i].value);return n},has:function(e){for(var t=j(this).entries,r=C(arguments.length,1),n=T(e),i=r<2?void 0:arguments[1],o=void 0===i?i:T(i),a=0;a<t.length;){var u=t[a++];if(u.key===n&&(void 0===o||u.value===o))return!0}return!1},set:function(e,t){var r=j(this);C(arguments.length,1);for(var n,i=r.entries,o=!1,a=T(e),s=T(t),c=0;c<i.length;c++)(n=i[c]).key===a&&(o?ee(i,c--,1):(o=!0,n.value=s));o||K(i,{key:a,value:s}),u||(this.size=i.length),r.updateURL()},sort:function(){var e=j(this);_(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=j(this).entries,n=b(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new we(this,"keys")},values:function(){return new we(this,"values")},entries:function(){return new we(this,"entries")}},{enumerable:!0}),c(ke,M,ke.entries,{name:"entries"}),c(ke,"toString",function(){return j(this).serialize()},{enumerable:!0}),u&&f(ke,"size",{get:function(){return j(this).entries.length},configurable:!0,enumerable:!0}),d(Se,U),e({global:!0,constructor:!0,forced:!s},{URLSearchParams:Se}),!s&&m(q)){var Ae=o(z.has),Te=o(z.set),Ee=function(e){if(A(e)){var t,r=e.body;if(S(r)===U)return t=e.headers?new q(e.headers):new q,Ae(t,"content-type")||Te(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),E(e,{body:O(0,T(r)),headers:O(0,t)})}return e};if(m(D)&&e({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return D(e,arguments.length>1?Ee(arguments[1]):{})}}),m(F)){var Oe=function(e){return h(this,H),new F(e,arguments.length>1?Ee(arguments[1]):{})};H.constructor=Oe,Oe.prototype=H,e({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Oe})}}return yp={URLSearchParams:Se,getState:j}}function Ap(){if(wp)return lp;wp=1,Fo();var e,t=Nr(),r=y(),n=dp(),i=a(),o=go(),u=fe(),s=$t(),c=Io(),f=To(),l=ot(),d=function(){if(ip)return np;ip=1;var e=y(),t=fe(),r=w(),n=m(),i=Tn(),o=Lr(),a=se(),u=it(),s=de(),c=Object.assign,f=Object.defineProperty,l=t([].concat);return np=!c||n(function(){if(e&&1!==c({b:1},c(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},r={},n=Symbol("assign detection"),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(e){r[e]=e}),7!==c({},t)[n]||i(c({},r)).join("")!==o})?function(t,n){for(var c=u(t),f=arguments.length,d=1,p=o.f,v=a.f;f>d;)for(var h,m=s(arguments[d++]),y=p?l(i(m),p(m)):i(m),g=y.length,w=0;g>w;)h=y[w++],e&&!r(v,m,h)||(c[h]=m[h]);return c}:c,np}(),p=vp(),v=ui(),h=Do().codeAt,g=hp(),b=No(),S=Pn(),k=Mu(),A=kp(),T=Gt(),E=T.set,O=T.getterFor("URL"),x=A.URLSearchParams,I=A.getState,R=i.URL,C=i.TypeError,P=i.parseInt,_=Math.floor,M=Math.pow,U=u("".charAt),L=u(/./.exec),B=u([].join),j=u(1.1.toString),N=u([].pop),D=u([].push),F=u("".replace),q=u([].shift),H=u("".split),z=u("".slice),W=u("".toLowerCase),G=u([].unshift),V="Invalid scheme",$="Invalid host",J="Invalid port",Q=/[a-z]/i,Y=/[\d+-.a-z]/i,K=/\d/,X=/^0x/i,Z=/^[0-7]+$/,ee=/^\d+$/,te=/^[\da-f]+$/i,re=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,ie=/^[\u0000-\u0020]+/,oe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,ae=/[\t\n\r]/g,ue=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)G(t,e%256),e=_(e/256);return B(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r?n:t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=j(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},ce={},le=d({},ce,{" ":1,'"':1,"<":1,">":1,"`":1}),pe=d({},le,{"#":1,"?":1,"{":1,"}":1}),ve=d({},pe,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),he=function(e,t){var r=h(e,0);return r>32&&r<127&&!l(t,e)?e:encodeURIComponent(e)},me={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ye=function(e,t){var r;return 2===e.length&&L(Q,U(e,0))&&(":"===(r=U(e,1))||!t&&"|"===r)},ge=function(e){var t;return e.length>1&&ye(z(e,0,2))&&(2===e.length||"/"===(t=U(e,2))||"\\"===t||"?"===t||"#"===t)},we=function(e){return"."===e||"%2e"===W(e)},be=function(e){return".."===(e=W(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},Se={},ke={},Ae={},Te={},Ee={},Oe={},xe={},Ie={},Re={},Ce={},Pe={},_e={},Me={},Ue={},Le={},Be={},je={},Ne={},De={},Fe={},qe={},He=function(e,t,r){var n,i,o,a=b(e);if(t){if(i=this.parse(a))throw new C(i);this.searchParams=null}else{if(void 0!==r&&(n=new He(r,!0)),i=this.parse(a,null,n))throw new C(i);(o=I(new x)).bindURL(this),this.searchParams=o}};He.prototype={type:"URL",parse:function(t,r,n){var i,o,a,u,s=this,c=r||Se,f=0,d="",h=!1,m=!1,y=!1;for(t=b(t),r||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,t=F(t,ie,""),t=F(t,oe,"$1")),t=F(t,ae,""),i=p(t);f<=i.length;){switch(o=i[f],c){case Se:if(!o||!L(Q,o)){if(r)return V;c=Ae;continue}d+=W(o),c=ke;break;case ke:if(o&&(L(Y,o)||"+"===o||"-"===o||"."===o))d+=W(o);else{if(":"!==o){if(r)return V;d="",c=Ae,f=0;continue}if(r&&(s.isSpecial()!==l(me,d)||"file"===d&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=d,r)return void(s.isSpecial()&&me[s.scheme]===s.port&&(s.port=null));d="","file"===s.scheme?c=Ue:s.isSpecial()&&n&&n.scheme===s.scheme?c=Te:s.isSpecial()?c=Ie:"/"===i[f+1]?(c=Ee,f++):(s.cannotBeABaseURL=!0,D(s.path,""),c=De)}break;case Ae:if(!n||n.cannotBeABaseURL&&"#"!==o)return V;if(n.cannotBeABaseURL&&"#"===o){s.scheme=n.scheme,s.path=v(n.path),s.query=n.query,s.fragment="",s.cannotBeABaseURL=!0,c=qe;break}c="file"===n.scheme?Ue:Oe;continue;case Te:if("/"!==o||"/"!==i[f+1]){c=Oe;continue}c=Re,f++;break;case Ee:if("/"===o){c=Ce;break}c=Ne;continue;case Oe:if(s.scheme=n.scheme,o===e)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=v(n.path),s.query=n.query;else if("/"===o||"\\"===o&&s.isSpecial())c=xe;else if("?"===o)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=v(n.path),s.query="",c=Fe;else{if("#"!==o){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=v(n.path),s.path.length--,c=Ne;continue}s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=v(n.path),s.query=n.query,s.fragment="",c=qe}break;case xe:if(!s.isSpecial()||"/"!==o&&"\\"!==o){if("/"!==o){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,c=Ne;continue}c=Ce}else c=Re;break;case Ie:if(c=Re,"/"!==o||"/"!==U(d,f+1))continue;f++;break;case Re:if("/"!==o&&"\\"!==o){c=Ce;continue}break;case Ce:if("@"===o){h&&(d="%40"+d),h=!0,a=p(d);for(var g=0;g<a.length;g++){var w=a[g];if(":"!==w||y){var S=he(w,ve);y?s.password+=S:s.username+=S}else y=!0}d=""}else if(o===e||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()){if(h&&""===d)return"Invalid authority";f-=p(d).length+1,d="",c=Pe}else d+=o;break;case Pe:case _e:if(r&&"file"===s.scheme){c=Be;continue}if(":"!==o||m){if(o===e||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()){if(s.isSpecial()&&""===d)return $;if(r&&""===d&&(s.includesCredentials()||null!==s.port))return;if(u=s.parseHost(d))return u;if(d="",c=je,r)return;continue}"["===o?m=!0:"]"===o&&(m=!1),d+=o}else{if(""===d)return $;if(u=s.parseHost(d))return u;if(d="",c=Me,r===_e)return}break;case Me:if(!L(K,o)){if(o===e||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()||r){if(""!==d){var k=P(d,10);if(k>65535)return J;s.port=s.isSpecial()&&k===me[s.scheme]?null:k,d=""}if(r)return;c=je;continue}return J}d+=o;break;case Ue:if(s.scheme="file","/"===o||"\\"===o)c=Le;else{if(!n||"file"!==n.scheme){c=Ne;continue}switch(o){case e:s.host=n.host,s.path=v(n.path),s.query=n.query;break;case"?":s.host=n.host,s.path=v(n.path),s.query="",c=Fe;break;case"#":s.host=n.host,s.path=v(n.path),s.query=n.query,s.fragment="",c=qe;break;default:ge(B(v(i,f),""))||(s.host=n.host,s.path=v(n.path),s.shortenPath()),c=Ne;continue}}break;case Le:if("/"===o||"\\"===o){c=Be;break}n&&"file"===n.scheme&&!ge(B(v(i,f),""))&&(ye(n.path[0],!0)?D(s.path,n.path[0]):s.host=n.host),c=Ne;continue;case Be:if(o===e||"/"===o||"\\"===o||"?"===o||"#"===o){if(!r&&ye(d))c=Ne;else if(""===d){if(s.host="",r)return;c=je}else{if(u=s.parseHost(d))return u;if("localhost"===s.host&&(s.host=""),r)return;d="",c=je}continue}d+=o;break;case je:if(s.isSpecial()){if(c=Ne,"/"!==o&&"\\"!==o)continue}else if(r||"?"!==o)if(r||"#"!==o){if(o!==e&&(c=Ne,"/"!==o))continue}else s.fragment="",c=qe;else s.query="",c=Fe;break;case Ne:if(o===e||"/"===o||"\\"===o&&s.isSpecial()||!r&&("?"===o||"#"===o)){if(be(d)?(s.shortenPath(),"/"===o||"\\"===o&&s.isSpecial()||D(s.path,"")):we(d)?"/"===o||"\\"===o&&s.isSpecial()||D(s.path,""):("file"===s.scheme&&!s.path.length&&ye(d)&&(s.host&&(s.host=""),d=U(d,0)+":"),D(s.path,d)),d="","file"===s.scheme&&(o===e||"?"===o||"#"===o))for(;s.path.length>1&&""===s.path[0];)q(s.path);"?"===o?(s.query="",c=Fe):"#"===o&&(s.fragment="",c=qe)}else d+=he(o,pe);break;case De:"?"===o?(s.query="",c=Fe):"#"===o?(s.fragment="",c=qe):o!==e&&(s.path[0]+=he(o,ce));break;case Fe:r||"#"!==o?o!==e&&("'"===o&&s.isSpecial()?s.query+="%27":s.query+="#"===o?"%23":he(o,ce)):(s.fragment="",c=qe);break;case qe:o!==e&&(s.fragment+=he(o,le))}f++}},parseHost:function(e){var t,r,n;if("["===U(e,0)){if("]"!==U(e,e.length-1))return $;if(t=function(e){var t,r,n,i,o,a,u,s=[0,0,0,0,0,0,0,0],c=0,f=null,l=0,d=function(){return U(e,l)};if(":"===d()){if(":"!==U(e,1))return;l+=2,f=++c}for(;d();){if(8===c)return;if(":"!==d()){for(t=r=0;r<4&&L(te,d());)t=16*t+P(d(),16),l++,r++;if("."===d()){if(0===r)return;if(l-=r,c>6)return;for(n=0;d();){if(i=null,n>0){if(!("."===d()&&n<4))return;l++}if(!L(K,d()))return;for(;L(K,d());){if(o=P(d(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;l++}s[c]=256*s[c]+i,2!==++n&&4!==n||c++}if(4!==n)return;break}if(":"===d()){if(l++,!d())return}else if(d())return;s[c++]=t}else{if(null!==f)return;l++,f=++c}}if(null!==f)for(a=c-f,c=7;0!==c&&a>0;)u=s[c],s[c--]=s[f+a-1],s[f+--a]=u;else if(8!==c)return;return s}(z(e,1,-1)),!t)return $;this.host=t}else if(this.isSpecial()){if(e=g(e),L(re,e))return $;if(t=function(e){var t,r,n,i,o,a,u,s=H(e,".");if(s.length&&""===s[s.length-1]&&s.length--,(t=s.length)>4)return e;for(r=[],n=0;n<t;n++){if(""===(i=s[n]))return e;if(o=10,i.length>1&&"0"===U(i,0)&&(o=L(X,i)?16:8,i=z(i,8===o?1:2)),""===i)a=0;else{if(!L(10===o?ee:8===o?Z:te,i))return e;a=P(i,o)}D(r,a)}for(n=0;n<t;n++)if(a=r[n],n===t-1){if(a>=M(256,5-t))return null}else if(a>255)return null;for(u=N(r),n=0;n<r.length;n++)u+=r[n]*M(256,3-n);return u}(e),null===t)return $;this.host=t}else{if(L(ne,e))return $;for(t="",r=p(e),n=0;n<r.length;n++)t+=he(r[n],ce);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return l(me,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&ye(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,u=e.query,s=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=ue(i),null!==o&&(c+=":"+o)):"file"===t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+B(a,"/"):"",null!==u&&(c+="?"+u),null!==s&&(c+="#"+s),c},setHref:function(e){var t=this.parse(e);if(t)throw new C(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new ze(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+ue(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",Se)},getUsername:function(){return this.username},setUsername:function(e){var t=p(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=he(t[r],ve)}},getPassword:function(){return this.password},setPassword:function(e){var t=p(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=he(t[r],ve)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ue(e):ue(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Pe)},getHostname:function(){var e=this.host;return null===e?"":ue(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,_e)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=b(e))?this.port=null:this.parse(e,Me))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+B(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,je))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=b(e))?this.query=null:("?"===U(e,0)&&(e=z(e,1)),this.query="",this.parse(e,Fe)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=b(e))?("#"===U(e,0)&&(e=z(e,1)),this.fragment="",this.parse(e,qe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ze=function(e){var t=f(this,We),n=k(arguments.length,1)>1?arguments[1]:void 0,i=E(t,new He(e,!1,n));r||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},We=ze.prototype,Ge=function(e,t){return{get:function(){return O(this)[e]()},set:t&&function(e){return O(this)[t](e)},configurable:!0,enumerable:!0}};if(r&&(c(We,"href",Ge("serialize","setHref")),c(We,"origin",Ge("getOrigin")),c(We,"protocol",Ge("getProtocol","setProtocol")),c(We,"username",Ge("getUsername","setUsername")),c(We,"password",Ge("getPassword","setPassword")),c(We,"host",Ge("getHost","setHost")),c(We,"hostname",Ge("getHostname","setHostname")),c(We,"port",Ge("getPort","setPort")),c(We,"pathname",Ge("getPathname","setPathname")),c(We,"search",Ge("getSearch","setSearch")),c(We,"searchParams",Ge("getSearchParams")),c(We,"hash",Ge("getHash","setHash"))),s(We,"toJSON",function(){return O(this).serialize()},{enumerable:!0}),s(We,"toString",function(){return O(this).serialize()},{enumerable:!0}),R){var Ve=R.createObjectURL,$e=R.revokeObjectURL;Ve&&s(ze,"createObjectURL",o(Ve,R)),$e&&s(ze,"revokeObjectURL",o($e,R))}return S(ze,"URL"),t({global:!0,constructor:!0,forced:!n,sham:!r},{URL:ze}),lp}bp||(bp=1,Ap());var Tp,Ep={};!function(){if(Tp)return Ep;Tp=1;var e=Nr(),t=w();e({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return t(URL.prototype.toString,this)}})}();var Op;Op||(Op=1,kp());var xp,Ip={};!function(){if(xp)return Ip;xp=1;var e=Nr(),t=ra().filter;e({target:"Array",proto:!0,forced:!ai()("filter")},{filter:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)}})}();var Rp,Cp={};!function(){if(Rp)return Cp;Rp=1;var e=Nr(),t=ra().find,r=xn(),n="find",i=!0;n in[]&&Array(1)[n](function(){i=!1}),e({target:"Array",proto:!0,forced:i},{find:function(e){return t(this,e,arguments.length>1?arguments[1]:void 0)}}),r(n)}();var Pp,_p,Mp={};if(function(){if(Pp)return Mp;Pp=1;var e=Nr(),t=fe(),r=Oe(),n=it(),i=hr(),o=Ai(),a=No(),u=m(),s=Od(),c=Fr(),f=xd(),l=Id(),d=Se(),p=Rd(),v=[],h=t(v.sort),y=t(v.push),g=u(function(){v.sort(void 0)}),w=u(function(){v.sort(null)}),b=c("sort"),S=!u(function(){if(d)return d<70;if(!(f&&f>3)){if(l)return!0;if(p)return p<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)v.push({k:t+n,v:r})}for(v.sort(function(e,t){return t.v-e.v}),n=0;n<v.length;n++)t=v[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}});e({target:"Array",proto:!0,forced:g||!w||!b||!S},{sort:function(e){void 0!==e&&r(e);var t=n(this);if(S)return void 0===e?h(t):h(t,e);var u,c,f=[],l=i(t);for(c=0;c<l;c++)c in t&&y(f,t[c]);for(s(f,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:a(t)>a(r)?1:-1}}(e)),u=i(f),c=0;c<u;)t[c]=f[c++];for(;c<l;)o(t,c++);return t}})}(),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():e.StarmusAudioEditor=t()}("undefined"!=typeof window?window:globalThis,function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",r=document.getElementById("starmus-editor-notice");r&&(e?(r.textContent=e,r.className="starmus-alert starmus-alert--".concat(t),r.hidden=!1):r.hidden=!0)}function t(e){var t=Math.floor(e/60),r=Math.floor(e%60);return t+":"+String(r).padStart(2,"0")}return{init:function(){var r=window.STARMUS_EDITOR_DATA;if(r){var n=r.restUrl,i=r.nonce,o=r.postId,a=r.audioUrl,u=r.annotations,s=void 0===u?[]:u,c=document.getElementById("overview"),f=document.getElementById("zoomview"),l=document.getElementById("play"),d=document.getElementById("back5"),p=document.getElementById("fwd5"),v=document.getElementById("zoom-in"),h=document.getElementById("zoom-out"),m=document.getElementById("zoom-fit"),y=document.getElementById("loop"),g=document.getElementById("add-region"),w=document.getElementById("save"),b=document.getElementById("regions-list");document.getElementById("starmus-editor-notice");var S=document.getElementById("starmus-time-cur"),k=document.getElementById("starmus-time-dur");if(a&&c&&f&&l&&g&&w&&b){var A=!1,T=function(e){A=!!e,w.disabled=!A};T(!1),window.addEventListener("beforeunload",function(e){A&&(e.preventDefault(),e.returnValue="")});var E=new Audio(a);E.crossOrigin="anonymous",E.addEventListener("error",function(){return e("Audio load error â check CORS or URL.","error")}),E.addEventListener("loadedmetadata",function(){var r=E.duration;if(!isFinite(r)||r<=0)e("Invalid audio file â cannot initialize.","error");else{var a=function(e){var t=(e||[]).filter(function(e){return isFinite(e.startTime)&&isFinite(e.endTime)&&e.startTime>=0&&e.endTime>e.startTime&&e.endTime<=r});t.sort(function(e,t){return e.startTime-t.startTime});var n,i=[],o=-1,a=ga(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;s.startTime>=o&&(i.push({id:s.id||u(),startTime:s.startTime,endTime:s.endTime,label:(s.label||"").trim().slice(0,200)}),o=s.endTime)}}catch(e){a.e(e)}finally{a.f()}return i},u=function(){var e,t;return(null===(e=window.crypto)||void 0===e||null===(t=e.randomUUID)||void 0===t?void 0:t.call(e))||"id-"+Math.random().toString(36).slice(2)+Date.now()},O=a(s);"undefined"!=typeof Peaks?Peaks.init({containers:{overview:c,zoomview:f},mediaElement:E,webAudio:{audioContext:new(window.AudioContext||window.webkitAudioContext),multiChannel:!1},height:180,zoomLevels:[64,128,256,512,1024,2048],segments:O,keyboard:!1,showPlayheadTime:!0},function(s,c){if(s)return console.error("Peaks init error:",s),void e("Could not load editor (see console).","error");k.textContent=t(r),E.addEventListener("timeupdate",function(){S.textContent=t(E.currentTime)}),l.addEventListener("click",function(){return E.paused?E.play():E.pause()}),E.addEventListener("play",function(){l.textContent="Pause",l.setAttribute("aria-pressed","true")}),E.addEventListener("pause",function(){l.textContent="Play",l.setAttribute("aria-pressed","false")}),d.onclick=function(){return E.currentTime=Math.max(0,E.currentTime-5)},p.onclick=function(){return E.currentTime=Math.min(r,E.currentTime+5)},v.onclick=function(){return c.zoom.zoomIn()},h.onclick=function(){return c.zoom.zoomOut()},m.onclick=function(){return c.zoom.zoom(0)};var f=!1;y.onchange=function(){return f=y.checked},E.addEventListener("timeupdate",function(){if(f){var e=E.currentTime,t=c.segments.getSegments();if(t.length){var r=t.find(function(t){return e>=t.startTime&&e<t.endTime});r&&e>=r.endTime&&(E.currentTime=r.startTime)}}});var O=function(){var e=a(c.segments.getSegments());if(b.innerHTML="",!e.length)return b.innerHTML='<tr><td colspan="5">No annotations. Click âAdd Regionâ.</td></tr>',void T(!1);e.forEach(function(e){var t=document.createElement("tr");t.innerHTML='<td><input data-id="'.concat(e.id,'" data-key="label" value="').concat((""+e.label).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),'"/></td>')+'<td><input data-id="'.concat(e.id,'" data-key="startTime" value="').concat(e.startTime.toFixed(2),'" step="0.01"/></td>')+'<td><input data-id="'.concat(e.id,'" data-key="endTime" value="').concat(e.endTime.toFixed(2),'" step="0.01"/></td>')+"<td>".concat((e.endTime-e.startTime).toFixed(2),"s</td>")+'<td><button data-act="jump" data-id="'.concat(e.id,'">Jump</button> <button data-act="del" data-id="').concat(e.id,'">Delete</button></td>'),b.appendChild(t)}),T(!0)};b.addEventListener("input",function(e){var t=e.target.dataset.id,r=e.target.dataset.key;if(t&&r){var n=c.segments.getSegment(t);if(n){var i=e.target.value;("startTime"!==r&&"endTime"!==r||(i=parseFloat(i),!isNaN(i)))&&(n.update(wa({},r,i)),T(!0),O())}}}),b.addEventListener("click",function(e){var t=e.target.dataset.act,r=e.target.dataset.id;if(t&&r){var n=c.segments.getSegment(r);n&&("jump"===t?(E.currentTime=n.startTime,E.play()):"del"===t&&(c.segments.removeById(r),T(!0),O()))}}),g.onclick=function(){var e=E.currentTime||0,t=Math.max(0,e-2),n=Math.min(r,e+2);c.segments.add({id:u(),startTime:t,endTime:n,label:""}),O()},w.onclick=ha(ka().m(function t(){var r,u,s;return ka().w(function(t){for(;;)switch(t.p=t.n){case 0:if(A){t.n=1;break}return t.a(2);case 1:return T(!1),r=a(c.segments.getSegments()),t.p=2,t.n=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":i},body:JSON.stringify({postId:o,annotations:r})});case 3:return u=t.v,t.n=4,u.json();case 4:if(s=t.v,u.ok&&s.success){t.n=5;break}throw new Error(s.message);case 5:c.segments.removeAll(),c.segments.add(a(s.annotations||[])),O(),e("Annotations saved.","success"),t.n=7;break;case 6:t.p=6,e("Save failed: "+t.v.message,"error");case 7:return t.a(2)}},t,null,[[2,6]])})),O()}):e("Peaks.js not loaded â cannot initialize editor.","error")}})}else e("Missing required editor elements.","error")}else console.error("STARMUS_EDITOR_DATA not defined â cannot initialize.")}}}),window.STARMUS_EDITOR_DATA?(window.STARMUS_BOOTSTRAP=window.STARMUS_EDITOR_DATA,window.STARMUS_BOOTSTRAP.pageType="editor"):window.STARMUS_RERECORDER_DATA?(window.STARMUS_BOOTSTRAP=window.STARMUS_RERECORDER_DATA,window.STARMUS_BOOTSTRAP.pageType="rerecorder"):window.STARMUS_RECORDER_DATA&&(window.STARMUS_BOOTSTRAP=window.STARMUS_RECORDER_DATA,window.STARMUS_BOOTSTRAP.pageType="recorder"),window.Starmus_DisableOptionalNodes=!0,window.Starmus_DisableOptionalNodes){var Up,Lp=null===(Up=window.AudioContext||window.webkitAudioContext)||void 0===Up?void 0:Up.prototype;Lp&&(Lp.createConstantSource&&(Lp.createConstantSource=function(){throw new Error("ConstantSourceNode disabled for stability.")}),Lp.createIIRFilter&&(Lp.createIIRFilter=function(){throw new Error("IIRFilterNode disabled for stability.")}))}function Bp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{window.StarmusHooks&&"function"==typeof window.StarmusHooks.doAction&&window.StarmusHooks.doAction("starmus_event",{instanceId:t.instanceId||null,event:e,severity:t.severity||"info",message:t.message||"",data:t.data||{}})}catch(e){console.warn("[Starmus] Global telemetry emit failed:",e)}}function jp(e){return Np.apply(this,arguments)}function Np(){return(Np=ha(ka().m(function e(t){return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:if("suspended"!==t.state){e.n=6;break}return e.p=2,e.n=3,t.resume();case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:console.log("[Starmus] AudioContext resumed");case 6:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function Dp(){try{return navigator.deviceMemory||null}catch(e){return null}}function Fp(){try{return navigator.hardwareConcurrency||null}catch(e){return null}}function qp(e){var t=e.capabilities||{},r=e.network||{};if(/\bCrOS\b|Chrome OS/i.test(navigator.userAgent))return"A";if(!t.mediaRecorder||!t.webrtc)return"C";var n=Dp(),i=Fp();if(null!=n&&n<1)return"C";if(null!=i){if(1===i)return"C";if(2===i)return"B"}return/wv|Crosswalk|Android WebView|Opera Mini/i.test(navigator.userAgent)?"C":"2g"===r.effectiveType||"slow-2g"===r.effectiveType||null!=n&&n<2?"B":"A"}function Hp(e){return zp.apply(this,arguments)}function zp(){return(zp=ha(ka().m(function e(t){var r,n;return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:if("C"!==t){e.n=1;break}return e.a(2,"C");case 1:if(!navigator.storage||!navigator.storage.estimate){e.n=6;break}return e.p=2,e.n=3,navigator.storage.estimate();case 3:if(r=e.v,!((n=(r.quota||0)/1024/1024)&&n<80)){e.n=4;break}return e.a(2,"C");case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:if(!navigator.permissions||!navigator.permissions.query){e.n=11;break}return e.p=7,e.n=8,navigator.permissions.query({name:"microphone"});case 8:if("denied"!==e.v.state){e.n=9;break}return e.a(2,"C");case 9:e.n=11;break;case 10:e.p=10,e.v;case 11:return e.a(2,t)}},e,null,[[7,10],[2,5]])}))).apply(this,arguments)}function Wp(e,t){var r,n=e.getState(),i=n.env||{},o=n.calibration||{},a=n.source||{},u=function(e,r){var n=t.querySelector('[name="'.concat(e,'"]'));n&&(n.value=r)};i&&Object.keys(i).length>0&&u("_starmus_env",JSON.stringify(i)),o.complete&&u("_starmus_calibration",JSON.stringify(o)),a.transcript&&u("first_pass_transcription",a.transcript.trim()),a.waveform_data&&u("waveform_json",JSON.stringify(a.waveform_data)),u("user_agent",navigator.userAgent||""),u("device_fingerprint",(null==i||null===(r=i.identifiers)||void 0===r?void 0:r.visitorId)||"")}window.tus=e,window.Peaks=t,window.PeaksVersion=t.prototype?"loaded":"missing",(_p="undefined"!=typeof window?window:globalThis).Starmus||(_p.Starmus={}),_p.Starmus.Peaks=t,window.SPARXSTAR=window.SPARXSTAR||{},window.SPARXSTAR.StarmusReady=!0,bc().then(function(){return console.log("[Starmus] Offline queue initialized")}).catch(function(e){return console.error("[Starmus] Offline queue init failed:",e)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),window.StarmusApp=window.StarmusApp||{},window.StarmusApp.isRecordingSupported=function(){try{var e=!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),t=!!window.MediaRecorder,r=!(!window.AudioContext&&!window.webkitAudioContext);return e&&t&&r}catch(e){return!1}};var Gp=new Map;function Vp(e,t){return $p.apply(this,arguments)}function $p(){return $p=ha(ka().m(function e(t,r){var n,i,o,a,u,s,c,f;return ka().w(function(e){for(;;)switch(e.n){case 0:if((n=r.getAttribute("data-starmus-id"))||(n="starmus_"+Date.now()+"_"+Math.random().toString(16).slice(2),r.setAttribute("data-starmus-id",n)),!Gp.has(n)){e.n=1;break}return e.a(2,n);case 1:return i=qp(t),e.n=2,Hp(i);case 2:return i=e.v,console.log("[Starmus] Instance ".concat(n," â Tier ").concat(i)),Bp("TIER_ASSIGN",{instanceId:n,severity:"info",message:"Tier ".concat(i," assigned"),data:{tier:i}}),o=da({instanceId:n,env:t,tier:i}),a={step1:r.querySelector(".starmus-step-1"),step2:r.querySelector(".starmus-step-2"),continueBtn:r.querySelector('[data-starmus-action="continue"]'),messageBox:r.querySelector("[data-starmus-message-box]"),setupMicBtn:r.querySelector('[data-starmus-action="setup-mic"]'),setupContainer:r.querySelector("[data-starmus-setup-container]"),recordBtn:r.querySelector('[data-starmus-action="record"]'),pauseBtn:r.querySelector('[data-starmus-action="pause"]'),resumeBtn:r.querySelector('[data-starmus-action="resume"]'),stopBtn:r.querySelector('[data-starmus-action="stop"]'),submitBtn:r.querySelector('[data-starmus-action="submit"]'),resetBtn:r.querySelector('[data-starmus-action="reset"]'),fileInput:r.querySelector('input[type="file"]'),statusEl:r.querySelector("[data-starmus-status]"),progressEl:r.querySelector("[data-starmus-progress]"),progressWrap:r.querySelector(".starmus-progress-wrap"),recorderContainer:r.querySelector("[data-starmus-recorder-container]"),fallbackContainer:r.querySelector("[data-starmus-fallback-container]"),timer:r.querySelector("[data-starmus-timer]"),timerElapsed:r.querySelector(".starmus-timer-elapsed"),durationProgress:r.querySelector("[data-starmus-duration-progress]"),volumeMeter:r.querySelector("[data-starmus-volume-meter]"),waveformBox:r.querySelector("[data-starmus-waveform]"),reviewControls:r.querySelector(".starmus-review-controls"),playBtn:r.querySelector('[data-starmus-action="play"]'),transcriptBox:r.querySelector("[data-starmus-transcript]")},"C"===i&&(a.recorderContainer&&(a.recorderContainer.style.display="none"),a.fallbackContainer&&(a.fallbackContainer.style.display="block"),null!==(u=window.StarmusHooks)&&void 0!==u&&u.doAction&&window.StarmusHooks.doAction("starmus_tier_c_revealed",n,t)),Fc(o,a),df(o,n,t),"C"!==i&&Gd(o,n),Gp.set(n,{store:o,form:r,elements:a,tier:i}),o.subscribe(function(){var e=o.getState();if("C"===e.tier&&"C"!==i&&!0===e.fallbackActive){var t=i;i="C",a.recorderContainer&&(a.recorderContainer.style.display="none"),a.fallbackContainer&&(a.fallbackContainer.style.display="block"),console.warn("[Starmus] Instance ".concat(n," downgraded from ").concat(t," â C")),Bp("TIER_DOWNGRADE",{instanceId:n,severity:"warning",message:"Runtime tier downgrade from ".concat(t," to C"),data:{previousTier:t,currentTier:"C",reason:"audio_graph_failure"}})}}),s="A"===i&&!(!window.SpeechRecognition&&!window.webkitSpeechRecognition),o.dispatch({type:"starmus/init",payload:{instanceId:n,env:t,tier:i,speechSupported:s}}),a.continueBtn&&a.continueBtn.addEventListener("click",function(e){e.preventDefault();var t=a.step1;if(t){var i=t.querySelector('[name="starmus_title"]'),u=t.querySelector('[name="starmus_language"]'),s=t.querySelector('[name="starmus_recording_type"]'),c=t.querySelector('[name="agreement_to_terms"]'),f=a.messageBox,l=[];if(i&&i.value.trim()||l.push("Title"),u&&u.value.trim()||l.push("Language"),s&&s.value.trim()||l.push("Recording Type"),c&&c.checked||l.push("Consent"),l.length>0)f&&(f.textContent="Missing: "+l.join(", "),f.style.display="block");else if(f&&(f.textContent="",f.style.display="none"),o.dispatch({type:"starmus/ui/step-continue"}),window.innerWidth<768){var d=r.closest(".starmus-recorder-form")||r;d.classList.add("starmus-immersive"),document.body.classList.add("starmus-lock-scroll"),history.pushState({starmusMode:"immersive",instanceId:n},"","#recording-mode");var p=function(){d.classList.remove("starmus-immersive"),document.body.classList.remove("starmus-lock-scroll");var e=d.querySelector(".starmus-close-immersive");e&&e.remove(),window.removeEventListener("popstate",p)};if(window.addEventListener("popstate",p),!d.querySelector(".starmus-close-immersive")){var v=document.createElement("button");v.innerHTML="&times;",v.className="starmus-close-immersive",v.setAttribute("aria-label","Close fullscreen mode"),v.onclick=function(e){e.preventDefault(),history.back()},d.style.position="relative",d.insertBefore(v,d.firstChild)}}}}),"true"===r.dataset.starmusRerecord&&o.dispatch({type:"starmus/ui/step-continue"}),"C"!==i&&(a.setupMicBtn&&a.setupMicBtn.addEventListener("click",function(){var e=ha(ka().m(function e(t){var r,i;return ka().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),!(r=window.AudioContext||window.webkitAudioContext)){e.n=1;break}return i=new r({latencyHint:"interactive"}),e.n=1,jp(i);case 1:fa.dispatch("setup-mic",{},{instanceId:n});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),a.recordBtn&&a.recordBtn.addEventListener("click",function(){var e=ha(ka().m(function e(t){var r,i;return ka().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),!(r=window.AudioContext||window.webkitAudioContext)){e.n=1;break}return i=new r({latencyHint:"interactive"}),e.n=1,jp(i);case 1:fa.dispatch("start-recording",{},{instanceId:n});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),a.pauseBtn&&a.pauseBtn.addEventListener("click",function(e){e.preventDefault(),fa.dispatch("pause-mic",{},{instanceId:n})}),a.resumeBtn&&a.resumeBtn.addEventListener("click",function(e){e.preventDefault(),fa.dispatch("resume-mic",{},{instanceId:n})}),a.stopBtn&&a.stopBtn.addEventListener("click",function(e){e.preventDefault(),fa.dispatch("stop-mic",{},{instanceId:n})})),a.fileInput&&a.fileInput.addEventListener("change",function(){var e,t=null===(e=a.fileInput.files)||void 0===e?void 0:e[0];t&&fa.dispatch("attach-file",{file:t},{instanceId:n})}),r.addEventListener("submit",function(e){e.preventDefault(),Wp(o,r);var t=new FormData(r),i={};t.forEach(function(e,t){return i[t]=e}),fa.dispatch("submit",{formFields:i},{instanceId:n})}),a.resetBtn&&a.resetBtn.addEventListener("click",function(e){e.preventDefault(),o.dispatch({type:"starmus/reset"}),fa.dispatch("reset",{},{instanceId:n})}),c=null,f=null,a.playBtn&&a.playBtn.addEventListener("click",function(e){var t;e.preventDefault();var r=o.getState().source||{},n=r.blob||r.file;n&&(c||(c=new Audio,f=URL.createObjectURL(n),c.src=f,c.addEventListener("ended",function(){o.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!1}})})),(null===(t=o.getState().recorder)||void 0===t?void 0:t.isPlaying)?(c.pause(),o.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!1}})):c.play().then(function(){o.dispatch({type:"starmus/recorder-playback-state",payload:{isPlaying:!0}})}).catch(function(e){return console.error("[Starmus] Playback failed:",e)}))}),fa.subscribe("reset",function(e,t){if(t.instanceId===n){if(c)try{c.pause()}catch(e){}f&&URL.revokeObjectURL(f),c=null,f=null}}),e.a(2,n)}},e)})),$p.apply(this,arguments)}function Jp(e){return Qp.apply(this,arguments)}function Qp(){return(Qp=ha(ka().m(function e(t){var r,n,i,o,a,u;return ka().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=t.detail||{},null!=(n=document.querySelectorAll('form[data-starmus="recorder"]'))&&n.length){e.n=1;break}return e.a(2);case 1:i=ga(n),e.p=2,i.s();case 3:if((o=i.n()).done){e.n=5;break}return a=o.value,e.n=4,Vp(r,a);case 4:e.n=3;break;case 5:e.n=7;break;case 6:e.p=6,u=e.v,i.e(u);case 7:return e.p=7,i.f(),e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}))).apply(this,arguments)}function Yp(){var e=function(){try{return navigator.connection||navigator.mozConnection||navigator.webkitConnection||null}catch(e){return null}}(),t=e?{effectiveType:e.effectiveType||"unknown",downlink:e.downlink||null,saveData:e.saveData||!1}:{effectiveType:"unknown",downlink:null,saveData:!1},r={browser:{userAgent:navigator.userAgent},device:{type:/mobile|android|iphone|ipad/i.test(navigator.userAgent)?"mobile":"desktop",memory:Dp(),concurrency:Fp()},capabilities:{webrtc:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),mediaRecorder:!(!navigator.mediaDevices||!window.MediaRecorder),indexedDB:!!window.indexedDB},network:t};Bp("E_ENV_FALLBACK_INIT",{severity:"warning",message:"Environment-ready event not fired; using fallback env",data:{fallbackEnv:r}}),Jp({detail:r})}var Kp=!1,Xp=null;document.addEventListener("sparxstar:environment-ready",function(e){Kp=!0,Xp&&(clearTimeout(Xp),Xp=null),Jp(e)}),Xp=setTimeout(function(){Kp||(console.warn("[Starmus] Using fallback initialization"),Yp())},2e3),"undefined"!=typeof window&&(window.STARMUS=window.STARMUS||{},window.STARMUS.instances=Gp,window.StarmusHooks=window.StarmusHooks||{doAction:fa.dispatch},window.CommandBus=fa),window.createStore=da,window.initCore=df,window.initUI=Fc,window.initRecorder=Gd,window.StarmusTus=ic,window.StarmusTranscriptController=Jd,window.StarmusOfflineQueue=bc,window.StarmusQueueSubmission=kc,window.initOffline=Oc,window.initAutoMetadata=ep,window.StarmusIntegrator=!0,window.StarmusRecorder=Gd,window.initStarmusRecorder=Gd,console.log("[Starmus] Runtime globals wired");export{Jd as StarmusTranscript,ic as StarmusTus,da as createStore,bc as getOfflineQueue,ep as initAutoMetadata,df as initCore,Oc as initOffline,Gd as initRecorder,Fc as initUI,kc as queueSubmission};
