// ==== starmus-audio-recorder-module.js ====
// Build Hash (SHA-1):   ed6cf5f91ebcedfa0a20cf6872e9fa79053c50fc
// Build Hash (SHA-256): 6e814c99351dfa7c1eb6dbadf319cc80769e77cea028050be31496ab33c1adb4
// Build Time: 2025-09-10T21:14:04.883Z

!function(){buildHash: 'ed6cf5f91ebcedfa0a20cf6872e9fa79053c50fc',
  "use strict";if(!(window.MediaRecorder&&window.Promise&&window.fetch)){Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var r=0;r<this.length;r++)this.hasOwnProperty(r)&&e.call(t,this[r],r,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var e="[Starmus Submissions]",t=void 0!==window.STARMUS_DEBUG&&window.STARMUS_DEBUG,r={};"loading"===document.readyState?document.addEventListener?document.addEventListener("DOMContentLoaded",a):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()}):a()}function i(e){if("string"!=typeof e)try{return JSON.stringify(e).substring(0,100)}catch(t){return String(e).substring(0,100)}return e.replace(/[\u0000-\u001F\u007F<>"'&]/g," ").substring(0,100)}function n(e,t,r,n){if("undefined"!=typeof console&&console[e]){var o=i(r),s=n?i(n):"";console[e](t,o,s)}}function o(e){if(!r.hasOwnProperty(e)){var t=document.getElementById(e);r[e]=t||null}return r[e]}function s(e,t,r){var n=o("starmus_user_message_"+e);if(!n){(n=document.createElement("div")).id="starmus_user_message_"+e,n.className="starmus-user-message",n.setAttribute("role","alert"),n.setAttribute("aria-live","polite");var s=o(e);s&&s.insertBefore(n,s.firstChild)}n.textContent=i(t),n.className="starmus-user-message starmus-message-"+(r||"info"),n.style.display="block";var a=n.getAttribute("data-timeout-id");if(a&&clearTimeout(parseInt(a,10)),"error"!==r){var u=setTimeout(function(){n&&(n.style.display="none",n.removeAttribute("data-timeout-id"))},5e3);n.setAttribute("data-timeout-id",String(u))}}function a(){var t=document.querySelectorAll("[data-enabled-recorder]");if(0!==t.length){for(var r=[],i=0;i<t.length;i++)r.push(t[i]);r.forEach(function(t){var r=t.id.substring(21),i=o(r);i?function(t,r){if("1"===t.getAttribute("data-starmus-bound"))return;t.setAttribute("data-starmus-bound","1");var i=t.querySelector("#starmus_step1_"+r),a=t.querySelector("#starmus_step2_"+r),m=t.querySelector("#starmus_continue_btn_"+r),y={step1:i,step2:a,continueBtn:m,errorDiv:t.querySelector("#starmus_step1_error_"+r),statusDiv:t.querySelector("#starmus_step1_status_"+r),submitBtn:t.querySelector("#submit_button_"+r),loaderDiv:t.querySelector("#starmus_loader_overlay_"+r)};if(!i||!a||!m)return n("error",e,"Multi-step form elements missing, defaulting to recorder"),i&&(i.style.display="none"),a&&(a.style.display="block"),void c(r);var v=[{id:"audio_title_"+r,name:"Title",type:"text"},{id:"language_"+r,name:"Language",type:"select"},{id:"recording_type_"+r,name:"Recording Type",type:"select"},{id:"audio_consent_"+r,name:"Consent",type:"checkbox"}],p={};v.forEach(function(e){p[e.id]=o(e.id)}),m.addEventListener("click",function(e){e.preventDefault(),function(e,t,r,i){e.errorDiv&&(e.errorDiv.style.display="none",e.errorDiv.textContent="");for(var n=0;n<r.length;n++){var o=t[r[n].id];o&&o.removeAttribute&&o.removeAttribute("aria-describedby")}for(var s=0;s<r.length;s++){var a=r[s],l=t[a.id];if(l)if(!u(l,a.type))return void d(e.errorDiv,a.name,l,i)}!function(e,t){e.step1.style.display="none",e.step2.style.display="block";var r=document.getElementById("starmus_audioRecorderHeading_"+t);r&&(r.setAttribute("tabindex","-1"),r.focus&&r.focus());c(t)}(e,i)}(y,p,v,r)}),t.addEventListener("submit",function(t){t.preventDefault(),function(t,r){if(void 0!==window.StarmusAudioRecorder&&"function"==typeof window.StarmusAudioRecorder.submit){t.submitBtn&&(t.submitBtn.disabled=!0),t.loaderDiv&&t.loaderDiv.classList.remove("starmus_visually_hidden");var i=window.StarmusAudioRecorder.submit(r);i&&"function"==typeof i.then?i.then(function(e){l(e,t,r)}).catch(function(i){n("error",e,"Submit failed",i.message||i),f(t,r,i)}):setTimeout(function(){l(i,t,r)},500)}else s(r,"Submission handler is not available. Please contact support.","error")}(y,r)})}(i,r):n("error",e,"Form element not found for instance ID",r)})}}function u(t,r){if(!t)return!1;try{if("function"==typeof t.checkValidity&&!t.checkValidity())return!1;switch(r){case"text":return t.value&&""!==t.value.trim();case"select":return""!==t.value;case"checkbox":return t.checked;default:return!0}}catch(r){return n("error",e,"Validation error",t.id||"unknown"),!1}}function d(e,t,r,n){if(e){var o=i(t);e.textContent='Please complete the "'+o+'" field.',e.style.display="block"}r&&r.focus&&(r.focus(),r.setAttribute&&e&&e.id&&r.setAttribute("aria-describedby",e.id))}function c(r){if(void 0!==window.StarmusAudioRecorder&&"function"==typeof window.StarmusAudioRecorder.init){var i=window.StarmusAudioRecorder.init({formInstanceId:r});i&&"function"==typeof i.then?i.then(function(i){i&&t&&n("log",e,"Recorder module initialized for",r)}).catch(function(t){n("error",e,"Recorder initialization failed",t.message||t),s(r,"Audio recorder failed to initialize. Please refresh the page.","error")}):i||(n("error",e,"Recorder initialization returned falsy value"),s(r,"Audio recorder failed to initialize. Please refresh the page.","error"))}else n("error",e,"StarmusAudioRecorder module not available"),s(r,"Audio recorder is not available. Please refresh the page.","error")}function l(t,r,i){if(r.loaderDiv&&r.loaderDiv.classList.add("starmus_visually_hidden"),t&&t.success)if(t.redirectUrl)!function(e){if("string"!=typeof e||0===e.length)return!1;if(e.startsWith("/"))return!0;try{return new URL(e,window.location.origin).origin===window.location.origin}catch(e){return!1}}(t.redirectUrl)?(n("warn",e,"Invalid redirect URL blocked",t.redirectUrl),s(i,"Successfully submitted!","success")):window.location.href=t.redirectUrl;else{s(i,"Successfully submitted!","success");var a=o(i);a&&a.reset&&a.reset(),void 0!==window.StarmusAudioRecorder&&"function"==typeof window.StarmusAudioRecorder.cleanup&&window.StarmusAudioRecorder.cleanup(i)}else f(r,i,new Error("Invalid result"))}function f(t,r,i){t.submitBtn&&(t.submitBtn.disabled=!1),t.loaderDiv&&t.loaderDiv.classList.add("starmus_visually_hidden");i&&i.message&&n("error",e,"Submit error details",i.message),s(r,"Submission failed. Please try again.","error")}}();