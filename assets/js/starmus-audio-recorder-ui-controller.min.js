// ==== starmus-audio-recorder-module.js ====
// Build Hash (SHA-1):   384a19619295c3c346125980f141f8aac4dcb997
// Build Hash (SHA-256): 450a72214c13b9f66669dec0e6a890638e48c1cca5f57513cc4dea78076fb263
// Build Time: 2025-09-10T21:14:04.881Z

!function(t,e){buildHash: '384a19619295c3c346125980f141f8aac4dcb997',
  "use strict";function n(t,e,n){console&&console[t]&&console[t]("[Starmus UI Controller]",e,n||"")}function o(t){return e.getElementById(t)}function r(t){return"string"!=typeof t?"":t.replace(/[\u0000-\u001F\u007F<>"'&]/g," ").substring(0,200)}function i(t,e,n){const i=o("starmus_step1_usermsg_"+t);i&&(i.textContent=r(e),i.setAttribute("data-status",n||"info"))}function u(t){if(!t)return!1;try{switch(t.type){case"text":case"textarea":return t.value&&""!==t.value.trim();case"select-one":return""!==t.value;case"checkbox":return t.checked;default:return!0}}catch(e){return n("error","Validation error for field",t.id||"unknown"),!1}}function s(e){const s=o("starmus_step1_"+e),a=o("starmus_step2_"+e),c=o("starmus_continue_btn_"+e),l=o("starmus_step1_usermsg_"+e);if(!s||!a||!c)return;let d=!0;const f=s.querySelectorAll("[required]");for(const t of f)if(!u(t)){d=!1;const e=s.querySelector('label[for="'+t.id+'"]'),o=e?e.textContent.replace("*","").trim():"A required field";l?(l.textContent='Please complete the "'+r(o)+'" field.',l.setAttribute("data-status","error")):n("error","Validation failed for:",r(o)),"function"==typeof t.focus&&t.focus();break}d&&(c.disabled=!0,i(e,"Capturing location...","info"),function(t){return new Promise(function(e){const r=o(t);if(!r||"undefined"==typeof navigator||!navigator.geolocation)return n("warn","Geolocation not available in this browser."),e(!0);const i=r.querySelector('input[name="gps_latitude"]'),u=r.querySelector('input[name="gps_longitude"]');if(!i||!u)return n("warn","GPS hidden fields not found in form.",t),e(!0);const s={timeout:8e3,maximumAge:3e5,enableHighAccuracy:!1};let a=!1;const c=setTimeout(function(){a||(a=!0,n("warn","Geolocation request timed out."),e(!0))},s.timeout+1e3);navigator.geolocation.getCurrentPosition(function(t){a||(a=!0,clearTimeout(c),t&&t.coords&&(i.value=t.coords.latitude,u.value=t.coords.longitude,n("log","Geolocation captured successfully.")),e(!0))},function(t){a||(a=!0,clearTimeout(c),n("warn","Geolocation failed.",t.message),e(!0))},s)})}(e).then(function(){c.disabled=!1,i(e,"","info"),s.style.display="none",a.style.display="block",t.StarmusAudioRecorder&&"function"==typeof t.StarmusAudioRecorder.init&&t.StarmusAudioRecorder.init({formInstanceId:e}).then(function(t){i(e,"Recorder ready.","info")}).catch(function(t){n("error","Engine init failed",t&&t.message)})}))}function a(e){const r=e.id;if("string"!=typeof(i=r)||!/^[A-Za-z0-9_-]{1,100}$/.test(i))return;var i;if("1"===e.getAttribute("data-starmus-bound"))return;e.setAttribute("data-starmus-bound","1");const u=o("starmus_continue_btn_"+r);u&&u.addEventListener("click",function(){s(r)});try{e.addEventListener("submit",function(o){o.preventDefault(),t.StarmusSubmissionsHandler&&"function"==typeof t.StarmusSubmissionsHandler.handleSubmit?t.StarmusSubmissionsHandler.handleSubmit(r,e):n("error","Submission handler module not available.")})}catch(t){n("error","Failed to bind form submission",t.message)}}function c(){try{const t=e.querySelectorAll("form.starmus-audio-form");if(t&&t.length>0)for(let e=0;e<t.length;e++){const n=t[e];n&&n.id&&a(n)}}catch(t){n("error","Failed to initialize forms.",t.message)}}"loading"===e.readyState?e.addEventListener("DOMContentLoaded",c):c()}(window,document);