# StarmusAdmin

**Namespace:** `Starisian\Sparxstar\Starmus\admin`

**File:** `/workspaces/starmus-audio-recorder/src/admin/StarmusAdmin.php`

## Description

Starmus Admin Handler - Refactored for Security & Performance
@package Starisian\Sparxstar\Starmus\admin
@version 0.9.2
@since 0.3.1

## Methods

### `__construct()`

**Visibility:** `public`

Starmus Admin Handler - Refactored for Security & Performance
@package Starisian\Sparxstar\Starmus\admin
@version 0.9.2
@since 0.3.1
/
namespace Starisian\Sparxstar\Starmus\admin;

if ( ! \defined( 'ABSPATH' ) ) {
	return;
}

use Starisian\Sparxstar\Starmus\data\interfaces\IStarmusAudioDAL;
use Starisian\Sparxstar\Starmus\core\StarmusSettings;

/**
Secure and optimized admin settings class.
/
class StarmusAdmin {

	/**
Menu slug for the plugin settings page.
@var string
/
	public const STARMUS_MENU_SLUG = 'starmus-admin';

	/**
Settings group identifier for WordPress options API.
@var string
/
	public const STARMUS_SETTINGS_GROUP = 'starmus_settings_group';

	// DELETED: const STARMUS_OPTION_KEY =   <-- This line should be gone.

	/**
Mapping of option keys to field types for rendering.
@var array<string, string>
/
	private array $field_types = array();

	/**
Settings service instance.
/
	private ?StarmusSettings $settings = null;

	/**
Data Access Layer instance.
/
	private ?\Starisian\Sparxstar\Starmus\data\interfaces\IStarmusAudioDAL $dal = null;

	/**
Constructor - initializes admin settings and hooks.
Sets up DAL and Settings dependencies, defines field type mappings,
and registers admin hooks for menu and settings registration.
@param IStarmusAudioDAL $DAL Data Access Layer instance.
@param StarmusSettings $settings Settings service instance.
@throws \Throwable If initialization fails.
@return void
@since 0.3.1

### `add_admin_menu()`

**Visibility:** `public`

Add admin menu with error handling.
@since 0.3.1

### `render_settings_page()`

**Visibility:** `public`

Render admin settings page with CSRF protection.
REVERTED: Back to standard settings page rendering using WordPress Settings API.
Checks user capabilities, displays settings form with nonce fields,
and handles error display.

### `register_settings()`

**Visibility:** `public`

Register plugin settings with WordPress Settings API.
REVERTED: This method is now back to its original purpose.
Registers the main option, adds settings sections and fields.
Called on 'admin_init' hook.

### `sanitize_settings()`

**Visibility:** `public`

Sanitize and validate settings on save.
REVERTED: This is the callback for register_setting.
ADDED: Cache clearing after sanitization.
Validates all input fields, applies appropriate sanitization,
converts page slugs to IDs, and returns sanitized array.
@param array<string, mixed> $input Raw input from settings form.
@return array<string, mixed> Sanitized settings array.

### `render_field()`

**Visibility:** `public`

Render form field with validation.
REVERTED: Field name is back to using STARMUS_OPTION_KEY for Settings API.
@param array<string,mixed> $args Field arguments.

## Properties

---

_Generated by Starisian Documentation Generator_
