# StarmusAudioProcessingHandler

**Namespace:** `Starisian\Sparxstar\Starmus\services`

**File:** `/workspaces/starmus-audio-recorder/src/services/StarmusAudioProcessingHandler.php`

## Description

Full post-save transcoding, mastering, archival, ID3, waveform generation.
@package Starisian\Sparxstar\Starmus\services
@version 0.8.5-dal

## Methods

### `star_process_and_archive_audio()`

**Visibility:** `public`

Full post-save transcoding, mastering, archival, ID3, waveform generation.
@package Starisian\Sparxstar\Starmus\services
@version 0.8.5-dal
/

namespace Starisian\Sparxstar\Starmus\services;

use Starisian\Sparxstar\Starmus\helpers\StarmusLogger;
use Starisian\Sparxstar\Starmus\data\StarmusAudioRecorderDAL;

if (! defined('ABSPATH')) {
	exit;
}

final readonly class StarmusAudioProcessingHandler
{

	private StarmusAudioProcessingService $audio_processing_service;

	private StarmusFileService $file_service;

	private StarmusWaveformService $waveform_service;

	private StarmusAudioRecorderDAL $dal;

	public function __construct()
	{
		$this->dal                      = new StarmusAudioRecorderDAL();
		$this->audio_processing_service = new StarmusAudioProcessingService($this->dal);
		$this->file_service             = new StarmusFileService($this->dal);
		$this->waveform_service         = new StarmusWaveformService();
	}

	public function star_is_tool_available(): bool
	{
		$path = shell_exec('command -v ffmpeg');
		return !in_array(trim((string) $path), ['', '0'], true);
	}

	public function process_and_archive_audio(int $audio_post_id, int $attachment_id, array $options = []): bool
	{
		return $this->star_process_and_archive_audio($audio_post_id, $attachment_id, $options);
	}

	/**
Transcode to WAV (archival) + MP3 (distribution), ID3, waveform, and metadata persistence.

---

_Generated by Starisian Documentation Generator_
