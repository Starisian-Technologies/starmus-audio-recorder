# StarmusSchemaMapper

**Namespace:** `Starisian\Sparxstar\Starmus\data\mappers`

**File:** `/workspaces/starmus-audio-recorder/src/data/mappers/StarmusSchemaMapper.php`

## Description

Schema Mapper for Starmus Audio System.
Acts as a Key Translator for the NEW Schema.
Works in tandem with StarmusSanitizer to ensure LEGACY keys are also generated.
@package Starisian\Sparxstar\Starmus\data\mappers
@version 1.1.1

## Methods

### `map_form_data()`

**Visibility:** `public`

Schema Mapper for Starmus Audio System.
Acts as a Key Translator for the NEW Schema.
Works in tandem with StarmusSanitizer to ensure LEGACY keys are also generated.
@package Starisian\Sparxstar\Starmus\data\mappers
@version 1.1.1
/

declare(strict_types=1);
namespace Starisian\Sparxstar\Starmus\data\mappers;

use function get_current_user_id;
use function json_decode;
use function json_encode;
use function json_last_error;
use function json_last_error_msg;
use function sanitize_text_field;

use Starisian\Sparxstar\Starmus\helpers\StarmusLogger;
use Throwable;

use function wp_unslash;

if (! \defined('ABSPATH')) {
    exit;
}

class StarmusSchemaMapper
{
    /**
List of fields that map 1:1 from Frontend to ACF (New Schema).
/
    private const PASSTHROUGH_ALLOWLIST = [
    // -- Group: aiwa_core_metadata --
    'stable_uri',
    'linked_data_uri',
    'dc_rights_type',
    'dc_rights',
    'dc_rights_geo',
    'dc_rights_royalty',
    'data_sensitivity_level',
    'anonymization_status',
    'copyright_licensee',

    // -- Group: session_meta --
    'project_collection_id',
    'accession_number',
    'session_start_time',
    'session_end_time',
    'location',
    'recording_equipment',
    'media_condition_notes',
    'usage_restrictions_rights',
    'access_level',
    'audio_quality_score_tax',
    'recording_metadata',

    // -- Group: shared_rights_credits --
    'copyright_status',
    'usage_constraints',

    // -- Group: processing --
    'explicit',
    'processing_log',

    // -- Group: agreement --
    'terms_type',
    'contributor_name',
    'contributor_user_agent',
    'submission_id',

    // -- Group: music_engineering --
    'sample_rate',
    'bit_depth',
    'tuning_hz',
    'channel_layout',

    // -- Group: music_composition --
    'bpm',
    'musical_key',
    'isrc_code',
    'integrated_lufs',
    ];

    /**
Maps form data to the ACF Schema structure.
@param array<string, mixed> $data Raw or semi-sanitized form data.
@return array<string, mixed> Data ready for ACF saving.

### `is_json_field()`

**Visibility:** `public`

Check if a specific field key should be treated as JSON.

---

_Generated by Starisian Documentation Generator_
