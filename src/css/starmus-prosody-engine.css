/* =========================================================
   CORE FUNCTIONAL ENGINE: PROSODY + STARMUS
   Requirement: skipping theme, NOT function.
   Logic: Standard Layout Math + Semantic Functional States
   ========================================================= */

:root {
    /* --- FUNCTIONAL SEMANTICS (Non-negotiable for Audio) --- */
    --s-success: #16a34a; /* Green: Safe levels */
    --s-warning: #ea580c; /* Orange: High levels */
    --s-danger:  #b91c1c; /* Red: Clipping/Recording */

    /* --- THEME INTERFACE (Inherited Paint) --- */
    --s-base:     var(--wp--preset--color--base);
    --s-surface:  var(--wp--preset--color--base-2, var(--wp--preset--color--base));
    --s-contrast: var(--wp--preset--color--contrast);
    --s-accent:   var(--wp--preset--color--accent);
}

/* ---------------------------------------------------------
   1. GLOBAL FUNCTIONAL DEFAULTS
   --------------------------------------------------------- */
.starmus-recorder-form, #cognitive-regulator {
    box-sizing: border-box !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 1.5rem !important;
    padding: 2rem !important;
    background-color: var(--s-base) !important;
    color: var(--s-contrast) !important;
}

/* ---------------------------------------------------------
   2. STARMUS RECORDER: FUNCTIONAL MACHINERY
   --------------------------------------------------------- */

/* Button Grouping: Prevents clumping/overlapping */
.starmus-btn-group, .starmus-recorder-form footer {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 12px !important;
    justify-content: center !important;
}

/* Functional Buttons: Touch-targets and State */
.starmus-btn, .button.starmus-btn {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 44px !important; /* WCAG standard */
    padding: 0.75rem 1.5rem !important;
    cursor: pointer !important;
    font-family: "Noto Sans", sans-serif !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    box-shadow: var(--wp--custom--shadow--raised); /* Inherit paint */
    background-color: var(--s-accent) !important;
    color: var(--s-base) !important;
}

/* Recording State: Visual Safety cue */
.starmus-btn--stop, .starmus-btn--record.is-recording {
    background-color: var(--s-danger) !important;
    color: #fff !important;
}

/* Timer: Functional Tabular numbers */
.starmus-timer {
    font-family: "Noto Sans Mono", monospace !important;
    font-variant-numeric: tabular-nums !important;
    font-size: clamp(2rem, 8vw, 3.5rem) !important;
    text-align: center !important;
    margin: 1rem 0 !important;
}

/* Audio Meter: Functional Semantic Gradient */
.starmus-meter-bar {
    height: 14px !important;
    width: 100% !important;
    background: color-mix(in srgb, var(--s-contrast), transparent 90%) !important;
    border-radius: 7px !important;
    overflow: hidden !important;
}

.starmus-meter-bar::after {
    content: "";
    display: block;
    height: 100%;
    width: var(--starmus-audio-level, 0%);
    background: linear-gradient(90deg, var(--s-success) 0%, var(--s-warning) 70%, var(--s-danger) 100%) !important;
    transition: width 0.05s linear;
}

/* ---------------------------------------------------------
   3. PROSODY PLAYER: FUNCTIONAL MACHINERY
   --------------------------------------------------------- */

/* The Stage: Rhythmic Flow */
#scaffold-stage {
    flex-grow: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
}

#text-flow {
    font-family: "Noto Sans Mono", monospace !important; /* precision required */
    line-height: 2 !important;
    text-align: center !important;
}

/* Prosodic Units: Rhythmic containers */
.prosodic-unit {
    display: inline-block !important;
    padding: 2px 8px !important;
    margin: 4px !important;
    transition: opacity 0.3s ease !important;
}

/* Current Word State: High focus visibility */
.prosodic-unit.current {
    font-weight: 700 !important;
    color: var(--s-accent) !important;
    background: color-mix(in srgb, var(--s-accent), transparent 90%) !important;
    opacity: 1 !important;
}

.prosodic-unit.past, .prosodic-unit.future {
    opacity: 0.3 !important;
}

/* The Tap Zone: Centered Functional Interface */
.tap-zone {
    width: clamp(160px, 40vw, 220px) !important;
    height: clamp(160px, 40vw, 220px) !important;
    margin: 2rem auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    box-shadow: var(--wp--custom--shadow--raised);
}

/* Control Deck: Sticky bottom controls */
.control-deck {
    display: flex !important;
    align-items: center !important;
    gap: 15px !important;
    padding: 1rem 2rem !important;
    border-top: 1px solid color-mix(in srgb, var(--s-contrast), transparent 90%) !important;
}

/* ---------------------------------------------------------
   4. FORM ELEMENTS: STRUCTURAL DEPTH
   --------------------------------------------------------- */
.starmus-recorder-form input, .starmus-recorder-form select, .starmus-recorder-form textarea {
    width: 100% !important;
    min-height: 48px !important;
    box-sizing: border-box !important;
    background-color: var(--s-surface) !important;
    color: var(--s-contrast) !important;
    border: 1px solid color-mix(in srgb, var(--s-contrast), transparent 85%) !important;
    box-shadow: var(--wp--custom--shadow--embossed);
    padding: 0 1rem !important;
    font-family: inherit;
}

/* Busy/Loading states: Critical function */
.starmus-btn[aria-busy="true"]::after {
    content: "";
    border: 2px solid var(--s-base);
    border-radius: 50%;
    border-left-color: transparent;
    width: 18px; height: 18px;
    animation: starmus-spin 1s linear infinite;
}

@keyframes starmus-spin { 100% { transform: rotate(360deg); } }
