/* =========================================================
   STARMUS PROSODY ENGINE: DARK-FIRST TACTILE SYSTEM
   Default: Dark Mode (Charcoal Paper)
   Option: Light Mode (Cream Paper)
   Logic: Palette-Driven with Africa-Ready Hex Fallbacks
   ========================================================= */

:root {
    /* --- 1. DARK MODE DEFAULTS (The Standard) --- */
    /* Theme mapping with safe dark-palette hex fallbacks */
    --p-base: var(--wp--preset--color--base, #121212);
    --p-base-two: var(--wp--preset--color--base-two, #1a1a1a);
    --p-contrast: var(--wp--preset--color--contrast, #e0e0e0);
    --p-accent: var(--wp--preset--color--accent, #ffd700); /* Gold accent for dark reading */
    --p-border: #333333;

    /* Shadows for Dark Surface (Deep & Sharp) */
    --p-shadow-raised: 2px 2px 5px rgba(0, 0, 0, 0.5);
    --p-shadow-recessed: inset 2px 2px 5px rgba(0, 0, 0, 0.6);
    --p-shadow-lift: 0 10px 20px rgba(0, 0, 0, 0.6);
    --p-shadow-contrast-tint: rgba(0, 0, 0, 0.3);

    /* Fonts */
    --p-font-stack: "Noto Sans", system-ui, sans-serif;
    --p-font-mono: "Noto Sans Mono", monospace;
}

/* --- 2. LIGHT MODE OVERRIDES (The Option) --- */
/* Triggers if the system is light OR the .light-mode class is present */
@media (prefers-color-scheme: light) {
    :root:not(.dark-mode) {
        --p-base: var(--wp--preset--color--base, #fcffe7);
        --p-base-two: var(--wp--preset--color--base-two, #f5f5e0);
        --p-contrast: var(--wp--preset--color--contrast, #180205);
        --p-accent: var(--wp--preset--color--accent, #8e3b46); /* Earthy red for light reading */
        --p-border: #c6c3b8;

        /* Shadows for Light Surface (Soft Ink Tints) */
        --p-shadow-raised: 0 1px 3px rgba(24, 2, 5, 0.12);
        --p-shadow-recessed: inset 0 2px 4px rgba(24, 2, 5, 0.15);
        --p-shadow-lift: 0 4px 12px rgba(24, 2, 5, 0.15);
        --p-shadow-contrast-tint: rgba(24, 2, 5, 0.1);
    }
}

/* Manual .light-mode class trigger */
.light-mode {
    --p-base: var(--wp--preset--color--base, #fcffe7);
    --p-base-two: var(--wp--preset--color--base-two, #f5f5e0);
    --p-contrast: var(--wp--preset--color--contrast, #180205);
    --p-accent: var(--wp--preset--color--accent, #8e3b46);
    --p-border: #c6c3b8;
    --p-shadow-raised: 0 1px 3px rgba(24, 2, 5, 0.12);
    --p-shadow-recessed: inset 0 2px 4px rgba(24, 2, 5, 0.15);
    --p-shadow-lift: 0 4px 12px rgba(24, 2, 5, 0.15);
}

/* =========================================
   3. LOSSLESS COMPONENT STYLES
   ========================================= */

#cognitive-regulator {
    background-color: var(--p-base) !important;
    color: var(--p-contrast) !important;
    font-family: var(--p-font-stack) !important;
    border: 1px solid var(--p-border);
    border-radius: 8px;
    overflow: hidden;
    position: relative;
    /* Transition for mood-switching */
    transition:
        background-color 0.4s ease,
        color 0.4s ease;
}

#calibration-layer {
    background: var(--p-base) !important;
}

.tap-zone {
    background: var(--p-base-two) !important;
    border: 2px solid var(--p-border) !important;
    box-shadow: var(--p-shadow-raised) !important;
    width: clamp(160px, 40vw, 220px) !important;
    height: clamp(160px, 40vw, 220px) !important;
}

.tap-zone:active,
.tap-zone.flash {
    box-shadow: var(--p-shadow-recessed) !important;
    background: var(--p-base) !important;
}

.tap-label {
    color: var(--p-contrast) !important;
    font-family: var(--p-font-stack) !important;
}

/* Prosodic Stage (Monospace Rhythmic engine) */
#text-flow {
    font-family: var(--p-font-mono) !important;
    line-height: 2 !important;
}

.prosodic-unit.current {
    color: var(--p-accent) !important;
    opacity: 1 !important;
    font-weight: 700 !important;
    /* Soft palette-aware highlight */
    background: rgba(255, 215, 0, 0.12) !important;
    box-shadow: 0 4px 12px var(--p-shadow-contrast-tint) !important;
}

.prosodic-unit.future,
.prosodic-unit.past {
    color: var(--p-contrast) !important;
    opacity: 0.3 !important;
}

/* Silence Beats */
.prosodic-unit.silence-beat {
    border: 1px dashed var(--p-border) !important;
    color: var(--p-accent) !important;
}

/* Control Deck (The Footer) */
.control-deck {
    background: var(--p-base-two) !important;
    border-top: 1px solid var(--p-border) !important;
}

.neutral-btn {
    background: var(--p-base) !important;
    color: var(--p-contrast) !important;
    box-shadow: var(--p-shadow-raised) !important;
    font-family: var(--p-font-stack) !important;
}

.neutral-btn.active {
    background: var(--p-accent) !important;
    color: var(--p-base) !important; /* Inverted for high contrast */
    box-shadow: var(--p-shadow-recessed) !important;
}

/* Pace Slider (Africa/Mobile Support) */
#pace-regulator {
    accent-color: var(--p-accent) !important;
}

#pace-regulator::-webkit-slider-thumb {
    background: var(--p-accent) !important;
    border: 2px solid var(--p-base);
    box-shadow: var(--p-shadow-raised);
}

/* =========================================
   LOCALIZATION & ACCESSIBILITY
   ========================================= */
[lang="ar"],
.localized-text.ar {
    font-family: "Noto Naskh Arabic", serif !important;
}
[lang="am"],
.localized-text.am {
    font-family: "Noto Sans Ethiopic", sans-serif !important;
}

@media (prefers-reduced-motion: reduce) {
    .prosodic-unit,
    .tap-zone,
    .control-deck {
        transition: none !important;
        animation: none !important;
    }
}
