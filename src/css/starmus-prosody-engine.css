/* =========================================================
   STARMUS PROSODY ENGINE: FULL TACTILE RESTORATION
   Logic: Lossless Selector Recovery • Dark-First • Material
   Focus: Africa-Ready • Dyslexia • Photophobia
   ========================================================= */

:root {
    /* 1. THEME MAPPING (Dark-First Palette) */
    --bg-surface: var(--wp--preset--color--base, #180205);
    --bg-panel: var(--wp--preset--color--base-two, #251717);
    --text-lit: var(--wp--preset--color--contrast, #eceecf);
    --text-dim: color-mix(in srgb, var(--text-lit), transparent 60%);
    --accent: var(--wp--preset--color--accent); /* Inherits from TT5 Accent */
    --ui-border: color-mix(in srgb, var(--text-lit), transparent 90%);

    /* 2. MATERIAL SHADOW STACK (Requested) */
    --shadow-material-raised: rgba(0, 0, 0, 0.4) 0px 10px 20px, rgba(0, 0, 0, 0.5) 0px 6px 6px;
    --shadow-material-click: rgba(0, 0, 0, 0.6) 0px 1px 2px 0px, rgba(0, 0, 0, 0.3) 0px 1px 3px 1px;
    --shadow-cta-flash: rgba(0, 0, 0, 0.6) 0px 19px 38px, rgba(0, 0, 0, 0.5) 0px 15px 12px;
    --shadow-recessed:
        inset 4px 4px 8px rgba(0, 0, 0, 0.7),
        inset -4px -4px 8px color-mix(in srgb, var(--bg-surface), white 10%);

    /* 3. FONT STACK */
    --font-stack: "Noto Sans", sans-serif;
    --font-mono: "Noto Sans Mono", monospace;
}

/* --- LIGHT MODE OPTION (Non-recursive mapping) --- */
.light-mode {
    --bg-surface: var(--wp--preset--color--contrast, #fcffe7);
    --bg-panel: var(--wp--preset--color--base-two, #f5f5e0);
    --text-lit: var(--wp--preset--color--base, #180205);
}

/* =========================================
   LAYER 0: GLOBAL TEXT & HEADINGS
   ========================================= */
#cognitive-regulator {
    background-color: var(--bg-surface) !important;
    color: var(--text-lit) !important;
    font-family: var(--font-stack) !important;
    border-radius: 8px;
    overflow: hidden;
    position: relative;
}

/* FORCED TITLE CASE FOR ENGINE TITLES */
#cognitive-regulator h1,
#cognitive-regulator h2,
.starmus-card-title {
    text-transform: capitalize !important;
    font-family: "Roboto Condensed", sans-serif !important;
    font-weight: 700;
}

/* =========================================
   LAYER 1: CALIBRATION (The Tap Zone)
   ========================================= */
#calibration-layer {
    background: var(--bg-surface) !important;
}

.tap-zone {
    width: clamp(160px, 40vw, 220px) !important;
    height: clamp(160px, 40vw, 220px) !important;
    background: var(--bg-panel) !important;
    border: 2px solid var(--ui-border) !important;
    border-radius: 50% !important;
    box-shadow: var(--shadow-material-raised) !important;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.tap-zone:active,
.tap-zone.flash {
    box-shadow: var(--shadow-material-click) !important;
    transform: scale(0.96);
}

.tap-label {
    color: var(--text-lit) !important;
    letter-spacing: 2px !important;
}

/* =========================================
   LAYER 2: THE STAGE (Rhythmic Text Flow)
   ========================================= */
#text-flow {
    font-family: var(--font-mono) !important;
    line-height: 2 !important;
    font-size: clamp(1.4rem, 5vw, 2.2rem) !important;
}

.prosodic-unit.current {
    color: var(--accent) !important;
    background: color-mix(in srgb, var(--accent), transparent 85%) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5) !important;
    font-weight: 700;
    transform: scale(1.05);
}

.prosodic-unit.future,
.prosodic-unit.past {
    color: var(--text-dim) !important;
    opacity: 0.3 !important;
}

.prosodic-unit.silence-beat {
    border: 1px dashed var(--ui-border) !important;
    color: var(--accent) !important;
    background: color-mix(in srgb, var(--bg-panel), transparent 50%) !important;
}

/* =========================================
   LAYER 3: CONTROLS (The Deck)
   ========================================= */
.control-deck {
    background: var(--bg-panel) !important;
    border-top: 1px solid var(--ui-border) !important;
}

.neutral-btn {
    background: var(--bg-surface) !important;
    color: var(--text-lit) !important;
    box-shadow: var(--shadow-material-raised) !important;
    border-radius: 4px !important;
    font-family: var(--font-stack) !important;
    transition: all 0.2s ease;
}

.neutral-btn:active {
    box-shadow: var(--shadow-material-click) !important;
}

.neutral-btn.active {
    background: var(--accent) !important;
    color: var(--bg-surface) !important;
}

/* Pace Slider (Embossed Inset) */
#pace-regulator {
    accent-color: var(--accent) !important;
    box-shadow: var(--shadow-recessed) !important;
    border-radius: 10px;
    height: 8px;
}

#pace-regulator::-webkit-slider-thumb {
    background: var(--accent) !important;
    box-shadow: var(--shadow-material-raised);
    border: 2px solid var(--bg-surface);
}

/* =========================================
   LAYER 4: CARDS (Curled Hover Logic)
   ========================================= */
.starmus-script-card {
    position: relative;
    background: var(--bg-panel) !important;
    border: 1px solid var(--ui-border) !important;
    border-radius: 4px;
    z-index: 1;
}

/* Curled shadow logic: Appear on hover only */
.starmus-script-card::before,
.starmus-script-card::after {
    content: "";
    position: absolute;
    bottom: 15px;
    width: 40%;
    height: 10px;
    box-shadow: 0 10px 18px rgba(0, 0, 0, 0.8);
    z-index: -1;
    opacity: 0;
    transition: all 0.3s ease;
}

.starmus-script-card::before {
    left: 15px;
    transform: skew(-5deg) rotate(-5deg);
}
.starmus-script-card::after {
    right: 15px;
    transform: skew(5deg) rotate(5deg);
}

.starmus-script-card:hover::before,
.starmus-script-card:hover::after {
    opacity: 1;
    bottom: 10px;
}

/* =========================================
   LOCALIZATION & ACCESSIBILITY
   ========================================= */
[lang="ar"] {
    font-family: "Noto Naskh Arabic", serif !important;
}
[lang="am"] {
    font-family: "Noto Sans Ethiopic", sans-serif !important;
}

@media (prefers-reduced-motion: reduce) {
    .prosodic-unit,
    .tap-zone,
    .neutral-btn {
        transition: none !important;
        animation: none !important;
    }
}
