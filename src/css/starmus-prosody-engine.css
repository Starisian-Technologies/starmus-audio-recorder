/* =========================================================
   STARMUS PROSODY ENGINE: FUNCTIONAL CORE (v4.2)
   Logic: Layout Math (Plugin) + Visual Identity (Theme)
   Requirement: No Theming. Total Structural Restoration.
   ========================================================= */

:root {
    /* --- 1. THEME INTERFACE (Inherited Paint) --- */
    --p-base:       var(--wp--preset--color--base);
    --p-surface:    var(--wp--preset--color--base-2, var(--wp--preset--color--base));
    --p-contrast:   var(--wp--preset--color--contrast);
    --p-accent:     var(--wp--preset--color--accent);

    /* --- 2. THEME SHADOWS --- */
    --p-shd-raised:   var(--wp--custom--shadow--raised);
    --p-shd-flat:     var(--wp--custom--shadow--flat);
    --p-shd-embossed: var(--wp--custom--shadow--embossed);
}

/* =========================================
   LAYER 0: THE SHELL (Fixed Height & Container)
   ========================================= */
#cognitive-regulator {
    /* Functional Requirement: Fixed height to allow layers to scroll/overlay */
    height: 60vh !important;
    min-height: 450px !important;
    width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    position: relative !important;
    overflow: hidden !important;

    background-color: var(--p-base) !important;
    color: var(--p-contrast) !important;
    font-family: inherit;
    border-radius: 8px;
    box-shadow: var(--p-shd-flat);
    box-sizing: border-box !important;
}

/* =========================================
   LAYER 1: CALIBRATION (The Functional Overlay)
   ========================================= */
#calibration-layer {
    position: absolute !important;
    inset: 0 !important;
    z-index: 200 !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    background: var(--p-base) !important;
    transition: opacity 0.5s ease;
}

.tap-zone {
    /* Functional Target: Large and centered */
    width: clamp(160px, 40vw, 220px) !important;
    height: clamp(160px, 40vw, 220px) !important;
    border-radius: 50% !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;

    background: var(--p-surface) !important;
    border: 2px solid var(--p-contrast) !important;
    box-shadow: var(--p-shd-raised) !important;
}

.tap-label { color: var(--p-contrast) !important; font-weight: 700; }

/* =========================================
   LAYER 2: THE STAGE (Rhythmic Scrolling Area)
   ========================================= */
#scaffold-stage {
    flex-grow: 1 !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
    position: relative !important;
    scrollbar-width: none;
}

#text-flow {
    /* Functional Requirement: Monospace for metronome-like word spacing */
    font-family: "Noto Sans Mono", monospace !important;
    font-size: clamp(1.4rem, 5vw, 2rem) !important;
    line-height: 2 !important;
    text-align: center !important;
    padding-top: 30vh !important; /* Critical: centers text vertically in viewport */
    padding-bottom: 30vh !important;
}

.prosodic-unit {
    display: inline-block !important;
    padding: 2px 8px !important;
    margin: 4px !important;
    transition: color 0.3s, opacity 0.3s !important;
}

/* Active State: Semantic emphasis */
.prosodic-unit.current {
    color: var(--p-accent) !important;
    font-weight: 800 !important;
    opacity: 1 !important;
    background: color-mix(in srgb, var(--p-accent), transparent 90%) !important;
    border-radius: 4px;
}

.prosodic-unit.past, .prosodic-unit.future {
    opacity: 0.3 !important;
}

/* =========================================
   LAYER 3: CONTROLS (The Deck)
   ========================================= */
.control-deck {
    display: flex !important;
    align-items: center !important;
    gap: 15px !important;
    padding: 12px 20px !important;
    z-index: 100 !important;

    background: var(--p-surface) !important;
    border-top: 1px solid color-mix(in srgb, var(--p-contrast), transparent 90%) !important;
}

.neutral-btn {
    display: inline-flex !important;
    min-height: 40px !important;
    padding: 0 16px !important;
    align-items: center !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    cursor: pointer !important;

    background: var(--p-base) !important;
    color: var(--p-contrast) !important;
    box-shadow: var(--p-shd-raised) !important;
    border-radius: 4px;
    border: none !important;
}

/* Pace Slider (Embossed) */
#pace-regulator {
    flex-grow: 1 !important;
    accent-color: var(--p-accent) !important;
    height: 8px !important;
    appearance: none;
    background: var(--p-base) !important;
    box-shadow: var(--p-shd-embossed) !important;
    border-radius: 10px;
}

#pace-regulator::-webkit-slider-thumb {
    appearance: none;
    width: 20px; height: 20px;
    background: var(--p-accent);
    border-radius: 50%;
    box-shadow: var(--p-shd-raised);
}

/* =========================================
   UTILITIES
   ========================================= */
#calibration-layer.fade-out { opacity: 0; pointer-events: none; }
#scaffold-stage.hidden { opacity: 0; }
