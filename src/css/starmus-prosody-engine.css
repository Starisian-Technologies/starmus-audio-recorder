/* =========================================================
   STARMUS PROSODY ENGINE: FUNCTIONAL REFACTOR
   Logic: Layout in Plugin. Identity in Theme.
   Standard: Lossless Selector Mapping â€¢ Switchable Surface
   ========================================================= */

:root {
    /* --- THEME ALIASING --- */
    /* Default: Plugin assumes Dark Surface (Base = Contrast, Contrast = Base) */
    --p-base:       var(--wp--preset--color--contrast); 
    --p-surface:    var(--wp--preset--color--contrast-2, var(--wp--preset--color--contrast));
    --p-contrast:   var(--wp--preset--color--base);
    --p-accent:     var(--wp--preset--color--accent);

    /* --- INHERITED IDENTITY --- */
    --p-shd-raised:   var(--wp--custom--shadow--raised);
    --p-shd-embossed: var(--wp--custom--shadow--embossed);
    --p-shd-flat:     var(--wp--custom--shadow--flat);
}

/* --- LIGHT MODE OPTION --- */
/* Swaps variables back to standard theme mapping */
.sparxstar-theme--light, .light-mode {
    --p-base:       var(--wp--preset--color--base);
    --p-surface:    var(--wp--preset--color--base-2, var(--wp--preset--color--base));
    --p-contrast:   var(--wp--preset--color--contrast);
}

/* =========================================
   LAYER 0: CONTAINER & SURFACE
   ========================================= */
#cognitive-regulator {
    background-color: var(--p-base) !important;
    color: var(--p-contrast) !important;
    font-family: inherit; /* Inherits Noto Sans from Readability Layer */
    border-radius: 8px;
    box-shadow: var(--p-shd-flat) !important;
    border: 1px solid color-mix(in srgb, var(--p-contrast), transparent 95%);
    position: relative;
    overflow: hidden;
}

/* =========================================
   LAYER 1: CALIBRATION (Functional Rhythm)
   ========================================= */
#calibration-layer {
    background: var(--p-base) !important;
}

.tap-zone {
    width: clamp(160px, 40vw, 220px) !important;
    height: clamp(160px, 40vw, 220px) !important;
    background: var(--p-surface) !important;
    border: 2px solid color-mix(in srgb, var(--p-contrast), transparent 90%) !important;
    border-radius: 50% !important;
    box-shadow: var(--p-shd-raised) !important;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.tap-label {
    color: var(--p-contrast) !important;
    font-weight: 700;
}

/* =========================================
   LAYER 2: THE STAGE (Functional Monospace)
   ========================================= */
#text-flow {
    /* Monospace is a functional requirement for rhythmic precision */
    font-family: "Noto Sans Mono", monospace !important;
    line-height: 2 !important;
    font-size: clamp(1.4rem, 5vw, 2.2rem) !important;
    text-align: center;
}

.prosodic-unit {
    display: inline-block;
    padding: 2px 8px;
    transition: color 0.3s, opacity 0.3s !important;
}

.prosodic-unit.current {
    /* Semantic Highlight: Uses Theme Accent */
    color: var(--p-accent) !important;
    background: color-mix(in srgb, var(--p-accent), transparent 90%) !important;
    border-radius: 4px;
    opacity: 1 !important;
}

.prosodic-unit.future, .prosodic-unit.past {
    opacity: 0.3 !important;
}

.prosodic-unit.silence-beat {
    border: 1px dashed color-mix(in srgb, var(--p-contrast), transparent 80%) !important;
    color: var(--p-accent) !important;
}

/* =========================================
   LAYER 3: CONTROLS (The Deck)
   ========================================= */
.control-deck {
    background: var(--p-surface) !important;
    border-top: 1px solid color-mix(in srgb, var(--p-contrast), transparent 90%) !important;
}

.neutral-btn {
    background: var(--p-base) !important;
    color: var(--p-contrast) !important;
    box-shadow: var(--p-shd-raised) !important;
    border: none !important;
    font-family: inherit;
    font-weight: 700;
    text-transform: uppercase;
    border-radius: 4px !important;
}

.neutral-btn.active {
    background: var(--p-accent) !important;
    color: var(--p-base) !important;
}

/* Pace Slider (Functional Inset) */
#pace-regulator {
    accent-color: var(--p-accent) !important;
    box-shadow: var(--p-shd-emboss) !important;
    background: var(--p-base) !important;
    appearance: none;
    height: 8px;
    border-radius: 10px;
}

#pace-regulator::-webkit-slider-thumb {
    appearance: none;
    width: 18px;
    height: 18px;
    background: var(--p-accent);
    border-radius: 50%;
    box-shadow: var(--p-shd-raised);
}

/* =========================================
   LAYER 4: CARDS (Library View)
   ========================================= */
.starmus-script-card {
    background: var(--p-surface) !important;
    box-shadow: var(--p-shd-flat) !important;
    padding: 2rem !important;
    border-radius: 8px !important;
}

.starmus-card-title {
    color: var(--p-accent) !important;
}